# Doctrine Migration File Generated on 2012-02-22 15:02:22
# Migrating from 0 to 20120216215726

# Version 20120209145310
ALTER TABLE Node RENAME Frame;
ALTER TABLE Route RENAME Sequence;
ALTER TABLE Playground RENAME Site;
ALTER TABLE users_playgrounds RENAME users_sites;
ALTER TABLE routes_layers RENAME sequences_layers;
ALTER TABLE Item DROP FOREIGN KEY FK_BF298A20F8FE9381;
DROP INDEX IDX_BF298A20F8FE9381 ON Item;
ALTER TABLE Item CHANGE playground_id site_id INT DEFAULT NULL;
CREATE INDEX IDX_BF298A20F6BD1646 ON Item (site_id);
ALTER TABLE Item ADD CONSTRAINT FK_BF298A20F6BD1646 FOREIGN KEY (site_id) REFERENCES Site(id);
ALTER TABLE Project DROP FOREIGN KEY FK_E00EE972F8FE9381;
DROP INDEX IDX_E00EE972F8FE9381 ON Project;
ALTER TABLE Project CHANGE playground_id site_id INT DEFAULT NULL;
ALTER TABLE Project ADD CONSTRAINT FK_E00EE972F6BD1646 FOREIGN KEY (site_id) REFERENCES Site(id);
CREATE INDEX IDX_E00EE972F6BD1646 ON Project (site_id);
ALTER TABLE Frame DROP FOREIGN KEY FK_254D477B34ECB4E6;
ALTER TABLE Frame DROP FOREIGN KEY FK_254D477B993D08FC;
ALTER TABLE Frame DROP FOREIGN KEY FK_254D477B6F5AF03F;
ALTER TABLE Frame DROP FOREIGN KEY FK_254D477B9F0A94F7;
ALTER TABLE Frame DROP FOREIGN KEY FK_254D477BAA9478C2;
DROP INDEX IDX_254D477B34ECB4E6 ON Frame;
DROP INDEX IDX_254D477BAA9478C2 ON Frame;
DROP INDEX IDX_254D477B6F5AF03F ON Frame;
DROP INDEX IDX_254D477B9F0A94F7 ON Frame;
DROP INDEX IDX_254D477B993D08FC ON Frame;
ALTER TABLE Frame CHANGE route_id sequence_id INT DEFAULT NULL;
ALTER TABLE Frame CHANGE route_index sequence_index INT DEFAULT NULL;
ALTER TABLE Frame ADD CONSTRAINT FK_743913C998FB19AE FOREIGN KEY (sequence_id) REFERENCES Sequence(id) ON DELETE CASCADE;
ALTER TABLE Frame ADD CONSTRAINT FK_743913C9AA9478C2 FOREIGN KEY (link_up_id) REFERENCES Frame(id);
ALTER TABLE Frame ADD CONSTRAINT FK_743913C96F5AF03F FOREIGN KEY (link_down_id) REFERENCES Frame(id);
ALTER TABLE Frame ADD CONSTRAINT FK_743913C99F0A94F7 FOREIGN KEY (link_left_id) REFERENCES Frame(id);
ALTER TABLE Frame ADD CONSTRAINT FK_743913C9993D08FC FOREIGN KEY (link_right_id) REFERENCES Frame(id);
ALTER TABLE users_sites DROP FOREIGN KEY FK_946022D3F8FE9381;
ALTER TABLE users_sites CHANGE playground_id site_id INT NOT NULL;
ALTER TABLE users_sites ADD CONSTRAINT FK_5B770E2AF6BD1646 FOREIGN KEY (site_id) REFERENCES Site(id);
ALTER TABLE sequences_layers DROP FOREIGN KEY FK_4931205234ECB4E6;
DROP INDEX IDX_4931205234ECB4E6 ON sequences_layers;
ALTER TABLE sequences_layers CHANGE route_id sequence_id INT NOT NULL;
ALTER TABLE sequences_layers ADD CONSTRAINT FK_8568B41298FB19AE FOREIGN KEY (sequence_id) REFERENCES Sequence(id) ON DELETE CASCADE;

# Version 20120209173402
ALTER TABLE User RENAME zUser;

# Version 20120209174241
ALTER TABLE Item ADD archive VARCHAR(50) NOT NULL;
ALTER TABLE Item CHANGE type media_type VARCHAR(20) NOT NULL;
ALTER TABLE Item CHANGE source layer_type VARCHAR(20) NOT NULL;

# Version 20120216215726
ALTER TABLE Item CHANGE media_creator_realname media_creator_realname VARCHAR(80) DEFAULT NULL;
ALTER TABLE Metadata CHANGE archive archive VARCHAR(50) DEFAULT NULL;
