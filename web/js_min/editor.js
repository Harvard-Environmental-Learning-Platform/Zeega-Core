/*!
 * jQuery UI 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI Widget 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
/*!
 * jQuery UI Mouse 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
/** @license VisualSearch.js 0.2.2
 *  (c) 2011 Samuel Clay, @samuelclay, DocumentCloud Inc.
 *  VisualSearch.js may be freely distributed under the MIT license.
 *  For all details and documentation:
 *  http://documentcloud.github.com/visualsearch
 */
/*!
 * jQuery Cycle Plugin (with Transition Definitions)
 * Examples and documentation at: http://jquery.malsup.com/cycle/
 * Copyright (c) 2007-2010 M. Alsup
 * Version: 2.9995 (09-AUG-2011)
 * Dual licensed under the MIT and GPL licenses.
 * http://jquery.malsup.com/license.html
 * Requires: jQuery v1.3.2 or later
 */
/*!
 * jQuery Cycle Plugin Transition Definitions
 * This script is a plugin for the jQuery Cycle Plugin
 * Examples and documentation at: http://malsup.com/jquery/cycle/
 * Copyright (c) 2007-2010 M. Alsup
 * Version:	 2.73
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 */
/*!
 * Popcorn.sequence
 *
 * Copyright 2011, Rick Waldron
 * Licensed under MIT license.
 *
 */
function initHeaderUX(){$(".bug-report").click(function(a){a.stopPropagation()}),$(".bug-report").parent().click(function(){$(".bug-unsubmitted").show(),$(".bug-submitted").hide()}),$(".close-bug").click(function(){$(".bug-report").parent().trigger("click")}),$(".submit-bug").click(function(){var a=new Backbone.Model({url:window.location.href,hash:window.location.hash.substr(1),description:$(".bug-description").val(),email:$(".bug-email").val(),browser:BrowserDetect.browser,version:BrowserDetect.version,os:BrowserDetect.OS,login:sessionStorage.getItem("user")});a.url=sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"bugs/report.php",a.save(),$(".bug-description").attr("value",""),$(".bug-unsubmitted").fadeOut("fast",function(){$(".bug-submitted").fadeIn()})}),$(".drop-down").click(function(){if(!$(this).hasClass("open")){$(this).addClass("open");var a=$(this);return $("body").bind("click",function(){a.removeClass("open"),$(this).unbind()}),!1}$(this).removeClass("open")}),$(".add-media a").click(function(){return $("#add-media").toggleClass("show"),$("body").on("click",function(){$("#add-media").removeClass("show")}),!1}),$(".new-project").click(function(){$.ajax({url:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"sites/"+sessionStorage.getItem("siteId")+"/project",type:"POST",success:function(a){console.log(a),window.location=sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"site/"+sessionStorage.getItem("siteShort")+"/project/"+a}})}),$("#book-three").find("a").attr("href","javascript:(function(){var head=document.getElementsByTagName('body')[0],script=document.createElement('script');script.id='zeegabm';script.type='text/javascript';script.src='"+sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"js/widget/zeega.bookmarklet.js?' + Math.floor(Math.random()*99999);head.appendChild(script);})(); void 0")}function textArea(){var a="<input type='textarea'>";return template}function makeGoogleMapTarget(a){var b='<div class="google-map-wrapper layer-control"><div id="map-'+a+'" class="map"></div>'+"</div>",c=$(b);return c}function makeGoogleMap(args){var defaults={type:"map",streetView:!0,searchBar:!0,disableDoubleClickZoom:!0,panControl:!1,zoomControl:!0,mapTypeControl:!0,scaleControl:!1,streetViewControl:!0,overviewMapControl:!1};_.defaults(args,defaults);var center=new google.maps.LatLng(args.lat,args.lng);eval("var gMapType = google.maps.MapTypeId."+args.mapType.toUpperCase());var mapOptions={zoom:args.zoom,center:center,mapTypeId:gMapType,disableDoubleClickZoom:args.disableDoubleClickZoom,panControl:args.panControl,zoomControl:args.zoomControl,mapTypeControl:args.mapTypeControl,scaleControl:args.scaleControl,streetViewControl:args.streetView,overviewMapControl:args.overviewMapControl},map=new google.maps.Map(args.controls.find(".map")[0],mapOptions),streetView=map.getStreetView();if(args.type=="streetview"){var pov={heading:args.heading,pitch:args.pitch,zoom:args.streetZoom};streetView.setPosition(center),streetView.setPov(pov),streetView.setVisible(!0)}google.maps.event.addListener(map,"zoom_changed",function(){args.controls.trigger("update",[{zoom:{property:"zoom",value:map.getZoom(),css:!1}}]),updateStaticMap(_.extend(args,{zoom:map.getZoom()}))}),google.maps.event.addListener(map,"idle",function(){var a=map.getCenter();args.controls.trigger("update",[{lat:{property:"lat",value:a.lat(),css:!1},lng:{property:"lng",value:a.lng(),css:!1}}]),updateStaticMap(_.extend(args,{lat:a.lat(),lng:a.lng()}))}),google.maps.event.addListener(map,"maptypeid_changed",function(){args.controls.trigger("update",[{mapType:{property:"mapType",value:map.getMapTypeId(),css:!1}}]),updateStaticMap(_.extend(args,{mapType:map.getMapTypeId()}))}),google.maps.event.addListener(streetView,"visible_changed",function(){if(streetView.getVisible()){var a=streetView.getPosition(),b={streetView:{property:"type",value:"streetview",css:!1},lat:{property:"lat",value:a.lat(),css:!1},lng:{property:"lng",value:a.lng(),css:!1}};args.controls.trigger("update",[b]),updateStaticMap(_.extend(args,{type:"streetview",lat:b.lat.value,lng:b.lng.value}))}else{var b={map:{property:"type",value:"map",css:!1}};args.controls.trigger("update",[b]),updateStaticMap(_.extend(args,{type:"map"}))}}),google.maps.event.addListener(streetView,"pov_changed",function(){delayedUpdate()});var delayedUpdate=_.debounce(function(){var a=streetView.getPosition(),b=streetView.getPov(),c={heading:{property:"heading",value:b.heading,css:!1},lat:{property:"lat",value:a.lat(),css:!1},lng:{property:"lng",value:a.lng(),css:!1},pitch:{property:"pitch",value:b.pitch,css:!1},streetZoom:{property:"streetZoom",value:Math.floor(b.zoom),css:!1}};args.controls.trigger("update",[c]),updateStaticMap(_.extend(args,{heading:b.heading,pitch:b.pitch,streetZoom:Math.floor(b.zoom),lat:a.lat(),lng:a.lng()}))},1e3);if(args.searchBar){var input=$('<input id="map-search" type="text" placeholder="search for a place">').css("width","258px"),button=$('<input id="map-submit" class="btn primary" type="Submit" value="search maps">');args.controls.find(".google-map-wrapper").append(input).append(button);var geocoder=new google.maps.Geocoder;button.click(function(){doMapSearch()}),input.keypress(function(a){a.which==13&&doMapSearch()});var doMapSearch=function(){event.preventDefault(),geocoder.geocode({address:input.val()},function(a,b){if(b==google.maps.GeocoderStatus.OK){streetView.getVisible()&&streetView.setVisible(!1);var c=a[0].geometry.location;map.setCenter(c)}else alert("Geocoder failed at address look for "+input.val()+": "+b)});var a={title:{property:"title",value:input.val(),css:!1}};args.controls.trigger("update",[a])}}}function updateStaticMap(a){console.log("UPDATE STATIC MAP"),console.log(a),console.log(a.width+":"+a.height);var b=6*parseInt(a.width),c=4*parseInt(a.height);a.type=="streetview"?(console.log("http://maps.googleapis.com/maps/api/streetview?size="+b+"x"+c+"&fov="+180/Math.pow(2,a.streetZoom)+"&location="+a.lat+","+a.lng+"&heading="+a.heading+"&pitch="+a.pitch+"&sensor=false"),a.visual.find("img").attr("src","http://maps.googleapis.com/maps/api/streetview?size="+b+"x"+c+"&fov="+180/Math.pow(2,a.streetZoom)+"&location="+a.lat+","+a.lng+"&heading="+a.heading+"&pitch="+a.pitch+"&sensor=false")):a.visual.find("img").attr("src","http://maps.googleapis.com/maps/api/staticmap?center="+a.lat+","+a.lng+"&zoom="+a.zoom+"&size="+b+"x"+c+"&maptype="+a.mapType+"&sensor=false")}function makeFullscreenButton(a){var b=$("<input>").attr({"class":"fullscreen-submit btn",type:"submit",value:"Fullscreen"});return b.click(function(){a.find("#width-slider").slider("option","value",100);var b={width:{property:"width",value:100,suffix:"%",css:!0},height:{property:"height",value:100,suffix:"%",css:!0},top:{property:"top",value:0,css:!0},left:{property:"left",value:0,css:!0}};a.trigger("update",[b,!1])}),b}function makeUISlider(a){var b={min:0,max:100,step:1,value:100,silent:!1,suffix:"",css:!1,scaleWith:!1,scaleValue:!1,callback:!1};_.defaults(a,b);var c=$("<div>").addClass("slider");a.label&&c.append($("<h4>").html(a.label));var d=$("<div>").addClass("layer-slider").attr("id",a.property+"-slider");return d.slider({min:a.min,max:a.max,value:a.value,step:a.step,slide:function(b,c){a.input&&a.input.val(c.value);var d={propertyA:{property:a.property,value:c.value,suffix:a.suffix,css:a.css}};if(a.scaleWith&&a.scaleValue){var e=c.value*a.scaleValue/a.value;d.propertyB={property:a.scaleWith,value:e,suffix:a.suffix,css:a.css}}a.dom.trigger("update",[d,!0])},stop:function(b,c){a.input&&a.input.val(c.value),console.log(a);var d={propertyA:{property:a.property,value:c.value,suffix:a.suffix,css:a.css}};if(a.scaleWith&&a.scaleValue){var e=c.value*a.scaleValue/a.value;d.propertyB={property:a.scaleWith,value:e,suffix:a.suffix,css:a.css}}a.dom.trigger("update",[d,a.silent]),a.callback&&console.log(a.callback)}}),c.append(d),c}function makeColorPicker(a){defaults={color:{r:255,g:255,b:255,a:1},opacity:!0},_.defaults(a,defaults);var b=a.label.replace(/\s/g,"-").toLowerCase(),c=$("<div>"),d=$("<div>").addClass("color-window").data("info",{id:a.id,property:a.property}),e=$("<div>").addClass("color-preview").css("background-color","#"+RGBToHex(a.color)),f=makeHiddenInput({label:"r",value:a.color.r}),g=makeHiddenInput({label:"g",value:a.color.g}),h=makeHiddenInput({label:"b",value:a.color.b}),i=makeHiddenInput({label:"a",value:a.color.a});if(a.opacity)var j={max:1,label:"Opacity",step:.01,property:"alpha",value:a.color.a,dom:c,input:i,css:!1},k=makeUISlider(j);d.append(e).append(f).append(g).append(h).append(i),c.append("<h4>"+a.label+"</h4>").append(d),a.opacity&&c.append(k),c.bind("update",function(b,c,d){var e="rgba("+f.val()+","+g.val()+","+h.val()+","+i.val()+")";a.target.css(a.property,e);if(!d){var j={r:f.val(),g:g.val(),b:h.val(),a:i.val()};a.controls.trigger("update",[{color:{property:a.property,value:j,css:!1}}])}}),c.bind("updateColor",function(b){var c="rgba("+f.val()+","+g.val()+","+h.val()+","+i.val()+")";a.target.css(a.property,c)});var l=d.ColorPicker({color:a.color,onShow:function(a){$(a).fadeIn()},onHide:function(b){$(b).fadeOut();var c={r:f.val(),g:g.val(),b:h.val(),a:i.val()};a.controls.trigger("update",[{color:{property:a.property,value:c,css:!1}}])},onChange:function(a,b,d){e.css("background-color","#"+b),f.val(d.r),g.val(d.g),h.val(d.b),c.trigger("updateColor")}});return c}function makeHiddenInput(a){var b=$('<input type="hidden" />').attr("id",a.label).val(a.value);return b}function RGBToHex(a){var b=[parseInt(a.r).toString(16),parseInt(a.g).toString(16),parseInt(a.b).toString(16)];return $.each(b,function(a,c){c.length==1&&(b[a]="0"+c)}),b.join("")}function getItemIcon(a){switch(a.toLowerCase()){case"audio":return"ui-icon-volume-on";case"image":return"ui-icon-image";case"video":return"ui-icon-video"}}function addGlobal(layerId,event,elementId){LayerGlobals[layerId]||(LayerGlobals[layerId]={}),eval("LayerGlobals[layerId]."+event+'= function(data){$("#'+elementId+'").trigger("'+event+'",data);}')}function getHost(){return window.location.protocol+"//"+window.location.host}function getBaseURL(){var a=window.location.pathname.split("/"),b=a.indexOf("/web/"),c=window.location.pathname.substring(0,b+4);return c}function convertTime(a){var b=Math.floor(a/60),c=Math.floor(a%60);return c<10&&(c="0"+c),b+":"+c}function deconvertTime(a,b){return 60*a+parseInt(b)}function getMinutes(a){return Math.floor(parseInt(a)/60)}function getSeconds(a){var b=Math.floor(a%60*10)/10;return b<10&&(b="0"+b),b}function isInt(a){var b=parseInt(a);return isNaN(b)?!1:a==b&&a.toString()==b.toString()}function isPercent(a){return isInt(a)&&parseInt(a)<=100}function deepCopy(a,b){var b=b||{};for(var c in a)typeof a[c]=="object"?(b[c]=a[c].constructor===Array?[]:{},deepCopy(a[c],b[c])):b[c]=a[c];return b}function rgbToHex(a,b,c){return toHex(a)+toHex(b)+toHex(c)}function toHex(a){return a=parseInt(a,10),isNaN(a)?"00":(a=Math.max(0,Math.min(a,255)),"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16))}function convertTime(a,b){var c=Math.floor(a/60);if(b&&!1)var d=Math.floor(a%600)/10;else var d=Math.floor(a%60);return d<10&&(d="0"+d),c+":"+d}(function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(w.has(a,h)){f++;if(!(g=w.has(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(w.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new E(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=w),exports._=w):a._=w,w.VERSION="1.3.1";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(w.has(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=w.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=w.toArray(a).reverse();return d&&!e&&(b=w.bind(b,d)),e?w.reduce(f,b,c,d):w.reduce(f,b)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var y=w.some=w.any=function(a,b,d){b||(b=w.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(w.isFunction(b)?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return w.reduce(d,function(c,d,f){if(0==f||(b===!0?w.last(c)!=d:!w.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a){var b=w.flatten(g.call(arguments,1));return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return w.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},w.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},w.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)w.has(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(w.has(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return i.call(a)=="[object Arguments]"},w.isArguments(arguments)||(w.isArguments=function(a){return!!a&&!!w.has(a,"callee")}),w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.has=function(a,b){return j.call(a,b)},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.mixin=function(a){x(w.functions(a),function(b){G(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||C,function(a,b){return"',_.escape("+D(b)+"),'"}).replace(c.interpolate||C,function(a,b){return"',"+D(b)+",'"}).replace(c.evaluate||C,function(a,b){return"');"+D(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,w):function(a){return e.call(this,a,w)}},w.chain=function(a){return w(a).chain()};var E=function(a){this._wrapped=a};w.prototype=E.prototype;var F=function(a,b){return b?w(a).chain():a},G=function(a,b){E.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),F(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];E.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],F(c,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];E.prototype[a]=function(){return F(b.apply(this._wrapped,arguments),this._chain)}}),E.prototype.chain=function(){return this._chain=!0,this},E.prototype.value=function(){return this._wrapped}}).call(this),define("web/js/lib/underscore.js",function(){}),function(){var a=this,b=a.Backbone,c=Array.prototype.slice,d=Array.prototype.splice,e;typeof exports!="undefined"?e=exports:e=a.Backbone={},e.VERSION="0.9.1";var f=a._;!f&&typeof require!="undefined"&&(f=require("underscore"));var g=a.jQuery||a.Zepto||a.ender;e.setDomLibrary=function(a){g=a},e.noConflict=function(){return a.Backbone=b,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={on:function(a,b,c){var d;a=a.split(/\s+/);var e=this._callbacks||(this._callbacks={});while(d=a.shift()){var f=e[d]||(e[d]={}),g=f.tail||(f.tail=f.next={});g.callback=b,g.context=c,f.tail=g.next={}}return this},off:function(a,b,c){var d,e,f;if(!a)delete this._callbacks;else if(e=this._callbacks){a=a.split(/\s+/);while(d=a.shift()){f=e[d],delete e[d];if(!b||!f)continue;while((f=f.next)&&f.next){if(f.callback===b&&(!c||f.context===c))continue;this.on(d,f.callback,f.context)}}}return this},trigger:function(a){var b,d,e,f,g,h,i;if(!(e=this._callbacks))return this;h=e.all,(a=a.split(/\s+/)).push(null);while(b=a.shift()){h&&a.push({next:h.next,tail:h.tail,event:b});if(!(d=e[b]))continue;a.push({next:d.next,tail:d.tail})}i=c.call(arguments,1);while(d=a.pop()){f=d.tail,g=d.event?[d.event].concat(i):i;while((d=d.next)!==f)d.callback.apply(d.context||this,g)}return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off,e.Model=function(a,b){var c;a||(a={}),b&&b.parse&&(a=this.parse(a));if(c=u(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection),this.attributes={},this._escapedAttributes={},this.cid=f.uniqueId("c");if(!this.set(a,{silent:!0}))throw new Error("Can't create an invalid model");delete this._changed,this._previousAttributes=f.clone(this.attributes),this.initialize.apply(this,arguments)},f.extend(e.Model.prototype,e.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=f.escape(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b,c){var d,g,h;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c||(c={});if(!d)return this;d instanceof e.Model&&(d=d.attributes);if(c.unset)for(g in d)d[g]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var i=this.attributes,j=this._escapedAttributes,k=this._previousAttributes||{},l=this._setting;this._changed||(this._changed={}),this._setting=!0;for(g in d){h=d[g],f.isEqual(i[g],h)||delete j[g],c.unset?delete i[g]:i[g]=h,this._changing&&!f.isEqual(this._changed[g],h)&&(this.trigger("change:"+g,this,h,c),this._moreChanges=!0),delete this._changed[g];if(!f.isEqual(k[g],h)||f.has(i,g)!=f.has(k,g))this._changed[g]=h}return l||(!c.silent&&this.hasChanged()&&this.change(c),this._setting=!1),this},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(a){return(a||(a={})).unset=!0,this.set(f.clone(this.attributes),a)},fetch:function(a){a=a?f.clone(a):{};var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b,c){var d,g;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c=c?f.clone(c):{},c.wait&&(g=f.clone(this.attributes));var h=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?h:c))return!1;var i=this,j=c.success;c.success=function(a,b,e){var g=i.parse(a,e);c.wait&&(g=f.extend(d||{},g));if(!i.set(g,c))return!1;j?j(i,a):i.trigger("sync",i,a,c)},c.error=e.wrapError(c.error,i,c);var k=this.isNew()?"create":"update",l=(this.sync||e.sync).call(this,k,this,c);return c.wait&&this.set(g,h),l},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d();a.success=function(e){a.wait&&d(),c?c(b,e):b.trigger("sync",b,e,a)},a.error=e.wrapError(a.error,b,a);var g=(this.sync||e.sync).call(this,"delete",this,a);return a.wait||d(),g},url:function(){var a=u(this.collection,"url")||u(this,"urlRoot")||v();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){if(this._changing||!this.hasChanged())return this;this._changing=!0,this._moreChanges=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],a);while(this._moreChanges)this._moreChanges=!1,this.trigger("change",this,a);return this._previousAttributes=f.clone(this.attributes),delete this._changed,this._changing=!1,this},hasChanged:function(a){return arguments.length?this._changed&&f.has(this._changed,a):!f.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this._changed):!1;var b,c=!1,d=this._previousAttributes;for(var e in a){if(f.isEqual(d[e],b=a[e]))continue;(c||(c={}))[e]=b}return c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validate(a,b);return c?(b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),e.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})},f.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,e,g,h,i,j,k={},l={};b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,g=a.length;c<g;c++){if(!(h=a[c]=this._prepareModel(a[c],b)))throw new Error("Can't add an invalid model to a collection");if(k[i=h.cid]||this._byCid[i]||(j=h.id)!=null&&(l[j]||this._byId[j]))throw new Error("Can't add the same model to a collection twice");k[i]=l[j]=h}for(c=0;c<g;c++)(h=a[c]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id!=null&&(this._byId[h.id]=h);this.length+=g,e=b.at!=null?b.at:this.models.length,d.apply(this.models,[e,0].concat(a)),this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,g=this.models.length;c<g;c++){if(!k[(h=this.models[c]).cid])continue;b.index=c,h.trigger("add",h,this,b)}return this},remove:function(a,b){var c,d,e,g;b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){g=this.getByCid(a[c])||this.get(a[c]);if(!g)continue;delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g)}return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]),b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return this._reset(),this.add(a,{silent:!0,parse:b.parse}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?f.clone(a):{},a.parse===undefined&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(e,f,g){b.wait&&c.add(e,b),d?d(e,f):e.trigger("sync",a,f,b)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return f(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model)a.collection||(a.collection=this);else{var c=a;b.collection=this,a=new this.model(c,b),a._validate(a.attributes,b)||(a=!1)}return a},_removeReference:function(a){this==a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if((a=="add"||a=="remove")&&c!=this)return;a=="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments)}});var h=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];f.each(h,function(a){e.Collection.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}}),e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var i=/:\w+/g,j=/\*\w+/g,k=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(a,b,c){return e.history||(e.history=new e.History),f.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),e.history.route(a,f.bind(function(d){var f=this._extractParameters(a,d);c&&c.apply(this,f),this.trigger.apply(this,["route:"+b].concat(f)),e.history.trigger("route",this,b,f)},this)),this},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(k,"\\$&").replace(i,"([^/]+)").replace(j,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),e.History=function(){this.handlers=[],f.bindAll(this,"checkUrl")};var l=/^[#\/]/,m=/msie [\w.]+/,n=!1;f.extend(e.History.prototype,e.Events,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a.replace(l,"")},start:function(a){if(n)throw new Error("Backbone.history has already been started");this.options=f.extend({},{root:"/"},this.options,a),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),c=document.documentMode,d=m.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);d&&(this.iframe=g('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?g(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!d?g(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b,n=!0;var e=window.location,h=e.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&e.hash&&(this.fragment=e.hash.replace(l,""),window.history.replaceState({},document.title,e.protocol+"//"+e.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){g(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),n=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){if(!n)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(l,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;this._hasPushState?(c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}}),e.View=function(a){this.cid=f.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var o=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName"];f.extend(e.View.prototype,e.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,b,c){var d=document.createElement(a);return b&&g(d).attr(b),c&&g(d).html(c),d},setElement:function(a,b){return this.$el=g(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=u(this,"events")))return;this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw new Error('Event "'+a[b]+'" does not exist');var d=b.match(o),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,g===""?this.$el.bind(e,c):this.$el.delegate(g,e,c)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(!this.el){var a=u(this,"attributes")||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.setElement(this.make(this.tagName,a),!1)}else this.setElement(this.el,!1)}});var q=function(a,b){var c=t(this,a,b);return c.extend=this.extend,c};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=q;var r={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(a,b,c){var d=r[a],h={type:d,dataType:"json"};return c.url||(h.url=u(b,"url")||v()),!c.data&&b&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(b.toJSON())),e.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),e.emulateHTTP&&(d==="PUT"||d==="DELETE")&&(e.emulateJSON&&(h.data._method=d),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)}),h.type!=="GET"&&!e.emulateJSON&&(h.processData=!1),g.ajax(f.extend(h,c))},e.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d,a?a(b,e,c):b.trigger("error",b,e,c)}};var s=function(){},t=function(a,b,c){var d;return b&&b.hasOwnProperty("constructor")?d=b.constructor:d=function(){a.apply(this,arguments)},f.extend(d,a),s.prototype=a.prototype,d.prototype=new s,b&&f.extend(d.prototype,b),c&&f.extend(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d},u=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},v=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("web/js/lib/backbone.js",function(){}),function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();return"area"===e?(c=b.parentNode,e=c.name,!b.href||!e||c.nodeName.toLowerCase()!=="map"?!1:(b=a("img[usemap=#"+e+"]")[0],!!b&&d(b))):(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{},a.ui.version||(a.extend(a.ui,{version:"1.8.14",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return b=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){c=a(this[0]);for(var d;c.length&&c[0]!==document;){d=c.css("position");if(d==="absolute"||d==="relative"||d==="fixed"){d=parseInt(c.css("zIndex"),10);if(!isNaN(d)&&d!==0)return d}c=c.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var f=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){b=a.ui[b].prototype;for(var e in d)b.plugins[e]=b.plugins[e]||[],b.plugins[e].push([c,d[e]])},call:function(a,b,c){if((b=a.plugins[b])&&a.element[0].parentNode)for(var d=0;d<b.length;d++)a.options[b[d][0]]&&b[d][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;c=c&&c==="left"?"scrollLeft":"scrollTop";var d=!1;return b[c]>0?!0:(b[c]=1,d=b[c]>0,b[c]=0,d)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}}))}(jQuery),function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)a(e).triggerHandler("remove");c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){return c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")}),d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)},c=new c,c.options=a.extend(!0,{},c.options),a[e][b].prototype=a.extend(!0,c,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;return e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e,f&&e.charAt(0)==="_"?h:(f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b)return h=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))}),h)}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",b),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e=this.options[b];c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),d=d||{};if(c.originalEvent){b=a.event.props.length;for(var f;b;)f=a.event.props[--b],c[f]=c.originalEvent[f]}return this.element.trigger(c,d),!(a.isFunction(e)&&e.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}}(jQuery),function(a){var b=!1;a(document).mousedown(function(){b=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var e=this,f=c.which==1,g=typeof this.options.cancel=="string"?a(c.target).closest(this.options.cancel).length:!1;if(!f||g||!this._mouseCapture(c))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)){this._mouseStarted=this._mouseStart(c)!==!1;if(!this._mouseStarted)return c.preventDefault(),!0}return!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return e._mouseMove(a)},this._mouseUpDelegate=function(a){return e._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0}},_mouseMove:function(b){return!a.browser.msie||document.documentMode>=9||!!b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&((this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1)?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){a.ui=a.ui||{};var b=/left|center|right/,c=/top|center|bottom/,d=a.fn.position,e=a.fn.offset;a.fn.position=function(e){if(!e||!e.of)return d.apply(this,arguments);e=a.extend({},e);var f=a(e.of),g=f[0],h=(e.collision||"flip").split(" "),i=e.offset?e.offset.split(" "):[0,0],j,k,l;return g.nodeType===9?(j=f.width(),k=f.height(),l={top:0,left:0}):g.setTimeout?(j=f.width(),k=f.height(),l={top:f.scrollTop(),left:f.scrollLeft()}):g.preventDefault?(e.at="left top",j=k=0,l={top:e.of.pageY,left:e.of.pageX}):(j=f.outerWidth(),k=f.outerHeight(),l=f.offset()),a.each(["my","at"],function(){var a=(e[this]||"").split(" ");a.length===1&&(a=b.test(a[0])?a.concat(["center"]):c.test(a[0])?["center"].concat(a):["center","center"]),a[0]=b.test(a[0])?a[0]:"center",a[1]=c.test(a[1])?a[1]:"center",e[this]=a}),h.length===1&&(h[1]=h[0]),i[0]=parseInt(i[0],10)||0,i.length===1&&(i[1]=i[0]),i[1]=parseInt(i[1],10)||0,e.at[0]==="right"?l.left+=j:e.at[0]==="center"&&(l.left+=j/2),e.at[1]==="bottom"?l.top+=k:e.at[1]==="center"&&(l.top+=k/2),l.left+=i[0],l.top+=i[1],this.each(function(){var b=a(this),c=b.outerWidth(),d=b.outerHeight(),f=parseInt(a.curCSS(this,"marginLeft",!0))||0,g=parseInt(a.curCSS(this,"marginTop",!0))||0,m=c+f+(parseInt(a.curCSS(this,"marginRight",!0))||0),n=d+g+(parseInt(a.curCSS(this,"marginBottom",!0))||0),o=a.extend({},l),p;e.my[0]==="right"?o.left-=c:e.my[0]==="center"&&(o.left-=c/2),e.my[1]==="bottom"?o.top-=d:e.my[1]==="center"&&(o.top-=d/2),o.left=Math.round(o.left),o.top=Math.round(o.top),p={left:o.left-f,top:o.top-g},a.each(["left","top"],function(b,f){a.ui.position[h[b]]&&a.ui.position[h[b]][f](o,{targetWidth:j,targetHeight:k,elemWidth:c,elemHeight:d,collisionPosition:p,collisionWidth:m,collisionHeight:n,offset:i,my:e.my,at:e.at})}),a.fn.bgiframe&&b.bgiframe(),b.offset(a.extend(o,{using:e.using}))})},a.ui.position={fit:{left:function(b,c){var d=a(window);d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),b.left=d>0?b.left-d:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window);d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),b.top=d>0?b.top-d:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]!=="center"){var d=a(window);d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();var e=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,f=c.at[0]==="left"?c.targetWidth:-c.targetWidth,g=-2*c.offset[0];b.left+=c.collisionPosition.left<0?e+f+g:d>0?e+f+g:0}},top:function(b,c){if(c.at[1]!=="center"){var d=a(window);d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();var e=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,f=c.at[1]==="top"?c.targetHeight:-c.targetHeight,g=-2*c.offset[1];b.top+=c.collisionPosition.top<0?e+f+g:d>0?e+f+g:0}}}},a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),f=parseInt(a.curCSS(b,"top",!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0;e={top:c.top-e.top+f,left:c.left-e.left+g},"using"in c?c.using.call(b,e):d.css(e)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?this.each(function(){a.offset.setOffset(this,b)}):e.call(this)})}(jQuery),function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");if(!c){c=this._uiHash();if(this._trigger("drag",b,c)===!1)return this._mouseUp({}),!1;this.position=c.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var e=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){e._trigger("stop",b)!==!1&&e._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){return this.options.iframeFix===!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)}),c},_createHelper:function(b){var c=this.options;return b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element,b.parents("body").length||b.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute"),b},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[b.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){b=a(b.containment);var c=b[0];if(c){b.offset();var e=a(c).css("overflow")!="hidden";this.containment=[(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0),(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0),(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=b}}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position),b=b=="absolute"?1:-1;var e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop())*b),left:c.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*b)}},_generatePosition:function(b){var c=this.options,e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName),g=b.pageX,h=b.pageY;if(this.originalPosition){var i;this.containment&&(this.relative_container?(i=this.relative_container.offset(),i=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):i=this.containment,b.pageX-this.offset.click.left<i[0]&&(g=i[0]+this.offset.click.left),b.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),b.pageX-this.offset.click.left>i[2]&&(g=i[2]+this.offset.click.left),b.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),c.grid&&(h=c.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY,h=i?h-this.offset.click.top<i[1]||h-this.offset.click.top>i[3]?h-this.offset.click.top<i[1]?h+c.grid[1]:h-c.grid[1]:h:h,g=c.grid[0]?this.originalPageX+Math.round((g-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX,g=i?g-this.offset.click.left<i[0]||g-this.offset.click.left>i[2]?g-this.offset.click.left<i[0]?g+c.grid[0]:g-c.grid[0]:g:g)}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop()),left:g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,e){return e=e||this._uiHash(),a.ui.plugin.call(this,b,[c,e]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,e)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"1.8.14"}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var e=a(this).data("draggable"),f=e.options,g=a.extend({},c,{item:e.element});e.sortables=[],a(f.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(e.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,g))})},stop:function(b,c){var e=a(this).data("draggable"),f=a.extend({},c,{item:e.element});a.each(e.sortables,function(){this.instance.isOver?(this.instance.isOver=0,e.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,e.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,f))})},drag:function(b,c){var e=a(this).data("draggable"),f=this;a.each(e.sortables,function(){this.instance.positionAbs=e.positionAbs,this.instance.helperProportions=e.helperProportions,this.instance.offset.click=e.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(f).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=e.offset.click.top,this.instance.offset.click.left=e.offset.click.left,this.instance.offset.parent.left-=e.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=e.offset.parent.top-this.instance.offset.parent.top,e._trigger("toSortable",b),e.dropped=this.instance.element,e.currentItem=e.element,this.instance.fromOutside=e),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),e._trigger("fromSortable",b),e.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){b=a(c.helper),c=a(this).data("draggable").options,b.css("opacity")&&(c._opacity=b.css("opacity")),b.css("opacity",c.opacity)},stop:function(b,c){b=a(this).data("draggable").options,b._opacity&&a(c.helper).css("opacity",b._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("draggable"),e=c.options,f=!1;if(c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x")c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?c.scrollParent[0].scrollTop=f=c.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-c.overflowOffset.top<e.scrollSensitivity&&(c.scrollParent[0].scrollTop=f=c.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?c.scrollParent[0].scrollLeft=f=c.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-c.overflowOffset.left<e.scrollSensitivity&&(c.scrollParent[0].scrollLeft=f=c.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var c=a(this),e=c.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:e.top,left:e.left})})},drag:function(b,c){for(var e=a(this).data("draggable"),f=e.options,g=f.snapTolerance,h=c.offset.left,i=h+e.helperProportions.width,j=c.offset.top,k=j+e.helperProportions.height,l=e.snapElements.length-1;l>=0;l--){var m=e.snapElements[l].left,n=m+e.snapElements[l].width,o=e.snapElements[l].top,p=o+e.snapElements[l].height;if(m-g<h&&h<n+g&&o-g<j&&j<p+g||m-g<h&&h<n+g&&o-g<k&&k<p+g||m-g<i&&i<n+g&&o-g<j&&j<p+g||m-g<i&&i<n+g&&o-g<k&&k<p+g){if(f.snapMode!="inner"){var q=Math.abs(o-k)<=g,r=Math.abs(p-j)<=g,s=Math.abs(m-i)<=g,t=Math.abs(n-h)<=g;q&&(c.position.top=e._convertPositionTo("relative",{top:o-e.helperProportions.height,left:0}).top-e.margins.top),r&&(c.position.top=e._convertPositionTo("relative",{top:p,left:0}).top-e.margins.top),s&&(c.position.left=e._convertPositionTo("relative",{top:0,left:m-e.helperProportions.width}).left-e.margins.left),t&&(c.position.left=e._convertPositionTo("relative",{top:0,left:n}).left-e.margins.left)}var u=q||r||s||t;f.snapMode!="outer"&&(q=Math.abs(o-j)<=g,r=Math.abs(p-k)<=g,s=Math.abs(m-h)<=g,t=Math.abs(n-i)<=g,q&&(c.position.top=e._convertPositionTo("relative",{top:o,left:0}).top-e.margins.top),r&&(c.position.top=e._convertPositionTo("relative",{top:p-e.helperProportions.height,left:0}).top-e.margins.top),s&&(c.position.left=e._convertPositionTo("relative",{top:0,left:m}).left-e.margins.left),t&&(c.position.left=e._convertPositionTo("relative",{top:0,left:n-e.helperProportions.width}).left-e.margins.left)),!e.snapElements[l].snapping&&(q||r||s||t||u)&&e.options.snap.snap&&e.options.snap.snap.call(e.element,b,a.extend(e._uiHash(),{snapItem:e.snapElements[l].item})),e.snapElements[l].snapping=q||r||s||t||u}else e.snapElements[l].snapping&&e.options.snap.release&&e.options.snap.release.call(e.element,b,a.extend(e._uiHash(),{snapItem:e.snapElements[l].item})),e.snapElements[l].snapping=!1}}}),a.ui.plugin.add("draggable","stack",{start:function(){var b=a(this).data("draggable").options;b=a.makeArray(a(b.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(b.length){var c=parseInt(b[0].style.zIndex)||0;a(b).each(function(a){this.style.zIndex=c+a}),this[0].style.zIndex=c+b.length}}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){b=a(c.helper),c=a(this).data("draggable").options,b.css("zIndex")&&(c._zIndex=b.css("zIndex")),b.css("zIndex",c.zIndex)},stop:function(b,c){b=a(this).data("draggable").options,b._zIndex&&a(c.helper).css("zIndex",b._zIndex)}})}(jQuery),function(a){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0,this.isout=1,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var b=a.ui.ddmanager.droppables[this.options.scope],c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(b,c){b=="accept"&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;!!c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;!!c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var e=c||a.ui.ddmanager.current;if(!e||(e.currentItem||e.element)[0]==this.element[0])return!1;var f=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==e.options.scope&&b.accept.call(b.element[0],e.currentItem||e.element)&&a.ui.intersect(e,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return f=!0,!1}),f?!1:this.accept.call(this.element[0],e.currentItem||e.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(e)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.extend(a.ui.droppable,{version:"1.8.14"}),a.ui.intersect=function(b,c,e){if(!c.offset)return!1;var f=(b.positionAbs||b.position.absolute).left,g=f+b.helperProportions.width,h=(b.positionAbs||b.position.absolute).top,i=h+b.helperProportions.height,j=c.offset.left,k=j+c.proportions.width,l=c.offset.top,m=l+c.proportions.height;switch(e){case"fit":return j<=f&&g<=k&&l<=h&&i<=m;case"intersect":return j<f+b.helperProportions.width/2&&g-b.helperProportions.width/2<k&&l<h+b.helperProportions.height/2&&i-b.helperProportions.height/2<m;case"pointer":return a.ui.isOver((b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,l,j,c.proportions.height,c.proportions.width);case"touch":return(h>=l&&h<=m||i>=l&&i<=m||h<l&&i>m)&&(f>=j&&f<=k||g>=j&&g<=k||f<j&&g>k);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var e=a.ui.ddmanager.droppables[b.options.scope]||[],f=c?c.type:null,g=(b.currentItem||b.element).find(":data(droppable)").andSelf(),h=0;a:for(;h<e.length;h++)if(!(e[h].options.disabled||b&&!e[h].accept.call(e[h].element[0],b.currentItem||b.element))){for(var i=0;i<g.length;i++)if(g[i]==e[h].element[0]){e[h].proportions.height=0;continue a}e[h].visible=e[h].element.css("display")!="none",e[h].visible&&(f=="mousedown"&&e[h]._activate.call(e[h],c),e[h].offset=e[h].element.offset(),e[h].proportions={width:e[h].element[0].offsetWidth,height:e[h].element[0].offsetHeight})}},drop:function(b,c){var e=!1;return a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(e=e||this._drop.call(this,c)),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c)))}),e},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var e=a.ui.intersect(b,this,this.options.tolerance);if(e=!e&&this.isover==1?"isout":e&&this.isover==0?"isover":null){var f;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(f=a.data(g[0],"droppable"),f.greedyChild=e=="isover"?1:0)}f&&e=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,c)),this[e]=1,this[e=="isout"?"isover":"isout"]=0,this[e=="isover"?"_over":"_out"].call(this,c),f&&e=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,c))}}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(jQuery),function(a){a.widget("ui.resizable",a.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var b=this,c=this.options;this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&a.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=c.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var d=this.handles.split(",");this.handles={};for(var f=0;f<d.length;f++){var g=a.trim(d[f]),h=a('<div class="ui-resizable-handle '+("ui-resizable-"+g)+'"></div>');/sw|se|ne|nw/.test(g)&&h.css({zIndex:++c.zIndex}),"se"==g&&h.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[g]=".ui-resizable-"+g,this.element.append(h)}}this._renderAxis=function(b){b=b||this.element;for(var c in this.handles){this.handles[c].constructor==String&&(this.handles[c]=a(this.handles[c],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var d=a(this.handles[c],this.element),f=0;f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),d=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(d,f),this._proportionallyResize()}a(this.handles[c])}},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=a&&a[1]?a[1]:"se"}}),c.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").hover(function(){c.disabled||(a(this).removeClass("ui-resizable-autohide"),b._handles.show())},function(){c.disabled||b.resizing||(a(this).addClass("ui-resizable-autohide"),b._handles.hide())})),this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var c=this.element;c.after(this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_mouseCapture:function(b){var c=!1;for(var d in this.handles)a(this.handles[d])[0]==b.target&&(c=!0);return!this.options.disabled&&c},_mouseStart:function(c){var d=this.options,f=this.element.position(),g=this.element;this.resizing=!0,this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()},(g.is(".ui-draggable")||/absolute/.test(g.css("position")))&&g.css({position:"absolute",top:f.top,left:f.left}),a.browser.opera&&/relative/.test(g.css("position"))&&g.css({position:"relative",top:"auto",left:"auto"}),this._renderProxy(),f=b(this.helper.css("left"));var h=b(this.helper.css("top"));return d.containment&&(f+=a(d.containment).scrollLeft()||0,h+=a(d.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:f,top:h},this.size=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.originalPosition={left:f,top:h},this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio=typeof d.aspectRatio=="number"?d.aspectRatio:this.originalSize.width/this.originalSize.height||1,d=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor",d=="auto"?this.axis+"-resize":d),g.addClass("ui-resizable-resizing"),this._propagate("start",c),!0},_mouseDrag:function(a){var b=this.helper,c=this.originalMousePosition,d=this._change[this.axis];if(!d)return!1;c=d.apply(this,[a,a.pageX-c.left||0,a.pageY-c.top||0]),this._updateVirtualBoundaries(a.shiftKey);if(this._aspectRatio||a.shiftKey)c=this._updateRatio(c,a);return c=this._respectSize(c,a),this._propagate("resize",a),b.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(c),this._trigger("resize",a,this.ui()),!1},_mouseStop:function(b){this.resizing=!1;var c=this.options,d=this;if(this._helper){var f=this._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName);f=g&&a.ui.hasScroll(f[0],"left")?0:d.sizeDiff.height,g=g?0:d.sizeDiff.width,g={width:d.helper.width()-g,height:d.helper.height()-f},f=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null;var h=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;c.animate||this.element.css(a.extend(g,{top:h,left:f})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()}return a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b=this.options,d,e,f;b={minWidth:c(b.minWidth)?b.minWidth:0,maxWidth:c(b.maxWidth)?b.maxWidth:Infinity,minHeight:c(b.minHeight)?b.minHeight:0,maxHeight:c(b.maxHeight)?b.maxHeight:Infinity};if(this._aspectRatio||a)a=b.minHeight*this.aspectRatio,e=b.minWidth/this.aspectRatio,d=b.maxHeight*this.aspectRatio,f=b.maxWidth/this.aspectRatio,a>b.minWidth&&(b.minWidth=a),e>b.minHeight&&(b.minHeight=e),d<b.maxWidth&&(b.maxWidth=d),f<b.maxHeight&&(b.maxHeight=f);this._vBoundaries=b},_updateCache:function(a){this.offset=this.helper.offset(),c(a.left)&&(this.position.left=a.left),c(a.top)&&(this.position.top=a.top),c(a.height)&&(this.size.height=a.height),c(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,d=this.size,e=this.axis;return c(a.height)?a.width=a.height*this.aspectRatio:c(a.width)&&(a.height=a.width/this.aspectRatio),e=="sw"&&(a.left=b.left+(d.width-a.width),a.top=null),e=="nw"&&(a.top=b.top+(d.height-a.height),a.left=b.left+(d.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,d=this.axis,e=c(a.width)&&b.maxWidth&&b.maxWidth<a.width,f=c(a.height)&&b.maxHeight&&b.maxHeight<a.height,g=c(a.width)&&b.minWidth&&b.minWidth>a.width,h=c(a.height)&&b.minHeight&&b.minHeight>a.height;g&&(a.width=b.minWidth),h&&(a.height=b.minHeight),e&&(a.width=b.maxWidth),f&&(a.height=b.maxHeight);var i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,l=/sw|nw|w/.test(d);return d=/nw|ne|n/.test(d),g&&l&&(a.left=i-b.minWidth),e&&l&&(a.left=i-b.maxWidth),h&&d&&(a.top=j-b.minHeight),f&&d&&(a.top=j-b.maxHeight),(b=!a.width&&!a.height)&&!a.left&&a.top?a.top=null:b&&!a.top&&a.left&&(a.left=null),a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,c=0;c<this._proportionallyResizeElements.length;c++){var d=this._proportionallyResizeElements[c];if(!this.borderDif){var f=[d.css("borderTopWidth"),d.css("borderRightWidth"),d.css("borderBottomWidth"),d.css("borderLeftWidth")],g=[d.css("paddingTop"),d.css("paddingRight"),d.css("paddingBottom"),d.css("paddingLeft")];this.borderDif=a.map(f,function(a,b){return a=parseInt(a,10)||0,b=parseInt(g[b],10)||0,a+b})}a.browser.msie&&(a(b).is(":hidden")||a(b).parents(":hidden").length)||d.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var c=a.browser.msie&&a.browser.version<7,d=c?1:0;c=c?2:-1,this.helper.addClass(this._helper).css({width:this.element.outerWidth()+c,height:this.element.outerHeight()+c,position:"absolute",left:this.elementOffset.left-d+"px",top:this.elementOffset.top-d+"px",zIndex:++b.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){return{left:this.originalPosition.left+b,width:this.originalSize.width-b}},n:function(a,b,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),b!="resize"&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.extend(a.ui.resizable,{version:"1.8.14"}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("resizable").options,c=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10),position:b.css("position")})})};typeof b.alsoResize=="object"&&!b.alsoResize.parentNode?b.alsoResize.length?(b.alsoResize=b.alsoResize[0],c(b.alsoResize)):a.each(b.alsoResize,function(a){c(a)}):c(b.alsoResize)},resize:function(b,c){var d=a(this).data("resizable");b=d.options;var f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,f){a(b).each(function(){var b=a(this),g=a(this).data("resizable-alsoresize"),i={},k=f&&f.length?f:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(k,function(a,b){(a=(g[b]||0)+(h[b]||0))&&a>=0&&(i[b]=a||null)}),a.browser.opera&&/relative/.test(b.css("position"))&&(d._revertToRelativePosition=!0,b.css({position:"absolute",top:"auto",left:"auto"})),b.css(i)})};typeof b.alsoResize=="object"&&!b.alsoResize.nodeType?a.each(b.alsoResize,function(a,b){i(a,b)}):i(b.alsoResize)},stop:function(){var b=a(this).data("resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.css({position:b.data("resizable-alsoresize").position})})};b._revertToRelativePosition&&(b._revertToRelativePosition=!1,typeof c.alsoResize=="object"&&!c.alsoResize.nodeType?a.each(c.alsoResize,function(a){d(a)}):d(c.alsoResize)),a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("resizable"),d=c.options,f=c._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName),h=g&&a.ui.hasScroll(f[0],"left")?0:c.sizeDiff.height;g={width:c.size.width-(g?0:c.sizeDiff.width),height:c.size.height-h},h=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null;var i=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(g,i&&h?{top:i,left:h}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};f&&f.length&&a(f[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var c=a(this).data("resizable"),d=c.element,f=c.options.containment;if(d=f instanceof a?f.get(0):/parent/.test(f)?d.parent().get(0):f){c.containerElement=a(d);if(/document/.test(f)||f==document)c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var g=a(d),h=[];a(["Top","Right","Left","Bottom"]).each(function(a,c){h[a]=b(g.css("padding"+c))}),c.containerOffset=g.offset(),c.containerPosition=g.position(),c.containerSize={height:g.innerHeight()-h[3],width:g.innerWidth()-h[1]},f=c.containerOffset;var i=c.containerSize.height,j=c.containerSize.width;j=a.ui.hasScroll(d,"left")?d.scrollWidth:j,i=a.ui.hasScroll(d)?d.scrollHeight:i,c.parentData={element:d,left:f.left,top:f.top,width:j,height:i}}}},resize:function(b){var c=a(this).data("resizable"),d=c.options,f=c.containerOffset,g=c.position;b=c._aspectRatio||b.shiftKey;var h={top:0,left:0},i=c.containerElement;i[0]!=document&&/static/.test(i.css("position"))&&(h=f),g.left<(c._helper?f.left:0)&&(c.size.width+=c._helper?c.position.left-f.left:c.position.left-h.left,b&&(c.size.height=c.size.width/d.aspectRatio),c.position.left=d.helper?f.left:0),g.top<(c._helper?f.top:0)&&(c.size.height+=c._helper?c.position.top-f.top:c.position.top,b&&(c.size.width=c.size.height*d.aspectRatio),c.position.top=c._helper?f.top:0),c.offset.left=c.parentData.left+c.position.left,c.offset.top=c.parentData.top+c.position.top,d=Math.abs((c._helper?c.offset.left-h.left:c.offset.left-h.left)+c.sizeDiff.width),f=Math.abs((c._helper?c.offset.top-h.top:c.offset.top-f.top)+c.sizeDiff.height),g=c.containerElement.get(0)==c.element.parent().get(0),h=/relative|absolute/.test(c.containerElement.css("position")),g&&h&&(d-=c.parentData.left),d+c.size.width>=c.parentData.width&&(c.size.width=c.parentData.width-d,b&&(c.size.height=c.size.width/c.aspectRatio)),f+c.size.height>=c.parentData.height&&(c.size.height=c.parentData.height-f,b&&(c.size.width=c.size.height*c.aspectRatio))},stop:function(){var b=a(this).data("resizable"),c=b.options,d=b.containerOffset,f=b.containerPosition,g=b.containerElement,h=a(b.helper),i=h.offset(),j=h.outerWidth()-b.sizeDiff.width;h=h.outerHeight()-b.sizeDiff.height,b._helper&&!c.animate&&/relative/.test(g.css("position"))&&a(this).css({left:i.left-f.left-d.left,width:j,height:h}),b._helper&&!c.animate&&/static/.test(g.css("position"))&&a(this).css({left:i.left-f.left-d.left,width:j,height:h})}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof c.ghost=="string"?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("resizable"),c=b.options,d=b.size,f=b.originalSize,g=b.originalPosition,h=b.axis;c.grid=typeof c.grid=="number"?[c.grid,c.grid]:c.grid;var i=Math.round((d.width-f.width)/(c.grid[0]||1))*(c.grid[0]||1);c=Math.round((d.height-f.height)/(c.grid[1]||1))*(c.grid[1]||1),/^(se|s|e)$/.test(h)?(b.size.width=f.width+i,b.size.height=f.height+c):/^(ne)$/.test(h)?(b.size.width=f.width+i,b.size.height=f.height+c,b.position.top=g.top-c):(/^(sw)$/.test(h)?(b.size.width=f.width+i,b.size.height=f.height+c):(b.size.width=f.width+i,b.size.height=f.height+c,b.position.top=g.top-c),b.position.left=g.left-i)}});var b=function(a){return parseInt(a,10)||0},c=function(a){return!isNaN(parseInt(a,10))}}(jQuery),function(a){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable"),this.dragged=!1;var c;this.refresh=function(){c=a(b.options.filter,b.element[0]),c.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=c.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){return this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"),this._mouseDestroy(),this},_mouseStart:function(b){var c=this;this.opos=[b.pageX,b.pageY];if(!this.options.disabled){var d=this.options;this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,b.metaKey||(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().andSelf().each(function(){var d=a.data(this,"selectable-item");if(d){var g=!b.metaKey||!d.$element.hasClass("ui-selected");return d.$element.removeClass(g?"ui-unselecting":"ui-selected").addClass(g?"ui-selecting":"ui-unselecting"),d.unselecting=!g,d.selecting=g,(d.selected=g)?c._trigger("selecting",b,{selecting:d.element}):c._trigger("unselecting",b,{unselecting:d.element}),!1}})}},_mouseDrag:function(b){var c=this;this.dragged=!0;if(!this.options.disabled){var d=this.options,f=this.opos[0],g=this.opos[1],h=b.pageX,i=b.pageY;if(f>h){var j=h;h=f,f=j}return g>i&&(j=i,i=g,g=j),this.helper.css({left:f,top:g,width:h-f,height:i-g}),this.selectees.each(function(){var j=a.data(this,"selectable-item");if(!!j&&j.element!=c.element[0]){var k=!1;d.tolerance=="touch"?k=!(j.left>h||j.right<f||j.top>i||j.bottom<g):d.tolerance=="fit"&&(k=j.left>f&&j.right<h&&j.top>g&&j.bottom<i),k?(j.selected&&(j.$element.removeClass("ui-selected"),j.selected=!1),j.unselecting&&(j.$element.removeClass("ui-unselecting"),j.unselecting=!1),j.selecting||(j.$element.addClass("ui-selecting"),j.selecting=!0,c._trigger("selecting",b,{selecting:j.element}))):(j.selecting&&(b.metaKey&&j.startselected?(j.$element.removeClass("ui-selecting"),j.selecting=!1,j.$element.addClass("ui-selected"),j.selected=!0):(j.$element.removeClass("ui-selecting"),j.selecting=!1,j.startselected&&(j.$element.addClass("ui-unselecting"),j.unselecting=!0),c._trigger("unselecting",b,{unselecting:j.element}))),j.selected&&!b.metaKey&&!j.startselected&&(j.$element.removeClass("ui-selected"),j.selected=!1,j.$element.addClass("ui-unselecting"),j.unselecting=!0,c._trigger("unselecting",b,{unselecting:j.element})))}}),!1}},_mouseStop:function(b){var c=this;return this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}}),a.extend(a.ui.selectable,{version:"1.8.14"})}(jQuery),function(a){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData("sortable-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var e=null,f=this;a(b.target).parents().each(function(){if(a.data(this,"sortable-item")==f)return e=a(this),!1}),a.data(b.target,"sortable-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var g=!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==b.target&&(g=!0)});if(!g)return!1}return this.currentItem=e,this._removeCurrentsFromItems(),!0},_mouseStart:function(b,c,e){c=this.options;var f=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),c.containment&&this._setContainment(),c.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",c.cursor)),c.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",c.opacity)),c.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",c.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!e)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,f._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,e=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))),e!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(c=this.items.length-1;c>=0;c--){e=this.items[c];var f=e.item[0],g=this._intersectsWithPointer(e);if(g&&f!=this.currentItem[0]&&this.placeholder[g==1?"next":"prev"]()[0]!=f&&!a.ui.contains(this.placeholder[0],f)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],f):!0)){this.direction=g==1?"down":"up";if(this.options.tolerance!="pointer"&&!this._intersectsWithSides(e))break;this._rearrange(b,e),this._trigger("change",b,this._uiHash());break}}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var e=this;c=e.placeholder.offset(),e.reverting=!0,a(this.helper).animate({left:c.left-this.offset.parent.left-e.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:c.top-this.offset.parent.top-e.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){e._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){var b=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("deactivate",null,b._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,b._uiHash(this)),this.containers[c].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),e=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&e.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!e.length&&b.key&&e.push(b.key+"="),e.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),e=[];return b=b||{},c.each(function(){e.push(a(b.item||this).attr(b.attribute||"id")||"")}),e},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left;return j=d+j>h&&d+j<i&&b+k>f&&b+k<g,this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?j:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height);b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),c=c&&b,b=this._getDragVerticalDirection();var e=this._getDragHorizontalDirection();return c?this.floating?e&&e=="right"||b=="down"?2:1:b&&(b=="down"?2:1):!1},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height);b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width);var e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&b||f=="left"&&!b:e&&(e=="down"&&c||e=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=[],e=[],f=this._connectWith();if(f&&b)for(b=f.length-1;b>=0;b--)for(var g=a(f[b]),h=g.length-1;h>=0;h--){var i=a.data(g[h],"sortable");i&&i!=this&&!i.options.disabled&&e.push([a.isFunction(i.options.items)?i.options.items.call(i.element):a(i.options.items,i.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),i])}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=e.length-1;b>=0;b--)e[b][0].each(function(){c.push(this)});return a(c)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data(sortable-item)"),b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(b){this.items=[],this.containers=[this];var c=this.items,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],f=this._connectWith();if(f)for(var g=f.length-1;g>=0;g--)for(var h=a(f[g]),i=h.length-1;i>=0;i--){var j=a.data(h[i],"sortable");j&&j!=this&&!j.options.disabled&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}for(g=e.length-1;g>=0;g--){b=e[g][1],f=e[g][0],i=0;for(h=f.length;i<h;i++)j=a(f[i]),j.data("sortable-item",b),c.push({item:j,instance:b,width:0,height:0,left:0,top:0})}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;c>=0;c--){var e=this.items[c];if(e.instance==this.currentContainer||!this.currentContainer||e.item[0]==this.currentItem[0]){var f=this.options.toleranceElement?a(this.options.toleranceElement,e.item):e.item;b||(e.width=f.outerWidth(),e.height=f.outerHeight()),f=f.offset(),e.left=f.left,e.top=f.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){var c=b||this,e=c.options;if(!e.placeholder||e.placeholder.constructor==String){var f=e.placeholder;e.placeholder={element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(f||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return f||(b.style.visibility="hidden"),b},update:function(a,b){if(!f||!!e.forcePlaceholderSize)b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(e.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),e.placeholder.update(c,c.placeholder)},_contactContainers:function(b){for(var c=null,e=null,f=this.containers.length-1;f>=0;f--)if(!a.ui.contains(this.currentItem[0],this.containers[f].element[0]))if(this._intersectsWith(this.containers[f].containerCache)){if(!c||!a.ui.contains(this.containers[f].element[0],c.element[0]))c=this.containers[f],e=f}else this.containers[f].containerCache.over&&(this.containers[f]._trigger("out",b,this._uiHash(this)),this.containers[f].containerCache.over=0);if(c)if(this.containers.length===1)this.containers[e]._trigger("over",b,this._uiHash(this)),this.containers[e].containerCache.over=1;else if(this.currentContainer!=this.containers[e]){c=1e4,f=null;for(var g=this.positionAbs[this.containers[e].floating?"left":"top"],h=this.items.length-1;h>=0;h--)if(a.ui.contains(this.containers[e].element[0],this.items[h].item[0])){var i=this.items[h][this.containers[e].floating?"left":"top"];Math.abs(i-g)<c&&(c=Math.abs(i-g),f=this.items[h])}if(f||this.options.dropOnEmpty)this.currentContainer=this.containers[e],f?this._rearrange(b,f,null,!0):this._rearrange(b,null,this.containers[e].element,!0),this._trigger("change",b,this._uiHash()),this.containers[e]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[e]._trigger("over",b,this._uiHash(this)),this.containers[e].containerCache.over=1}},_createHelper:function(b){var c=this.options;return b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem,b.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]),b[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(b[0].style.width==""||c.forceHelperSize)&&b.width(this.currentItem.width()),(b[0].style.height==""||c.forceHelperSize)&&b.height(this.currentItem.height()),b},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0];b=a(b.containment).offset();var e=a(c).css("overflow")!="hidden";this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position),b=b=="absolute"?1:-1;var e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop())*b),left:c.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*b)}},_generatePosition:function(b){var c=this.options,e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var g=b.pageX,h=b.pageY;return this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(g=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(h=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(g=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(h=this.containment[3]+this.offset.click.top)),c.grid&&(h=this.originalPageY+Math.round((h-this.originalPageY)/c.grid[1])*c.grid[1],h=this.containment?h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3]?h-this.offset.click.top<this.containment[1]?h+c.grid[1]:h-c.grid[1]:h:h,g=this.originalPageX+Math.round((g-this.originalPageX)/c.grid[0])*c.grid[0],g=this.containment?g-this.offset.click.left<this.containment[0]||g-this.offset.click.left>this.containment[2]?g-this.offset.click.left<this.containment[0]?g+c.grid[0]:g-c.grid[0]:g:g)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop()),left:g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)},_clear:function(b,c){this.reverting=!1;var e=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS)if(this._storedCSS[f]=="auto"||this._storedCSS[f]=="static")this._storedCSS[f]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&e.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){c||e.push(function(a){this._trigger("remove",a,this._uiHash())});for(f=this.containers.length-1;f>=0;f--)a.ui.contains(this.containers[f].element[0],this.currentItem[0])&&!c&&(e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[f])),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[f])))}for(f=this.containers.length-1;f>=0;f--)c||e.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over&&(e.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(f=0;f<e.length;f++)e[f].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!c){for(f=0;f<e.length;f++)e[f].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.extend(a.ui.sortable,{version:"1.8.14"})}(jQuery),function(a){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:!0,clearStyle:!1,collapsible:!1,event:"click",fillSpace:!1,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var b=this,d=b.options;b.running=0,b.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix"),b.headers=b.element.find(d.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){d.disabled||a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){d.disabled||a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){d.disabled||a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){d.disabled||a(this).removeClass("ui-state-focus")}),b.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(d.navigation){var e=b.element.find("a").filter(d.navigationFilter).eq(0);if(e.length){var f=e.closest(".ui-accordion-header");b.active=f.length?f:e.closest(".ui-accordion-content").prev()}}b.active=b._findActive(b.active||d.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top"),b.active.next().addClass("ui-accordion-content-active"),b._createIcons(),b.resize(),b.element.attr("role","tablist"),b.headers.attr("role","tab").bind("keydown.accordion",function(a){return b._keydown(a)}).next().attr("role","tabpanel"),b.headers.not(b.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide(),b.active.length?b.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):b.headers.eq(0).attr("tabIndex",0),a.browser.safari||b.headers.find("a").attr("tabIndex",-1),d.event&&b.headers.bind(d.event.split(" ").join(".accordion ")+".accordion",function(a){b._clickHandler.call(b,a,this),a.preventDefault()})},_createIcons:function(){var b=this.options;b.icons&&(a("<span></span>").addClass("ui-icon "+b.icons.header).prependTo(this.headers),this.active.children(".ui-icon").toggleClass(b.icons.header).toggleClass(b.icons.headerSelected),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-icon").remove(),this.element.removeClass("ui-accordion-icons")},destroy:function(){var b=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex"),this.headers.find("a").removeAttr("tabIndex"),this._destroyIcons();var d=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");return(b.autoHeight||b.fillHeight)&&d.css("height",""),a.Widget.prototype.destroy.call(this)},_setOption:function(b,d){a.Widget.prototype._setOption.apply(this,arguments),b=="active"&&this.activate(d),b=="icons"&&(this._destroyIcons(),d&&this._createIcons()),b=="disabled"&&this.headers.add(this.headers.next())[d?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(b){if(!(this.options.disabled||b.altKey||b.ctrlKey)){var d=a.ui.keyCode,e=this.headers.length,f=this.headers.index(b.target),g=!1;switch(b.keyCode){case d.RIGHT:case d.DOWN:g=this.headers[(f+1)%e];break;case d.LEFT:case d.UP:g=this.headers[(f-1+e)%e];break;case d.SPACE:case d.ENTER:this._clickHandler({target:b.target},b.target),b.preventDefault()}return g?(a(b.target).attr("tabIndex",-1),a(g).attr("tabIndex",0),g.focus(),!1):!0}},resize:function(){var b=this.options,d;if(b.fillSpace){if(a.browser.msie){var e=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}d=this.element.parent().height(),a.browser.msie&&this.element.parent().css("overflow",e),this.headers.each(function(){d-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,d-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else b.autoHeight&&(d=0,this.headers.next().each(function(){d=Math.max(d,a(this).height("").height())}).height(d));return this},activate:function(a){return this.options.active=a,a=this._findActive(a)[0],this._clickHandler({target:a},a),this},_findActive:function(b){return b?typeof b=="number"?this.headers.filter(":eq("+b+")"):this.headers.not(this.headers.not(b)):b===!1?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(b,d){var e=this.options;if(!e.disabled)if(b.target){b=a(b.currentTarget||d),d=b[0]===this.active[0],e.active=e.collapsible&&d?!1:this.headers.index(b);if(!(this.running||!e.collapsible&&d)){var f=this.active;j=b.next(),h=this.active.next(),i={options:e,newHeader:d&&e.collapsible?a([]):b,oldHeader:this.active,newContent:d&&e.collapsible?a([]):j,oldContent:h};var g=this.headers.index(this.active[0])>this.headers.index(b[0]);this.active=d?a([]):b,this._toggle(j,h,i,d,g),f.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(e.icons.headerSelected).addClass(e.icons.header),d||(b.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(e.icons.header).addClass(e.icons.headerSelected),b.next().addClass("ui-accordion-content-active"))}}else if(e.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(e.icons.headerSelected).addClass(e.icons.header),this.active.next().addClass("ui-accordion-content-active");var h=this.active.next(),i={options:e,newHeader:a([]),oldHeader:e.active,newContent:a([]),oldContent:h},j=this.active=a([]);this._toggle(j,h,i)}},_toggle:function(b,d,e,f,g){var h=this,i=h.options;h.toShow=b,h.toHide=d,h.data=e;var j=function(){if(h)return h._completed.apply(h,arguments)};h._trigger("changestart",null,h.data),h.running=d.size()===0?b.size():d.size();if(i.animated){e={},e=i.collapsible&&f?{toShow:a([]),toHide:d,complete:j,down:g,autoHeight:i.autoHeight||i.fillSpace}:{toShow:b,toHide:d,complete:j,down:g,autoHeight:i.autoHeight||i.fillSpace},i.proxied||(i.proxied=i.animated),i.proxiedDuration||(i.proxiedDuration=i.duration),i.animated=a.isFunction(i.proxied)?i.proxied(e):i.proxied,i.duration=a.isFunction(i.proxiedDuration)?i.proxiedDuration(e):i.proxiedDuration,f=a.ui.accordion.animations;var k=i.duration,l=i.animated;l&&!f[l]&&!a.easing[l]&&(l="slide"),f[l]||(f[l]=function(a){this.slide(a,{easing:l,duration:k||700})}),f[l](e)}else i.collapsible&&f?b.toggle():(d.hide(),b.show()),j(!0);d.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur(),b.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running,this.running||(this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""}),this.toHide.removeClass("ui-accordion-content-active"),this.toHide.length&&(this.toHide.parent()[0].className=this.toHide.parent()[0].className),this._trigger("change",null,this.data))}}),a.extend(a.ui.accordion,{version:"1.8.14",animations:{slide:function(b,d){b=a.extend({easing:"swing",duration:300},b,d);if(b.toHide.size())if(b.toShow.size()){var e=b.toShow.css("overflow"),f=0,g={},h={},i;d=b.toShow,i=d[0].style.width,d.width(parseInt(d.parent().width(),10)-parseInt(d.css("paddingLeft"),10)-parseInt(d.css("paddingRight"),10)-(parseInt(d.css("borderLeftWidth"),10)||0)-(parseInt(d.css("borderRightWidth"),10)||0)),a.each(["height","paddingTop","paddingBottom"],function(d,e){h[e]="hide",d=(""+a.css(b.toShow[0],e)).match(/^([\d+-.]+)(.*)$/),g[e]={value:d[1],unit:d[2]||"px"}}),b.toShow.css({height:0,overflow:"hidden"}).show(),b.toHide.filter(":hidden").each(b.complete).end().filter(":visible").animate(h,{step:function(a,c){c.prop=="height"&&(f=c.end-c.start===0?0:(c.now-c.start)/(c.end-c.start)),b.toShow[0].style[c.prop]=f*g[c.prop].value+g[c.prop].unit},duration:b.duration,easing:b.easing,complete:function(){b.autoHeight||b.toShow.css("height",""),b.toShow.css({width:i,overflow:e}),b.complete()}})}else b.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},b);else b.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},b)},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1e3:200})}}})}(jQuery),function(a){var b=0;a.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var b=this,c=this.element[0].ownerDocument,e;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!b.options.disabled&&!b.element.attr("readonly")){e=!1;var f=a.ui.keyCode;switch(c.keyCode){case f.PAGE_UP:b._move("previousPage",c);break;case f.PAGE_DOWN:b._move("nextPage",c);break;case f.UP:b._move("previous",c),c.preventDefault();break;case f.DOWN:b._move("next",c),c.preventDefault();break;case f.ENTER:case f.NUMPAD_ENTER:b.menu.active&&(e=!0,c.preventDefault());case f.TAB:if(!b.menu.active)return;b.menu.select(c);break;case f.ESCAPE:b.element.val(b.term),b.close(c);break;default:clearTimeout(b.searching),b.searching=setTimeout(function(){b.term!=b.element.val()&&(b.selectedItem=null,b.search(null,c))},b.options.delay)}}}).bind("keypress.autocomplete",function(a){e&&(e=!1,a.preventDefault())}).bind("focus.autocomplete",function(){b.options.disabled||(b.selectedItem=null,b.previous=b.element.val())}).bind("blur.autocomplete",function(a){b.options.disabled||(clearTimeout(b.searching),b.closing=setTimeout(function(){b.close(a),b._change(a)},150))}),this._initSource(),this.response=function(){return b._response.apply(b,arguments)},this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",c)[0]).mousedown(function(c){var e=b.menu.element[0];a(c.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==b.element[0]&&c.target!==e&&!a.ui.contains(e,c.target)&&b.close()})},1),setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,c){c=c.item.data("item.autocomplete"),!1!==b._trigger("focus",a,{item:c})&&/^key/.test(a.originalEvent.type)&&b.element.val(c.value)},selected:function(a,d){var e=d.item.data("item.autocomplete"),f=b.previous;b.element[0]!==c.activeElement&&(b.element.focus(),b.previous=f,setTimeout(function(){b.previous=f,b.selectedItem=e},1)),!1!==b._trigger("select",a,{item:e})&&b.element.val(e.value),b.term=b.element.val(),b.close(a),b.selectedItem=e},blur:function(){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="source"&&this._initSource(),b==="appendTo"&&this.menu.element.appendTo(a(c||"body",this.element[0].ownerDocument)[0]),b==="disabled"&&c&&this.xhr&&this.xhr.abort()},_initSource:function(){var c=this,f,g;a.isArray(this.options.source)?(f=this.options.source,this.source=function(b,c){c(a.ui.autocomplete.filter(f,b.term))}):typeof this.options.source=="string"?(g=this.options.source,this.source=function(f,h){c.xhr&&c.xhr.abort(),c.xhr=a.ajax({url:g,data:f,dataType:"json",autocompleteRequest:++b,success:function(a){this.autocompleteRequest===b&&h(a)},error:function(){this.autocompleteRequest===b&&h([])}})}):this.source=this.options.source},search:function(a,b){a=a!=null?a:this.element.val(),this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)!==!1)return this._search(a)},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.source({term:a},this.response)},_response:function(a){!this.options.disabled&&a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):this.close(),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b=="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b),this.menu.deactivate(),this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(new a.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(b,c){var e=this;a.each(c,function(a,c){e._renderItem(b,c)})},_renderItem:function(b,c){return a("<li></li>").data("item.autocomplete",c).append(a("<a></a>").text(c.label)).appendTo(b)},_move:function(a,b){this.menu.element.is(":visible")?this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)?(this.element.val(this.term),this.menu.deactivate()):this.menu[a](b):this.search(null,b)},widget:function(){return this.menu.element}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(b,c){var e=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return e.test(a.label||a.value||a)})}})}(jQuery),function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){a(c.target).closest(".ui-menu-item a").length&&(c.preventDefault(),b.select(c))}),this.refresh()},refresh:function(){var b=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,b){this.deactivate();if(this.hasScroll()){var c=b.offset().top-this.element.offset().top,d=this.element.scrollTop(),e=this.element.height();c<0?this.element.scrollTop(d+c):c>=e&&this.element.scrollTop(d+c-e+b.height())}this.active=b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",a,{item:b})},deactivate:function(){this.active&&(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,b,c){this.active?(a=this.active[a+"All"](".ui-menu-item").eq(0),a.length?this.activate(c,a):this.activate(c,this.element.children(b))):this.activate(c,this.element.children(b))},nextPage:function(b){if(this.hasScroll())if(!this.active||this.last())this.activate(b,this.element.children(".ui-menu-item:first"));else{var c=this.active.offset().top,e=this.element.height(),f=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c-e+a(this).height();return b<10&&b>-10});f.length||(f=this.element.children(".ui-menu-item:last")),this.activate(b,f)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll())if(!this.active||this.first())this.activate(b,this.element.children(".ui-menu-item:last"));else{var c=this.active.offset().top,e=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c+e-a(this).height();return b<10&&b>-10}),result.length||(result=this.element.children(".ui-menu-item:first")),this.activate(b,result)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})}(jQuery),function(a){var b,c,d,e,f=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},g=function(b){var c=b.name,d=b.form,e=a([]);return c&&(e=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",f),typeof this.options.disabled!="boolean"&&(this.options.disabled=this.element.attr("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var m=this,n=this.options,o=this.type==="checkbox"||this.type==="radio",p="ui-state-hover"+(o?"":" ui-state-active");n.label===null&&(n.label=this.buttonElement.html()),this.element.is(":disabled")&&(n.disabled=!0),this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){n.disabled||(a(this).addClass("ui-state-hover"),this===b&&a(this).addClass("ui-state-active"))}).bind("mouseleave.button",function(){n.disabled||a(this).removeClass(p)}).bind("click.button",function(a){n.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus.button",function(){m.buttonElement.addClass("ui-state-focus")}).bind("blur.button",function(){m.buttonElement.removeClass("ui-state-focus")}),o&&(this.element.bind("change.button",function(){e||m.refresh()}),this.buttonElement.bind("mousedown.button",function(a){n.disabled||(e=!1,c=a.pageX,d=a.pageY)}).bind("mouseup.button",function(a){!n.disabled&&(c!==a.pageX||d!==a.pageY)&&(e=!0)})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(n.disabled||e)return!1;a(this).toggleClass("ui-state-active"),m.buttonElement.attr("aria-pressed",m.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(n.disabled||e)return!1;a(this).addClass("ui-state-active"),m.buttonElement.attr("aria-pressed",!0);var b=m.element[0];g(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",!1)}):(this.buttonElement.bind("mousedown.button",function(){if(n.disabled)return!1;a(this).addClass("ui-state-active"),b=this,a(document).one("mouseup",function(){b=null})}).bind("mouseup.button",function(){if(n.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(n.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",n.disabled),this._resetButton()},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().filter(":last"),b="label[for="+this.element.attr("id")+"]";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),(a=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.attr("aria-pressed",a)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title"),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="disabled"?c?this.element.attr("disabled",!0):this.element.removeAttr("disabled"):this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?g(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",!0):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",!1)}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",!0):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",!1))},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}}),a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c),a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var b=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(b?"ui-corner-right":"ui-corner-left").end().end()},destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy"),a.Widget.prototype.destroy.call(this)}})}(jQuery),function(a,b){var c={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},d={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},e=a.attrFn||{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0,click:!0};a.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(b){var c=a(this).css(b).offset().top;c<0&&a(this).css("top",b.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.options.title=this.options.title||this.originalTitle;var b=this,c=b.options,d=c.title||"&#160;",e=a.ui.dialog.getTitleId(b.element),f=(b.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c.dialogClass).css({zIndex:c.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(d){c.closeOnEscape&&d.keyCode&&d.keyCode===a.ui.keyCode.ESCAPE&&(b.close(d),d.preventDefault())}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(a){b.moveToTop(!1,a)});b.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(f);var g=(b.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(f),h=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){h.addClass("ui-state-hover")},function(){h.removeClass("ui-state-hover")}).focus(function(){h.addClass("ui-state-focus")}).blur(function(){h.removeClass("ui-state-focus")}).click(function(a){return b.close(a),!1}).appendTo(g);(b.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(c.closeText).appendTo(h),a("<span></span>").addClass("ui-dialog-title").attr("id",e).html(d).prependTo(g),a.isFunction(c.beforeclose)&&!a.isFunction(c.beforeClose)&&(c.beforeClose=c.beforeclose),g.find("*").add(g).disableSelection(),c.draggable&&a.fn.draggable&&b._makeDraggable(),c.resizable&&a.fn.resizable&&b._makeResizable(),b._createButtons(c.buttons),b._isOpen=!1,a.fn.bgiframe&&f.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;return a.overlay&&a.overlay.destroy(),a.uiDialog.hide(),a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),a.uiDialog.remove(),a.originalTitle&&a.element.attr("title",a.originalTitle),a},widget:function(){return this.uiDialog},close:function(b){var c=this,d,e;if(!1!==c._trigger("beforeClose",b))return c.overlay&&c.overlay.destroy(),c.uiDialog.unbind("keypress.ui-dialog"),c._isOpen=!1,c.options.hide?c.uiDialog.hide(c.options.hide,function(){c._trigger("close",b)}):(c.uiDialog.hide(),c._trigger("close",b)),a.ui.dialog.overlay.resize(),c.options.modal&&(d=0,a(".ui-dialog").each(function(){this!==c.uiDialog[0]&&(e=a(this).css("z-index"),isNaN(e)||(d=Math.max(d,e)))}),a.ui.dialog.maxZ=d),c},isOpen:function(){return this._isOpen},moveToTop:function(b,c){var d=this,e=d.options;return e.modal&&!b||!e.stack&&!e.modal?d._trigger("focus",c):(e.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=e.zIndex),d.overlay&&(a.ui.dialog.maxZ+=1,d.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)),b={scrollTop:d.element.attr("scrollTop"),scrollLeft:d.element.attr("scrollLeft")},a.ui.dialog.maxZ+=1,d.uiDialog.css("z-index",a.ui.dialog.maxZ),d.element.attr(b),d._trigger("focus",c),d)},open:function(){if(!this._isOpen){var b=this,c=b.options,d=b.uiDialog;return b.overlay=c.modal?new a.ui.dialog.overlay(b):null,b._size(),b._position(c.position),d.show(c.show),b.moveToTop(!0),c.modal&&d.bind("keypress.ui-dialog",function(b){if(b.keyCode===a.ui.keyCode.TAB){var c=a(":tabbable",this),d=c.filter(":first");c=c.filter(":last");if(b.target===c[0]&&!b.shiftKey)return d.focus(1),!1;if(b.target===d[0]&&b.shiftKey)return c.focus(1),!1}}),a(b.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus(),b._isOpen=!0,b._trigger("open"),b}},_createButtons:function(b){var c=this,d=!1,f=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(f);c.uiDialog.find(".ui-dialog-buttonpane").remove(),typeof b=="object"&&b!==null&&a.each(b,function(){return!(d=!0)}),d&&(a.each(b,function(b,d){d=a.isFunction(d)?{click:d,text:b}:d;var f=a('<button type="button"></button>').click(function(){d.click.apply(c.element[0],arguments)}).appendTo(g);a.each(d,function(a,b){a!=="click"&&(a in e?f[a](b):f.attr(a,b))}),a.fn.button&&f.button()}),f.appendTo(c.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=c.options,e=a(document),f;c.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,h){f=d.height==="auto"?"auto":a(this).height(),a(this).height(a(this).height()).addClass("ui-dialog-dragging"),c._trigger("dragStart",e,b(h))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(h,i){d.position=[i.position.left-e.scrollLeft(),i.position.top-e.scrollTop()],a(this).removeClass("ui-dialog-dragging").height(f),c._trigger("dragStop",h,b(i)),a.ui.dialog.overlay.resize()}})},_makeResizable:function(c){function d(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}c=c===b?this.options.resizable:c;var e=this,f=e.options,g=e.uiDialog.css("position");c=typeof c=="string"?c:"n,e,s,w,se,sw,ne,nw",e.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:e.element,maxWidth:f.maxWidth,maxHeight:f.maxHeight,minWidth:f.minWidth,minHeight:e._minHeight(),handles:c,start:function(b,c){a(this).addClass("ui-dialog-resizing"),e._trigger("resizeStart",b,d(c))},resize:function(a,b){e._trigger("resize",a,d(b))},stop:function(b,c){a(this).removeClass("ui-dialog-resizing"),f.height=a(this).height(),f.width=a(this).width(),e._trigger("resizeStop",b,d(c)),a.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var c=[],d=[0,0],e;if(b){if(typeof b=="string"||typeof b=="object"&&"0"in b)c=b.split?b.split(" "):[b[0],b[1]],c.length===1&&(c[1]=c[0]),a.each(["left","top"],function(a,b){+c[a]===c[a]&&(d[a]=c[a],c[a]=b)}),b={my:c.join(" "),at:c.join(" "),offset:d.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show(),this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b)),e||this.uiDialog.hide()},_setOptions:function(b){var e=this,f={},g=!1;a.each(b,function(a,b){e._setOption(a,b),a in c&&(g=!0),a in d&&(f[a]=b)}),g&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",f)},_setOption:function(b,c){var d=this,e=d.uiDialog;switch(b){case"beforeclose":b="beforeClose";break;case"buttons":d._createButtons(c);break;case"closeText":d.uiDialogTitlebarCloseText.text(""+c);break;case"dialogClass":e.removeClass(d.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c);break;case"disabled":c?e.addClass("ui-dialog-disabled"):e.removeClass("ui-dialog-disabled");break;case"draggable":var f=e.is(":data(draggable)");f&&!c&&e.draggable("destroy"),!f&&c&&d._makeDraggable();break;case"position":d._position(c);break;case"resizable":(f=e.is(":data(resizable)"))&&!c&&e.resizable("destroy"),f&&typeof c=="string"&&e.resizable("option","handles",c),!f&&c!==!1&&d._makeResizable(c);break;case"title":a(".ui-dialog-title",d.uiDialogTitlebar).html(""+(c||"&#160;"))}a.Widget.prototype._setOption.apply(d,arguments)},_size:function(){var b=this.options,c,d,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),b.minWidth>b.width&&(b.width=b.minWidth),c=this.uiDialog.css({height:"auto",width:b.width}).height(),d=Math.max(0,b.minHeight-c),b.height==="auto"?a.support.minHeight?this.element.css({minHeight:d,height:"auto"}):(this.uiDialog.show(),b=this.element.css("height","auto").height(),e||this.uiDialog.hide(),this.element.height(Math.max(b,d))):this.element.height(Math.max(b.height-c,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),a.extend(a.ui.dialog,{version:"1.8.14",uuid:0,maxZ:0,getTitleId:function(a){return a=a.attr("id"),a||(this.uuid+=1,a=this.uuid),"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}}),a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(b){this.instances.length===0&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(document).bind("keydown.dialog-overlay",function(c){b.options.closeOnEscape&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE&&(b.close(c),c.preventDefault())}),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var c=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});return a.fn.bgiframe&&c.bgiframe(),this.instances.push(c),c},destroy:function(b){var c=a.inArray(b,this.instances);c!=-1&&this.oldInstances.push(this.instances.splice(c,1)[0]),this.instances.length===0&&a([document,window]).unbind(".dialog-overlay"),b.remove();var d=0;a.each(this.instances,function(){d=Math.max(d,this.css("z-index"))}),this.maxZ=d},height:function(){var b,c;return a.browser.msie&&a.browser.version<7?(b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),b<c?a(window).height()+"px":b+"px"):a(document).height()+"px"},width:function(){var b,c;return a.browser.msie?(b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),b<c?a(window).width()+"px":b+"px"):a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)}),b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}}),a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,c=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=c.values&&c.values.length||1,g=[];this._mouseSliding=this._keySliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(c.disabled?" ui-slider-disabled ui-disabled":"")),this.range=a([]),c.range&&(c.range===!0&&(c.values||(c.values=[this._valueMin(),this._valueMin()]),c.values.length&&c.values.length!==2&&(c.values=[c.values[0],c.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(c.range==="min"||c.range==="max"?" ui-slider-range-"+c.range:"")));for(var h=e.length;h<f;h+=1)g.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=e.add(a(g.join("")).appendTo(b.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){c.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")}),this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)}),this.handles.keydown(function(c){var e=!0,f=a(this).data("index.ui-slider-handle"),g,h,i;if(!b.options.disabled){switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:e=!1;if(!b._keySliding){b._keySliding=!0,a(this).addClass("ui-state-active"),g=b._start(c,f);if(g===!1)return}}i=b.options.step,g=b.options.values&&b.options.values.length?h=b.values(f):h=b.value();switch(c.keyCode){case a.ui.keyCode.HOME:h=b._valueMin();break;case a.ui.keyCode.END:h=b._valueMax();break;case a.ui.keyCode.PAGE_UP:h=b._trimAlignValue(g+(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:h=b._trimAlignValue(g-(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(g===b._valueMax())return;h=b._trimAlignValue(g+i);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(g===b._valueMin())return;h=b._trimAlignValue(g-i)}return b._slide(c,f,h),e}}).keyup(function(c){var e=a(this).data("index.ui-slider-handle");b._keySliding&&(b._keySliding=!1,b._stop(c,e),b._change(c,e),a(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options,e,f,g,h,i;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e=this._normValueFromMouse({x:b.pageX,y:b.pageY}),f=this._valueMax()-this._valueMin()+1,h=this,this.handles.each(function(b){var c=Math.abs(e-h.values(b));f>c&&(f=c,g=a(this),i=b)}),c.range===!0&&this.values(1)===c.min&&(i+=1,g=a(this.handles[i])),this._start(b,i)===!1?!1:(this._mouseSliding=!0,h._handleIndex=i,g.addClass("ui-state-active").focus(),c=g.offset(),this._clickOffset=a(b.target).parents().andSelf().is(".ui-slider-handle")?{left:b.pageX-c.left-g.width()/2,top:b.pageY-c.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)}:{left:0,top:0},this.handles.hasClass("ui-state-hover")||this._slide(b,i,e),this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b=this._normValueFromMouse({x:a.pageX,y:a.pageY});return this._slide(a,this._handleIndex,b),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._clickOffset=this._handleIndex=null,this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var b;return this.orientation==="horizontal"?(b=this.elementSize.width,a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),b=a/b,b>1&&(b=1),b<0&&(b=0),this.orientation==="vertical"&&(b=1-b),a=this._valueMax()-this._valueMin(),this._trimAlignValue(this._valueMin()+b*a)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d;this.options.values&&this.options.values.length?(d=this.values(b?0:1),this.options.values.length===2&&this.options.range===!0&&(b===0&&c>d||b===1&&c<d)&&(c=d),c!==this.values(b)&&(d=this.values(),d[b]=c,a=this._trigger("slide",a,{handle:this.handles[b],value:c,values:d}),this.values(b?0:1),a!==!1&&this.values(b,c,!0))):c!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[b],value:c}),a!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("change",a,c)}},value:function(a){if(!arguments.length)return this._value();this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0)},values:function(b,c){var e,f,g;if(arguments.length>1)this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();e=this.options.values,f=arguments[0];for(g=0;g<e.length;g+=1)e[g]=this._trimAlignValue(f[g]),this._change(null,g);this._refreshValue()}},_setOption:function(b,c){var e,f=0;a.isArray(this.options.values)&&(f=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments);switch(b){case"disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.attr("disabled","disabled"),this.element.addClass("ui-disabled")):(this.handles.removeAttr("disabled"),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(e=0;e<f;e+=1)this._change(null,e);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);b=this.options.values.slice();for(c=0;c<b.length;c+=1)b[c]=this._trimAlignValue(b[c]);return b},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b;return alignValue=a-c,Math.abs(c)*2>=b&&(alignValue+=c>0?b:-b),parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b=this.options.range,c=this.options,e=this,f=this._animateOff?!1:c.animate,g,h={},i,j,k,l;this.options.values&&this.options.values.length?this.handles.each(function(b){g=(e.values(b)-e._valueMin())/(e._valueMax()-e._valueMin())*100,h[e.orientation==="horizontal"?"left":"bottom"]=g+"%",a(this).stop(1,1)[f?"animate":"css"](h,c.animate),e.options.range===!0&&(e.orientation==="horizontal"?(b===0&&e.range.stop(1,1)[f?"animate":"css"]({left:g+"%"},c.animate),b===1&&e.range[f?"animate":"css"]({width:g-i+"%"},{queue:!1,duration:c.animate})):(b===0&&e.range.stop(1,1)[f?"animate":"css"]({bottom:g+"%"},c.animate),b===1&&e.range[f?"animate":"css"]({height:g-i+"%"},{queue:!1,duration:c.animate}))),i=g}):(j=this.value(),k=this._valueMin(),l=this._valueMax(),g=l!==k?(j-k)/(l-k)*100:0,h[e.orientation==="horizontal"?"left":"bottom"]=g+"%",this.handle.stop(1,1)[f?"animate":"css"](h,c.animate),b==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:g+"%"},c.animate),b==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-g+"%"},{queue:!1,duration:c.animate}),b==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:g+"%"},c.animate),b==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-g+"%"},{queue:!1,duration:c.animate}))}}),a.extend(a.ui.slider,{version:"1.8.14"})}(jQuery),function(a,b){function c(){return++e}function d(){return++f}var e=0,f=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(a,b){a=="selected"?this.options.collapsible&&b==this.options.selected||this.select(b):(this.options[a]=b,this._tabify())},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+c()},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+d());return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(c){function d(b,c){b.css("display",""),!a.support.opacity&&c.opacity&&b[0].style.removeAttribute("filter")}var e=this,f=this.options,g=/^#.+/;this.list=this.element.find("ol,ul").eq(0),this.lis=a(" > li:has(a[href])",this.list),this.anchors=this.lis.map(function(){return a("a",this)[0]}),this.panels=a([]),this.anchors.each(function(b,c){var d=a(c).attr("href"),h=d.split("#")[0],i;h&&(h===location.toString().split("#")[0]||(i=a("base")[0])&&h===i.href)&&(d=c.hash,c.href=d),g.test(d)?e.panels=e.panels.add(e.element.find(e._sanitizeSelector(d))):d&&d!=="#"?(a.data(c,"href.tabs",d),a.data(c,"load.tabs",d.replace(/#.*$/,"")),d=e._tabId(c),c.href="#"+d,c=e.element.find("#"+d),c.length||(c=a(f.panelTemplate).attr("id",d).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(e.panels[b-1]||e.list),c.data("destroy.tabs",!0)),e.panels=e.panels.add(c)):f.disabled.push(b)}),c?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),f.selected===b?(location.hash&&this.anchors.each(function(a,b){if(b.hash==location.hash)return f.selected=a,!1}),typeof f.selected!="number"&&f.cookie&&(f.selected=parseInt(e._cookie(),10)),typeof f.selected!="number"&&this.lis.filter(".ui-tabs-selected").length&&(f.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))),f.selected=f.selected||(this.lis.length?0:-1)):f.selected===null&&(f.selected=-1),f.selected=f.selected>=0&&this.anchors[f.selected]||f.selected<0?f.selected:0,f.disabled=a.unique(f.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(a){return e.lis.index(a)}))).sort(),a.inArray(f.selected,f.disabled)!=-1&&f.disabled.splice(a.inArray(f.selected,f.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),f.selected>=0&&this.anchors.length&&(e.element.find(e._sanitizeSelector(e.anchors[f.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(f.selected).addClass("ui-tabs-selected ui-state-active"),e.element.queue("tabs",function(){e._trigger("show",null,e._ui(e.anchors[f.selected],e.element.find(e._sanitizeSelector(e.anchors[f.selected].hash))[0]))}),this.load(f.selected)),a(window).bind("unload",function(){e.lis.add(e.anchors).unbind(".tabs"),e.lis=e.anchors=e.panels=null})):f.selected=this.lis.index(this.lis.filter(".ui-tabs-selected")),this.element[f.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible"),f.cookie&&this._cookie(f.selected,f.cookie),c=0;for(var h;h=this.lis[c];c++)a(h)[a.inArray(c,f.disabled)!=-1&&!a(h).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");f.cache===!1&&this.anchors.removeData("cache.tabs"),this.lis.add(this.anchors).unbind(".tabs");if(f.event!=="mouseover"){var i=function(a,b){b.is(":not(.ui-state-disabled)")&&b.addClass("ui-state-"+a)},j=function(a,b){b.removeClass("ui-state-"+a)};this.lis.bind("mouseover.tabs",function(){i("hover",a(this))}),this.lis.bind("mouseout.tabs",function(){j("hover",a(this))}),this.anchors.bind("focus.tabs",function(){i("focus",a(this).closest("li"))}),this.anchors.bind("blur.tabs",function(){j("focus",a(this).closest("li"))})}var k,l;f.fx&&(a.isArray(f.fx)?(k=f.fx[0],l=f.fx[1]):k=l=f.fx);var m=l?function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.hide().removeClass("ui-tabs-hide").animate(l,l.duration||"normal",function(){d(c,l),e._trigger("show",null,e._ui(b,c[0]))})}:function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.removeClass("ui-tabs-hide"),e._trigger("show",null,e._ui(b,c[0]))},n=k?function(a,b){b.animate(k,k.duration||"normal",function(){e.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),d(b,k),e.element.dequeue("tabs")})}:function(a,b){e.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),e.element.dequeue("tabs")};this.anchors.bind(f.event+".tabs",function(){var b=this,c=a(b).closest("li"),d=e.panels.filter(":not(.ui-tabs-hide)"),g=e.element.find(e._sanitizeSelector(b.hash));if(c.hasClass("ui-tabs-selected")&&!f.collapsible||c.hasClass("ui-state-disabled")||c.hasClass("ui-state-processing")||e.panels.filter(":animated").length||e._trigger("select",null,e._ui(this,g[0]))===!1)return this.blur(),!1;f.selected=e.anchors.index(this),e.abort();if(f.collapsible){if(c.hasClass("ui-tabs-selected"))return f.selected=-1,f.cookie&&e._cookie(f.selected,f.cookie),e.element.queue("tabs",function(){n(b,d)}).dequeue("tabs"),this.blur(),!1;if(!d.length)return f.cookie&&e._cookie(f.selected,f.cookie),e.element.queue("tabs",function(){m(b,g)}),e.load(e.anchors.index(this)),this.blur(),!1}f.cookie&&e._cookie(f.selected,f.cookie);if(!g.length)throw"jQuery UI Tabs: Mismatching fragment identifier.";d.length&&e.element.queue("tabs",function(){n(b,d)}),e.element.queue("tabs",function(){m(b,g)}),e.load(e.anchors.index(this)),a.browser.msie&&this.blur()}),this.anchors.bind("click.tabs",function(){return!1})},_getIndex:function(a){return typeof a=="string"&&(a=this.anchors.index(this.anchors.filter("[href$="+a+"]"))),a},destroy:function(){var b=this.options;return this.abort(),this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"),this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.anchors.each(function(){var b=a.data(this,"href.tabs");b&&(this.href=b);var c=a(this).unbind(".tabs");a.each(["href","load","cache"],function(a,b){c.removeData(b+".tabs")})}),this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")}),b.cookie&&this._cookie(null,b.cookie),this},add:function(c,d,e){e===b&&(e=this.anchors.length);var f=this,g=this.options;d=a(g.tabTemplate.replace(/#\{href\}/g,c).replace(/#\{label\}/g,d)),c=c.indexOf("#")?this._tabId(a("a",d)[0]):c.replace("#",""),d.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var h=f.element.find("#"+c);return h.length||(h=a(g.panelTemplate).attr("id",c).data("destroy.tabs",!0)),h.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"),e>=this.lis.length?(d.appendTo(this.list),h.appendTo(this.list[0].parentNode)):(d.insertBefore(this.lis[e]),h.insertBefore(this.panels[e])),g.disabled=a.map(g.disabled,function(a){return a>=e?++a:a}),this._tabify(),this.anchors.length==1&&(g.selected=0,d.addClass("ui-tabs-selected ui-state-active"),h.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){f._trigger("show",null,f._ui(f.anchors[0],f.panels[0]))}),this.load(0)),this._trigger("add",null,this._ui(this.anchors[e],this.panels[e])),this},remove:function(b){b=this._getIndex(b);var c=this.options,d=this.lis.eq(b).remove(),e=this.panels.eq(b).remove();return d.hasClass("ui-tabs-selected")&&this.anchors.length>1&&this.select(b+(b+1<this.anchors.length?1:-1)),c.disabled=a.map(a.grep(c.disabled,function(a){return a!=b}),function(a){return a>=b?--a:a}),this._tabify(),this._trigger("remove",null,this._ui(d.find("a")[0],e[0])),this},enable:function(b){b=this._getIndex(b);var c=this.options;if(a.inArray(b,c.disabled)!=-1)return this.lis.eq(b).removeClass("ui-state-disabled"),c.disabled=a.grep(c.disabled,function(a){return a!=b}),this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b])),this},disable:function(a){a=this._getIndex(a);var b=this.options;return a!=b.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),b.disabled.push(a),b.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a]))),this},select:function(a){a=this._getIndex(a);if(a==-1){if(!this.options.collapsible||this.options.selected==-1)return this;a=this.options.selected}return this.anchors.eq(a).trigger(this.options.event+".tabs"),this},load:function(b){b=this._getIndex(b);var c=this,d=this.options,e=this.anchors.eq(b)[0],f=a.data(e,"load.tabs");this.abort();if(!(!f||this.element.queue("tabs").length!==0&&a.data(e,"cache.tabs"))){this.lis.eq(b).addClass("ui-state-processing");if(d.spinner){var g=a("span",e);g.data("label.tabs",g.html()).html(d.spinner)}return this.xhr=a.ajax(a.extend({},d.ajaxOptions,{url:f,success:function(f,g){c.element.find(c._sanitizeSelector(e.hash)).html(f),c._cleanup(),d.cache&&a.data(e,"cache.tabs",!0),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.success(f,g)}catch(h){}},error:function(a,f){c._cleanup(),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.error(a,f,b,e)}catch(g){}}})),c.element.dequeue("tabs"),this}this.element.dequeue("tabs")},abort:function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("tabs",this.element.queue("tabs").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._cleanup(),this},url:function(a,b){return this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",b),this},length:function(){return this.anchors.length}}),a.extend(a.ui.tabs,{version:"1.8.14"}),a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(a,b){var c=this,d=this.options,e=c._rotate||(c._rotate=function(b){clearTimeout(c.rotation),c.rotation=setTimeout(function(){var a=d.selected;c.select(++a<c.anchors.length?a:0)},a),b&&b.stopPropagation()});return b=c._unrotate||(c._unrotate=b?function(){t=d.selected,e()}:function(a){a.clientX&&c.rotate(null)}),a?(this.element.bind("tabsshow",e),this.anchors.bind(d.event+".tabs",b),e()):(clearTimeout(c.rotation),this.element.unbind("tabsshow",e),this.anchors.unbind(d.event+".tabs",b),delete this._rotate,delete this._unrotate),this}})}(jQuery),function(d,C){function M(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._inDialog=this._datepickerShowing=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1},d.extend(this._defaults,this.regional[""]),this.dpDiv=N(d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function N(a){return a.bind("mouseout",function(a){a=d(a.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a"),a.length&&a.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(b){b=d(b.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a"),!d.datepicker._isDisabledDatepicker(J.inline?a.parent()[0]:J.input[0])&&!!b.length&&(b.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),b.addClass("ui-state-hover"),b.hasClass("ui-datepicker-prev")&&b.addClass("ui-datepicker-prev-hover"),b.hasClass("ui-datepicker-next")&&b.addClass("ui-datepicker-next-hover"))})}function H(a,b){d.extend(a,b);for(var c in b)if(b[c]==null||b[c]==C)a[c]=b[c];return a}d.extend(d.ui,{datepicker:{version:"1.8.14"}});var A=(new Date).getTime(),J;d.extend(M.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return H(this._defaults,a||{}),this},_attachDatepicker:function(a,b){var c=null;for(var e in this._defaults){var f=a.getAttribute("date:"+e);if(f){c=c||{};try{c[e]=eval(f)}catch(h){c[e]=f}}}e=a.nodeName.toLowerCase(),f=e=="div"||e=="span",a.id||(this.uuid+=1,a.id="dp"+this.uuid);var i=this._newInst(d(a),f);i.settings=d.extend({},b||{},c||{}),e=="input"?this._connectDatepicker(a,i):f&&this._inlineDatepicker(a,i)},_newInst:function(a,b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?N(d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(a,b){var c=d(a);b.append=d([]),b.trigger=d([]),c.hasClass(this.markerClassName)||(this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),d.data(a,"datepicker",b))},_attachments:function(a,b){var c=this._get(b,"appendText"),e=this._get(b,"isRTL");b.append&&b.append.remove(),c&&(b.append=d('<span class="'+this._appendClass+'">'+c+"</span>"),a[e?"before":"after"](b.append)),a.unbind("focus",this._showDatepicker),b.trigger&&b.trigger.remove(),c=this._get(b,"showOn"),(c=="focus"||c=="both")&&a.focus(this._showDatepicker);if(c=="button"||c=="both"){c=this._get(b,"buttonText");var f=this._get(b,"buttonImage");b.trigger=d(this._get(b,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:f,alt:c,title:c}):d('<button type="button"></button>').addClass(this._triggerClass).html(f==""?c:d("<img/>").attr({src:f,alt:c,title:c}))),a[e?"before":"after"](b.trigger),b.trigger.click(function(){return d.datepicker._datepickerShowing&&d.datepicker._lastInput==a[0]?d.datepicker._hideDatepicker():d.datepicker._showDatepicker(a[0]),!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){for(var b=0,c=0,d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort"))),b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=d(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),d.data(a,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.dpDiv.show())},_dialogDatepicker:function(a,b,c,e,f){return a=this._dialogInst,a||(this.uuid+=1,this._dialogInput=d('<input type="text" id="'+("dp"+this.uuid)+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),d("body").append(this._dialogInput),a=this._dialogInst=this._newInst(this._dialogInput,!1),a.settings={},d.data(this._dialogInput[0],"datepicker",a)),H(a.settings,e||{}),b=b&&b.constructor==Date?this._formatDate(a,b):b,this._dialogInput.val(b),this._pos=f?f.length?f:[f.pageX,f.pageY]:null,this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),a.settings.onSelect=c,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),d.blockUI&&d.blockUI(this.dpDiv),d.data(this._dialogInput[0],"datepicker",a),this},_destroyDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();d.removeData(a,"datepicker"),e=="input"?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(e=="div"||e=="span")&&b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input")a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(e=="div"||e=="span")b=b.children("."+this._inlineClass),b.children().removeClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled");this._disabledInputs=d.map(this._disabledInputs,function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input")a.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(e=="div"||e=="span")b=b.children("."+this._inlineClass),b.children().addClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled");this._disabledInputs=d.map(this._disabledInputs,function(b){return b==a?null:b}),this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return d.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(a,b,c){var e=this._getInst(a);if(arguments.length==2&&typeof b=="string")return b=="defaults"?d.extend({},d.datepicker._defaults):e?b=="all"?d.extend({},e.settings):this._get(e,b):null;var f=b||{};typeof b=="string"&&(f={},f[b]=c);if(e){this._curInst==e&&this._hideDatepicker();var g=this._getDateDatepicker(a,!0),h=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max");H(e.settings,f),h!==null&&f.dateFormat!==C&&f.minDate===C&&(e.settings.minDate=this._formatDate(e,h)),i!==null&&f.dateFormat!==C&&f.maxDate===C&&(e.settings.maxDate=this._formatDate(e,i)),this._attachments(d(a),e),this._autoSize(e),this._setDate(e,g),this._updateAlternate(e),this._updateDatepicker(e)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){if(a=this._getInst(a))this._setDate(a,b),this._updateDatepicker(a),this._updateAlternate(a)},_getDateDatepicker:function(a,b){return(a=this._getInst(a))&&!a.inline&&this._setDateFromField(a,b),a?this._getDate(a):null},_doKeyDown:function(a){var b=d.datepicker._getInst(a.target),c=!0,e=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if(d.datepicker._datepickerShowing)switch(a.keyCode){case 9:d.datepicker._hideDatepicker(),c=!1;break;case 13:return c=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",b.dpDiv),c[0]?d.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,c[0]):d.datepicker._hideDatepicker(),!1;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&d.datepicker._clearDate(a.target),c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&d.datepicker._gotoToday(a.target),c=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,e?1:-1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,-7,"D"),c=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,e?-1:1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,7,"D"),c=a.ctrlKey||a.metaKey;break;default:c=!1}else a.keyCode==36&&a.ctrlKey?d.datepicker._showDatepicker(this):c=!1;c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=d.datepicker._getInst(a.target);if(d.datepicker._get(b,"constrainInput")){b=d.datepicker._possibleChars(d.datepicker._get(b,"dateFormat"));var c=String.fromCharCode(a.charCode==C?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||c<" "||!b||b.indexOf(c)>-1}},_doKeyUp:function(a){a=d.datepicker._getInst(a.target);if(a.input.val()!=a.lastVal)try{d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,d.datepicker._getFormatConfig(a))&&(d.datepicker._setDateFromField(a),d.datepicker._updateAlternate(a),d.datepicker._updateDatepicker(a))}catch(b){d.datepicker.log(b)}return!0},_showDatepicker:function(a){a=a.target||a,a.nodeName.toLowerCase()!="input"&&(a=d("input",a.parentNode)[0]);if(!d.datepicker._isDisabledDatepicker(a)&&d.datepicker._lastInput!=a){var b=d.datepicker._getInst(a);d.datepicker._curInst&&d.datepicker._curInst!=b&&(d.datepicker._datepickerShowing&&d.datepicker._triggerOnClose(d.datepicker._curInst),d.datepicker._curInst.dpDiv.stop(!0,!0));var c=d.datepicker._get(b,"beforeShow");H(b.settings,c?c.apply(a,[a,b]):{}),b.lastVal=null,d.datepicker._lastInput=a,d.datepicker._setDateFromField(b),d.datepicker._inDialog&&(a.value=""),d.datepicker._pos||(d.datepicker._pos=d.datepicker._findPos(a),d.datepicker._pos[1]+=a.offsetHeight);var e=!1;d(a).parents().each(function(){return e|=d(this).css("position")=="fixed",!e}),e&&d.browser.opera&&(d.datepicker._pos[0]-=document.documentElement.scrollLeft,d.datepicker._pos[1]-=document.documentElement.scrollTop),c={left:d.datepicker._pos[0],top:d.datepicker._pos[1]},d.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),d.datepicker._updateDatepicker(b),c=d.datepicker._checkOffset(b,c,e),b.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){c=d.datepicker._get(b,"showAnim");var f=d.datepicker._get(b,"duration"),g=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(a.length){var c=d.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex(d(a).zIndex()+1),d.datepicker._datepickerShowing=!0,d.effects&&d.effects[c]?b.dpDiv.show(c,d.datepicker._get(b,"showOptions"),f,g):b.dpDiv[c||"show"](c?f:null,g),(!c||!f)&&g(),b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus(),d.datepicker._curInst=b}}},_updateDatepicker:function(a){this.maxRows=4;var b=d.datepicker._getBorders(a.dpDiv);J=a,a.dpDiv.empty().append(this._generateHTML(a));var c=a.dpDiv.find("iframe.ui-datepicker-cover");c.length&&c.css({left:-b[0],top:-b[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()}),a.dpDiv.find("."+this._dayOverClass+" a").mouseover(),b=this._getNumberOfMonths(a),c=b[1],a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),c>1&&a.dpDiv.addClass("ui-datepicker-multi-"+c).css("width",17*c+"em"),a.dpDiv[(b[0]!=1||b[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),a==d.datepicker._curInst&&d.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement&&a.input.focus();if(a.yearshtml){var e=a.yearshtml;setTimeout(function(){e===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml),e=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var e=a.dpDiv.outerWidth(),f=a.dpDiv.outerHeight(),g=a.input?a.input.outerWidth():0,h=a.input?a.input.outerHeight():0,i=document.documentElement.clientWidth+d(document).scrollLeft(),j=document.documentElement.clientHeight+d(document).scrollTop();return b.left-=this._get(a,"isRTL")?e-g:0,b.left-=c&&b.left==a.input.offset().left?d(document).scrollLeft():0,b.top-=c&&b.top==a.input.offset().top+h?d(document).scrollTop():0,b.left-=Math.min(b.left,b.left+e>i&&i>e?Math.abs(b.left+e-i):0),b.top-=Math.min(b.top,b.top+f>j&&j>f?Math.abs(f+h):0),b},_findPos:function(a){for(var b=this._get(this._getInst(a),"isRTL");a&&(a.type=="hidden"||a.nodeType!=1||d.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];return a=d(a).offset(),[a.left,a.top]},_triggerOnClose:function(a){var b=this._get(a,"onClose");b&&b.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a])},_hideDatepicker:function(a){var b=this._curInst;if(!(!b||a&&b!=d.data(a,"datepicker"))&&this._datepickerShowing){a=this._get(b,"showAnim");var c=this._get(b,"duration"),e=function(){d.datepicker._tidyDialog(b),this._curInst=null};d.effects&&d.effects[a]?b.dpDiv.hide(a,d.datepicker._get(b,"showOptions"),c,e):b.dpDiv[a=="slideDown"?"slideUp":a=="fadeIn"?"fadeOut":"hide"](a?c:null,e),a||e(),d.datepicker._triggerOnClose(b),this._datepickerShowing=!1,this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),d.blockUI&&(d.unblockUI(),d("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){d.datepicker._curInst&&(a=d(a.target),a[0].id!=d.datepicker._mainDivId&&a.parents("#"+d.datepicker._mainDivId).length==0&&!a.hasClass(d.datepicker.markerClassName)&&!a.hasClass(d.datepicker._triggerClass)&&d.datepicker._datepickerShowing&&(!d.datepicker._inDialog||!d.blockUI)&&d.datepicker._hideDatepicker())},_adjustDate:function(a,b,c){a=d(a);var e=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e))},_gotoToday:function(a){a=d(a);var b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay)b.selectedDay=b.currentDay,b.drawMonth=b.selectedMonth=b.currentMonth,b.drawYear=b.selectedYear=b.currentYear;else{var c=new Date;b.selectedDay=c.getDate(),b.drawMonth=b.selectedMonth=c.getMonth(),b.drawYear=b.selectedYear=c.getFullYear()}this._notifyChange(b),this._adjustDate(a)},_selectMonthYear:function(a,b,c){a=d(a);var e=this._getInst(a[0]);e._selectingMonthYear=!1,e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(e),this._adjustDate(a)},_clickMonthYear:function(a){var b=this._getInst(d(a)[0]);b.input&&b._selectingMonthYear&&setTimeout(function(){b.input.focus()},0),b._selectingMonthYear=!b._selectingMonthYear},_selectDay:function(a,b,c,e){var f=d(a);!d(e).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(f[0])&&(f=this._getInst(f[0]),f.selectedDay=f.currentDay=d("a",e).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(a){a=d(a),this._getInst(a[0]),this._selectDate(a,"")},_selectDate:function(a,b){a=this._getInst(d(a)[0]),b=b!=null?b:this._formatDate(a),a.input&&a.input.val(b),this._updateAlternate(a);var c=this._get(a,"onSelect");c?c.apply(a.input?a.input[0]:null,[b,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],typeof a.input[0]!="object"&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),e=this._getDate(a),f=this.formatDate(c,e,this._getFormatConfig(a));d(b).each(function(){d(this).val(f)})}},noWeekends:function(a){return a=a.getDay(),[a>0&&a<6,""]},iso8601Week:function(a){a=new Date(a.getTime()),a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();return a.setMonth(0),a.setDate(1),Math.floor(Math.round((b-a)/864e5)/7)+1},parseDate:function(a,b,c){if(a==null||b==null)throw"Invalid arguments";b=typeof b=="object"?b.toString():b+"";if(b=="")return null;var e=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;e=typeof e!="string"?e:(new Date).getFullYear()%100+parseInt(e,10);for(var f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,g=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,i=(c?c.monthNames:null)||this._defaults.monthNames,j=c=-1,k=-1,l=-1,m=!1,n=function(b){return(b=s+1<a.length&&a.charAt(s+1)==b)&&s++,b},o=function(a){var c=n(a);a=new RegExp("^\\d{1,"+(a=="@"?14:a=="!"?20:a=="y"&&c?4:a=="o"?3:2)+"}"),a=b.substring(r).match(a);if(!a)throw"Missing number at position "+r;return r+=a[0].length,parseInt(a[0],10)},p=function(a,c,e){a=d.map(n(a)?e:c,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});var f=-1;d.each(a,function(a,c){a=c[1];if(b.substr(r,a.length).toLowerCase()==a.toLowerCase())return f=c[0],r+=a.length,!1});if(f!=-1)return f+1;throw"Unknown name at position "+r},q=function(){if(b.charAt(r)!=a.charAt(s))throw"Unexpected literal at position "+r;r++},r=0,s=0;s<a.length;s++)if(m)a.charAt(s)=="'"&&!n("'")?m=!1:q();else switch(a.charAt(s)){case"d":k=o("d");break;case"D":p("D",f,g);break;case"o":l=o("o");break;case"m":j=o("m");break;case"M":j=p("M",h,i);break;case"y":c=o("y");break;case"@":var t=new Date(o("@"));c=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"!":t=new Date((o("!")-this._ticksTo1970)/1e4),c=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"'":n("'")?q():m=!0;break;default:q()}if(r<b.length)throw"Extra/unparsed characters found in date: "+b.substring(r);c==-1?c=(new Date).getFullYear():c<100&&(c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=e?0:-100));if(l>-1){j=1,k=l;do{e=this._getDaysInMonth(c,j-1);if(k<=e)break;j++,k-=e}while(1)}t=this._daylightSavingAdjust(new Date(c,j-1,k));if(t.getFullYear()!=c||t.getMonth()+1!=j||t.getDate()!=k)throw"Invalid date";return t},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,f=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort;c=(c?c.monthNames:null)||this._defaults.monthNames;var g=function(b){return(b=l+1<a.length&&a.charAt(l+1)==b)&&l++,b},h=function(a,b,c){b=""+b;if(g(a))for(;b.length<c;)b="0"+b;return b},i=function(a,b,c,d){return g(a)?d[b]:c[b]},j="",k=!1;if(b)for(var l=0;l<a.length;l++)if(k)a.charAt(l)=="'"&&!g("'")?k=!1:j+=a.charAt(l);else switch(a.charAt(l)){case"d":j+=h("d",b.getDate(),2);break;case"D":j+=i("D",b.getDay(),d,e);break;case"o":j+=h("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":j+=h("m",b.getMonth()+1,2);break;case"M":j+=i("M",b.getMonth(),f,c);break;case"y":j+=g("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":j+=b.getTime();break;case"!":j+=b.getTime()*1e4+this._ticksTo1970;break;case"'":g("'")?j+="'":k=!0;break;default:j+=a.charAt(l)}return j},_possibleChars:function(a){for(var b="",c=!1,d=function(b){return(b=e+1<a.length&&a.charAt(e+1)==b)&&e++,b},e=0;e<a.length;e++)if(c)a.charAt(e)=="'"&&!d("'")?c=!1:b+=a.charAt(e);else switch(a.charAt(e)){case"d":case"m":case"y":case"@":b+="0123456789";break;case"D":case"M":return null;case"'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(e)}return b},_get:function(a,b){return a.settings[b]!==C?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e,f;e=f=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(c,d,g)||f}catch(h){this.log(h),d=b?"":d}a.selectedDay=e.getDate(),a.drawMonth=a.selectedMonth=e.getMonth(),a.drawYear=a.selectedYear=e.getFullYear(),a.currentDay=d?e.getDate():0,a.currentMonth=d?e.getMonth():0,a.currentYear=d?e.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(b){try{return d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),b,d.datepicker._getFormatConfig(a))}catch(c){}var e=(b.toLowerCase().match(/^c/)?d.datepicker._getDate(a):null)||new Date,f=e.getFullYear(),g=e.getMonth();e=e.getDate();for(var h=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(b);i;){switch(i[2]||"d"){case"d":case"D":e+=parseInt(i[1],10);break;case"w":case"W":e+=parseInt(i[1],10)*7;break;case"m":case"M":g+=parseInt(i[1],10),e=Math.min(e,d.datepicker._getDaysInMonth(f,g));break;case"y":case"Y":f+=parseInt(i[1],10),e=Math.min(e,d.datepicker._getDaysInMonth(f,g))}i=h.exec(b)}return new Date(f,g,e)};if(b=(b=b==null||b===""?c:typeof b=="string"?f(b):typeof b=="number"?isNaN(b)?c:e(b):new Date(b.getTime()))&&b.toString()=="Invalid Date"?c:b)b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear;b=this._restrictMinMax(a,this._determineDate(a,b,new Date)),a.selectedDay=a.currentDay=b.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth(),a.drawYear=a.selectedYear=a.currentYear=b.getFullYear(),(e!=a.selectedMonth||f!=a.selectedYear)&&!c&&this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),e=this._get(a,"showButtonPanel"),f=this._get(a,"hideIfNoPrevNext"),g=this._get(a,"navigationAsDateFormat"),h=this._getNumberOfMonths(a),i=this._get(a,"showCurrentAtPos"),j=this._get(a,"stepMonths"),k=h[0]!=1||h[1]!=1,l=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),m=this._getMinMaxDate(a,"min"),n=this._getMinMaxDate(a,"max");i=a.drawMonth-i;var o=a.drawYear;i<0&&(i+=12,o--);if(n){var p=this._daylightSavingAdjust(new Date(n.getFullYear(),n.getMonth()-h[0]*h[1]+1,n.getDate()));for(p=m&&p<m?m:p;this._daylightSavingAdjust(new Date(o,i,1))>p;)i--,i<0&&(i=11,o--)}a.drawMonth=i,a.drawYear=o,p=this._get(a,"prevText"),p=g?this.formatDate(p,this._daylightSavingAdjust(new Date(o,i-j,1)),this._getFormatConfig(a)):p,p=this._canAdjustMonth(a,-1,o,i)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+A+".datepicker._adjustDate('#"+a.id+"', -"+j+", 'M');\" title=\""+p+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+p+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+p+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+p+"</span></a>";var q=this._get(a,"nextText");q=g?this.formatDate(q,this._daylightSavingAdjust(new Date(o,i+j,1)),this._getFormatConfig(a)):q,f=this._canAdjustMonth(a,1,o,i)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+A+".datepicker._adjustDate('#"+a.id+"', +"+j+", 'M');\" title=\""+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+q+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+q+"</span></a>",j=this._get(a,"currentText"),q=this._get(a,"gotoCurrent")&&a.currentDay?l:b,j=g?this.formatDate(j,q,this._getFormatConfig(a)):j,g=a.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+A+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>",e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?g:"")+(this._isInRange(a,q)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+A+".datepicker._gotoToday('#"+a.id+"');\">"+j+"</button>":"")+(c?"":g)+"</div>":"",g=parseInt(this._get(a,"firstDay"),10),g=isNaN(g)?0:g,j=this._get(a,"showWeek"),q=this._get(a,"dayNames"),this._get(a,"dayNamesShort");var r=this._get(a,"dayNamesMin"),s=this._get(a,"monthNames"),t=this._get(a,"monthNamesShort"),u=this._get(a,"beforeShowDay"),v=this._get(a,"showOtherMonths"),w=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var x=this._getDefaultDate(a),y="",z=0;z<h[0];z++){var B="";this.maxRows=4;for(var C=0;C<h[1];C++){var D=this._daylightSavingAdjust(new Date(o,i,a.selectedDay)),E=" ui-corner-all",F="";if(k){F+='<div class="ui-datepicker-group';if(h[1]>1)switch(C){case 0:F+=" ui-datepicker-group-first",E=" ui-corner-"+(c?"right":"left");break;case h[1]-1:F+=" ui-datepicker-group-last",E=" ui-corner-"+(c?"left":"right");break;default:F+=" ui-datepicker-group-middle",E=""}F+='">'}F+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+E+'">'+(/all|left/.test(E)&&z==0?c?f:p:"")+(/all|right/.test(E)&&z==0?c?p:f:"")+this._generateMonthYearHeader(a,i,o,m,n,z>0||C>0,s,t)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var G=j?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(E=0;E<7;E++){var H=(E+g)%7;G+="<th"+((E+g+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+q[H]+'">'+r[H]+"</span></th>"}F+=G+"</tr></thead><tbody>",G=this._getDaysInMonth(o,i),o==a.selectedYear&&i==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,G)),E=(this._getFirstDayOfMonth(o,i)-g+7)%7,G=Math.ceil((E+G)/7),this.maxRows=G=k?this.maxRows>G?this.maxRows:G:G,H=this._daylightSavingAdjust(new Date(o,i,1-E));for(var I=0;I<G;I++){F+="<tr>";var J=j?'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(H)+"</td>":"";for(E=0;E<7;E++){var K=u?u.apply(a.input?a.input[0]:null,[H]):[!0,""],L=H.getMonth()!=i,M=L&&!w||!K[0]||m&&H<m||n&&H>n;J+='<td class="'+((E+g+6)%7>=5?" ui-datepicker-week-end":"")+(L?" ui-datepicker-other-month":"")+(H.getTime()==D.getTime()&&i==a.selectedMonth&&a._keyEvent||x.getTime()==H.getTime()&&x.getTime()==D.getTime()?" "+this._dayOverClass:"")+(M?" "+this._unselectableClass+" ui-state-disabled":"")+(L&&!v?"":" "+K[1]+(H.getTime()==l.getTime()?" "+this._currentClass:"")+(H.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!L||v)&&K[2]?' title="'+K[2]+'"':"")+(M?"":' onclick="DP_jQuery_'+A+".datepicker._selectDay('#"+a.id+"',"+H.getMonth()+","+H.getFullYear()+', this);return false;"')+">"+(L&&!v?"&#xa0;":M?'<span class="ui-state-default">'+H.getDate()+"</span>":'<a class="ui-state-default'+(H.getTime()==b.getTime()?" ui-state-highlight":"")+(H.getTime()==l.getTime()?" ui-state-active":"")+(L?" ui-priority-secondary":"")+'" href="#">'+H.getDate()+"</a>")+"</td>",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H)}F+=J+"</tr>"}i++,i>11&&(i=0,o++),F+="</tbody></table>"+(k?"</div>"+(h[0]>0&&C==h[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),B+=F}y+=B}return y+=e+(d.browser.msie&&parseInt(d.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),a._keyEvent=!1,y},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i=this._get(a,"changeMonth"),j=this._get(a,"changeYear"),k=this._get(a,"showMonthAfterYear"),l='<div class="ui-datepicker-title">',m="";if(f||!i)m+='<span class="ui-datepicker-month">'+g[b]+"</span>";else{g=d&&d.getFullYear()==c;var n=e&&e.getFullYear()==c;m+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+A+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" onclick=\"DP_jQuery_"+A+".datepicker._clickMonthYear('#"+a.id+"');\">";for(var o=0;o<12;o++)(!g||o>=d.getMonth())&&(!n||o<=e.getMonth())&&(m+='<option value="'+o+'"'+(o==b?' selected="selected"':"")+">"+h[o]+"</option>");m+="</select>"}k||(l+=m+(f||!i||!j?"&#xa0;":""));if(!a.yearshtml){a.yearshtml="";if(f||!j)l+='<span class="ui-datepicker-year">'+c+"</span>";else{h=this._get(a,"yearRange").split(":");var p=(new Date).getFullYear();g=function(a){return a=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?p+parseInt(a,10):parseInt(a,10),isNaN(a)?p:a},b=g(h[0]),h=Math.max(b,g(h[1]||"")),b=d?Math.max(b,d.getFullYear()):b,h=e?Math.min(h,e.getFullYear()):h;for(a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+A+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+A+".datepicker._clickMonthYear('#"+a.id+"');\">";b<=h;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>",l+=a.yearshtml,a.yearshtml=null}}return l+=this._get(a,"yearSuffix"),k&&(l+=(f||!i||!j?"&#xa0;":"")+m),l+="</div>",l},_adjustInstDate:function(a,b,c){var d=a.drawYear+(c=="Y"?b:0),e=a.drawMonth+(c=="M"?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+(c=="D"?b:0),d=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,b))),a.selectedDay=d.getDate(),a.drawMonth=a.selectedMonth=d.getMonth(),a.drawYear=a.selectedYear=d.getFullYear(),(c=="M"||c=="Y")&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min");return a=this._getMinMaxDate(a,"max"),b=c&&b<c?c:b,b=a&&b>a?a:b},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){return a=this._get(a,"numberOfMonths"),a==null?[1,1]:typeof a=="number"?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a);return c=this._daylightSavingAdjust(new Date(c,d+(b<0?b:e[0]*e[1]),1)),b<0&&c.setDate(this._getDaysInMonth(c.getFullYear(),c.getMonth())),this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min");return a=this._getMinMaxDate(a,"max"),(!c||b.getTime()>=c.getTime())&&(!a||b.getTime()<=a.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){return b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear),b=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay)),this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}}),d.fn.datepicker=function(a){if(!this.length)return this;d.datepicker.initialized||(d(document).mousedown(d.datepicker._checkExternalClick).find("body").append(d.datepicker.dpDiv),d.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);return typeof a!="string"||a!="isDisabled"&&a!="getDate"&&a!="widget"?a=="option"&&arguments.length==2&&typeof arguments[1]=="string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b)):this.each(function(){typeof a=="string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this].concat(b)):d.datepicker._attachDatepicker(this,a)}):d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b))},d.datepicker=new M,d.datepicker.initialized=!1,d.datepicker.uuid=(new Date).getTime(),d.datepicker.version="1.8.14",window["DP_jQuery_"+A]=d}(jQuery),function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove(),a.Widget.prototype.destroy.apply(this,arguments)},value:function(a){return a===b?this._value():(this._setOption("value",a),this)},_setOption:function(b,c){b==="value"&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;return typeof a!="number"&&(a=0),Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change")),this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%"),this.element.attr("aria-valuenow",a)}}),a.extend(a.ui.progressbar,{version:"1.8.14"})}(jQuery),jQuery.effects||function(a,b){function c(b){var c;return b&&b.constructor==Array&&b.length==3?b:(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))?[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]:(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))?[parseFloat(c[1])*2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55]:(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))?[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]:/rgba\(0, 0, 0, 0\)/.exec(b)?j.transparent:j[a.trim(b).toLowerCase()]}function d(b,d){var e;do{e=a.curCSS(b,d);if(e!=""&&e!="transparent"||a.nodeName(b,"body"))break;d="backgroundColor"}while(b=b.parentNode);return c(e)}function e(){var a=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,d;if(a&&a.length&&a[0]&&a[a[0]])for(var e=a.length;e--;)c=a[e],typeof a[c]=="string"&&(d=c.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),b[d]=a[c]);else for(c in a)typeof a[c]=="string"&&(b[c]=a[c]);return b}function f(b){var c,d;for(c in b)d=b[c],(d==null||a.isFunction(d)||c in l||/scrollbar/.test(c)||!/color/i.test(c)&&isNaN(parseFloat(d)))&&delete b[c];return b}function g(a,b){var c={_:0},d;for(d in b)a[d]!=b[d]&&(c[d]=b[d]);return c}function h(b,c,d,e){typeof b=="object"&&(e=c,d=null,c=b,b=c.effect),a.isFunction(c)&&(e=c,d=null,c={});if(typeof c=="number"||a.fx.speeds[c])e=d,d=c,c={};return a.isFunction(d)&&(e=d,d=null),c=c||{},d=d||c.duration,d=a.fx.off?0:typeof d=="number"?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,e=e||c.complete,[b,c,d,e]}function i(b){return!b||typeof b=="number"||a.fx.speeds[b]?!0:typeof b=="string"&&!a.effects[b]?!0:!1}a.effects={},a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(b,e){a.fx.step[e]=function(a){a.colorInit||(a.start=d(a.elem,e),a.end=c(a.end),a.colorInit=!0),a.elem.style[e]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var j={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},k=["add","remove","toggle"],l={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.effects.animateClass=function(b,c,d,h){return a.isFunction(d)&&(h=d,d=null),this.queue(function(){var i=a(this),j=i.attr("style")||" ",l=f(e.call(this)),m,n=i.attr("class");a.each(k,function(a,c){b[c]&&i[c+"Class"](b[c])}),m=f(e.call(this)),i.attr("class",n),i.animate(g(l,m),{queue:!1,duration:c,easing:d,complete:function(){a.each(k,function(a,c){b[c]&&i[c+"Class"](b[c])}),typeof i.attr("style")=="object"?(i.attr("style").cssText="",i.attr("style").cssText=j):i.attr("style",j),h&&h.apply(this,arguments),a.dequeue(this)}})})},a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{add:b},c,d,e]):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{remove:b},c,d,e]):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,g){return typeof d=="boolean"||d===b?e?a.effects.animateClass.apply(this,[d?{add:c}:{remove:c},e,f,g]):this._toggleClass(c,d):a.effects.animateClass.apply(this,[{toggle:c},d,e,f])},switchClass:function(b,c,d,e,f){return a.effects.animateClass.apply(this,[{add:c,remove:b},d,e,f])}}),a.extend(a.effects,{version:"1.8.14",save:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.data("ec.storage."+b[c],a[0].style[b[c]])},restore:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.css(b[c],a.data("ec.storage."+b[c]))},setMode:function(a,b){return b=="toggle"&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":a=0;break;case"center":a=.5;break;case"right":a=1;break;default:a=a[1]/b.width}return{x:a,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});return b.wrap(d),d=b.parent(),b.css("position")=="static"?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),d.css(c).show()},removeWrapper:function(a){return a.parent().is(".ui-effects-wrapper")?a.parent().replaceWith(a):a},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){unit=b.cssUnit(c),unit[0]>0&&(e[c]=unit[0]*d+unit[1])}),e}}),a.fn.extend({effect:function(b){var c=h.apply(this,arguments),d={options:c[1],duration:c[2],callback:c[3]};c=d.options.mode;var e=a.effects[b];return a.fx.off||!e?c?this[c](d.duration,d.callback):this.each(function(){d.callback&&d.callback.call(this)}):e.call(this,d)},_show:a.fn.show,show:function(a){if(i(a))return this._show.apply(this,arguments);var b=h.apply(this,arguments);return b[1].mode="show",this.effect.apply(this,b)},_hide:a.fn.hide,hide:function(a){if(i(a))return this._hide.apply(this,arguments);var b=h.apply(this,arguments);return b[1].mode="hide",this.effect.apply(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(i(b)||typeof b=="boolean"||a.isFunction(b))return this.__toggle.apply(this,arguments);var c=h.apply(this,arguments);return c[1].mode="toggle",this.effect.apply(this,c)},cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}}),a.easing.jswing=a.easing.swing,a.extend(a.easing,{def:"easeOutQuad",swing:function(b,c,d,e,f){return a.easing[a.easing.def](b,c,d,e,f)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b==0?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){a=1.70158;var f=0,g=d;return b==0?c:(b/=e)==1?c+d:(f||(f=e*.3),g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g),-(g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f))+c)},easeOutElastic:function(a,b,c,d,e){a=1.70158;var f=0,g=d;return b==0?c:(b/=e)==1?c+d:(f||(f=e*.3),g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g),g*Math.pow(2,-10*b)*Math.sin((b*e-a)*2*Math.PI/f)+d+c)},easeInOutElastic:function(a,b,c,d,e){a=1.70158;var f=0,g=d;return b==0?c:(b/=e/2)==2?c+d:(f||(f=e*.3*1.5),g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g),b<1?-0.5*g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)+c:g*Math.pow(2,-10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)*.5+d+c)},easeInBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),e*(c/=f)*c*((g+1)*c-g)+d},easeOutBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),e*((c=c/f-1)*c*((g+1)*c+g)+1)+d},easeInOutBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),(c/=f/2)<1?e/2*c*c*(((g*=1.525)+1)*c-g)+d:e/2*((c-=2)*c*(((g*=1.525)+1)*c+g)+2)+d},easeInBounce:function(b,c,d,e,f){return e-a.easing.easeOutBounce(b,f-c,0,e,f)+d},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(b,c,d,e,f){return c<f/2?a.easing.easeInBounce(b,c*2,0,e,f)*.5+d:a.easing.easeOutBounce(b,c*2-f,0,e,f)*.5+e*.5+d}})}(jQuery),function(a){a.effects.blind=function(c){return this.queue(function(){var d=a(this),e=["position","top","bottom","left","right"],f=a.effects.setMode(d,c.options.mode||"hide"),g=c.options.direction||"vertical";a.effects.save(d,e),d.show();var h=a.effects.createWrapper(d).css({overflow:"hidden"}),i=g=="vertical"?"height":"width";g=g=="vertical"?h.height():h.width(),f=="show"&&h.css(i,0);var j={};j[i]=f=="show"?g:0,h.animate(j,c.duration,c.options.easing,function(){f=="hide"&&d.hide(),a.effects.restore(d,e),a.effects.removeWrapper(d),c.callback&&c.callback.apply(d[0],arguments),d.dequeue()})})}}(jQuery),function(a){a.effects.bounce=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],f=a.effects.setMode(c,b.options.mode||"effect"),g=b.options.direction||"up",h=b.options.distance||20,i=b.options.times||5,j=b.duration||250;/show|hide/.test(f)&&d.push("opacity"),a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var k=g=="up"||g=="down"?"top":"left";g=g=="up"||g=="left"?"pos":"neg",h=b.options.distance||(k=="top"?c.outerHeight({margin:!0})/3:c.outerWidth({margin:!0})/3),f=="show"&&c.css("opacity",0).css(k,g=="pos"?-h:h),f=="hide"&&(h/=i*2),f!="hide"&&i--;if(f=="show"){var l={opacity:1};l[k]=(g=="pos"?"+=":"-=")+h,c.animate(l,j/2,b.options.easing),h/=2,i--}for(l=0;l<i;l++){var m={},n={};m[k]=(g=="pos"?"-=":"+=")+h,n[k]=(g=="pos"?"+=":"-=")+h,c.animate(m,j/2,b.options.easing).animate(n,j/2,b.options.easing),h=f=="hide"?h*2:h/2}f=="hide"?(l={opacity:0},l[k]=(g=="pos"?"-=":"+=")+h,c.animate(l,j/2,b.options.easing,function(){c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})):(m={},n={},m[k]=(g=="pos"?"-=":"+=")+h,n[k]=(g=="pos"?"+=":"-=")+h,c.animate(m,j/2,b.options.easing).animate(n,j/2,b.options.easing,function(){a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})),c.queue("fx",function(){c.dequeue()}),c.dequeue()})}}(jQuery),function(a){a.effects.clip=function(c){return this.queue(function(){var d=a(this),f=["position","top","bottom","left","right","height","width"],g=a.effects.setMode(d,c.options.mode||"hide"),h=c.options.direction||"vertical";a.effects.save(d,f),d.show();var i=a.effects.createWrapper(d).css({overflow:"hidden"});i=d[0].tagName=="IMG"?i:d;var j={size:h=="vertical"?"height":"width",position:h=="vertical"?"top":"left"};h=h=="vertical"?i.height():i.width(),g=="show"&&(i.css(j.size,0),i.css(j.position,h/2));var k={};k[j.size]=g=="show"?h:0,k[j.position]=g=="show"?0:h/2,i.animate(k,{queue:!1,duration:c.duration,easing:c.options.easing,complete:function(){g=="hide"&&d.hide(),a.effects.restore(d,f),a.effects.removeWrapper(d),c.callback&&c.callback.apply(d[0],arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.drop=function(b){return this.queue(function(){var e=a(this),f=["position","top","bottom","left","right","opacity"],g=a.effects.setMode(e,b.options.mode||"hide"),h=b.options.direction||"left";a.effects.save(e,f),e.show(),a.effects.createWrapper(e);var i=h=="up"||h=="down"?"top":"left";h=h=="up"||h=="left"?"pos":"neg";var j=b.options.distance||(i=="top"?e.outerHeight({margin:!0})/2:e.outerWidth({margin:!0})/2);g=="show"&&e.css("opacity",0).css(i,h=="pos"?-j:j);var k={opacity:g=="show"?1:0};k[i]=(g=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+j,e.animate(k,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){g=="hide"&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),b.callback&&b.callback.apply(this,arguments),e.dequeue()}})})}}(jQuery),function(a){a.effects.explode=function(b){return this.queue(function(){var c=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3,d=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3;b.options.mode=b.options.mode=="toggle"?a(this).is(":visible")?"hide":"show":b.options.mode;var e=a(this).show().css("visibility","hidden"),f=e.offset();f.top-=parseInt(e.css("marginTop"),10)||0,f.left-=parseInt(e.css("marginLeft"),10)||0;for(var g=e.outerWidth(!0),h=e.outerHeight(!0),i=0;i<c;i++)for(var k=0;k<d;k++)e.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-k*(g/d),top:-i*(h/c)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:g/d,height:h/c,left:f.left+k*(g/d)+(b.options.mode=="show"?(k-Math.floor(d/2))*(g/d):0),top:f.top+i*(h/c)+(b.options.mode=="show"?(i-Math.floor(c/2))*(h/c):0),opacity:b.options.mode=="show"?0:1}).animate({left:f.left+k*(g/d)+(b.options.mode=="show"?0:(k-Math.floor(d/2))*(g/d)),top:f.top+i*(h/c)+(b.options.mode=="show"?0:(i-Math.floor(c/2))*(h/c)),opacity:b.options.mode=="show"?1:0},b.duration||500);setTimeout(function(){b.options.mode=="show"?e.css({visibility:"visible"}):e.css({visibility:"visible"}).hide(),b.callback&&b.callback.apply(e[0]),e.dequeue(),a("div.ui-effects-explode").remove()},b.duration||500)})}}(jQuery),function(a){a.effects.fade=function(c){return this.queue(function(){var d=a(this),e=a.effects.setMode(d,c.options.mode||"hide");d.animate({opacity:e},{queue:!1,duration:c.duration,easing:c.options.easing,complete:function(){c.callback&&c.callback.apply(this,arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.fold=function(b){return this.queue(function(){var d=a(this),e=["position","top","bottom","left","right"],f=a.effects.setMode(d,b.options.mode||"hide"),g=b.options.size||15,h=!!b.options.horizFirst,i=b.duration?b.duration/2:a.fx.speeds._default/2;a.effects.save(d,e),d.show();var j=a.effects.createWrapper(d).css({overflow:"hidden"}),k=f=="show"!=h,l=k?["width","height"]:["height","width"];k=k?[j.width(),j.height()]:[j.height(),j.width()];var m=/([0-9]+)%/.exec(g);m&&(g=parseInt(m[1],10)/100*k[f=="hide"?0:1]),f=="show"&&j.css(h?{height:0,width:g}:{height:g,width:0}),h={},m={},h[l[0]]=f=="show"?k[0]:g,m[l[1]]=f=="show"?k[1]:0,j.animate(h,i,b.options.easing).animate(m,i,b.options.easing,function(){f=="hide"&&d.hide(),a.effects.restore(d,e),a.effects.removeWrapper(d),b.callback&&b.callback.apply(d[0],arguments),d.dequeue()})})}}(jQuery),function(a){a.effects.highlight=function(c){return this.queue(function(){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,c.options.mode||"show"),g={backgroundColor:d.css("backgroundColor")};f=="hide"&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:c.options.color||"#ffff99"}).animate(g,{queue:!1,duration:c.duration,easing:c.options.easing,complete:function(){f=="hide"&&d.hide(),a.effects.restore(d,e),f=="show"&&!a.support.opacity&&this.style.removeAttribute("filter"),c.callback&&c.callback.apply(this,arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.pulsate=function(b){return this.queue(function(){var c=a(this),e=a.effects.setMode(c,b.options.mode||"show");times=(b.options.times||5)*2-1,duration=b.duration?b.duration/2:a.fx.speeds._default/2,isVisible=c.is(":visible"),animateTo=0,isVisible||(c.css("opacity",0).show(),animateTo=1),(e=="hide"&&isVisible||e=="show"&&!isVisible)&&times--;for(e=0;e<times;e++)c.animate({opacity:animateTo},duration,b.options.easing),animateTo=(animateTo+1)%2;c.animate({opacity:animateTo},duration,b.options.easing,function(){animateTo==0&&c.hide(),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}).dequeue()})}}(jQuery),function(a){a.effects.puff=function(b){return this.queue(function(){var d=a(this),e=a.effects.setMode(d,b.options.mode||"hide"),f=parseInt(b.options.percent,10)||150,g=f/100,h={height:d.height(),width:d.width()};a.extend(b.options,{fade:!0,mode:e,percent:e=="hide"?f:100,from:e=="hide"?h:{height:h.height*g,width:h.width*g}}),d.effect("scale",b.options,b.duration,b.callback),d.dequeue()})},a.effects.scale=function(b){return this.queue(function(){var d=a(this),e=a.extend(!0,{},b.options),f=a.effects.setMode(d,b.options.mode||"effect"),g=parseInt(b.options.percent,10)||(parseInt(b.options.percent,10)==0?0:f=="hide"?0:100),h=b.options.direction||"both",i=b.options.origin;f!="effect"&&(e.origin=i||["middle","center"],e.restore=!0),i={height:d.height(),width:d.width()},d.from=b.options.from||(f=="show"?{height:0,width:0}:i),g={y:h!="horizontal"?g/100:1,x:h!="vertical"?g/100:1},d.to={height:i.height*g.y,width:i.width*g.x},b.options.fade&&(f=="show"&&(d.from.opacity=0,d.to.opacity=1),f=="hide"&&(d.from.opacity=1,d.to.opacity=0)),e.from=d.from,e.to=d.to,e.mode=f,d.effect("size",e,b.duration,b.callback),d.dequeue()})},a.effects.size=function(b){return this.queue(function(){var d=a(this),e=["position","top","bottom","left","right","width","height","overflow","opacity"],f=["position","top","bottom","left","right","overflow","opacity"],g=["width","height","overflow"],h=["fontSize"],i=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],j=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],k=a.effects.setMode(d,b.options.mode||"effect"),l=b.options.restore||!1,m=b.options.scale||"both",n=b.options.origin,o={height:d.height(),width:d.width()};d.from=b.options.from||o,d.to=b.options.to||o,n&&(n=a.effects.getBaseline(n,o),d.from.top=(o.height-d.from.height)*n.y,d.from.left=(o.width-d.from.width)*n.x,d.to.top=(o.height-d.to.height)*n.y,d.to.left=(o.width-d.to.width)*n.x);var p={from:{y:d.from.height/o.height,x:d.from.width/o.width},to:{y:d.to.height/o.height,x:d.to.width/o.width}};if(m=="box"||m=="both")p.from.y!=p.to.y&&(e=e.concat(i),d.from=a.effects.setTransition(d,i,p.from.y,d.from),d.to=a.effects.setTransition(d,i,p.to.y,d.to)),p.from.x!=p.to.x&&(e=e.concat(j),d.from=a.effects.setTransition(d,j,p.from.x,d.from),d.to=a.effects.setTransition(d,j,p.to.x,d.to));(m=="content"||m=="both")&&p.from.y!=p.to.y&&(e=e.concat(h),d.from=a.effects.setTransition(d,h,p.from.y,d.from),d.to=a.effects.setTransition(d,h,p.to.y,d.to)),a.effects.save(d,l?e:f),d.show(),a.effects.createWrapper(d),d.css("overflow","hidden").css(d.from);if(m=="content"||m=="both")i=i.concat(["marginTop","marginBottom"]).concat(h),j=j.concat(["marginLeft","marginRight"]),g=e.concat(i).concat(j),d.find("*[width]").each(function(){child=a(this),l&&a.effects.save(child,g);var d={height:child.height(),width:child.width()};child.from={height:d.height*p.from.y,width:d.width*p.from.x},child.to={height:d.height*p.to.y,width:d.width*p.to.x},p.from.y!=p.to.y&&(child.from=a.effects.setTransition(child,i,p.from.y,child.from),child.to=a.effects.setTransition(child,i,p.to.y,child.to)),p.from.x!=p.to.x&&(child.from=a.effects.setTransition(child,j,p.from.x,child.from),child.to=a.effects.setTransition(child,j,p.to.x,child.to)),child.css(child.from),child.animate(child.to,b.duration,b.options.easing,function(){l&&a.effects.restore(child,g)})});d.animate(d.to,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){d.to.opacity===0&&d.css("opacity",d.from.opacity),k=="hide"&&d.hide(),a.effects.restore(d,l?e:f),a.effects.removeWrapper(d),b.callback&&b.callback.apply(this,arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.shake=function(b){return this.queue(function(){var c=a(this),e=["position","top","bottom","left","right"];a.effects.setMode(c,b.options.mode||"effect");var f=b.options.direction||"left",g=b.options.distance||20,h=b.options.times||3,i=b.duration||b.options.duration||140;a.effects.save(c,e),c.show(),a.effects.createWrapper(c);var j=f=="up"||f=="down"?"top":"left",k=f=="up"||f=="left"?"pos":"neg";f={};var l={},m={};f[j]=(k=="pos"?"-=":"+=")+g,l[j]=(k=="pos"?"+=":"-=")+g*2,m[j]=(k=="pos"?"-=":"+=")+g*2,c.animate(f,i,b.options.easing);for(g=1;g<h;g++)c.animate(l,i,b.options.easing).animate(m,i,b.options.easing);c.animate(l,i,b.options.easing).animate(f,i/2,b.options.easing,function(){a.effects.restore(c,e),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}),c.dequeue()})}}(jQuery),function(a){a.effects.slide=function(b){return this.queue(function(){var e=a(this),f=["position","top","bottom","left","right"],g=a.effects.setMode(e,b.options.mode||"show"),h=b.options.direction||"left";a.effects.save(e,f),e.show(),a.effects.createWrapper(e).css({overflow:"hidden"});var i=h=="up"||h=="down"?"top":"left";h=h=="up"||h=="left"?"pos":"neg";var j=b.options.distance||(i=="top"?e.outerHeight({margin:!0}):e.outerWidth({margin:!0}));g=="show"&&e.css(i,h=="pos"?isNaN(j)?"-"+j:-j:j);var k={};k[i]=(g=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+j,e.animate(k,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){g=="hide"&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),b.callback&&b.callback.apply(this,arguments),e.dequeue()}})})}}(jQuery),function(a){a.effects.transfer=function(b){return this.queue(function(){var c=a(this),d=a(b.options.to),f=d.offset();d={top:f.top,left:f.left,height:d.innerHeight(),width:d.innerWidth()},f=c.offset();var g=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:f.top,left:f.left,height:c.innerHeight(),width:c.innerWidth(),position:"absolute"}).animate(d,b.duration,b.options.easing,function(){g.remove(),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}}(jQuery),define("web/js/lib/jquery/ui/js/jquery-ui.min.js",function(){}),function(a,b,c){function d(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function e(a,b){for(var d in b)a[d]===c&&(a[d]=b[d]);return a}function f(a,b){for(var c in b)a.style[g(a,c)||c]=b[c];return a}function g(a,b){var d=a.style,e,f;if(d[b]!==c)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(f=0;f<k.length;f++){e=k[f]+b;if(d[e]!==c)return e}}function h(a,b,c,d){var e=["opacity",b,~~(a*100),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=m.substring(0,m.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(n.insertRule("@"+i+"keyframes "+e+"{"+"0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+g+"}"+"}",0),l[e]=1),e}function i(a,b,c){return c&&!c.parentNode&&i(a,c),a.insertBefore(b,c||null),a}function j(a,c){var d=b.createElement(a||"div"),e;for(e in c)d[e]=c[e];return d}var k=["webkit","Moz","ms","O"],l={},m;i(b.getElementsByTagName("head")[0],j("style"));var n=b.styleSheets[b.styleSheets.length-1],o=function q(a){if(!this.spin)return new q(a);this.opts=e(a||{},{lines:12,length:7,width:5,radius:10,color:"#000",speed:1,trail:100,opacity:.25,fps:20})},p=o.prototype={spin:function(a){this.stop();var b=this,c=b.el=f(j(),{position:"relative"}),e,g;a&&(g=d(i(a,c,a.firstChild)),e=d(c),f(c,{left:(a.offsetWidth>>1)-e.x+g.x+"px",top:(a.offsetHeight>>1)-e.y+g.y+"px"})),c.setAttribute("aria-role","progressbar"),b.lines(c,b.opts);if(!m){var h=b.opts,k=0,l=h.fps,n=l/h.speed,o=(1-h.opacity)/(n*h.trail/100),p=n/h.lines;(function q(){k++;for(var a=h.lines;a;a--){var d=Math.max(1-(k+a*p)%n*o,h.opacity);b.opacity(c,h.lines-a,d,h)}b.timeout=b.el&&setTimeout(q,~~(1e3/l))})()}return b},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this}};p.lines=function(a,b){function c(a,c){return f(j(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*d)+"deg) translate("+b.radius+"px"+",0)",borderRadius:(b.width>>1)+"px"})}var d=0,e;for(;d<b.lines;d++)e=f(j(),{position:"absolute",top:1+~(b.width/2)+"px",transform:"translate3d(0,0,0)",opacity:b.opacity,animation:m&&h(b.opacity,b.trail,d,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&i(e,f(c("#000","0 0 4px #000"),{top:"2px"})),i(a,i(e,c(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},p.opacity=function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)},function(){var a=f(j("group"),{behavior:"url(#default#VML)"}),b;if(!g(a,"transform")&&a.adj){for(b=4;b--;)n.addRule(["group","roundrect","fill","stroke"][b],"behavior:url(#default#VML)");p.lines=function(a,b){function c(a,c,g){i(h,i(f(d(),{rotation:360/b.lines*a+"deg",left:~~c}),i(f(j("roundrect",{arcsize:1}),{width:e,height:b.width,left:b.radius,top:-b.width>>1,filter:g}),j("fill",{color:b.color,opacity:b.opacity}),j("stroke",{opacity:0}))))}function d(){return f(j("group",{coordsize:g+" "+g,coordorigin:-e+" "+ -e}),{width:g,height:g})}var e=b.length+b.width,g=2*e,h=d(),k=~(b.length+b.radius+b.width)+"px",l;if(b.shadow)for(l=1;l<=b.lines;l++)c(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=b.lines;l++)c(l);return i(f(a,{margin:k+" 0 0 "+k,zoom:1}),h)},p.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}else m=g(a,"animation")}(),a.Spinner=o}(window,document),define("web/js/lib/spin.js",function(){});var swfobject=function(){function A(){if(t)return;try{var a=i.getElementsByTagName("body")[0].appendChild(Q("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;var c=l.length;for(var d=0;d<c;d++)l[d]()}function B(a){t?a():l[l.length]=a}function C(b){if(typeof h.addEventListener!=a)h.addEventListener("load",b,!1);else if(typeof i.addEventListener!=a)i.addEventListener("load",b,!1);else if(typeof h.attachEvent!=a)R(h,"onload",b);else if(typeof h.onload=="function"){var c=h.onload;h.onload=function(){c(),b()}}else h.onload=b}function D(){k?E():F()}function E(){var c=i.getElementsByTagName("body")[0],d=Q(b);d.setAttribute("type",e);var f=c.appendChild(d);if(f){var g=0;(function(){if(typeof f.GetVariable!=a){var b=f.GetVariable("$version");b&&(b=b.split(" ")[1].split(","),y.pv=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)])}else if(g<10){g++,setTimeout(arguments.callee,10);return}c.removeChild(d),f=null,F()})()}else F()}function F(){var b=m.length;if(b>0)for(var c=0;c<b;c++){var d=m[c].id,e=m[c].callbackFn,f={success:!1,id:d};if(y.pv[0]>0){var g=P(d);if(g)if(S(m[c].swfVersion)&&!(y.wk&&y.wk<312))U(d,!0),e&&(f.success=!0,f.ref=G(d),e(f));else if(m[c].expressInstall&&H()){var h={};h.data=m[c].expressInstall,h.width=g.getAttribute("width")||"0",h.height=g.getAttribute("height")||"0",g.getAttribute("class")&&(h.styleclass=g.getAttribute("class")),g.getAttribute("align")&&(h.align=g.getAttribute("align"));var i={},j=g.getElementsByTagName("param"),k=j.length;for(var l=0;l<k;l++)j[l].getAttribute("name").toLowerCase()!="movie"&&(i[j[l].getAttribute("name")]=j[l].getAttribute("value"));I(h,i,d,e)}else J(g),e&&e(f)}else{U(d,!0);if(e){var n=G(d);n&&typeof n.SetVariable!=a&&(f.success=!0,f.ref=n),e(f)}}}}function G(c){var d=null,e=P(c);if(e&&e.nodeName=="OBJECT")if(typeof e.SetVariable!=a)d=e;else{var f=e.getElementsByTagName(b)[0];f&&(d=f)}return d}function H(){return!u&&S("6.0.65")&&(y.win||y.mac)&&!(y.wk&&y.wk<312)}function I(b,c,d,e){u=!0,r=e||null,s={success:!1,id:d};var g=P(d);if(g){g.nodeName=="OBJECT"?(p=K(g),q=null):(p=g,q=d),b.id=f;if(typeof b.width==a||!/%$/.test(b.width)&&parseInt(b.width,10)<310)b.width="310";if(typeof b.height==a||!/%$/.test(b.height)&&parseInt(b.height,10)<137)b.height="137";i.title=i.title.slice(0,47)+" - Flash Player Installation";var j=y.ie&&y.win?"ActiveX":"PlugIn",k="MMredirectURL="+h.location.toString().replace(/&/g,"%26")+"&MMplayerType="+j+"&MMdoctitle="+i.title;typeof c.flashvars!=a?c.flashvars+="&"+k:c.flashvars=k;if(y.ie&&y.win&&g.readyState!=4){var l=Q("div");d+="SWFObjectNew",l.setAttribute("id",d),g.parentNode.insertBefore(l,g),g.style.display="none",function(){g.readyState==4?g.parentNode.removeChild(g):setTimeout(arguments.callee,10)}()}L(b,c,d)}}function J(a){if(y.ie&&y.win&&a.readyState!=4){var b=Q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(K(a),b),a.style.display="none",function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(K(a),a)}function K(a){var c=Q("div");if(y.win&&y.ie)c.innerHTML=a.innerHTML;else{var d=a.getElementsByTagName(b)[0];if(d){var e=d.childNodes;if(e){var f=e.length;for(var g=0;g<f;g++)(e[g].nodeType!=1||e[g].nodeName!="PARAM")&&e[g].nodeType!=8&&c.appendChild(e[g].cloneNode(!0))}}}return c}function L(c,d,f){var g,h=P(f);if(y.wk&&y.wk<312)return g;if(h){typeof c.id==a&&(c.id=f);if(y.ie&&y.win){var i="";for(var j in c)c[j]!=Object.prototype[j]&&(j.toLowerCase()=="data"?d.movie=c[j]:j.toLowerCase()=="styleclass"?i+=' class="'+c[j]+'"':j.toLowerCase()!="classid"&&(i+=" "+j+'="'+c[j]+'"'));var k="";for(var l in d)d[l]!=Object.prototype[l]&&(k+='<param name="'+l+'" value="'+d[l]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+k+"</object>",n[n.length]=c.id,g=P(c.id)}else{var m=Q(b);m.setAttribute("type",e);for(var o in c)c[o]!=Object.prototype[o]&&(o.toLowerCase()=="styleclass"?m.setAttribute("class",c[o]):o.toLowerCase()!="classid"&&m.setAttribute(o,c[o]));for(var p in d)d[p]!=Object.prototype[p]&&p.toLowerCase()!="movie"&&M(m,p,d[p]);h.parentNode.replaceChild(m,h),g=m}}return g}function M(a,b,c){var d=Q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function N(a){var b=P(a);b&&b.nodeName=="OBJECT"&&(y.ie&&y.win?(b.style.display="none",function(){b.readyState==4?O(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function O(a){var b=P(a);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}function P(a){var b=null;try{b=i.getElementById(a)}catch(c){}return b}function Q(a){return i.createElement(a)}function R(a,b,c){a.attachEvent(b,c),o[o.length]=[a,b,c]}function S(a){var b=y.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function T(c,d,e,f){if(y.ie&&y.mac)return;var g=i.getElementsByTagName("head")[0];if(!g)return;var h=e&&typeof e=="string"?e:"screen";f&&(v=null,w=null);if(!v||w!=h){var j=Q("style");j.setAttribute("type","text/css"),j.setAttribute("media",h),v=g.appendChild(j),y.ie&&y.win&&typeof i.styleSheets!=a&&i.styleSheets.length>0&&(v=i.styleSheets[i.styleSheets.length-1]),w=h}y.ie&&y.win?v&&typeof v.addRule==b&&v.addRule(c,d):v&&typeof i.createTextNode!=a&&v.appendChild(i.createTextNode(c+" {"+d+"}"))}function U(a,b){if(!x)return;var c=b?"visible":"hidden";t&&P(a)?P(a).style.visibility=c:T("#"+a,"visibility:"+c)}function V(b){var c=/[\\\"<>\.;]/,d=c.exec(b)!=null;return d&&typeof encodeURIComponent!=a?encodeURIComponent(b):b}var a="undefined",b="object",c="Shockwave Flash",d="ShockwaveFlash.ShockwaveFlash",e="application/x-shockwave-flash",f="SWFObjectExprInst",g="onreadystatechange",h=window,i=document,j=navigator,k=!1,l=[D],m=[],n=[],o=[],p,q,r,s,t=!1,u=!1,v,w,x=!0,y=function(){var f=typeof i.getElementById!=a&&typeof i.getElementsByTagName!=a&&typeof i.createElement!=a,g=j.userAgent.toLowerCase(),l=j.platform.toLowerCase(),m=l?/win/.test(l):/win/.test(g),n=l?/mac/.test(l):/mac/.test(g),o=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,p=!1,q=[0,0,0],r=null;if(typeof j.plugins!=a&&typeof j.plugins[c]==b)r=j.plugins[c].description,r&&(typeof j.mimeTypes==a||!j.mimeTypes[e]||!!j.mimeTypes[e].enabledPlugin)&&(k=!0,p=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),q[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),q[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof h.ActiveXObject!=a)try{var s=new ActiveXObject(d);s&&(r=s.GetVariable("$version"),r&&(p=!0,r=r.split(" ")[1].split(","),q=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(t){}return{w3:f,pv:q,wk:o,ie:p,win:m,mac:n}}(),z=function(){if(!y.w3)return;(typeof i.readyState!=a&&i.readyState=="complete"||typeof i.readyState==a&&(i.getElementsByTagName("body")[0]||i.body))&&A(),t||(typeof i.addEventListener!=a&&i.addEventListener("DOMContentLoaded",A,!1),y.ie&&y.win&&(i.attachEvent(g,function(){i.readyState=="complete"&&(i.detachEvent(g,arguments.callee),A())}),h==top&&function(){if(t)return;try{i.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}A()}()),y.wk&&function(){if(t)return;if(!/loaded|complete/.test(i.readyState)){setTimeout(arguments.callee,0);return}A()}(),C(A))}(),W=function(){y.ie&&y.win&&window.attachEvent("onunload",function(){var a=o.length;for(var b=0;b<a;b++)o[b][0].detachEvent(o[b][1],o[b][2]);var c=n.length;for(var d=0;d<c;d++)N(n[d]);for(var e in y)y[e]=null;y=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(y.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,m[m.length]=e,U(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(y.w3)return G(a)},embedSWF:function(c,d,e,f,g,h,i,j,k,l){var m={success:!1,id:d};y.w3&&!(y.wk&&y.wk<312)&&c&&d&&e&&f&&g?(U(d,!1),B(function(){e+="",f+="";var n={};if(k&&typeof k===b)for(var o in k)n[o]=k[o];n.data=c,n.width=e,n.height=f;var p={};if(j&&typeof j===b)for(var q in j)p[q]=j[q];if(i&&typeof i===b)for(var r in i)typeof p.flashvars!=a?p.flashvars+="&"+r+"="+i[r]:p.flashvars=r+"="+i[r];if(S(g)){var s=L(n,p,d);n.id==d&&U(d,!0),m.success=!0,m.ref=s}else{if(h&&H()){n.data=h,I(n,p,d,l);return}U(d,!0)}l&&l(m)})):l&&l(m)},switchOffAutoHideShow:function(){x=!1},ua:y,getFlashPlayerVersion:function(){return{major:y.pv[0],minor:y.pv[1],release:y.pv[2]}},hasFlashPlayerVersion:S,createSWF:function(a,b,c){return y.w3?L(a,b,c):undefined},showExpressInstall:function(a,b,c,d){y.w3&&H()&&I(a,b,c,d)},removeSWF:function(a){y.w3&&N(a)},createCSS:function(a,b,c,d){y.w3&&T(a,b,c,d)},addDomLoadEvent:B,addLoadEvent:C,getQueryParamValue:function(a){var b=i.location.search||i.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return V(b);var c=b.split("&");for(var d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return V(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(u){var a=P(f);a&&p&&(a.parentNode.replaceChild(p,a),q&&(U(q,!0),y.ie&&y.win&&(p.style.display="block")),r&&r(s)),u=!1}}}}();define("web/js/lib/swfobject.js",function(){}),function(){var a=jQuery;window.VS||(window.VS={}),VS.app||(VS.app={}),VS.ui||(VS.ui={}),VS.model||(VS.model={}),VS.utils||(VS.utils={}),VS.VERSION="0.2.2",VS.VisualSearch=function(b){var c={container:"",query:"",unquotable:[],remainder:"text",callbacks:{search:a.noop,focus:a.noop,blur:a.noop,facetMatches:a.noop,valueMatches:a.noop}};this.options=_.extend({},c,b),this.options.callbacks=_.extend({},c.callbacks,b.callbacks),VS.app.hotkeys.initialize(),this.searchQuery=new VS.model.SearchQuery,this.searchBox=new VS.ui.SearchBox({app:this});if(b.container){var d=this.searchBox.render().el;a(this.options.container).html(d)}return this.searchBox.value(this.options.query||""),a(window).bind("unload",function(a){}),this},VS.init=function(a){return new VS.VisualSearch(a)}}(),function(){var a=jQuery;VS.ui.SearchBox=Backbone.View.extend({id:"search",events:{"click .VS-cancel-search-box":"clearSearch","mousedown .VS-search-box":"maybeFocusSearch","dblclick .VS-search-box":"highlightSearch","click .VS-search-box":"maybeTripleClick"},initialize:function(){this.app=this.options.app,this.flags={allSelected:!1},this.facetViews=[],this.inputViews=[],_.bindAll(this,"renderFacets","_maybeDisableFacets","disableFacets","deselectAllFacets","addedFacet","removedFacet","changedFacet"),this.app.searchQuery.bind("reset",this.renderFacets).bind("add",this.addedFacet).bind("remove",this.removedFacet).bind("change",this.changedFacet),a(document).bind("keydown",this._maybeDisableFacets)},render:function(){return a(this.el).append(JST.search_box({})),a(document.body).setMode("no","search"),this},value:function(a){return a==null?this.serialize():this.setQuery(a)},serialize:function(){var a=[],b=this.inputViews.length;return this.app.searchQuery.each(_.bind(function(b,c){a.push(this.inputViews[c].value()),a.push(b.serialize())},this)),b&&a.push(this.inputViews[b-1].value()),_.compact(a).join(" ")},setQuery:function(a){this.currentQuery=a,VS.app.SearchParser.parse(this.app,a)},viewPosition:function(a){var b=a.type=="facet"?this.facetViews:this.inputViews,c=_.indexOf(b,a);return c==-1&&(c=0),c},searchEvent:function(a){var b=this.value();this.focusSearch(a),this.value(b),this.app.options.callbacks.search(b,this.app.searchQuery)},addFacet:function(a,b,c){a=VS.utils.inflector.trim(a),b=VS.utils.inflector.trim(b||"");if(!a)return;var d=new VS.model.SearchFacet({category:a,value:b||"",app:this.app});this.app.searchQuery.add(d,{at:c})},addedFacet:function(a){this.renderFacets();var b=_.detect(this.facetViews,function(b){if(b.model==a)return!0});_.defer(function(){b.enableEdit()})},changedFacet:function(){this.renderFacets()},removedFacet:function(a,b,c){},renderFacets:function(){this.facetViews=[],this.inputViews=[],this.$(".VS-search-inner").empty(),this.app.searchQuery.each(_.bind(this.renderFacet,this)),this.renderSearchInput()},renderFacet:function(a,b){var c=new VS.ui.SearchFacet({app:this.app,model:a,order:b});return this.renderSearchInput(),this.facetViews.push(c),this.$(".VS-search-inner").children().eq(b*2).after(c.render().el),c.calculateSize(),_.defer(_.bind(c.calculateSize,c)),c},renderSearchInput:function(){var a=new VS.ui.SearchInput({position:this.inputViews.length,app:this.app});this.$(".VS-search-inner").append(a.render().el),this.inputViews.push(a)},clearSearch:function(a){var b=_.bind(function(){this.disableFacets(),this.value(""),this.flags.allSelected=!1,this.searchEvent(a),this.focusSearch(a)},this);this.app.options.callbacks.clearSearch?this.app.options.callbacks.clearSearch(b):b()},selectAllFacets:function(){this.flags.allSelected=!0,a(document).one("click.selectAllFacets",this.deselectAllFacets),_.each(this.facetViews,function(a,b){a.selectFacet()}),_.each(this.inputViews,function(a,b){a.selectText()})},allSelected:function(a){return a&&(this.flags.allSelected=!1),this.flags.allSelected},deselectAllFacets:function(b){this.disableFacets();if(this.$(b.target).is(".category,input")){var c=a(b.target).closest(".search_facet,.search_input"),d=_.detect(this.facetViews.concat(this.inputViews),function(a){return a.el==c[0]});d.type=="facet"?d.selectFacet():d.type=="input"&&_.defer(function(){d.enableEdit(!0)})}},disableFacets:function(b){_.each(this.inputViews,function(a){a&&a!=b&&(a.modes.editing=="is"||a.modes.selected=="is")&&a.disableEdit()}),_.each(this.facetViews,function(a){a&&a!=b&&(a.modes.editing=="is"||a.modes.selected=="is")&&(a.disableEdit(),a.deselectFacet())}),this.flags.allSelected=!1,this.removeFocus(),a(document).unbind("click.selectAllFacets")},resizeFacets:function(a){_.each(this.facetViews,function(b,c){(!a||b==a)&&b.resize()})},_maybeDisableFacets:function(a){if(this.flags.allSelected&&VS.app.hotkeys.key(a)=="backspace")return a.preventDefault(),this.clearSearch(a),!1;this.flags.allSelected&&VS.app.hotkeys.printable(a)&&this.clearSearch(a)},focusNextFacet:function(a,b,c){c=c||{};var d=this.facetViews.length,e=c.viewPosition||this.viewPosition(a);c.skipToFacet?c.skipToFacet&&a.type=="text"&&d==e&&b>=0&&(e=0,b=0):(a.type=="text"&&b>0&&(b-=1),a.type=="facet"&&b<0&&(b+=1));var f,g=Math.min(d,e+b);a.type=="text"?(g>=0&&g<d?f=this.facetViews[g]:g==d&&(f=this.inputViews[this.inputViews.length-1]),f&&c.selectFacet&&f.type=="facet"?f.selectFacet():f&&(f.enableEdit(),f.setCursorAtEnd(b||c.startAtEnd))):a.type=="facet"&&(c.skipToFacet?g>=d||g<0?(f=_.last(this.inputViews),f.enableEdit()):(f=this.facetViews[g],f.enableEdit(),f.setCursorAtEnd(b||c.startAtEnd)):(f=this.inputViews[g],f.enableEdit())),c.selectText&&f.selectText(),this.resizeFacets()},maybeFocusSearch:function(b){(a(b.target).is(".VS-search-box")||a(b.target).is(".VS-search-inner")||b.type=="keydown")&&this.focusSearch(b)},focusSearch:function(a,b){var c=this.inputViews[this.inputViews.length-1];c.enableEdit(b),b||c.setCursorAtEnd(-1),a.type=="keydown"&&(c.keydown(a),c.box.trigger("keydown")),_.defer(_.bind(function(){this.$("input:focus").length||c.enableEdit(b)},this))},highlightSearch:function(b){if(a(b.target).is(".VS-search-box")||a(b.target).is(".VS-search-inner")||b.type=="keydown"){var c=this.inputViews[this.inputViews.length-1];c.startTripleClickTimer(),this.focusSearch(b,!0)}},maybeTripleClick:function(a){var b=this.inputViews[this.inputViews.length-1];return b.maybeTripleClick(a)},addFocus:function(){this.app.options.callbacks.focus(),this.$(".VS-search-box").addClass("VS-focus")},removeFocus:function(){this.app.options.callbacks.blur();var a=_.any(this.facetViews.concat(this.inputViews),function(a){return a.isFocused()});a||this.$(".VS-search-box").removeClass("VS-focus")},showFacetCategoryMenu:function(a){a.preventDefault(),a.stopPropagation();if(this.facetCategoryMenu&&this.facetCategoryMenu.modes.open=="is")return this.facetCategoryMenu.close();var b=[{title:"Account",onClick:_.bind(this.addFacet,this,"account","")},{title:"Project",onClick:_.bind(this.addFacet,this,"project","")},{title:"Filter",onClick:_.bind(this.addFacet,this,"filter","")},{title:"Access",onClick:_.bind(this.addFacet,this,"access","")}],c=this.facetCategoryMenu||(this.facetCategoryMenu=new dc.ui.Menu({items:b,standalone:!0}));return this.$(".VS-icon-search").after(c.render().open().content),!1}})}(),function(){var a=jQuery;VS.ui.SearchFacet=Backbone.View.extend({type:"facet",className:"search_facet",events:{"click .category":"selectFacet","keydown input":"keydown","mousedown input":"enableEdit","mouseover .VS-icon-cancel":"showDelete","mouseout .VS-icon-cancel":"hideDelete","click .VS-icon-cancel":"remove"},initialize:function(a){this.flags={canClose:!1},_.bindAll(this,"set","keydown","deselectFacet","deferDisableEdit")},render:function(){return a(this.el).html(JST.search_facet({model:this.model})),this.setMode("not","editing"),this.setMode("not","selected"),this.box=this.$("input"),this.box.val(this.model.get("value")),this.box.bind("blur",this.deferDisableEdit),this.box.bind("input propertychange",this.keydown),this.setupAutocomplete(),this},calculateSize:function(){this.box.autoGrowInput(),this.box.unbind("updated.autogrow"),this.box.bind("updated.autogrow",_.bind(this.moveAutocomplete,this))},resize:function(a){this.box.trigger("resize.autogrow",a)},setupAutocomplete:function(){this.box.autocomplete({source:_.bind(this.autocompleteValues,this),minLength:0,delay:0,autoFocus:!0,position:{offset:"0 5"},create:_.bind(function(b,c){a(this.el).find(".ui-autocomplete-input").css("z-index","auto")},this),select:_.bind(function(a,b){a.preventDefault();var c=this.model.get("value");return this.set(b.item.value),(c!=b.item.value||this.box.val()!=b.item.value)&&this.search(a),!1},this),open:_.bind(function(b,c){var d=this.box;this.box.autocomplete("widget").find(".ui-menu-item").each(function(){var b=a(this);b.data("item.autocomplete")["value"]==d.val()&&d.data("autocomplete").menu.activate(new a.Event("mouseover"),b)})},this)}),this.box.autocomplete("widget").addClass("VS-interface")},moveAutocomplete:function(){var a=this.box.data("autocomplete");a&&a.menu.element.position({my:"left top",at:"left bottom",of:this.box.data("autocomplete").element,collision:"flip",offset:"0 5"})},searchAutocomplete:function(a){var b=this.box.data("autocomplete");if(b){var c=b.menu.element;b.search(),c.outerWidth(Math.max(c.width("").outerWidth(),b.element.outerWidth()))}},closeAutocomplete:function(){var a=this.box.data("autocomplete");a&&a.close()},autocompleteValues:function(b,c){var d=this.model.get("category"),e=this.model.get("value"),f=b.term;this.options.app.options.callbacks.valueMatches(d,f,function(b,d){d=d||{},b=b||[];if(f&&e!=f){if(d.preserveMatches)return b;var g=VS.utils.inflector.escapeRegExp(f||""),h=new RegExp("\\b"+g,"i");b=a.grep(b,function(a){return h.test(a)||h.test(a.value)||h.test(a.label)})}d.preserveOrder?c(b):c(_.sortBy(b,function(a){return a==e||a.value==e?"":a}))})},set:function(a){if(!a)return;this.model.set({value:a})},search:function(a,b){b||(b=1),this.closeAutocomplete(),this.options.app.searchBox.searchEvent(a),_.defer(_.bind(function(){this.options.app.searchBox.focusNextFacet(this,b,{viewPosition:this.options.order})},this))},enableEdit:function(){this.modes.editing!="is"&&(this.setMode("is","editing"),this.deselectFacet(),this.box.val()==""&&this.box.val(this.model.get("value"))),this.flags.canClose=!1,this.options.app.searchBox.disableFacets(this),this.options.app.searchBox.addFocus(),_.defer(_.bind(function(){this.options.app.searchBox.addFocus()},this)),this.resize(),this.searchAutocomplete(),this.box.focus()},deferDisableEdit:function(){this.flags.canClose=!0,_.delay(_.bind(function(){this.flags.canClose&&!this.box.is(":focus")&&this.modes.editing=="is"&&this.modes.selected!="is"&&this.disableEdit()},this),250)},disableEdit:function(){var a=VS.utils.inflector.trim(this.box.val());a!=this.model.get("value")&&this.set(a),this.flags.canClose=!1,this.box.selectRange(0,0),this.box.blur(),this.setMode("not","editing"),this.closeAutocomplete(),this.options.app.searchBox.removeFocus()},selectFacet:function(b){b&&b.preventDefault();var c=this.options.app.searchBox.allSelected();if(this.modes.selected=="is")return;this.box.is(":focus")&&(this.box.setCursorPosition(0),this.box.blur()),this.flags.canClose=!1,this.closeAutocomplete(),this.setMode("is","selected"),this.setMode("not","editing");if(!c||b)a(document).unbind("keydown.facet",this.keydown),a(document).unbind("click.facet",this.deselectFacet),_.defer(_.bind(function(){a(document).unbind("keydown.facet").bind("keydown.facet",this.keydown),a(document).unbind("click.facet").one("click.facet",this.deselectFacet)},this)),this.options.app.searchBox.disableFacets(this),this.options.app.searchBox.addFocus();return!1},deselectFacet:function(b){return b&&b.preventDefault(),this.modes.selected=="is"&&(this.setMode("not","selected"),this.closeAutocomplete(),this.options.app.searchBox.removeFocus()),a(document).unbind("keydown.facet",this.keydown),a(document).unbind("click.facet",this.deselectFacet),!1},isFocused:function(){return this.box.is(":focus")},showDelete:function(){a(this.el).addClass("search_facet_maybe_delete")},hideDelete:function(){a(this.el).removeClass("search_facet_maybe_delete")},setCursorAtEnd:function(a){a==-1?this.box.setCursorPosition(this.box.val().length):this.box.setCursorPosition(0)},remove:function(a){var b=this.model.get("value");this.deselectFacet(),this.disableEdit(),this.options.app.searchQuery.remove(this.model),b?this.search(a,-1):(this.options.app.searchBox.renderFacets(),this.options.app.searchBox.focusNextFacet(this,-1,{viewPosition:this.options.order}))},selectText:function(){this.box.selectRange(0,this.box.val().length)},keydown:function(a){var b=VS.app.hotkeys.key(a);if(b=="enter"&&this.box.val())this.disableEdit(),this.search(a);else if(b=="left")this.modes.selected=="is"?(this.deselectFacet(),this.options.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1})):this.box.getCursorPosition()==0&&!this.box.getSelection().length&&this.selectFacet();else if(b=="right")this.modes.selected=="is"?(a.preventDefault(),this.deselectFacet(),this.setCursorAtEnd(0),this.enableEdit()):this.box.getCursorPosition()==this.box.val().length&&(a.preventDefault(),this.disableEdit(),this.options.app.searchBox.focusNextFacet(this,1));else if(VS.app.hotkeys.shift&&b=="tab")a.preventDefault(),this.options.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1,skipToFacet:!0,selectText:!0});else if(b=="tab")a.preventDefault(),this.options.app.searchBox.focusNextFacet(this,1,{skipToFacet:!0,selectText:!0});else{if(!(!VS.app.hotkeys.command||a.which!=97&&a.which!=65))return a.preventDefault(),this.options.app.searchBox.selectAllFacets(),!1;VS.app.hotkeys.printable(a)&&this.modes.selected=="is"?(this.options.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1}),this.remove(a)):b=="backspace"&&(this.modes.selected=="is"?(a.preventDefault(),this.remove(a)):this.box.getCursorPosition()==0&&!this.box.getSelection().length&&(a.preventDefault(),this.selectFacet()))}this.resize(a),a.which==null&&(this.searchAutocomplete(a),_.defer(_.bind(this.resize,this,a)))}})}(),function(){var a=jQuery;VS.ui.SearchInput=Backbone.View.extend({type:"text",className:"search_input",events:{"keypress input":"keypress","keydown input":"keydown","click input":"maybeTripleClick","dblclick input":"startTripleClickTimer"},initialize:function(){this.app=this.options.app,this.flags={canClose:!1},_.bindAll(this,"removeFocus","addFocus","moveAutocomplete","deferDisableEdit")},render:function(){return a(this.el).html(JST.search_input({})),this.setMode("not","editing"),this.setMode("not","selected"),this.box=this.$("input"),this.box.autoGrowInput(),this.box.bind("updated.autogrow",this.moveAutocomplete),this.box.bind("blur",this.deferDisableEdit),this.box.bind("focus",this.addFocus),this.setupAutocomplete(),this},setupAutocomplete:function(){this.box.autocomplete({minLength:1,delay:50,autoFocus:!0,position:{offset:"0 -1"},source:_.bind(this.autocompleteValues,this),create:_.bind(function(b,c){a(this.el).find(".ui-autocomplete-input").css("z-index","auto")},this),select:_.bind(function(a,b){a.preventDefault(),a.stopPropagation();var c=this.addTextFacetRemainder(b.item.value),d=this.options.position+(c?1:0);return this.app.searchBox.addFacet(b.item.value,"",d),!1},this)}),this.box.data("autocomplete")._renderMenu=function(a,b){var c="";_.each(b,_.bind(function(b,d){b.category&&b.category!=c&&(a.append('<li class="ui-autocomplete-category">'+b.category+"</li>"),c=b.category),this._renderItem(a,b)},this))},this.box.autocomplete("widget").addClass("VS-interface")},autocompleteValues:function(b,c){var d=b.term,e=d.match(/\w+$/),f=VS.utils.inflector.escapeRegExp(e&&e[0]||" ");this.app.options.callbacks.facetMatches(function(b,d){d=d||{},b=b||[];var e=new RegExp("^"+f,"i"),g=a.grep(b,function(a){return a&&e.test(a.label||a)});d.preserveOrder?c(g):c(_.sortBy(g,function(a){return a.label?a.category+"-"+a.label:a}))})},closeAutocomplete:function(){var a=this.box.data("autocomplete");a&&a.close()},moveAutocomplete:function(){var a=this.box.data("autocomplete");a&&a.menu.element.position({my:"left top",at:"left bottom",of:this.box.data("autocomplete").element,collision:"none",offset:"0 -1"})},searchAutocomplete:function(a){var b=this.box.data("autocomplete");if(b){var c=b.menu.element;b.search(),c.outerWidth(Math.max(c.width("").outerWidth(),b.element.outerWidth()))}},addTextFacetRemainder:function(a){var b=this.box.val(),c=b.match(/\b(\w+)$/),d=new RegExp(c[0],"i");return c&&a.search(d)==0&&(b=b.replace(/\b(\w+)$/,"")),b=b.replace("^s+|s+$",""),b&&this.app.searchBox.addFacet(this.app.options.remainder,b,this.options.position),b},enableEdit:function(a){this.addFocus(),a&&this.selectText(),this.box.focus()},addFocus:function(){this.flags.canClose=!1,this.app.searchBox.allSelected()||this.app.searchBox.disableFacets(this),this.app.searchBox.addFocus(),this.setMode("is","editing"),this.setMode("not","selected"),this.searchAutocomplete()},disableEdit:function(){this.box.blur(),this.removeFocus()},removeFocus:function(){this.flags.canClose=!1,this.app.searchBox.removeFocus(),this.setMode("not","editing"),this.setMode("not","selected"),this.closeAutocomplete()},deferDisableEdit:function(){this.flags.canClose=!0,_.delay(_.bind(function(){this.flags.canClose&&!this.box.is(":focus")&&this.modes.editing=="is"&&this.disableEdit()},this),250)},startTripleClickTimer:function(){this.tripleClickTimer=setTimeout(_.bind(function(){this.tripleClickTimer=null},this),500)},maybeTripleClick:function(a){if(!!this.tripleClickTimer)return a.preventDefault(),this.app.searchBox.selectAllFacets(),!1},isFocused:function(){return this.box.is(":focus")},value:function(){return this.box.val()},setCursorAtEnd:function(a){a==-1?this.box.setCursorPosition(this.box.val().length):this.box.setCursorPosition(0)},selectText:function(){this.box.selectRange(0,this.box.val().length),this.app.searchBox.allSelected()?this.setMode("is","selected"):this.box.focus()},search:function(a,b){b||(b=0),this.closeAutocomplete(),this.app.searchBox.searchEvent(a),_.defer(_.bind(function(){this.app.searchBox.focusNextFacet(this,b)},this))},keypress:function(a){var b=VS.app.hotkeys.key(a);if(b=="enter")return this.search(a,100);if(VS.app.hotkeys.colon(a)){this.box.trigger("resize.autogrow",a);var c=this.box.val(),d=[];this.app.options.callbacks.facetMatches&&this.app.options.callbacks.facetMatches(function(a){d=a});var e=_.map(d,function(a){return a.label?a.label:a});if(_.contains(e,c)){a.preventDefault();var f=this.addTextFacetRemainder(c),g=this.options.position+(f?1:0);return this.app.searchBox.addFacet(c,"",g),!1}}else if(b=="backspace"&&this.box.getCursorPosition()==0&&!this.box.getSelection().length)return a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),this.app.searchBox.resizeFacets(),!1},keydown:function(a){var b=VS.app.hotkeys.key(a);if(b=="left")this.box.getCursorPosition()==0&&(a.preventDefault(),this.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1}));else if(b=="right")this.box.getCursorPosition()==this.box.val().length&&(a.preventDefault(),this.app.searchBox.focusNextFacet(this,1,{selectFacet:!0}));else if(VS.app.hotkeys.shift&&b=="tab")a.preventDefault(),this.app.searchBox.focusNextFacet(this,-1,{selectText:!0});else if(b=="tab"){a.preventDefault();var c=this.box.val();if(c.length){var d=this.addTextFacetRemainder(c),e=this.options.position+(d?1:0);this.app.searchBox.addFacet(c,"",e)}else this.app.searchBox.focusNextFacet(this,0,{skipToFacet:!0,selectText:!0})}else{if(VS.app.hotkeys.command&&String.fromCharCode(a.which).toLowerCase()=="a")return a.preventDefault(),this.app.searchBox.selectAllFacets(),!1;if(b=="backspace"&&!this.app.searchBox.allSelected()&&this.box.getCursorPosition()==0&&!this.box.getSelection().length)return a.preventDefault(),this.app.searchBox.focusNextFacet(this,-1,{backspace:!0}),!1}this.box.trigger("resize.autogrow",a)}})}(),function(){var a=jQuery;Backbone.View.prototype.setMode=function(b,c){this.modes||(this.modes={});if(this.modes[c]===b)return;a(this.el).setMode(b,c),this.modes[c]=b}}(),function(){var a=jQuery;VS.app.hotkeys={KEYS:{16:"shift",17:"command",91:"command",93:"command",224:"command",13:"enter",37:"left",38:"upArrow",39:"right",40:"downArrow",46:"delete",8:"backspace",9:"tab",188:"comma"},initialize:function(){_.bindAll(this,"down","up","blur"),a(document).bind("keydown",this.down),a(document).bind("keyup",this.up),a(window).bind("blur",this.blur)},down:function(a){var b=this.KEYS[a.which];b&&(this[b]=!0)},up:function(a){var b=this.KEYS[a.which];b&&(this[b]=!1)},blur:function(a){for(var b in this.KEYS)this[this.KEYS[b]]=!1},key:function(a){return this.KEYS[a.which]},colon:function(a){var b=a.which;return b&&String.fromCharCode(b)==":"},printable:function(a){var b=a.which;if(a.type=="keydown"){if(b==32||b>=48&&b<=90||b>=96&&b<=111||b>=186&&b<=192||b>=219&&b<=222)return!0}else if(b>=32&&b<=126||b>=160&&b<=500||String.fromCharCode(b)==":")return!0;return!1}}}(),function(){var a=jQuery;VS.utils.inflector={trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},escapeRegExp:function(a){return a.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")}}}(),function(){var a=jQuery;a.fn.extend({setMode:function(a,b){b=b||"mode";var c=new RegExp("\\w+_"+b+"(\\s|$)","g"),d=a===null?"":a+"_"+b;return this.each(function(){this.className=(this.className.replace(c,"")+" "+d).replace(/\s\s/g," ")}),d},autoGrowInput:function(){return this.each(function(){var b=a(this),c=a("<div />").css({opacity:0,top:-9999,left:-9999,position:"absolute",whiteSpace:"nowrap"}).addClass("VS-input-width-tester").addClass("VS-interface"),d="keydown.autogrow keypress.autogrow resize.autogrow change.autogrow";b.next(".VS-input-width-tester").remove(),b.after(c),b.unbind(d).bind(d,function(a,d){d&&(a=d);var e=b.val();if(VS.app.hotkeys.key(a)=="backspace"){var f=b.getCursorPosition();f>0&&(e=e.slice(0,f-1)+e.slice(f,e.length))}else VS.app.hotkeys.printable(a)&&!VS.app.hotkeys.command&&(e+=String.fromCharCode(a.which));e=e.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),c.html(e),b.width(c.width()+3),b.trigger("updated.autogrow")}),b.trigger("resize.autogrow")})},getCursorPosition:function(){var b=0,c=this.get(0);if(document.selection){c.focus();var d=document.selection.createRange(),e=document.selection.createRange().text.length;d.moveStart("character",-c.value.length),b=d.text.length-e}else c&&a(c).is(":visible")&&c.selectionStart!=null&&(b=c.selectionStart);return b},setCursorPosition:function(b){return this.each(function(){return a(this).selectRange(b,b)})},selectRange:function(a,b){return this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(a,b);else if(this.createTextRange){var c=this.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),b-a>=0&&c.select()}})},getSelection:function(){var a=this[0];if(a.selectionStart!=null){var b=a.selectionStart,c=a.selectionEnd;return{start:b,end:c,length:c-b,text:a.value.substr(b,c-b)}}if(document.selection){var d=document.selection.createRange();if(d){var e=a.createTextRange(),f=e.duplicate();e.moveToBookmark(d.getBookmark()),f.setEndPoint("EndToStart",e);var b=f.text.length,c=b+d.text.length;return{start:b,end:c,length:c-b,text:d.text}}}return{start:0,end:0,length:0}}});if(a.browser.msie&&!1){window.console={};var b;window.console.log=function(c){if(_.isArray(c))var d=c[0],e=_.map(c.slice(1),function(a){return JSON.stringify(a)}).join(" - ");b||(b=a("<div><ol></ol></div>").css({position:"fixed",bottom:10,left:10,zIndex:2e4,width:a("body").width()-80,border:"1px solid #000",padding:"10px",backgroundColor:"#fff",fontFamily:"arial,helvetica,sans-serif",fontSize:"11px"}),a("body").append(b));var f=a("<li>"+d+" - "+e+"</li>").css({borderBottom:"1px solid #999999"});b.find("ol").append(f),_.delay(function(){f.fadeOut(500)},5e3)}}}(),function(){var a=jQuery,b="('[^']+'|\"[^\"]+\")",c="('[^']+'|\"[^\"]+\"|[^'\"\\s]\\S*)",d=c+":\\s*";VS.app.SearchParser={ALL_FIELDS:new RegExp(d+c,"g"),CATEGORY:new RegExp(d),parse:function(a,b){var c=this._extractAllFacets(a,b);return a.searchQuery.reset(c),c},_extractAllFacets:function(a,b){var c=[],d=b;while(b){var e,f;d=b;var g=this._extractNextField(b);g?g.indexOf(":")!=-1?(e=g.match(this.CATEGORY)[1].replace(/(^['"]|['"]$)/g,""),f=g.replace(this.CATEGORY,"").replace(/(^['"]|['"]$)/g,""),b=VS.utils.inflector.trim(b.replace(g,""))):g.indexOf(":")==-1&&(e=a.options.remainder,f=g,b=VS.utils.inflector.trim(b.replace(f,""))):(e=a.options.remainder,f=this._extractSearchText(b),b=VS.utils.inflector.trim(b.replace(f,"")));if(e&&f){var h=new VS.model.SearchFacet({category:e,value:VS.utils.inflector.trim(f),app:a});c.push(h)}if(d==b)break}return c},_extractNextField:function(a){var d=new RegExp("^\\s*(\\S+)\\s+(?="+b+c+")"),e=a.match(d);return e&&e.length>=1?e[1]:this._extractFirstField(a)},_extractFirstField:function(a){var b=a.match(this.ALL_FIELDS);return b&&b.length&&b[0]},_extractSearchText:function(a){a=a||"";var b=VS.utils.inflector.trim(a.replace(this.ALL_FIELDS,""));return b}}}(),function(){var a=jQuery;VS.model.SearchFacet=Backbone.Model.extend({serialize:function(){var a=this.quoteCategory(this.get("category")),b=VS.utils.inflector.trim(this.get("value")),c=this.get("app").options.remainder;return b?(!_.contains(this.get("app").options.unquotable||[],a)&&a!=c&&(b=this.quoteValue(b)),a!=c?a+=": ":a="",a+b):""},quoteCategory:function(a){var b=/"/.test(a),c=/'/.test(a),d=/\s/.test(a);return b&&!c?"'"+a+"'":d||c&&!b?'"'+a+'"':a},quoteValue:function(a){var b=/"/.test(a),c=/'/.test(a);return b&&!c?"'"+a+"'":'"'+a+'"'}})}(),function(){var a=jQuery;VS.model.SearchQuery=Backbone.Collection.extend({model:VS.model.SearchFacet,serialize:function(){return this.map(function(a){return a.serialize()}).join(" ")},facets:function(){return this.map(function(a){var b={};return b[a.get("category")]=a.get("value"),b})},find:function(a){var b=this.detect(function(b){return b.get("category")==a});return b&&b.get("value")},count:function(a){return this.select(function(b){return b.get("category")==a}).length},values:function(a){var b=this.select(function(b){return b.get("category")==a});return _.map(b,function(a){return a.get("value")})},has:function(a,b){return this.any(function(c){var d=c.get("category")==a;return b?d&&c.get("value")==b:d})},withoutCategory:function(a){return this.map(function(b){if(b.get("category")!=a)return b.serialize()}).join(" ")}})}(),function(){window.JST=window.JST||{},window.JST.search_box=_.template('<div class="VS-search">\n  <div class="VS-search-box-wrapper VS-search-box">\n    <div class="VS-icon VS-icon-search"></div>\n    <div class="VS-search-inner"></div>\n    <div class="VS-icon VS-icon-cancel VS-cancel-search-box" title="clear search"></div>\n  </div>\n</div>'),window.JST.search_facet=_.template('<% if (model.has(\'category\')) { %>\n  <div class="category"><%= model.get(\'category\') %>:</div>\n<% } %>\n\n<div class="search_facet_input_container">\n  <input type="text" class="search_facet_input VS-interface" value="" />\n</div>\n\n<div class="search_facet_remove VS-icon VS-icon-cancel"></div>'),window.JST.search_input=_.template('<input type="text" />')}(),define("web/js/lib/visualsearch.js",function(){}),function(a){var b={VERSION:"0.2",ROOT_URL:function(){for(var a=document.getElementsByTagName("script"),b=/^(.*\/)leaflet-?([\w-]*)\.js.*$/,c=0,d=a.length;c<d;c++){var e=a[c].src;if(e=e&&e.match(b)){if(e[2]=="include")break;return e[1]}}return"../../dist/"}(),noConflict:function(){return a.L=this._originalL,this},_originalL:a.L};window.L=b}(this),L.Util={extend:function(a){for(var b=Array.prototype.slice.call(arguments,1),c=0,d=b.length,e;c<d;c++){e=b[c]||{};for(var f in e)e.hasOwnProperty(f)&&(a[f]=e[f])}return a},bind:function(a,b){return function(){return a.apply(b,arguments)}},stamp:function(){var a=0;return function(b){return b._leaflet_id=b._leaflet_id||++a,b._leaflet_id}}(),requestAnimFrame:function(){function a(a){window.setTimeout(a,1e3/60)}var b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||a;return function(c,d,e){c=d?L.Util.bind(c,d):d,e&&b===a?c():b(c)}}(),limitExecByInterval:function(a,b,c){function d(){e=!1,f&&(g.callee.apply(c,g),f=!1)}var e,f,g;return function(){g=arguments,e?f=!0:(e=!0,setTimeout(d,b),a.apply(c,g))}},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},setOptions:function(a,b){a.options=L.Util.extend({},a.options,b)},getParamString:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return"?"+b.join("&")}},L.Class=function(){},L.Class.extend=function(a){var b=function(){!L.Class._prototyping&&this.initialize&&this.initialize.apply(this,arguments)};L.Class._prototyping=!0;var c=new this;L.Class._prototyping=!1,c.constructor=b,b.prototype=c,c.superclass=this.prototype,a.statics&&(L.Util.extend(b,a.statics),delete a.statics),a.includes&&(L.Util.extend.apply(null,[c].concat(a.includes)),delete a.includes),a.options&&c.options&&(a.options=L.Util.extend({},c.options,a.options)),L.Util.extend(c,a),b.extend=arguments.callee,b.include=function(a){L.Util.extend(this.prototype,a)};for(var d in this)this.hasOwnProperty(d)&&d!="prototype"&&(b[d]=this[d]);return b},L.Mixin={},L.Mixin.Events={addEventListener:function(a,b,c){var d=this._leaflet_events=this._leaflet_events||{};return d[a]=d[a]||[],d[a].push({action:b,context:c}),this},hasEventListeners:function(a){return"_leaflet_events"in this&&a in this._leaflet_events&&this._leaflet_events[a].length>0},removeEventListener:function(a,b,c){if(!this.hasEventListeners(a))return this;for(var d=0,e=this._leaflet_events,f=e[a].length;d<f;d++)if(e[a][d].action===b&&(!c||e[a][d].context===c)){e[a].splice(d,1);break}return this},fireEvent:function(a,b){if(this.hasEventListeners(a)){for(var c=L.Util.extend({type:a,target:this},b),d=this._leaflet_events[a].slice(),e=0,f=d.length;e<f;e++)d[e].action.call(d[e].context||this,c);return this}}},L.Mixin.Events.on=L.Mixin.Events.addEventListener,L.Mixin.Events.off=L.Mixin.Events.removeEventListener,L.Mixin.Events.fire=L.Mixin.Events.fireEvent,function(){var a=navigator.userAgent.toLowerCase(),b=!!window.ActiveXObject,c=a.indexOf("webkit")!=-1,d=a.indexOf("mobi")!=-1,e=a.indexOf("android")!=-1,f=window.opera;L.Browser={ie:b,ie6:b&&!window.XMLHttpRequest,webkit:c,webkit3d:c&&"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,mobileWebkit:c&&(d||e),mobileOpera:d&&f,gecko:a.indexOf("gecko")!=-1,android:e},L.Browser.touch=L.Browser.mobileWebkit||L.Browser.mobileOpera}(),L.Point=function(a,b,c){this.x=c?Math.round(a):a,this.y=c?Math.round(b):b},L.Point.prototype={add:function(a){return this.clone()._add(a)},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(a)},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a,b){return new L.Point(this.x/a,this.y/a,b)},multiplyBy:function(a){return new L.Point(this.x*a,this.y*a)},distanceTo:function(a){var b=a.x-this.x,a=a.y-this.y;return Math.sqrt(b*b+a*a)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},clone:function(){return new L.Point(this.x,this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}},L.Bounds=L.Class.extend({initialize:function(a,b){if(a)for(var c=a instanceof Array?a:[a,b],d=0,e=c.length;d<e;d++)this.extend(c[d])},extend:function(a){!this.min&&!this.max?(this.min=new L.Point(a.x,a.y),this.max=new L.Point(a.x,a.y)):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y))},getCenter:function(a){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},contains:function(a){var b;return a instanceof L.Bounds&&(b=a.min,a=a.max),b.x>=this.min.x&&a.x<=this.max.x&&b.y>=this.min.y&&a.y<=this.max.y}}),L.Transformation=L.Class.extend({initialize:function(a,b,c,d){this._a=a,this._b=b,this._c=c,this._d=d},transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new L.Point((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}}),L.LineUtil={simplify:function(a,b){return b?(a=this.reducePoints(a,b),a=this.simplifyDP(a,b)):a.slice()},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqPointToSegmentDist(a,b,c))},simplifyDP:function(a,b){for(var c=0,d=0,e=b*b,f=1,g=a.length,h;f<g-1;f++)h=this._sqPointToSegmentDist(a[f],a[0],a[g-1]),h>c&&(d=f,c=h);return c>=e?(c=a.slice(0,d),d=a.slice(d),g=this.simplifyDP(c,b).slice(0,g-2),d=this.simplifyDP(d,b),g.concat(d)):[a[0],a[g-1]]},reducePoints:function(a,b){for(var c=[a[0]],d=b*b,e=1,f=0,g=a.length;e<g;e++)this._sqDist(a[e],a[f])<d||(c.push(a[e]),f=e);return f<g-1&&c.push(a[g-1]),c},clipSegment:function(a,b,c,d){var d=d?this._lastCode:this._getBitCode(a,c),e=this._getBitCode(b,c);for(this._lastCode=e;;){if(!(d|e))return[a,b];if(d&e)return!1;var f=d||e,g=this._getEdgeIntersection(a,b,f,c),h=this._getBitCode(g,c);f==d?(a=g,d=h):(b=g,e=h)}},_getEdgeIntersection:function(a,b,c,d){var e=b.x-a.x,b=b.y-a.y,f=d.min,d=d.max;if(c&8)return new L.Point(a.x+e*(d.y-a.y)/b,d.y);if(c&4)return new L.Point(a.x+e*(f.y-a.y)/b,f.y);if(c&2)return new L.Point(d.x,a.y+b*(d.x-a.x)/e);if(c&1)return new L.Point(f.x,a.y+b*(f.x-a.x)/e)},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqPointToSegmentDist:function(a,b,c){var d=c.x-b.x,e=c.y-b.y;if(!d&&!e)return this._sqDist(a,b);var f=((a.x-b.x)*d+(a.y-b.y)*e)/this._sqDist(b,c);return f<0?this._sqDist(a,b):f>1?this._sqDist(a,c):(b=new L.Point(b.x+d*f,b.y+e*f),this._sqDist(a,b))}},L.PolyUtil={},L.PolyUtil.clipPolygon=function(a,b){var c,d=[1,4,2,8],e,f,g,h,i,j,k=L.LineUtil;e=0;for(i=a.length;e<i;e++)a[e]._code=k._getBitCode(a[e],b);for(g=0;g<4;g++){j=d[g],c=[],e=0,i=a.length;for(f=i-1;e<i;f=e++)(h=a[e],f=a[f],h._code&j)?f._code&j||(f=k._getEdgeIntersection(f,h,j,b),f._code=k._getBitCode(f,b),c.push(f)):(f._code&j&&(f=k._getEdgeIntersection(f,h,j,b),f._code=k._getBitCode(f,b),c.push(f)),c.push(h));a=c}return a},L.DomEvent={addListener:function(a,b,c,d){function e(b){return c.call(d||a,b||L.DomEvent._getEvent())}var f=L.Util.stamp(c);if(L.Browser.touch&&b=="dblclick"&&this.addDoubleTapListener)this.addDoubleTapListener(a,e,f);else if("addEventListener"in a)if(b=="mousewheel")a.addEventListener("DOMMouseScroll",e,!1),a.addEventListener(b,e,!1);else if(b=="mouseenter"||b=="mouseleave"){var g=e,e=function(b){if(L.DomEvent._checkMouse(a,b))return g(b)};a.addEventListener(b=="mouseenter"?"mouseover":"mouseout",e,!1)}else a.addEventListener(b,e,!1);else"attachEvent"in a&&a.attachEvent("on"+b,e);a["_leaflet_"+b+f]=e},removeListener:function(a,b,c){var c=L.Util.stamp(c),d="_leaflet_"+b+c;handler=a[d],L.Browser.mobileWebkit&&b=="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,c):"removeEventListener"in a?b=="mousewheel"?(a.removeEventListener("DOMMouseScroll",handler,!1),a.removeEventListener(b,handler,!1)):b=="mouseenter"||b=="mouseleave"?a.removeEventListener(b=="mouseenter"?"mouseover":"mouseout",handler,!1):a.removeEventListener(b,handler,!1):"detachEvent"in a&&a.detachEvent("on"+b,handler),a[d]=null},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!=a;)c=c.parentNode}catch(d){return!1}return c!=a},_getEvent:function(){var a=window.event;if(!a)for(var b=arguments.callee.caller;b;){if((a=b.arguments[0])&&Event==a.constructor)break;b=b.caller}return a},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},disableClickPropagation:function(a){L.DomEvent.addListener(a,"mousedown",L.DomEvent.stopPropagation),L.DomEvent.addListener(a,"click",L.DomEvent.stopPropagation),L.DomEvent.addListener(a,"dblclick",L.DomEvent.stopPropagation)},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},stop:function(a){L.DomEvent.preventDefault(a),L.DomEvent.stopPropagation(a)},getMousePosition:function(a,b){var c=new L.Point(a.pageX?a.pageX:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.pageY?a.pageY:a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return b?c.subtract(L.DomUtil.getCumulativeOffset(b)):c},getWheelDelta:function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/120),a.detail&&(b=-a.detail/3),b}},L.Util.extend(L.DomEvent,{addDoubleTapListener:function(a,b,c){function d(a){if(a.touches.length==1){var b=Date.now(),c=b-(f||b);i=a.touches[0],g=c>0&&c<=h,f=b}}function e(){g&&(i.type="dblclick",b(i),f=null)}var f,g=!1,h=250,i;a["_leaflet_touchstart"+c]=d,a["_leaflet_touchend"+c]=e,a.addEventListener("touchstart",d,!1),a.addEventListener("touchend",e,!1)},removeDoubleTapListener:function(a,b){a.removeEventListener(a,a["_leaflet_touchstart"+b],!1),a.removeEventListener(a,a["_leaflet_touchend"+b],!1)}}),L.DomUtil={get:function(a){return typeof a=="string"?document.getElementById(a):a},getStyle:function(a,b){var c=a.style[b];!c&&a.currentStyle&&(c=a.currentStyle[b]);if(!c||c=="auto")c=(c=document.defaultView.getComputedStyle(a,null))?c[b]:null;return c=="auto"?null:c},getCumulativeOffset:function(a){var b=0,c=0;do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a);return new L.Point(c,b)},create:function(a,b,c){return a=document.createElement(a),a.className=b,c&&c.appendChild(a),a},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=L.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},CLASS_RE:/(\\s|^)'+cls+'(\\s|$)/,hasClass:function(a,b){return a.className.length>0&&RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className)},addClass:function(a,b){L.DomUtil.hasClass(a,b)||(a.className+=(a.className?" ":"")+b)},setOpacity:function(a,b){L.Browser.ie?a.style.filter="alpha(opacity="+Math.round(b*100)+")":a.style.opacity=b},testProp:function(a){for(var b=document.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1},getTranslateString:function(a){return L.DomUtil.TRANSLATE_OPEN+a.x+"px,"+a.y+"px"+L.DomUtil.TRANSLATE_CLOSE},getScaleString:function(a,b){return L.DomUtil.getTranslateString(b)+" scale("+a+") "+L.DomUtil.getTranslateString(b.multiplyBy(-1))},setPosition:function(a,b){a._leaflet_pos=b,L.Browser.webkit?a.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(b):(a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._leaflet_pos}},L.Util.extend(L.DomUtil,{TRANSITION:L.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:L.DomUtil.testProp(["transformProperty","WebkitTransform","OTransform","MozTransform","msTransform"]),TRANSLATE_OPEN:"translate"+(L.Browser.webkit3d?"3d(":"("),TRANSLATE_CLOSE:L.Browser.webkit3d?",0)":")"}),L.Draggable=L.Class.extend({includes:L.Mixin.Events,statics:{START:L.Browser.touch?"touchstart":"mousedown",END:L.Browser.touch?"touchend":"mouseup",MOVE:L.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(a,b){this._element=a,this._dragStartTarget=b||a},enable:function(){this._enabled||(L.DomEvent.addListener(this._dragStartTarget,L.Draggable.START,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._dragStartTarget,L.Draggable.START,this._onDown),this._enabled=!1)},_onDown:function(a){if(!(a.shiftKey||a.which!=1&&a.button!=1&&!a.touches)&&!(a.touches&&a.touches.length>1)){var b=a.touches&&a.touches.length==1?a.touches[0]:a;L.DomEvent.preventDefault(a),L.Browser.mobileWebkit&&(b.target.className+=" leaflet-active"),this._moved=!1,L.DomUtil.disableTextSelection(),this._setMovingCursor(),this._startPos=this._newPos=L.DomUtil.getPosition(this._element),this._startPoint=new L.Point(b.clientX,b.clientY),L.DomEvent.addListener(document,L.Draggable.MOVE,this._onMove,this),L.DomEvent.addListener(document,L.Draggable.END,this._onUp,this)}},_onMove:function(a){a.touches&&a.touches.length>1||(L.DomEvent.preventDefault(a),a=a.touches&&a.touches.length==1?a.touches[0]:a,this._moved||(this.fire("dragstart"),this._moved=!0),this._newPos=this._startPos.add(new L.Point(a.clientX,a.clientY)).subtract(this._startPoint),L.Util.requestAnimFrame(this._updatePosition,this,!0),this.fire("drag"))},_updatePosition:function(){L.DomUtil.setPosition(this._element,this._newPos)},_onUp:function(a){if(a.changedTouches){var a=a.changedTouches[0],b=a.target,c=this._newPos&&this._newPos.distanceTo(this._startPos)||0;b.className=b.className.replace(" leaflet-active",""),c<L.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",a)}L.DomUtil.enableTextSelection(),this._restoreCursor(),L.DomEvent.removeListener(document,L.Draggable.MOVE,this._onMove),L.DomEvent.removeListener(document,L.Draggable.END,this._onUp),this._moved&&this.fire("dragend")},_removeActiveClass:function(){},_setMovingCursor:function(){this._bodyCursor=document.body.style.cursor,document.body.style.cursor="move"},_restoreCursor:function(){document.body.style.cursor=this._bodyCursor},_simulateEvent:function(a,b){var c=document.createEvent("MouseEvent");c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c)}}),L.Transition=L.Class.extend({includes:L.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:L.DomUtil.setPosition},implemented:function(){return L.Transition.NATIVE||L.Transition.TIMER}},options:{easing:"ease",duration:.5},_setProperty:function(a,b){var c=L.Transition.CUSTOM_PROPS_SETTERS;a in c?c[a](this._el,b):this._el.style[a]=b}}),L.Transition=L.Transition.extend({statics:function(){var a=L.DomUtil.TRANSITION;return{NATIVE:!!a,TRANSITION:a,PROPERTY:a+"Property",DURATION:a+"Duration",EASING:a+"TimingFunction",END:a=="webkitTransition"||a=="OTransition"?a+"End":"transitionend",CUSTOM_PROPS_PROPERTIES:{position:L.Browser.webkit?L.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(a,b){this._el=a,L.Util.setOptions(this,b),L.DomEvent.addListener(a,L.Transition.END,this._onTransitionEnd,this),this._onFakeStep=L.Util.bind(this._onFakeStep,this)},run:function(a){var b,c=[],d=L.Transition.CUSTOM_PROPS_PROPERTIES;for(b in a)a.hasOwnProperty(b)&&(b=d[b]?d[b]:b,b=b.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}),c.push(b));this._el.style[L.Transition.DURATION]=this.options.duration+"s",this._el.style[L.Transition.EASING]=this.options.easing,this._el.style[L.Transition.PROPERTY]=c.join(", ");for(b in a)a.hasOwnProperty(b)&&this._setProperty(b,a[b]);this._inProgress=!0,this.fire("start"),L.Transition.NATIVE?this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval):this._onTransitionEnd()},_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[L.Transition.PROPERTY]="none",this.fire("step"),this.fire("end"))}}),L.Transition=L.Transition.NATIVE?L.Transition:L.Transition.extend({statics:{getTime:Date.now||function(){return+(new Date)},TIMER:!0,EASINGS:{ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},CUSTOM_PROPS_GETTERS:{position:L.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(a,b){this._el=a,L.Util.extend(this.options,b);var c=L.Transition.EASINGS[this.options.easing]||L.Transition.EASINGS.ease;this._p1=new L.Point(0,0),this._p2=new L.Point(c[0],c[1]),this._p3=new L.Point(c[2],c[3]),this._p4=new L.Point(1,1),this._step=L.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(a){this._props={};var b=L.Transition.CUSTOM_PROPS_GETTERS,c=L.Transition.UNIT_RE;this.fire("start");for(var d in a)if(a.hasOwnProperty(d)){var e={};if(d in b)e.from=b[d](this._el);else{var f=this._el.style[d].match(c);e.from=parseFloat(f[0]),e.unit=f[1]}e.to=a[d],this._props[d]=e}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=L.Transition.getTime()},_step:function(){var a=L.Transition.getTime()-this._startTime,b=this.options.duration*1e3;a<b?this._runFrame(this._cubicBezier(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){var b=L.Transition.CUSTOM_PROPS_SETTERS,c,d;for(c in this._props)this._props.hasOwnProperty(c)&&(d=this._props[c],c in b?(d=d.to.subtract(d.from).multiplyBy(a).add(d.from),b[c](this._el,d)):this._el.style[c]=(d.to-d.from)*a+d.from+d.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")},_cubicBezier:function(a){var b=3*Math.pow(1-a,2)*a,c=3*(1-a)*Math.pow(a,2),d=Math.pow(a,3),a=this._p1.multiplyBy(Math.pow(1-a,3)),b=this._p2.multiplyBy(b),c=this._p3.multiplyBy(c),d=this._p4.multiplyBy(d);return a.add(b).add(c).add(d).y}}),L.LatLng=function(a,b,c){c!==!0&&(a=Math.max(Math.min(a,90),-90),b=(b+180)%360+(b<-180?180:-180)),this.lat=a,this.lng=b},L.Util.extend(L.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),L.LatLng.prototype={equals:function(a){return a instanceof L.LatLng?Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=L.LatLng.MAX_MARGIN:!1},toString:function(){return"LatLng("+L.Util.formatNum(this.lat)+", "+L.Util.formatNum(this.lng)+")"}},L.LatLngBounds=L.Class.extend({initialize:function(a,b){if(a)for(var c=a instanceof Array?a:[a,b],d=0,e=c.length;d<e;d++)this.extend(c[d])},extend:function(a){!this._southWest&&!this._northEast?(this._southWest=new L.LatLng(a.lat,a.lng),this._northEast=new L.LatLng(a.lat,a.lng)):(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng))},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new L.LatLng(this._northEast.lat,this._southWest.lng)},getSouthEast:function(){return new L.LatLng(this._southWest.lat,this._northEast.lng)},contains:function(a){var b=this._southWest,c=this._northEast,d;return a instanceof L.LatLngBounds?(d=a.getSouthWest(),a=a.getNorthEast()):d=a,d.lat>=b.lat&&a.lat<=c.lat&&d.lng>=b.lng&&a.lng<=c.lng}}),L.Projection={},L.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(a){var b=L.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,d=a.lng*b,a=Math.max(Math.min(c,a.lat),-c)*b,a=Math.log(Math.tan(Math.PI/4+a/2));return new L.Point(d,a)},unproject:function(a,b){var c=L.LatLng.RAD_TO_DEG;return new L.LatLng((2*Math.atan(Math.exp(a.y))-Math.PI/2)*c,a.x*c,b)}},L.Projection.LonLat={project:function(a){return new L.Point(a.lng,a.lat)},unproject:function(a,b){return new L.LatLng(a.y,a.x,b)}},L.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(a){var b=L.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,d=this.R_MAJOR,e=a.lng*b*d,a=Math.max(Math.min(c,a.lat),-c)*b,b=this.R_MINOR/d,b=Math.sqrt(1-b*b),c=b*Math.sin(a),c=Math.pow((1-c)/(1+c),b*.5),a=-d*Math.log(Math.tan(.5*(Math.PI*.5-a))/c);return new L.Point(e,a)},unproject:function(a,b){for(var c=L.LatLng.RAD_TO_DEG,d=this.R_MAJOR,e=a.x*c/d,f=this.R_MINOR/d,f=Math.sqrt(1-f*f),d=Math.exp(-a.y/d),g=Math.PI/2-2*Math.atan(d),h=15,i=.1;Math.abs(i)>1e-7&&--h>0;)i=f*Math.sin(g),i=Math.PI/2-2*Math.atan(d*Math.pow((1-i)/(1+i),.5*f))-g,g+=i;return new L.LatLng(g*c,e,b)}},L.CRS={latLngToPoint:function(a,b){return this.transformation._transform(this.projection.project(a),b)},pointToLatLng:function(a,b,c){return this.projection.unproject(this.transformation.untransform(a,b),c)},project:function(a){return this.projection.project(a)}},L.CRS.EPSG3857=L.Util.extend({},L.CRS,{code:"EPSG:3857",projection:L.Projection.SphericalMercator,transformation:new L.Transformation(.5/Math.PI,.5,-0.5/Math.PI,.5),project:function(a){return this.projection.project(a).multiplyBy(6378137)}}),L.CRS.EPSG900913=L.Util.extend({},L.CRS.EPSG3857,{code:"EPSG:900913"}),L.CRS.EPSG4326=L.Util.extend({},L.CRS,{code:"EPSG:4326",projection:L.Projection.LonLat,transformation:new L.Transformation(1/360,.5,-1/360,.5)}),L.CRS.EPSG3395=L.Util.extend({},L.CRS,{code:"EPSG:3395",projection:L.Projection.Mercator,transformation:function(){var a=L.Projection.Mercator;return new L.Transformation(.5/(Math.PI*a.R_MAJOR),.5,-0.5/(Math.PI*a.R_MINOR),.5)}()}),L.LayerGroup=L.Class.extend({initialize:function(a){this._layers={};if(a)for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},addLayer:function(a){return this._layers[L.Util.stamp(a)]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){return delete this._layers[L.Util.stamp(a)],this._map&&this._map.removeLayer(a),this},clearLayers:function(){return this._iterateLayers(this.removeLayer,this),this},onAdd:function(a){this._map=a,this._iterateLayers(a.addLayer,a)},onRemove:function(a){this._iterateLayers(a.removeLayer,a),delete this._map},_iterateLayers:function(a,b){for(var c in this._layers)this._layers.hasOwnProperty(c)&&a.call(b,this._layers[c])}}),L.FeatureGroup=L.LayerGroup.extend({includes:L.Mixin.Events,addLayer:function(a){this._initEvents(a),L.LayerGroup.prototype.addLayer.call(this,a),this._popupContent&&a.bindPopup&&a.bindPopup(this._popupContent)},bindPopup:function(a){this._popupContent=a;for(var b in this._layers)this._layers.hasOwnProperty(b)&&this._layers[b].bindPopup&&this._layers[b].bindPopup(a)},_events:["click","dblclick","mouseover","mouseout"],_initEvents:function(a){for(var b=0,c=this._events.length;b<c;b++)a.on(this._events[b],this._propagateEvent,this)},_propagateEvent:function(a){a.layer=a.target,a.target=this,this.fire(a.type,a)}}),L.TileLayer=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,scheme:"xyz",noWrap:!1,unloadInvisibleTiles:L.Browser.mobileWebkit,updateWhenIdle:L.Browser.mobileWebkit},initialize:function(a,b){L.Util.setOptions(this,b),this._url=a,typeof this.options.subdomains=="string"&&(this.options.subdomains=this.options.subdomains.split(""))},onAdd:function(a){this._map=a,this._initContainer(),this._createTileProto(),a.on("viewreset",this._reset,this),this.options.updateWhenIdle?a.on("moveend",this._update,this):(this._limitedUpdate=L.Util.limitExecByInterval(this._update,100,this),a.on("move",this._limitedUpdate,this)),this._reset(),this._update()},onRemove:function(){this._map.getPanes().tilePane.removeChild(this._container),this._container=null,this._map.off("viewreset",this._reset,this),this.options.updateWhenIdle?this._map.off("moveend",this._update,this):this._map.off("move",this._limitedUpdate,this)},getAttribution:function(){return this.options.attribution},setOpacity:function(a){this.options.opacity=a,this._setOpacity(a);if(L.Browser.webkit)for(i in this._tiles)this._tiles[i].style.webkitTransform+=" translate(0,0)"},_setOpacity:function(a){a<1&&L.DomUtil.setOpacity(this._container,a)},_initContainer:function(){var a=this._map.getPanes().tilePane;if(!this._container||a.empty)this._container=L.DomUtil.create("div","leaflet-layer",a),this._setOpacity(this.options.opacity)},_reset:function(){this._tiles={},this._initContainer(),this._container.innerHTML=""},_update:function(){var a=this._map.getPixelBounds(),b=this.options.tileSize,c=new L.Point(Math.floor(a.min.x/b),Math.floor(a.min.y/b)),a=new L.Point(Math.floor(a.max.x/b),Math.floor(a.max.y/b)),c=new L.Bounds(c,a);this._addTilesFromCenterOut(c),this.options.unloadInvisibleTiles&&this._removeOtherTiles(c)},_addTilesFromCenterOut:function(a){for(var b=[],c=a.getCenter(),d=a.min.y;d<=a.max.y;d++)for(var e=a.min.x;e<=a.max.x;e++)e+":"+d in this._tiles||b.push(new L.Point(e,d));b.sort(function(a,b){return a.distanceTo(c)-b.distanceTo(c)}),this._tilesToLoad=b.length,a=0;for(d=this._tilesToLoad;a<d;a++)this._addTile(b[a])},_removeOtherTiles:function(a){var b,c,d;for(d in this._tiles)this._tiles.hasOwnProperty(d)&&(b=d.split(":"),c=parseInt(b[0],10),b=parseInt(b[1],10),c<a.min.x||c>a.max.x||b<a.min.y||b>a.max.y)&&(this._tiles[d].src="",this._tiles[d].parentNode==this._container&&this._container.removeChild(this._tiles[d]),delete this._tiles[d])},_addTile:function(a){var b=this._getTilePos(a),c=this._map.getZoom(),d=a.x+":"+a.y,e=1<<c;this.options.noWrap||(a.x=(a.x%e+e)%e);if(!(a.y<0||a.y>=e)){var f=this._createTile();L.DomUtil.setPosition(f,b),this._tiles[d]=f,this.options.scheme=="tms"&&(a.y=e-a.y-1),this._loadTile(f,a,c),this._container.appendChild(f)}},_getTilePos:function(a){var b=this._map.getPixelOrigin();return a.multiplyBy(this.options.tileSize).subtract(b)},getTileUrl:function(a,b){return this._url.replace("{s}",this.options.subdomains[(a.x+a.y)%this.options.subdomains.length]).replace("{z}",b).replace("{x}",a.x).replace("{y}",a.y)},_createTileProto:function(){this._tileImg=L.DomUtil.create("img","leaflet-tile"),this._tileImg.galleryimg="no";var a=this.options.tileSize;this._tileImg.style.width=a+"px",this._tileImg.style.height=a+"px"},_createTile:function(){var a=this._tileImg.cloneNode(!1);return a.onselectstart=a.onmousemove=L.Util.falseFn,a},_loadTile:function(a,b,c){a._layer=this,a.onload=this._tileOnLoad,a.onerror=this._tileOnError,a.src=this.getTileUrl(b,c)},_tileOnLoad:function(){var a=this._layer;this.className+=" leaflet-tile-loaded",a.fire("tileload",{tile:this,url:this.src}),a._tilesToLoad--,a._tilesToLoad||a.fire("load")},_tileOnError:function(){var a=this._layer;a.fire("tileerror",{tile:this,url:this.src});if(a=a.options.errorTileUrl)this.src=a}}),L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(a,b){this._url=a,this.wmsParams=L.Util.extend({},this.defaultWmsParams),this.wmsParams.width=this.wmsParams.height=this.options.tileSize;for(var c in b)this.options.hasOwnProperty(c)||(this.wmsParams[c]=b[c]);L.Util.setOptions(this,b)},onAdd:function(a){this.wmsParams[parseFloat(this.wmsParams.version)>=1.3?"crs":"srs"]=a.options.crs.code,L.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this.options.tileSize,a=a.multiplyBy(b),b=a.add(new L.Point(b,b)),a=this._map.unproject(a,this._zoom,!0),b=this._map.unproject(b,this._zoom,!0),a=this._map.options.crs.project(a),b=this._map.options.crs.project(b),b=[a.x,b.y,b.x,a.y].join(",");return this._url+L.Util.getParamString(this.wmsParams)+"&bbox="+b}}),L.TileLayer.Canvas=L.TileLayer.extend({options:{async:!1},initialize:function(a){L.Util.setOptions(this,a)},_createTileProto:function(){this._canvasProto=L.DomUtil.create("canvas","leaflet-tile");var a=this.options.tileSize;this._canvasProto.width=a,this._canvasProto.height=a},_createTile:function(){var a=this._canvasProto.cloneNode(!1);return a.onselectstart=a.onmousemove=L.Util.falseFn,a},_loadTile:function(a,b,c){a._layer=this,this.drawTile(a,b,c),this.options.async||this.tileDrawn(a)},drawTile:function(){},tileDrawn:function(a){this._tileOnLoad.call(a)}}),L.ImageOverlay=L.Class.extend({includes:L.Mixin.Events,initialize:function(a,b){this._url=a,this._bounds=b},onAdd:function(a){this._map=a,this._image||this._initImage(),a.getPanes().overlayPane.appendChild(this._image),a.on("viewreset",this._reset,this),this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._image),a.off("viewreset",this._reset,this)},_initImage:function(){this._image=L.DomUtil.create("img","leaflet-image-layer"),this._image.style.visibility="hidden",L.Util.extend(this._image,{galleryimg:"no",onselectstart:L.Util.falseFn,onmousemove:L.Util.falseFn,onload:this._onImageLoad,src:this._url})},_reset:function(){var a=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),b=this._map.latLngToLayerPoint(this._bounds.getSouthEast()).subtract(a);L.DomUtil.setPosition(this._image,a),this._image.style.width=b.x+"px",this._image.style.height=b.y+"px"},_onImageLoad:function(){this.style.visibility=""}}),L.Popup=L.Class.extend({includes:L.Mixin.Events,options:{maxWidth:300,autoPan:!0,closeButton:!0,offset:new L.Point(0,2),autoPanPadding:new L.Point(5,5)},initialize:function(a){L.Util.setOptions(this,a)},onAdd:function(a){this._map=a,this._container||this._initLayout(),this._updateContent(),this._container.style.opacity="0",this._map._panes.popupPane.appendChild(this._container),this._map.on("viewreset",this._updatePosition,this),this._map.options.closePopupOnClick&&this._map.on("preclick",this._close,this),this._update(),this._container.style.opacity="1",this._opened=!0},onRemove:function(a){a._panes.popupPane.removeChild(this._container),a.off("viewreset",this._updatePosition,this),a.off("click",this._close,this),this._container.style.opacity="0",this._opened=!1},setLatLng:function(a){return this._latlng=a,this._opened&&this._update(),this},setContent:function(a){return this._content=a,this._opened&&this._update(),this},_close:function(){this._opened&&this._map.removeLayer(this)},_initLayout:function(){this._container=L.DomUtil.create("div","leaflet-popup"),this._closeButton=L.DomUtil.create("a","leaflet-popup-close-button",this._container),this._closeButton.href="#close",this._closeButton.onclick=L.Util.bind(this._onCloseButtonClick,this),this._wrapper=L.DomUtil.create("div","leaflet-popup-content-wrapper",this._container),L.DomEvent.disableClickPropagation(this._wrapper),this._contentNode=L.DomUtil.create("div","leaflet-popup-content",this._wrapper),this._tipContainer=L.DomUtil.create("div","leaflet-popup-tip-container",this._container),this._tip=L.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_update:function(){this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_updateContent:function(){this._content&&(typeof this._content=="string"?this._contentNode.innerHTML=this._content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this._content)))},_updateLayout:function(){this._container.style.width="",this._container.style.whiteSpace="nowrap";var a=this._container.offsetWidth;this._container.style.width=(a>this.options.maxWidth?this.options.maxWidth:a)+"px",this._container.style.whiteSpace="",this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._containerBottom=-a.y-this.options.offset.y,this._containerLeft=a.x-Math.round(this._containerWidth/2)+this.options.offset.x,this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_adjustPan:function(){if(this.options.autoPan){var a=this._container.offsetHeight,b=this._map.layerPointToContainerPoint(new L.Point(this._containerLeft,-a-this._containerBottom)),c=new L.Point(0,0),d=this.options.autoPanPadding,e=this._map.getSize();b.x<0&&(c.x=b.x-d.x),b.x+this._containerWidth>e.x&&(c.x=b.x+this._containerWidth-e.x+d.x),b.y<0&&(c.y=b.y-d.y),b.y+a>e.y&&(c.y=b.y+a-e.y+d.y),(c.x||c.y)&&this._map.panBy(c)}},_onCloseButtonClick:function(a){this._close(),L.DomEvent.stop(a)}}),L.Icon=L.Class.extend({iconUrl:L.ROOT_URL+"images/marker.png",shadowUrl:L.ROOT_URL+"images/marker-shadow.png",iconSize:new L.Point(25,41),shadowSize:new L.Point(41,41),iconAnchor:new L.Point(13,41),popupAnchor:new L.Point(0,-33),initialize:function(a){a&&(this.iconUrl=a)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(a){var b=this[a+"Size"],c=this[a+"Url"],d=this._createImg(c);return c?(d.className="leaflet-marker-"+a,d.style.marginLeft=-this.iconAnchor.x+"px",d.style.marginTop=-this.iconAnchor.y+"px",b&&(d.style.width=b.x+"px",d.style.height=b.y+"px"),d):null},_createImg:function(a){var b;return L.Browser.ie6?(b=document.createElement("div"),b.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'")'):(b=document.createElement("img"),b.src=a),b}}),L.Marker=L.Class.extend({includes:L.Mixin.Events,options:{icon:new L.Icon,title:"",clickable:!0,draggable:!1},initialize:function(a,b){L.Util.setOptions(this,b),this._latlng=a},onAdd:function(a){this._map=a,this._initIcon(),a.on("viewreset",this._reset,this),this._reset()},onRemove:function(a){this._removeIcon(),a.off("viewreset",this._reset,this)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=a,this._reset()},setIcon:function(a){this._removeIcon(),this._icon=this._shadow=null,this.options.icon=a,this._initIcon()},_initIcon:function(){this._icon||(this._icon=this.options.icon.createIcon(),this.options.title&&(this._icon.title=this.options.title),this._initInteraction()),this._shadow||(this._shadow=this.options.icon.createShadow()),this._map._panes.markerPane.appendChild(this._icon),this._shadow&&this._map._panes.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this._map._panes.markerPane.removeChild(this._icon),this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow)},_reset:function(){var a=this._map.latLngToLayerPoint(this._latlng).round();L.DomUtil.setPosition(this._icon,a),this._shadow&&L.DomUtil.setPosition(this._shadow,a),this._icon.style.zIndex=a.y},_initInteraction:function(){if(this.options.clickable){this._icon.className+=" leaflet-clickable",L.DomEvent.addListener(this._icon,"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseover","mouseout"],b=0;b<a.length;b++)L.DomEvent.addListener(this._icon,a[b],this._fireMouseEvent,this)}L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())},_onMouseClick:function(a){L.DomEvent.stopPropagation(a),(!this.dragging||!this.dragging.moved())&&this.fire(a.type)},_fireMouseEvent:function(a){this.fire(a.type),L.DomEvent.stopPropagation(a)}}),L.Marker.include({openPopup:function(){return this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup),this},closePopup:function(){this._popup&&this._popup._close()},bindPopup:function(a,b){return b=L.Util.extend({offset:this.options.icon.popupAnchor},b),this._popup=new L.Popup(b),this._popup.setContent(a),this.on("click",this.openPopup,this),this}}),L.Path=L.Class.extend({includes:[L.Mixin.Events],statics:function(){return{SVG_NS:"http://www.w3.org/2000/svg",SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,CLIP_PADDING:.5}}(),options:{stroke:!0,color:"#0033ff",weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0,updateOnMoveEnd:!1},initialize:function(a){L.Util.setOptions(this,a)},onAdd:function(a){this._map=a,this._initElements(),this._initEvents(),this.projectLatlngs(),this._updatePath(),a.on("viewreset",this.projectLatlngs,this),this._updateTrigger=this.options.updateOnMoveEnd?"moveend":"viewreset",a.on(this._updateTrigger,this._updatePath,this)},onRemove:function(a){a._pathRoot.removeChild(this._container),a.off("viewreset",this._projectLatlngs,this),a.off(this._updateTrigger,this._updatePath,this)},projectLatlngs:function(){},getPathString:function(){},setStyle:function(a){L.Util.setOptions(this,a),this._path&&this._updateStyle()},_initElements:function(){this._initRoot(),this._initPath(),this._initStyle()},_initRoot:function(){this._map._pathRoot||(this._map._pathRoot=this._createElement("svg"),this._map._panes.overlayPane.appendChild(this._map._pathRoot),this._map.on("moveend",this._updateSvgViewport,this),this._updateSvgViewport())},_updateSvgViewport:function(){this._updateViewport();var a=this._map._pathViewport,b=a.min,c=a.max,a=c.x-b.x,c=c.y-b.y,d=this._map._pathRoot,e=this._map._panes.overlayPane;L.Browser.mobileWebkit&&e.removeChild(d),L.DomUtil.setPosition(d,b),d.setAttribute("width",a),d.setAttribute("height",c),d.setAttribute("viewBox",[b.x,b.y,a,c].join(" ")),L.Browser.mobileWebkit&&e.appendChild(d)},_updateViewport:function(){var a=L.Path.CLIP_PADDING,b=this._map.getSize(),c=L.DomUtil.getPosition(this._map._mapPane).multiplyBy(-1).subtract(b.multiplyBy(a)),a=c.add(b.multiplyBy(1+a*2));this._map._pathViewport=new L.Bounds(c,a)},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path),this._map._pathRoot.appendChild(this._container)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill?this._path.setAttribute("fill-rule","evenodd"):this._path.setAttribute("fill","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight)),this.options.fill&&(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity))},_updatePath:function(){var a=this.getPathString();a||(a="M0 0"),this._path.setAttribute("d",a)},_createElement:function(a){return document.createElementNS(L.Path.SVG_NS,a)},_initEvents:function(){if(this.options.clickable){L.Path.VML||this._path.setAttribute("class","leaflet-clickable"),L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseover","mouseout"],b=0;b<a.length;b++)L.DomEvent.addListener(this._container,a[b],this._fireMouseEvent,this)}},_onMouseClick:function(a){(!this._map.dragging||!this._map.dragging.moved())&&this._fireMouseEvent(a)},_fireMouseEvent:function(a){this.hasEventListeners(a.type)&&(this.fire(a.type,{latlng:this._map.mouseEventToLatLng(a),layerPoint:this._map.mouseEventToLayerPoint(a)}),L.DomEvent.stopPropagation(a))},_redraw:function(){this.projectLatlngs(),this._updatePath()}}),L.Path.VML=function(){var a=document.createElement("div");return a.innerHTML='<v:shape adj="1"/>',a=a.firstChild,a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}(),L.Path=L.Path.SVG||!L.Path.VML?L.Path:L.Path.extend({statics:{CLIP_PADDING:.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initRoot:function(){this._map._pathRoot||(this._map._pathRoot=document.createElement("div"),this._map._pathRoot.className="leaflet-vml-container",this._map._panes.overlayPane.appendChild(this._map._pathRoot),this._map.on("moveend",this._updateViewport,this),this._updateViewport())},_initPath:function(){this._container=this._createElement("shape"),this._container.className+=" leaflet-vml-shape"+(this.options.clickable?" leaflet-clickable":""),this._container.coordsize="1 1",this._path=this._createElement("path"),this._container.appendChild(this._path),this._map._pathRoot.appendChild(this._container)},_initStyle:function(){this.options.stroke?(this._stroke=this._createElement("stroke"),this._stroke.endcap="round",this._container.appendChild(this._stroke)):this._container.stroked=!1,this.options.fill?(this._container.filled=!0,this._fill=this._createElement("fill"),this._container.appendChild(this._fill)):this._container.filled=!1,this._updateStyle()},_updateStyle:function(){this.options.stroke&&(this._stroke.weight=this.options.weight+"px",this._stroke.color=this.options.color,this._stroke.opacity=this.options.opacity),this.options.fill&&(this._fill.color=this.options.fillColor||this.options.color,this._fill.opacity=this.options.fillOpacity)},_updatePath:function(){this._container.style.display="none",this._path.v=this.getPathString()+" ",this._container.style.display=""}}),L.Path.include({bindPopup:function(a,b){if(!this._popup||this._popup.options!==b)this._popup=new L.Popup(b);return this._popup.setContent(a),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},_openPopup:function(a){this._popup.setLatLng(a.latlng),this._map.openPopup(this._popup)}}),L.Polyline=L.Path.extend({initialize:function(a,b){L.Path.prototype.initialize.call(this,b),this._latlngs=a},options:{smoothFactor:1,noClip:!1,updateOnMoveEnd:!0},projectLatlngs:function(){this._originalPoints=[];for(var a=0,b=this._latlngs.length;a<b;a++)this._originalPoints[a]=this._map.latLngToLayerPoint(this._latlngs[a])},getPathString:function(){for(var a=0,b=this._parts.length,c="";a<b;a++)c+=this._getPathPartStr(this._parts[a]);return c},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._latlngs=a,this._redraw(),this},addLatLng:function(a){return this._latlngs.push(a),this._redraw(),this},spliceLatLngs:function(){var a=[].splice.apply(this._latlngs,arguments);return this._redraw(),a},_getPathPartStr:function(a){for(var b=L.Path.VML,c=0,d=a.length,e="",f;c<d;c++)f=a[c],b&&f._round(),e+=(c?"L":"M")+f.x+" "+f.y;return e},_clipPoints:function(){var a=this._originalPoints,b=a.length,c,d,e;if(this.options.noClip)this._parts=[a];else{var f=this._parts=[],g=this._map._pathViewport,h=L.LineUtil;for(d=c=0;c<b-1;c++)if(e=h.clipSegment(a[c],a[c+1],g,c))if(f[d]=f[d]||[],f[d].push(e[0]),e[1]!=a[c+1]||c==b-2)f[d].push(e[1]),d++}},_simplifyPoints:function(){for(var a=this._parts,b=L.LineUtil,c=0,d=a.length;c<d;c++)a[c]=b.simplify(a[c],this.options.smoothFactor)},_updatePath:function(){this._clipPoints(),this._simplifyPoints(),L.Path.prototype._updatePath.call(this)}}),L.Polygon=L.Polyline.extend({options:{fill:!0},initialize:function(a,b){L.Polyline.prototype.initialize.call(this,a,b),a[0]instanceof Array&&(this._latlngs=a[0],this._holes=a.slice(1))},projectLatlngs:function(){L.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[];if(this._holes)for(var a=0,b=this._holes.length;a<b;a++){this._holePoints[a]=[];for(var c=0,d=this._holes[a].length;c<d;c++)this._holePoints[a][c]=this._map.latLngToLayerPoint(this._holes[a][c])}},_clipPoints:function(){var a=[];this._parts=[this._originalPoints].concat(this._holePoints);if(!this.options.noClip){for(var b=0,c=this._parts.length;b<c;b++){var d=L.PolyUtil.clipPolygon(this._parts[b],this._map._pathViewport);d.length&&a.push(d)}this._parts=a}},_getPathPartStr:function(a){return L.Polyline.prototype._getPathPartStr.call(this,a)+(L.Path.SVG?"z":"x")}}),function(){function a(a){return L.FeatureGroup.extend({initialize:function(b,c){this._layers={};for(var d=0,e=b.length;d<e;d++)this.addLayer(new a(b[d],c))},setStyle:function(a){for(var b in this._layers)this._layers.hasOwnProperty(b)&&this._layers[b].setStyle&&this._layers[b].setStyle(a)}})}L.MultiPolyline=a(L.Polyline),L.MultiPolygon=a(L.Polygon)}(),L.Circle=L.Path.extend({initialize:function(a,b,c){L.Path.prototype.initialize.call(this,c),this._latlng=a,this._mRadius=b},options:{fill:!0},setLatLng:function(a){return this._latlng=a,this._redraw(),this},setRadius:function(a){return this._mRadius=a,this._redraw(),this},projectLatlngs:function(){var a=this._map.options.scale(this._map._zoom);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=this._mRadius/40075017*a},getPathString:function(){var a=this._point,b=this._radius;return L.Path.SVG?"M"+a.x+","+(a.y-b)+"A"+b+","+b+",0,1,1,"+(a.x-.1)+","+(a.y-b)+" z":(a._round(),b=Math.round(b),"AL "+a.x+","+a.y+" "+b+","+b+" 0,23592600")}}),L.CircleMarker=L.Circle.extend({options:{radius:10,weight:2},initialize:function(a,b){L.Circle.prototype.initialize.call(this,a,null,b),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(a){return this._radius=a,this._redraw(),this}}),L.GeoJSON=L.LayerGroup.extend({includes:L.Mixin.Events,initialize:function(a,b){L.Util.setOptions(this,b),this._geojson=a,this._layers={},a&&this.addGeoJSON(a)},addGeoJSON:function(a){if(a.features)for(var b=0,c=a.features.length;b<c;b++)this.addGeoJSON(a.features[b]);else b=a.type=="Feature"?a.geometry:a,c=L.GeoJSON.geometryToLayer(b,this.options.pointToLayer),this.fire("featureparse",{layer:c,properties:a.properties,geometryType:b.type,bbox:a.bbox,id:a.id}),this.addLayer(c)}}),L.Util.extend(L.GeoJSON,{geometryToLayer:function(a,b){var c=a.coordinates,d,e,f,g=[];switch(a.type){case"Point":return d=this.coordsToLatLng(c),b?b(d):new L.Marker(d);case"MultiPoint":e=0;for(f=c.length;e<f;e++)d=this.coordsToLatLng(c[e]),d=b?b(d):new L.Marker(d),g.push(d);return new L.FeatureGroup(g);case"LineString":return c=this.coordsToLatLngs(c),new L.Polyline(c);case"Polygon":return c=this.coordsToLatLngs(c,1),new L.Polygon(c);case"MultiLineString":return c=this.coordsToLatLngs(c,1),new L.MultiPolyline(c);case"MultiPolygon":return c=this.coordsToLatLngs(c,2),new L.MultiPolygon(c);case"GeometryCollection":e=0;for(f=a.geometries.length;e<f;e++)d=this.geometryToLayer(a.geometries[e]),g.push(d);return new L.FeatureGroup(g);default:throw Error("Invalid GeoJSON object.")}},coordsToLatLng:function(a,b){var c=parseFloat(a[b?0:1]),d=parseFloat(a[b?1:0]);return new L.LatLng(c,d)},coordsToLatLngs:function(a,b,c){var d,e=[],f,g=a.length;for(f=0;f<g;f++)d=b?this.coordsToLatLngs(a[f],b-1,c):this.coordsToLatLng(a[f],c),e.push(d);return e}}),L.Handler=L.Class.extend({initialize:function(a){this._map=a},enabled:function(){return!!this._enabled}}),L.Handler.MapDrag=L.Handler.extend({enable:function(){this._enabled||(this._draggable||(this._draggable=new L.Draggable(this._map._mapPane,this._map._container),this._draggable.on("dragstart",this._onDragStart,this),this._draggable.on("drag",this._onDrag,this),this._draggable.on("dragend",this._onDragEnd,this)),this._draggable.enable(),this._enabled=!0)},disable:function(){this._enabled&&(this._draggable.disable(),this._enabled=!1)},moved:function(){return this._draggable._moved},_onDragStart:function(){this._map.fire("movestart"),this._map.fire("dragstart")},_onDrag:function(){this._map.fire("move"),this._map.fire("drag")},_onDragEnd:function(){this._map.fire("moveend"),this._map.fire("dragend")}}),L.Handler.TouchZoom=L.Handler.extend({enable:function(){L.Browser.mobileWebkit&&!this._enabled&&(L.DomEvent.addListener(this._map._container,"touchstart",this._onTouchStart,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._map._container,"touchstart",this._onTouchStart,this),this._enabled=!1)},_onTouchStart:function(a){if(a.touches&&a.touches.length==2&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a.touches[0]),c=this._map.mouseEventToLayerPoint(a.touches[1]),d=this._map.containerPointToLayerPoint(this._map.getSize().divideBy(2));this._startCenter=b.add(c).divideBy(2,!0),this._startDist=b.distanceTo(c),this._moved=!1,this._zooming=!0,this._centerOffset=d.subtract(this._startCenter),L.DomEvent.addListener(document,"touchmove",this._onTouchMove,this),L.DomEvent.addListener(document,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&a.touches.length==2){this._moved||(this._map._mapPane.className+=" leaflet-zoom-anim",this._map._prepareTileBg(),this._moved=!0);var b=this._map.mouseEventToLayerPoint(a.touches[0]),c=this._map.mouseEventToLayerPoint(a.touches[1]);this._scale=b.distanceTo(c)/this._startDist,this._delta=b.add(c).divideBy(2,!0).subtract(this._startCenter),this._map._tileBg.style.webkitTransform=[L.DomUtil.getTranslateString(this._delta),L.DomUtil.getScaleString(this._scale,this._startCenter)].join(" "),L.DomEvent.preventDefault(a)}},_onTouchEnd:function(){if(this._moved&&this._zooming){this._zooming=!1;var a=this._map.getZoom(),b=Math.log(this._scale)/Math.LN2,b=this._map._limitZoom(a+(b>0?Math.ceil(b):Math.floor(b))),a=b-a,c=this._centerOffset.subtract(this._delta).divideBy(this._scale),d=this._map.unproject(this._map.getPixelOrigin().add(this._startCenter).add(c));L.DomEvent.removeListener(document,"touchmove",this._onTouchMove),L.DomEvent.removeListener(document,"touchend",this._onTouchEnd),this._map._runAnimation(d,b,Math.pow(2,a)/this._scale,this._startCenter.add(c))}}}),L.Handler.ScrollWheelZoom=L.Handler.extend({enable:function(){this._enabled||(L.DomEvent.addListener(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0,this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._map._container,"mousewheel",this._onWheelScroll),this._enabled=!1)},_onWheelScroll:function(a){this._delta+=L.DomEvent.getWheelDelta(a),this._lastMousePos=this._map.mouseEventToContainerPoint(a),clearTimeout(this._timer),this._timer=setTimeout(L.Util.bind(this._performZoom,this),50),L.DomEvent.preventDefault(a)},_performZoom:function(){var a=Math.round(this._delta);this._delta=0;if(a){var b=this._getCenterForScrollWheelZoom(this._lastMousePos,a),a=this._map.getZoom()+a;this._map._limitZoom(a)!=this._map._zoom&&this._map.setView(b,a)}},_getCenterForScrollWheelZoom:function(a,b){var c=this._map.getPixelBounds().getCenter(),d=this._map.getSize().divideBy(2),d=a.subtract(d).multiplyBy(1-Math.pow(2,-b));return this._map.unproject(c.add(d),this._map._zoom,!0)}}),L.Handler.DoubleClickZoom=L.Handler.extend({enable:function(){this._enabled||(this._map.on("dblclick",this._onDoubleClick,this._map),this._enabled=!0)},disable:function(){this._enabled&&(this._map.off("dblclick",this._onDoubleClick,this._map),this._enabled=!1)},_onDoubleClick:function(a){this.setView(a.latlng,this._zoom+1)}}),L.Handler.ShiftDragZoom=L.Handler.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane},enable:function(){this._enabled||(L.DomEvent.addListener(this._container,"mousedown",this._onMouseDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._container,"mousedown",this._onMouseDown),this._enabled=!1)},_onMouseDown:function(a){if(!a.shiftKey||a.which!=1&&a.button!=1)return!1;L.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(a),this._box=L.DomUtil.create("div","leaflet-zoom-box",this._pane),L.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",L.DomEvent.addListener(document,"mousemove",this._onMouseMove,this),L.DomEvent.addListener(document,"mouseup",this._onMouseUp,this),L.DomEvent.preventDefault(a)},_onMouseMove:function(a){var b=this._map.mouseEventToLayerPoint(a),a=b.x-this._startLayerPoint.x,c=b.y-this._startLayerPoint.y,b=new L.Point(Math.min(b.x,this._startLayerPoint.x),Math.min(b.y,this._startLayerPoint.y));L.DomUtil.setPosition(this._box,b),this._box.style.width=Math.abs(a)-4+"px",this._box.style.height=Math.abs(c)-4+"px"},_onMouseUp:function(a){this._pane.removeChild(this._box),this._container.style.cursor="",L.DomUtil.enableTextSelection(),L.DomEvent.removeListener(document,"mousemove",this._onMouseMove),L.DomEvent.removeListener(document,"mouseup",this._onMouseUp),a=this._map.mouseEventToLayerPoint(a),this._map.fitBounds(new L.LatLngBounds(this._map.layerPointToLatLng(this._startLayerPoint),this._map.layerPointToLatLng(a)))}}),L.Handler.MarkerDrag=L.Handler.extend({initialize:function(a){this._marker=a},enable:function(){this._enabled||(this._draggable||(this._draggable=new L.Draggable(this._marker._icon,this._marker._icon),this._draggable.on("dragstart",this._onDragStart,this),this._draggable.on("drag",this._onDrag,this),this._draggable.on("dragend",this._onDragEnd,this)),this._draggable.enable(),this._enabled=!0)},disable:function(){this._enabled&&(this._draggable.disable(),this._enabled=!1)},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup(),this._marker.fire("movestart"),this._marker.fire("dragstart")},_onDrag:function(){var a=L.DomUtil.getPosition(this._marker._icon);L.DomUtil.setPosition(this._marker._shadow,a),this._marker._latlng=this._marker._map.layerPointToLatLng(a),this._marker.fire("move"),this._marker.fire("drag")},_onDragEnd:function(){this._marker.fire("moveend"),this._marker.fire("dragend")}}),L.Control={},L.Control.Position={TOP_LEFT:"topLeft",TOP_RIGHT:"topRight",BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight"},L.Control.Zoom=L.Class.extend({onAdd:function(a){this._map=a,this._container=L.DomUtil.create("div","leaflet-control-zoom"),this._zoomInButton=this._createButton("Zoom in","leaflet-control-zoom-in",this._map.zoomIn,this._map),this._zoomOutButton=this._createButton("Zoom out","leaflet-control-zoom-out",this._map.zoomOut,this._map),this._container.appendChild(this._zoomInButton),this._container.appendChild(this._zoomOutButton)},getContainer:function(){return this._container},getPosition:function(){return L.Control.Position.TOP_LEFT},_createButton:function(a,b,c,d){var e=document.createElement("a");return e.href="#",e.title=a,e.className=b,L.DomEvent.disableClickPropagation(e),L.DomEvent.addListener(e,"click",L.DomEvent.preventDefault),L.DomEvent.addListener(e,"click",c,d),e}}),L.Control.Attribution=L.Class.extend({onAdd:function(a){this._container=L.DomUtil.create("div","leaflet-control-attribution"),this._map=a,this._prefix='Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>',this._attributions={},this._update()},getPosition:function(){return L.Control.Position.BOTTOM_RIGHT},getContainer:function(){return this._container},setPrefix:function(a){this._prefix=a},addAttribution:function(a){a&&(this._attributions[a]=!0,this._update())},removeAttribution:function(a){a&&(delete this._attributions[a],this._update())},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions.hasOwnProperty(b)&&a.push(b);b=[],this._prefix&&b.push(this._prefix),a.length&&b.push(a.join(", ")),this._container.innerHTML=b.join(" &mdash; ")}}}),L.Map=L.Class.extend({includes:L.Mixin.Events,options:{crs:L.CRS.EPSG3857||L.CRS.EPSG4326,scale:function(a){return 256*(1<<a)},center:null,zoom:null,layers:[],dragging:!0,touchZoom:L.Browser.mobileWebkit&&!L.Browser.android,scrollWheelZoom:!L.Browser.mobileWebkit,doubleClickZoom:!0,shiftDragZoom:!0,zoomControl:!0,attributionControl:!0,fadeAnimation:L.DomUtil.TRANSITION&&!L.Browser.android,zoomAnimation:L.DomUtil.TRANSITION&&!L.Browser.android&&!L.Browser.mobileOpera,trackResize:!0,closePopupOnClick:!0},initialize:function(a,b){L.Util.setOptions(this,b),this._container=L.DomUtil.get(a),this._initLayout(),L.DomEvent&&(this._initEvents(),L.Handler&&this._initInteraction(),L.Control&&this._initControls());var c=this.options.center,d=this.options.zoom;c!==null&&d!==null&&this.setView(c,d,!0),c=this.options.layers,c=c instanceof Array?c:[c],this._tileLayersNum=0,this._initLayers(c)},setView:function(a,b){return this._resetView(a,this._limitZoom(b)),this},setZoom:function(a){return this.setView(this.getCenter(),a)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(a){var b=this.getBoundsZoom(a);return this.setView(a.getCenter(),b)},fitWorld:function(){var a=new L.LatLng(-60,-170),b=new L.LatLng(85,179);return this.fitBounds(new L.LatLngBounds(a,b))},panTo:function(a){return this.setView(a,this._zoom)},panBy:function(a){return this.fire("movestart"),this._rawPanBy(a),this.fire("move"),this.fire("moveend"),this},addLayer:function(a){var b=L.Util.stamp(a);return this._layers[b]?this:(this._layers[b]=a,a.options&&!isNaN(a.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,a.options.maxZoom)),a.options&&!isNaN(a.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||Infinity,a.options.minZoom)),this.options.zoomAnimation&&L.TileLayer&&a instanceof L.TileLayer&&(this._tileLayersNum++,a.on("load",this._onTileLayerLoad,this)),this.attributionControl&&a.getAttribution&&this.attributionControl.addAttribution(a.getAttribution()),b=function(){a.onAdd(this),this.fire("layeradd",{layer:a})},this._loaded?b.call(this):this.on("load",b,this),this)},removeLayer:function(a){var b=L.Util.stamp(a);return this._layers[b]&&(a.onRemove(this),delete this._layers[b],this.options.zoomAnimation&&L.TileLayer&&a instanceof L.TileLayer&&(this._tileLayersNum--,a.off("load",this._onTileLayerLoad,this)),this.attributionControl&&a.getAttribution&&this.attributionControl.removeAttribution(a.getAttribution()),this.fire("layerremove",{layer:a})),this},invalidateSize:function(){return this._sizeChanged=!0,this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.Util.bind(function(){this.fire("moveend")},this),200),this},getCenter:function(a){var b=this.getSize().divideBy(2);return this.unproject(this._getTopLeftPoint().add(b),this._zoom,a)},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(new L.Point(a.min.x,a.max.y)),a=this.unproject(new L.Point(a.max.x,a.min.y));return new L.LatLngBounds(b,a)},getMinZoom:function(){return isNaN(this.options.minZoom)?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return isNaN(this.options.maxZoom)?this._layersMaxZoom||Infinity:this.options.maxZoom},getBoundsZoom:function(a){var b=this.getSize(),c=this.getMinZoom(),d=this.getMaxZoom(),e=a.getNorthEast(),a=a.getSouthWest(),f,g;do c++,f=this.project(e,c),g=this.project(a,c),f=new L.Point(f.x-g.x,g.y-f.y);while(f.x<=b.x&&f.y<=b.y&&c<=d);return c-1},getSize:function(){if(!this._size||this._sizeChanged)this._size=new L.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size},getPixelBounds:function(){var a=this._getTopLeftPoint(),b=this.getSize();return new L.Bounds(a,a.add(b))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},mouseEventToContainerPoint:function(a){return L.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},containerPointToLayerPoint:function(a){return a.subtract(L.DomUtil.getPosition(this._mapPane))},layerPointToContainerPoint:function(a){return a.add(L.DomUtil.getPosition(this._mapPane))},layerPointToLatLng:function(a){return this.unproject(a.add(this._initialTopLeftPoint))},latLngToLayerPoint:function(a){return this.project(a)._subtract(this._initialTopLeftPoint)},project:function(a,b){return b=typeof b=="undefined"?this._zoom:b,this.options.crs.latLngToPoint(a,this.options.scale(b))},unproject:function(a,b,c){return b=typeof b=="undefined"?this._zoom:b,this.options.crs.pointToLatLng(a,this.options.scale(b),c)},_initLayout:function(){var a=this._container;a.className+=" leaflet-container",this.options.fadeAnimation&&(a.className+=" leaflet-fade-anim");var b=L.DomUtil.getStyle(a,"position");b!="absolute"&&b!="relative"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._mapPane=a.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=a.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=a.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),a.shadowPane=this._createPane("leaflet-shadow-pane"),a.overlayPane=this._createPane("leaflet-overlay-pane"),a.markerPane=this._createPane("leaflet-marker-pane"),a.popupPane=this._createPane("leaflet-popup-pane")},_createPane:function(a,b){return L.DomUtil.create("div",a,b||this._objectsPane)},_resetView:function(a,b,c){var d=this._zoom!=b;this.fire("movestart"),this._zoom=b,this._initialTopLeftPoint=this._getNewTopLeftPoint(a),c?this._initialTopLeftPoint._add(L.DomUtil.getPosition(this._mapPane)):L.DomUtil.setPosition(this._mapPane,new L.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset"),this.fire("move"),d&&this.fire("zoomend"),this.fire("moveend"),this._loaded||(this._loaded=!0,this.fire("load"))},_initLayers:function(a){this._layers={};for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},_initControls:function(){this.options.zoomControl&&this.addControl(new L.Control.Zoom),this.options.attributionControl&&(this.attributionControl=new L.Control.Attribution,this.addControl(this.attributionControl))},_rawPanBy:function(a){var b=L.DomUtil.getPosition(this._mapPane);L.DomUtil.setPosition(this._mapPane,b.subtract(a))},_initEvents:function(){L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseenter","mouseleave","mousemove"],b=0;b<a.length;b++)L.DomEvent.addListener(this._container,a[b],this._fireMouseEvent,this);this.options.trackResize&&L.DomEvent.addListener(window,"resize",this.invalidateSize,this)},_onMouseClick:function(a){if(!this.dragging||!this.dragging.moved())this.fire("pre"+a.type),this._fireMouseEvent(a)},_fireMouseEvent:function(a){var b=a.type,b=b=="mouseenter"?"mouseover":b=="mouseleave"?"mouseout":b;this.hasEventListeners(b)&&this.fire(b,{latlng:this.mouseEventToLatLng(a),layerPoint:this.mouseEventToLayerPoint(a)})},_initInteraction:function(){var a={dragging:L.Handler.MapDrag,touchZoom:L.Handler.TouchZoom,doubleClickZoom:L.Handler.DoubleClickZoom,scrollWheelZoom:L.Handler.ScrollWheelZoom,shiftDragZoom:L.Handler.ShiftDragZoom},b;for(b in a)a.hasOwnProperty(b)&&a[b]&&(this[b]=new a[b](this),this.options[b]&&this[b].enable())},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(L.Util.bind(this._clearTileBg,this),500))},_getTopLeftPoint:function(){if(!this._loaded)throw Error("Set map center and zoom first.");return this._initialTopLeftPoint.subtract(L.DomUtil.getPosition(this._mapPane))},_getNewTopLeftPoint:function(a){var b=this.getSize().divideBy(2);return this.project(a).subtract(b).round()},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom();return Math.max(b,Math.min(c,a))}}),L.Map.include({locate:function(a){var b={timeout:1e4};return L.Util.extend(b,a),navigator.geolocation?navigator.geolocation.getCurrentPosition(L.Util.bind(this._handleGeolocationResponse,this),L.Util.bind(this._handleGeolocationError,this),b):this.fire("locationerror",{code:0,message:"Geolocation not supported."}),this},locateAndSetView:function(a,b){return this._setViewOnLocate=!0,this._maxLocateZoom=a||Infinity,this.locate(b)},_handleGeolocationError:function(a){var a=a.code,b=a==1?"permission denied":a==2?"position unavailable":"timeout";this._setViewOnLocate&&(this.fitWorld(),this._setViewOnLocate=!1),this.fire("locationerror",{code:a,message:"Geolocation error: "+b+"."})},_handleGeolocationResponse:function(a){var b=180*a.coords.accuracy/4e7,c=b*2,d=a.coords.latitude,e=a.coords.longitude,f=new L.LatLng(d-b,e-c),b=new L.LatLng(d+b,e+c),f=new L.LatLngBounds(f,b);this._setViewOnLocate&&(b=Math.min(this.getBoundsZoom(f),this._maxLocateZoom),this.setView(f.getCenter(),b),this._setViewOnLocate=!1),this.fire("locationfound",{latlng:new L.LatLng(d,e),bounds:f,accuracy:a.coords.accuracy})}}),L.Map.include({openPopup:function(a){return this.closePopup(),this._popup=a,this.addLayer(a)},closePopup:function(){return this._popup&&this.removeLayer(this._popup),this}}),L.Map.include(!L.Transition||!L.Transition.implemented()?{}:{setView:function(a,b,c){var b=this._limitZoom(b),d=this._zoom!=b;return this._loaded&&!c&&this._layers&&(c=this._getNewTopLeftPoint(a).subtract(this._getTopLeftPoint()),d?this._zoomToIfCenterInView&&this._zoomToIfCenterInView(a,b,c):this._panByIfClose(c))?this:(this._resetView(a,b),this)},panBy:function(a){return this._panTransition||(this._panTransition=new L.Transition(this._mapPane,{duration:.3}),this._panTransition.on("step",this._onPanTransitionStep,this),this._panTransition.on("end",this._onPanTransitionEnd,this)),this.fire(this,"movestart"),this._panTransition.run({position:L.DomUtil.getPosition(this._mapPane).subtract(a)}),this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){this.fire("moveend")},_panByIfClose:function(a){return this._offsetIsWithinView(a)?(this.panBy(a),!0):!1},_offsetIsWithinView:function(a,b){var c=b||1,d=this.getSize();return Math.abs(a.x)<=d.x*c&&Math.abs(a.y)<=d.y*c}}),L.Map.include(L.DomUtil.TRANSITION?{_zoomToIfCenterInView:function(a,b,c){if(this._animatingZoom)return!0;if(!this.options.zoomAnimation)return!1;var d=Math.pow(2,b-this._zoom),c=c.divideBy(1-1/d);return this._offsetIsWithinView(c,1)?(this._mapPane.className+=" leaflet-zoom-anim",c=this.containerPointToLayerPoint(this.getSize().divideBy(2)).add(c),this._prepareTileBg(),this._runAnimation(a,b,d,c),!0):!1},_runAnimation:function(a,b,c,d){this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,a=L.DomUtil.TRANSFORM;if(L.Browser.gecko||window.opera)this._tileBg.style[a]+=" translate(0,0)";L.Browser.android?(this._tileBg.style[a+"Origin"]=d.x+"px "+d.y+"px",c="scale("+c+")"):c=L.DomUtil.getScaleString(c,d),L.Util.falseFn(this._tileBg.offsetWidth),d={},d[a]=this._tileBg.style[a]+" "+c,this._tileBg.transition.run(d)},_prepareTileBg:function(){this._tileBg||(this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),this._tileBg.style.zIndex=1);var a=this._tilePane,b=this._tileBg;b.style[L.DomUtil.TRANSFORM]="",b.style.visibility="hidden",b.empty=!0,a.empty=!1,this._tilePane=this._panes.tilePane=b,this._tileBg=a,this._tileBg.transition||(this._tileBg.transition=new L.Transition(this._tileBg,{duration:.3,easing:"cubic-bezier(0.25,0.1,0.25,0.75)"}),this._tileBg.transition.on("end",this._onZoomTransitionEnd,this)),this._stopLoadingBgTiles()},_stopLoadingBgTiles:function(){for(var a=[].slice.call(this._tileBg.getElementsByTagName("img")),b=0,c=a.length;b<c;b++)a[b].complete||(a[b].src="",a[b].parentNode.removeChild(a[b]))},_onZoomTransitionEnd:function(){this._restoreTileFront(),L.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0),this._mapPane.className=this._mapPane.className.replace(" leaflet-zoom-anim",""),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){!this._animatingZoom&&!this.touchZoom._zooming&&(this._tileBg.innerHTML="")}}:{}),L.Map.include({addControl:function(a){a.onAdd(this);var b=a.getPosition(),c=this._controlCorners[b],a=a.getContainer();return L.DomUtil.addClass(a,"leaflet-control"),b.indexOf("bottom")!=-1?c.insertBefore(a,c.firstChild):c.appendChild(a),this},removeControl:function(a){var b=this._controlCorners[a.getPosition()],c=a.getContainer();return b.removeChild(c),a.onRemove&&a.onRemove(this),this},_initControlPos:function(){var a=this._controlCorners={},b=L.DomUtil.create("div","leaflet-control-container",this._container);L.Browser.mobileWebkit&&(b.className+=" leaflet-big-buttons"),a.topLeft=L.DomUtil.create("div","leaflet-top leaflet-left",b),a.topRight=L.DomUtil.create("div","leaflet-top leaflet-right",b),a.bottomLeft=L.DomUtil.create("div","leaflet-bottom leaflet-left",b),a.bottomRight=L.DomUtil.create("div","leaflet-bottom leaflet-right",b)}}),define("web/js/lib/leaflet/leaflet.js",function(){}),define("web/js/ux/zeega.ux.header.js",function(){}),define("web/js/ux/layer-controls.js",function(){}),function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function g(){!a&&this.init&&this.init.apply(this,arguments)}var d=this.prototype;a=!0;var e=new this;a=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);return this._super=c,e}}(f,c[f]):c[f];return g.prototype=e,g.prototype.constructor=g,g.extend=arguments.callee,g}}(),define("web/js/helpers/zeega.extends.js",function(){});var LayerGlobals=new Array;String.prototype.toCapitalCase=function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},Storage.prototype.setObject=function(a,b){this.setItem(a,JSON.stringify(b))},Storage.prototype.getObject=function(a){var b=this.getItem(a);return b&&JSON.parse(b)},String.prototype.toRGB=function(){var a=function(a){return a.charAt(0)=="#"?a.substring(1,7):a},b="";return b+=parseInt(a(this).substring(0,2),16)+",",b+=parseInt(a(this).substring(2,4),16)+",",b+=parseInt(a(this).substring(4,6),16),b},define("web/js/helpers/zeega.helpers.js",function(){}),this.zeega={module:function(){var a={};return function(b){return a[b]?a[b]:a[b]={Views:{}}}}(),app:_.extend({busy:!1,hold:null,currentFrame:null,thumbnailUpdates:!0,previewMode:!1,helpCounter:0,maxFramesPerSequence:0,maxLayersPerFrame:0,url_prefix:"",url_hash:{sequence:null,frame:null},init:function(){this.url_prefix=sessionStorage.getItem("hostname")+sessionStorage.getItem("directory"),this.loadModules(),this.isLoaded=!0},loadModules:function(){var a=this,b=zeega.module("project"),c=zeega.module("items");console.log($.parseJSON(projectJSON)),this.loadCollectionsDropdown($.parseJSON(collectionsJSON)),this.itemCollection=new c.ViewCollection,this.project=new b.Model($.parseJSON(projectJSON).project),this.project.on("ready",function(){a.startEditor()}),this.project.loadProject(),console.log(this.project)},loadCollectionsDropdown:function(a){_.each(a,function(a){$("#database-collection-filter").append('<option value="'+a.id+'">'+a.title+"</option>")})},searchDatabase:function(a,b){this.itemCollection.search(a,b)},refreshDatabase:function(){this.itemCollection.refresh()},startEditor:function(){console.log("editor started"),this.renderSequenceFrames(),this.startRouter()},startRouter:function(){var a=this,b=Backbone.Router.extend({routes:{"":"nullLoad","editor/sequence/:sequenceID/frame/:frameID":"goToSequenceFrame","player/sequence/:sequenceID/frame/:frameID":"checkPlayer"},nullLoad:function(){a.goToSequence(a.project.sequences.at(0).id),a.goToFrame(a.project.sequences.at(0).get("frames")[0])},goToSequenceFrame:function(b,c){a.goToSequence(b),a.goToFrame(c)},checkPlayer:function(b,c){console.log("zeega check player router"),a.previewMode?a.player.goToSequenceFrame(b,c):this.goToSequenceFrame(b,c)}});this.router=new b,Backbone.history.start()},goToSequence:function(a,b){this.unrenderFrame(this.currentFrame),this.currentSequence.trigger("blur"),this.currentSequence=this.project.sequences.get(a),this.currentSequence.trigger("focus"),this.renderSequenceFrames();var c=b?this.project.frames.get(b):this.project.frames.get(this.currentSequence.get("frames")[0]);this.loadFrame(c)},goToFrame:function(a){_.isUndefined(a)||a=="undefined"?(this.currentFrame=this.project.frames.get(this.currentSequence.get("frames")[0]),this.loadFrame(this.currentFrame)):this.loadFrame(this.project.frames.get(a))},loadFrame:function(a){var b=this;this.unrenderFrame(this.currentFrame),this.currentFrame&&this.currentFrame.trigger("blur"),this.currentFrame=a,this.currentFrame.trigger("focus"),this.renderFrame(this.currentFrame),this.router.navigate("editor/sequence/"+this.currentSequence.id+"/frame/"+a.id,{silent:!0}),this.restorePanelStates(),this.setAdvanceValues()},renderSequenceFrames:function(){var a=this;$("#frame-list").empty(),_.each(this.currentSequence.get("frames"),function(b){a.project.frames.get(b).render()})},renderFrame:function(a){if(a){var b=0,c=this;_.each(_.compact(a.get("layers")),function(a,d){var e=c.project.layers.get(a);e.layerIndex=b,b++,_.isUndefined(e)?console.log("layer missing"):e.trigger("editor_layerRender",d)})}},unrenderFrame:function(a){if(a){var b=this;_.each(a.get("layers"),function(a){var c=b.project.layers.get(a);_.isUndefined(c)?console.log("layer missing"):(c.visual&&c.visual.remove(),c.controls&&c.controls.remove(),c.trigger("editor_layerExit"))})}},restorePanelStates:function(){var a=localStorage.getObject(this.currentFrame.id);!_.isNull(a)&&!_.isUndefined(a.panelStates)&&_.each(a.panelStates,function(a,b){var c=$("#"+b+"-view-bar"),d=$(c).next("div");a&&d.is(":visible")?(d.hide("blind",{direction:"vertical"}),$(c).find(".expander").removeClass("zicon-collapse").addClass("zicon-expand")):!a&&d.is(":hidden")&&(d.show("blind",{direction:"vertical"}),$(c).find(".expander").addClass("zicon-collapse").removeClass("zicon-expand"))})},makeConnection:function(a){console.log("make connection: "+a);switch(a){case"newFrame":var b=this;console.log("make new sequence"),this.hold=this.addLayer({type:"Link",options:{from_sequence:this.currentSequence.id,from_frame:this.currentFrame.id}}),console.log(this.hold),$("#connection-confirm").show(),$("#make-connection button").addClass("disabled"),this.busy=!0;break;case"existingFrame":console.log("link to existing");var c=zeega.module("modal"),d=new c.Views.LinkExisting;$("body").append(d.render().el),d.show();break;case"advanced":console.log("link with advanced options!");var c=zeega.module("modal"),e=new c.Views.LinkAdvanced;console.log(e),$("body").append(e.render().el),e.show()}},connectToSequenceFrame:function(a,b){console.log("connectToSequenceFrame "+a+" "+b),this.busy=!1,this.addLayer({type:"Link",options:{from_sequence:this.currentSequence.id,from_frame:this.currentFrame.id,to_sequence:a,to_frame:b}}),console.log(this)},connectToAdvanced:function(a){var b=this,c=this.addLayer({type:"Link",options:{from_sequence:this.currentSequence.id,from_frame:this.currentFrame.id}});c.on("layer_saved",function(){c.off("layer_saved");var d=_.union(a,[c.id]),e=zeega.module("sequence"),f=new e.Model({frame_id:b.currentFrame.id,layers_to_persist:d});f.save({},{success:function(){c.setToFrame(f.id,f.get("frames")[0].id),c.visual.render(),b.project.frames.add(f.get("frames")),f.set("frames",[f.get("frames")[0].id]),f.trigger("sync"),b.goToSequence(f.id),b.busy=!1}}),b.project.sequences.add(f)})},confirmConnection:function(a){console.log("confirm connection: "+a);if(a=="ok"){var b=this;console.log("create and go to new sequence");var c=[this.hold.id],d=zeega.module("sequence"),e=new d.Model({frame_id:this.currentFrame.id,layers_to_persist:c});e.save({},{success:function(){console.log("sequence saved"),console.log(e),b.busy=!1,b.hold.setToFrame(e.id,e.get("frames")[0].id),b.hold.visual.render(),b.project.frames.add(e.get("frames")),e.set("frames",[e.get("frames")[0].id]),e.trigger("sync"),b.goToSequence(e.id),this.hold=null,this.busy=!1}}),this.project.sequences.add(e)}else this.hold.trigger("editor_removeLayerFromFrame",this.hold),this.hold.destroy(),this.hold=null,this.busy=!1},deleteSequence:function(a){var b=this,c=this.project.sequences.get(a);this.currentSequence.id==a&&this.router.navigate("",{trigger:!0});var d=[];return _.each(c.get("frames"),function(a){var c=b.project.frames.get(a);d=_.union(d,c.get("layers"))}),_.each(d,function(c){var d=b.project.layers.get(c);if(d.get("type")=="Link"){var e=d.get("attr");(e.from_sequence==a||e.to_sequence==a)&&d.destroy()}}),c.destroy(),!1},setAdvanceValues:function(){var a=!1;!_.isNull(this.currentFrame.get("attr"))&&!_.isNull(this.currentFrame.get("attr").advance)&&(a=this.currentFrame.get("attr").advance);var b=$("#advance-controls");a>0?(b.find('input[id="time"]').prop("checked",!0),b.find('input[id="manual"]').prop("checked",!1),b.find('input[id="playback"]').prop("checked",!1),$("#advance-time").val(a/1e3)):a==-1?(b.find('input[id="time"]').prop("checked",!1),b.find('input[id="manual"]').prop("checked",!0),b.find('input[id="playback"]').prop("checked",!1),$("#advance-time").val(10)):a||(b.find('input[id="time"]').prop("checked",!1),b.find('input[id="manual"]').prop("checked",!1),b.find('input[id="playback"]').prop("checked",!0),$("#advance-time").val(10))},addFrame:function(a){if(!this.busy){var b=this,c=a||1,d=zeega.module("frame");for(var e=0;e<c;e++){var f=_.compact(this.currentSequence.get("attr").persistLayers)||[];console.log("new frame!!!"),console.log(this.currentSequence.get("attr").persistLayers),console.log(f);var g=new d.Model;g.set({layers:f},{silent:!0}),console.log(g),g.save({},{success:function(){console.log(g),g.render(),g.trigger("refresh_view"),g.trigger("updateThumb"),b.project.frames.add(g),b.loadFrame(g),b.currentSequence.get("frames").push(g.id)}})}}},updateFrameOrder:function(a){console.log("	UPDATE FRAME ORDER"),this.currentSequence.updateFrameOrder()},duplicateFrame:function(a){if(!this.busy){console.log("	DUPLICATE FRAME"),console.log(a);var b=this,c=a.clone();console.log(""+a.get("layers"));var d=[];_.each(a.get("layers"),function(a){zeega.app.project.layers.get(a).get("type")!="Link"&&d.push(a)}),console.log(d),c.set({layers:d,duplicate_id:parseInt(a.id),id:null}),c.oldLayerIDs=a.get("layers"),c.frameIndex=_.indexOf(this.currentSequence.get("frames"),a.id),c.dupe=!0,c.save({},{success:function(a){console.log("frame saved and is a duplicate"),console.log(a),b.currentSequence.insertFrameView(a,c.frameIndex),_.each(a.oldLayerIDs,function(c,d){var e=b.currentSequence.get("attr").persistLayers;if(_.include(e,parseInt(c))){var f=a.get("layers");f[d]=String(c),a.set({layers:f})}else b.project.layers.duplicateLayer(c,a.get("layers")[d])})}}),this.project.frames.add(c)}},addLayer:function(a){if(!this.busy){console.log("ADD LAYER");var b=this;return a=_.defaults(a,{frame:b.currentFrame,options:{},show:function(){return b.currentFrame.id==a.frame.id?!0:!1}}),console.log("show layer? "+a.show()),console.log(a),this.project.layers.addNewLayer(a)}},continueLayer:function(a){console.log("continue layer: "+a);var b=zeega.module("modal"),c=new b.Views.ContinueLayer({model:this.project.layers.get(a)});$("body").append(c.render().el),c.show()},continueLayerToNextFrame:function(a){if(!this.busy){var b=this.getRightFrame();if(b!=0&&b!=this.currentFrame){var c=[];if(b.get("layers")){var d=_.compact(b.get("layers"));d.unshift(parseInt(a)),c=d}else c=[parseInt(a)];b.save({layers:c})}}},continueOnAllFrames:function(a){if(!this.busy){var b=this.project.layers.get(a),c=_.isObject(this.currentSequence.get("attr"))?this.currentSequence.get("attr"):{persistLayers:[]};_.include(c.persistLayers,a)?(console.log("remove persistence"),c.persistLayers=_.without(c.persistLayers,a),c.persistLayers.length==0&&(c.persistLayers=[!1]),this.removePersistenceFromFrames(a)):(console.log("add persistence"),c.persistLayers.unshift(a),this.addPersistenceToFrames(a)),this.currentSequence.save({attr:c}),console.log("save current sequence",c,this.currentSequence)}},addPersistenceToFrames:function(a){var b=this;_.each(this.currentSequence.get("frames"),function(c){var d=b.project.frames.get(c),e=d.get("layers")||[];e.push(a),d.save({layers:_.compact(_.uniq(e))})})},removePersistenceFromFrames:function(a){var b=this;_.each(this.currentSequence.get("frames"),function(c){var d=b.project.frames.get(c);if(_.include(d.get("layers"),a)&&c!=b.currentFrame.id){var e=_.without(d.get("layers"),a);e.length==0&&(e=[!1]),d.save({layers:e})}})},updateLayerOrder:function(a){console.log("updateLayerOrder");var a=a||this.currentFrame,b=_.map($("#links-list>li"),function(a){return $(a).data("id")}),c=_.map($("#layers-list-visual>li"),function(a){return $(a).data("id")}),d=b.concat(c).reverse();_.each(d,function(a,b){$("#layer-visual-"+a).css("z-index",b)}),a.save({layers:_.compact(d)})},getFrameIndex:function(a){if(_.isNumber(a))frameId=a;else if(_.isString(a))frameId=parseInt(a);else{if(!_.isNumber(a.id))return!1;frameId=a.id}return _.indexOf(this.sequence.get("framesOrder"),frameId)},previewSequence:function(){console.log("preview the sequence");var a=this;this.previewMode=!0,this.exportProject(),this.unrenderFrame(this.currentFrame),this.player=new Player2($("body")),this.player.loadProject(this.exportProject(),{sequenceID:parseInt(this.currentSequence.id),frameID:parseInt(this.currentFrame.id)}),console.log("update background color"),$("body").css({background:"#000"})},restoreFromPreview:function(){this.previewMode=!1,$("body").css({background:"#333"}),this.renderFrame(this.currentFrame)},exportProject:function(a){console.log("-- EXPORT --");var b=this.project.toJSON(),c={sequences:this.project.sequences.toJSON(),frames:this.project.frames.toJSON(),layers:this.project.layers.toJSON()};return _.extend(b,c),console.log(b),a?JSON.stringify(b):b},getLeftFrame:function(){var a=_.indexOf(this.currentSequence.get("frames"),parseInt(this.currentFrame.id));return this.frames.get(frameOrder[a-1])||this.frames.get(frameOrder[1])},getRightFrame:function(){var a=_.indexOf(this.currentSequence.get("frames"),this.currentFrame.id);return this.project.frames.get(this.currentSequence.get("frames")[a+1])||!1},loadLeftFrame:function(){console.log("load left ----"),console.log(this.getLeftFrame()),this.loadFrame(this.getLeftFrame())},loadRightFrame:function(){this.loadFrame(this.getRightFrame())},udpateAspectRatio:function(a){console.log("changeAspectRatio to: "+a),console.log(this.project),this.project.set({attr:{ratio:a}}),this.project.save()},initStartHelp:function(){localStorage.help!="false"&&this.helpCounter==0&&($("#visual-editor-workspace").popover({trigger:"manual"}),this.displayStartHelp())},displayStartHelp:function(){var a=this,b=["visual-editor-workspace"];console.log("	HELPPPPPPP"),console.log(b[0]),console.log(this.helpCounter),console.log($("#"+b[a.helpCounter])),a.helpCounter>0&&($("#"+b[a.helpCounter-1]).popover("hide"),$("#"+b[a.helpCounter-1]).css("box-shadow",""));if(a.helpCounter>=b.length)return console.log("end of line"),$("#"+b[a.helpCounter-1]).css("box-shadow",""),this.turnOffHelp(),!1;$("#"+b[a.helpCounter]).popover("show"),$("#"+b[a.helpCounter]).css("box-shadow","0 0 18px orange"),this.helpCounter++},turnOffHelp:function(){console.log("turn off help windows");var a=["visual-editor-workspace","database-panel","new-layer-tray","layer-panel","frame-drawer","preview"];localStorage.help=!1,console.log(a[this.helpCounter-1]),$("#"+a[this.helpCounter-1]).popover("hide"),$("#"+a[this.helpCounter-1]).css("box-shadow",""),this.helpCounter=0},editCoverImage:function(a){a.item.get("layer_type")=="Image"&&(console.log(a),console.log("we can make something out of this"),$("#sequence-cover-image").css("background-image",'url("'+a.item.get("uri")+'")'),console.log(this),this.project.set({cover_image:a.item.get("uri")}))},shareProject:function(){var a=zeega.module("modal");this.view=new a.Views.ShareProject({model:this.project}),this.view.render()}},Backbone.Events)},define("web/js/app/zeega.js",function(){});var Player2=Backbone.View.extend({MINIMUM_LOAD:3e3,has_started:!1,loadAheadDistance:2,overlaysHidden:!1,viewportRatio:1.5,zeega:!0,apiplayer:!1,initialize:function(a,b){this.model=new Backbone.Model,this.container=a,this.generateBackbone(),_.isUndefined(zeega.app.router)&&(this.zeega=!1),_.isUndefined(b)||(this.apiplayer=b)},loadProject:function(a,b){this.container.prepend(this.render().el),$("#wrapper").hide(),$(this.el).fadeIn(),this.initListeners(),this.data=a,this.parseData(a);var c=_.isUndefined(b)||_.isUndefined(b.sequenceID)?a.sequences[0].id:b.sequenceID,d=_.isUndefined(b)||_.isUndefined(b.frameID)?_.find(a.sequences,function(a){return a.id==c}).frames[0]:b.frameID;this.setCurrentSequence(c),this.setCurrentFrame(d),_.isUndefined(zeega.app.router)?(this.startRouter(),this.updateTitle()):(this.router=zeega.app.router,this.goToFrame(this.currentFrame))},loadProjectById:function(a,b){var c=this;this.model.on("sequences_loaded",function(){c.render(),c.setCurrentSequence(c.initial_s),c.setCurrentFrame(c.initial_f),c.setCurrentLayers(),c.goToFrame(c.currentFrame)}),$.getJSON(sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"api/projects/"+a,function(a){c.sequences=new c.Sequences(a.project.sequences),c.initial_s=_.isUndefined(b)||_.isUndefined(b.sequenceID)?a.project.sequences[0].id:b.sequenceID,c.initial_f=_.isUndefined(b)||_.isUndefined(b.frameID)?_.find(a.project.sequences,function(a){return a.id==c.initial_s}).frames[0].id:b.frameID,c.model.trigger("sequences_loaded")})},startRouter:function(){var a=this,b=Backbone.Router.extend({routes:{"":"goToCurrentFrame","player/sequence/:sequenceID/frame/:frameID":"goToSequenceFrame"},goToSequenceFrame:function(b,c){a.goToSequenceFrame(b,c)},goToCurrentFrame:function(){a.goToFrame(a.currentFrame)}});this.router=new b,Backbone.history.start()},updateTitle:function(){$("title").html(this.data.title)},goToSequenceFrame:function(a,b){this.currentSequence=this.sequences.get(a),this.goToFrame(this.frames.get(b))},goToFrame:function(a){this.clearStage(a);if(a.status=="ready")this.renderFrame(a.id);else{var b=this;console.log("frame needs a little bit more to load…"),a.on("ready",function(){a.off("ready"),b.has_played?b.renderFrame(a.id):setTimeout(function(){a.loader.fadeOut(),b.startTimer=setTimeout(function(){b.renderFrame(a.id),b.has_played=!0},1e3)},2e3)})}this.router.navigate("player/sequence/"+this.currentSequence.id+"/frame/"+a.id),this.loadAhead()},clearStage:function(a){console.log("clear stage!!");if(this.currentFrame.id!=a.id){var b=this,c=this.currentFrame.get("layers"),d=a.get("layers"),e=_.difference(c,d);_.each(e,function(a){console.log("remove layer: "+a,b.layers.get(a)),b.layers.get(a).trigger("player_exit")})}},renderFrame:function(a){var b=this,c=this.frames.get(a);this.currentFrame=c,_.each(c.get("layers"),function(a,c){console.log(a),b.layers.get(a).trigger("player_play",c+1)}),this.setAdvance(c.get("attr").advance),this.updateCitations(),this.updateArrows()},loadAhead:function(){console.log("LOAD AHEAD ON SEQUENCE: "+this.currentSequence.id);var a=this.currentSequence.get("frames")||_.pluck(_.toArray(this.currentSequence.frames),"id");this.currentSequence.set("frames",a);var b=_.indexOf(a,this.currentFrame.id);for(var c=0;c<this.loadAheadDistance*2+1;c++){var d=Math.ceil(c/2)*(-1+2*(c%2)),e=b+d;if(e>=0&&e<a.length){var f=a[e],g=this.frames.get(f);g.status!="loading"&&g.status!="ready"&&this.preloadFrame(g)}}},preloadFrame:function(a){var b=this;this.currentFrame==a&&$("#zeega-player").prepend(a.loader.render().el);var c=[];_.each(a.links,function(a){c=_.union(b.frames.get(a).get("layers"),c)}),console.log("preload layers: "+_.union(c,a.get("layers"))),_.each(_.union(c,a.get("layers")),function(c){var d=b.layers.get(c);d.status!="loading"&&a.status!="ready"&&b.preloadLayer(d)}),a.trigger("loading",a.id)},preloadLayer:function(a){a.trigger("loading",a.id),this.$el.find("#preview-media").append(a.visual.render().el),a.trigger("player_preload")},setAdvance:function(a){var b=this;this.t&&clearTimeout(this.t),a!=-1&&(a==0?_.each(_.toArray(this.currentLayers),function(a){a.on("playback_ended",function(){b.goRight()})}):a>0&&(a=a<1?1:a,this.t=setTimeout(function(){b.goRight()},a)))},goLeft:function(){var a=this.getLeft();a&&this.goToFrame(a)},goRight:function(){var a=this.getRight();a&&this.goToFrame(a)},getLeft:function(a){_.isUndefined(a)&&(a=1);var b=this.currentSequence.get("frames"),c=_.indexOf(b,this.currentFrame.id);return c-a<0?!1:this.frames.get(b[c-a])},getRight:function(a){a=a||1;var b=this.currentSequence.get("frames"),c=_.indexOf(b,this.currentFrame.id);return this.frames.get(b[c+a])||!1},updateCitations:function(){var a=this,b=Backbone.View.extend({tagName:"li",className:"clearfix",render:function(){$(this.el).html(_.template(this.getTemplate(),this.model.attributes))},events:{click:"expandCitation"},expandCitation:function(a){a.stopPropagation(),$("#citation").animate({height:"100px"}),this.closeOtherCitations(),this.$el.find(".citation-content").is(":hidden")?this.$el.find(".citation-content").show():(this.$el.find(".citation-content").hide(),this.closeCitationBar())},closeOtherCitations:function(){var a=this;_.each($(".citation-content"),function(b){$(b).is(":visible")&&b!=a.$el.find(".citation-content")[0]&&$(b).hide()})},closeCitation:function(){this.$el.find(".citation-content").is(":visible")&&this.$el.find(".citation-content").hide()},expandCitationBar:function(){$("#citation").animate({height:"100px"})},closeCitationBar:function(){$("#citation").animate({height:"24px"})},getTemplate:function(){var a='<div class="citation-tab"><i class="zicon-<%= type.toLowerCase() %>"></i></div><div class="citation-content" style="display:none"><div class="citation-thumb"><img width="100%" height="100%" src="<%= attr.thumbnail_url %>"/></div><div class="citation-body"><div class="citation-title"><%= attr.title %></div><div class="citation-metadata"><a href="<%= attr.attribution_uri %>" target="blank">Link to original</a></div></div></div>';return a}});this.$el.find("#citation ul").empty(),_.each(this.currentFrame.get("layers"),function(c){var d=a.layers.get(c);!d.citation&&d.displayCitation&&(d.citation=new b({model:d})),d.citation&&(d.citation.render(),a.$el.find("#citation ul").append(d.citation.el))})},closePlayer:function(){var a=this;$("#wrapper").show(),this.unsetListeners(),_.each(_.toArray(this.currentSequence.layers),function(a){a.rendered&&a.trigger("player_unrender")}),this.zeega&&zeega.app.restoreFromPreview(),this.$el.fadeOut(450,function(){$(this).remove()})},render:function(){if(this.apiplayer)var a=this.container.width(),b=this.container.height();else var a=window.innerWidth,b=window.innerHeight;var c={};return a/b>this.viewportRatio?(c.height=b+"px",c.width=b*this.viewportRatio+"px",c.fontSize=b/519*100+"%"):(c.height=a/this.viewportRatio+"px",c.width=a+"px",c.fontSize=a/704*100+"%"),$(this.el).attr("id","preview-wrapper").append(this.getTemplate()),$(this.el).find("#preview-media").css(c),this},updateArrows:function(){var a=this.getLeft(),b=this.getRight();this.currentSequence.get("frames").length<2?(this.$el.find("#preview-left").hide(),this.$el.find("#preview-right").hide()):this.overlaysHidden||(a?this.$el.find("#preview-left").is(":hidden")&&this.$el.find("#preview-left").fadeIn():this.$el.find("#preview-left").fadeOut(),b?this.$el.find("#preview-right").is(":hidden")&&this.$el.find("#preview-right").fadeIn():this.$el.find("#preview-right").fadeOut())},fadeOutOverlays:function(a){a.overlaysHidden=!0},initListeners:function(){var a=this;$(window).bind("keydown",function(b){switch(b.which){case 27:a.zeega&&a.closePlayer();break;case 8:a.zeega&&a.closePlayer();break;case 37:a.goLeft();break;case 39:a.goRight();break;case 38:a.goUp();break;case 40:a.goDown();break;case 32:a.playPause()}}),this.apiplayer||(window.onresize=function(b){var c=window.innerWidth,d=window.innerHeight,e={};c/d>a.viewportRatio?(e.height=d+"px",e.width=d*a.viewportRatio+"px"):(e.height=c/a.viewportRatio+"px",e.width=c+"px"),a.$el.find("#preview-media").clearQueue().animate(e,500)}),$("#zeega-player").keydown(function(a){});var b=_.debounce(this.fadeOutOverlays,5e3);onmousemove=function(){a.overlaysHidden?(a.overlaysHidden=!1,$(".player-overlay").fadeIn("slow"),a.updateArrows()):b(a)}},unsetListeners:function(){$(window).unbind("keydown"),onmousemove=null},events:{"click #preview-left":"goLeft","click #preview-right":"goRight","click #preview-close":"closePlayer"},parseData:function(a){this.sequences=new this.Sequences(a.sequences);var b=zeega.module("layer"),c=[];_.each(a.layers,function(a){var d=new b[a.type](a,{player:!0});d.id=parseInt(d.id),c.push(d)}),this.layers=new this.LayerCollection(c),this.frames=new this.FrameCollection(a.frames),this.frames.addFrameLoadersAndConnections(),this.layers.on("ready",this.updateFrameStatus,this),this.model.trigger("sequences_loaded")},setCurrentSequence:function(a){this.currentSequence=this.sequences.get(a)},setCurrentFrame:function(a){this.currentFrame=this.frames.get(a)},updateFrameStatus:function(a){var b=this;_.each(_.toArray(this.frames),function(c){var d=c.get("layers"),e=b.layers.ready;_.include(d,a)&&c.loader.incrementLoaded(a),_.difference(d,e).length==0&&c.trigger("ready",c.id)})},generateBackbone:function(){var a=this,b=Backbone.Model.extend(),c=Backbone.Model.extend(),d=Backbone.View.extend({className:"progress-bar",loadedCount:0,initialize:function(){},render:function(){var b=this;return $(this.el).css("z-index",1e5),this.model.get("layers").length>0&&($(this.el).append(_.template(this.getTemplate(),a.data)),this.$el.find(".progress-types ul").empty(),_.each(this.model.get("layers"),function(c){var d=a.layers.get(c);console.log(d),console.log("load layer type: "+d.get("type"));if(d.get("type")!="Link"){var e=d.get("attr").archive?d.get("attr").archive.toLowerCase():d.get("type").toLowerCase();console.log(e),b.$el.find(".progress-types ul").append('<li class="layer-load-icon-'+d.id+'"><i class="zitem-'+e+'"></i></li>')}}),$(this.el).find(".bar").stop().animate({width:.25/this.model.get("layers").length*100+"%"},200).animate({width:.75/this.model.get("layers").length*100+"%"},1e5)),this},incrementLoaded:function(a){var b=this;this.loadedCount++,this.$el.find(".layer-load-icon-"+a+" i").addClass("loaded"),$(this.el).find(".bar").stop().animate({width:this.loadedCount/this.model.get("layers").length*100+"%"},2e3).animate({width:this.loadedCount*1.5/this.model.get("layers").length*100+"%"},1e5),this.model.get("layers").length==this.loadedCount&&b.has_played&&this.fadeOut()},fadeOut:function(){var a=this;$(this.el).fadeOut("show",function(){a.remove()})},getTemplate:function(){return html="<div class='progress-head'><h3 class='estimate'>Estimated time to experience this project. . .</h3><h3 class='time'><%= estimated_time %></h3></div><div class='progress progress-striped active progress-danger'><div class='bar' style='width:0'></div></div><div class='progress-types'><ul></ul></div>",html}});this.LayerCollection=Backbone.Collection.extend({loading:[],ready:[],initialize:function(){this.on("loading",this.updateLoadingStatus,this),this.on("ready",this.updateReadyStatus,this)},updateLoadingStatus:function(a){var b=this.get(a);b.status!="loading"&&b.status!="ready"&&(b.status="loading",this.loading.push(a))},updateReadyStatus:function(a){var b=this.get(a);b.status!="ready"&&(this.loading=_.without(this.loading,a),b.status="ready",this.ready.push(a))}}),this.FrameCollection=this.LayerCollection.extend({addFrameLoadersAndConnections:function(){_.each(_.toArray(this),function(b){b.loader=new d({model:b});var c=[];_.each(b.get("layers"),function(d){var e=a.layers.get(d);e.get("type")=="Link"&&e.get("attr").from_frame==b.id&&c.push(e.get("attr").to_frame)}),b.links=c})}});var e=Backbone.Model.extend({initialize:function(){this.parseData()},parseData:function(){},updateFrameStatus:function(a){var b=this;_.each(_.toArray(this.frames),function(c){var d=c.get("layers"),e=b.layers.ready;_.include(d,a)&&c.loader.incrementLoaded(),_.difference(d,e).length==0&&c.trigger("ready",c.id)})}});this.Sequences=Backbone.Collection.extend({model:e,initialize:function(){}})},getTemplate:function(){return html="<div id='zeega-player'>",this.zeega&&(html+="<div id='preview-close' class='player-overlay'><a href='#'><span class='zicon orange zicon-close' ></span></a></div>"),html+="<div id='preview-left' class='hidden preview-nav-arrow preview-nav'><div class='arrow-background'></div><img class='player-arrow arrow-left' src='"+sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"images/mediaPlayerArrow_shadow.png"+"'>"+"</div>"+"<div id='preview-right' class='hidden preview-nav-arrow preview-nav'>"+"<div class='arrow-background'></div>"+"<img class='player-arrow arrow-right' src='"+sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"images/mediaPlayerArrow_shadow.png"+"'>"+"</div>"+"<div id='preview-media'></div>"+"<div id='citation' class='player-overlay'><ul class='clearfix'></ul></div>",html}});define("web/js/app/zeega.player.js",function(){}),function(a){a.fn.spin=function(b,c){var d={tiny:{lines:9,length:3,width:2,radius:4},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8},slow:{lines:6,length:3,width:2,radius:4,speed:.5}};if(Spinner)return this.each(function(){var e=a(this),f=e.data();f.spinner&&(f.spinner.stop(),delete f.spinner),b!==!1&&(typeof b=="string"&&(b in d?b=d[b]:b={},c&&(b.color=c)),f.spinner=(new Spinner(a.extend({color:e.css("color")},b))).spin(this))});throw"Spinner class not available."}}(jQuery),define("web/js/lib/jquery/plugins/spin.js",function(){}),function($){$.fn.editable=function(a,b){if("disable"==a){$(this).data("disabled.editable",!0);return}if("enable"==a){$(this).data("disabled.editable",!1);return}if("destroy"==a){$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");return}var c=$.extend({},$.fn.editable.defaults,{target:a},b),d=$.editable.types[c.type].plugin||function(){},e=$.editable.types[c.type].submit||function(){},f=$.editable.types[c.type].buttons||$.editable.types.defaults.buttons,g=$.editable.types[c.type].content||$.editable.types.defaults.content,h=$.editable.types[c.type].element||$.editable.types.defaults.element,i=$.editable.types[c.type].reset||$.editable.types.defaults.reset,j=c.callback||function(){},k=c.onedit||function(){},l=c.onsubmit||function(){},m=c.onreset||function(){},n=c.onerror||i;return c.tooltip&&$(this).attr("title",c.tooltip),c.autowidth="auto"==c.width,c.autoheight="auto"==c.height,this.each(function(){var a=this,b=$(a).width(),o=$(a).height();$(this).data("event.editable",c.event),$.trim($(this).html())||$(this).html(c.placeholder),$(this).bind(c.event,function(m){if(!0===$(this).data("disabled.editable"))return;if(a.editing)return;if(!1===k.apply(this,[c,a]))return;m.preventDefault(),m.stopPropagation(),c.tooltip&&$(a).removeAttr("title"),0==$(a).width()?(c.width=b,c.height=o):(c.width!="none"&&(c.width=c.autowidth?$(a).width():c.width),c.height!="none"&&(c.height=c.autoheight?$(a).height():c.height)),$(this).html().toLowerCase().replace(/(;|"|\/)/g,"")==c.placeholder.toLowerCase().replace(/(;|"|\/)/g,"")&&$(this).html(""),a.editing=!0,a.revert=$(a).html(),$(a).html("");var p=$("<form />");c.cssclass&&("inherit"==c.cssclass?p.attr("class",$(a).attr("class")):p.attr("class",c.cssclass)),c.style&&("inherit"==c.style?(p.attr("style",$(a).attr("style")),p.css("display",$(a).css("display"))):p.attr("style",c.style));var q=h.apply(p,[c,a]),r;if(c.loadurl){var s=setTimeout(function(){q.disabled=!0,g.apply(p,[c.loadtext,c,a])},100),t={};t[c.id]=a.id,$.isFunction(c.loaddata)?$.extend(t,c.loaddata.apply(a,[a.revert,c])):$.extend(t,c.loaddata),$.ajax({type:c.loadtype,url:c.loadurl,data:t,async:!1,success:function(a){window.clearTimeout(s),r=a,q.disabled=!1}})}else c.data?(r=c.data,$.isFunction(c.data)&&(r=c.data.apply(a,[a.revert,c]))):r=a.revert;g.apply(p,[r,c,a]),q.attr("name",c.name),f.apply(p,[c,a]),$(a).append(p),d.apply(p,[c,a]),$(":input:visible:enabled:first",p).focus(),c.select&&q.select(),q.keydown(function(b){b.keyCode==27&&(b.preventDefault(),i.apply(p,[c,a]))});var s;"cancel"==c.onblur?q.blur(function(b){s=setTimeout(function(){i.apply(p,[c,a])},500)}):"submit"==c.onblur?q.blur(function(a){s=setTimeout(function(){p.submit()},200)}):$.isFunction(c.onblur)?q.blur(function(b){c.onblur.apply(a,[q.val(),c])}):q.blur(function(a){}),p.submit(function(b){s&&clearTimeout(s),b.preventDefault();if(!1!==l.apply(p,[c,a])&&!1!==e.apply(p,[c,a]))if($.isFunction(c.target)){var d=c.target.apply(a,[q.val(),c]);$(a).html(d),a.editing=!1,j.apply(a,[a.innerHTML,c]),$.trim($(a).html())||$(a).html(c.placeholder)}else{var f={};f[c.name]=q.val(),f[c.id]=a.id,$.isFunction(c.submitdata)?$.extend(f,c.submitdata.apply(a,[a.revert,c])):$.extend(f,c.submitdata),"PUT"==c.method&&(f._method="put"),$(a).html(c.indicator);var g={type:"POST",data:f,dataType:"html",url:c.target,success:function(b,d){g.dataType=="html"&&$(a).html(b),a.editing=!1,j.apply(a,[b,c]),$.trim($(a).html())||$(a).html(c.placeholder)},error:function(b,d,e){n.apply(p,[c,a,b])}};$.extend(g,c.ajaxoptions),$.ajax(g)}return $(a).attr("title",c.tooltip),!1})}),this.reset=function(b){this.editing&&!1!==m.apply(b,[c,a])&&($(a).html(a.revert),a.editing=!1,$.trim($(a).html())||$(a).html(c.placeholder),c.tooltip&&$(a).attr("title",c.tooltip))}})},$.editable={types:{defaults:{element:function(a,b){var c=$('<input type="hidden"></input>');return $(this).append(c),c},content:function(a,b,c){$(":input:first",this).val(a)},reset:function(a,b){b.reset(this)},buttons:function(a,b){var c=this;if(a.submit){if(a.submit.match(/>$/))var d=$(a.submit).click(function(){d.attr("type")!="submit"&&c.submit()});else{var d=$('<button type="submit" />');d.html(a.submit)}$(this).append(d)}if(a.cancel){if(a.cancel.match(/>$/))var e=$(a.cancel);else{var e=$('<button type="cancel" />');e.html(a.cancel)}$(this).append(e),$(e).click(function(d){if($.isFunction($.editable.types[a.type].reset))var e=$.editable.types[a.type].reset;else var e=$.editable.types.defaults.reset;return e.apply(c,[a,b]),!1})}}},text:{element:function(a,b){var c=$("<input />");return a.width!="none"&&c.attr("width",a.width),a.height!="none"&&c.attr("height",a.height),c.attr("autocomplete","off"),a.size&&c.attr("size",a.size),a.maxlength&&c.attr("maxlength",a.maxlength),$(this).append(c),c}},textarea:{element:function(a,b){var c=$("<textarea />");return a.rows?c.attr("rows",a.rows):a.height!="none"&&c.height(a.height),a.cols?c.attr("cols",a.cols):a.width!="none"&&c.width(a.width),$(this).append(c),c}},select:{element:function(a,b){var c=$("<select />");return $(this).append(c),c},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json){if(!json.hasOwnProperty(key))continue;if("selected"==key)continue;var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){($(this).val()==json["selected"]||$(this).text()==$.trim(original.revert))&&$(this).attr("selected","selected")});if(!settings.submit){var form=this;$("select",this).change(function(){form.submit()})}}}},addInputType:function(a,b){$.editable.types[a]=b}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery),define("web/js/lib/jquery/plugins/jeditable.min.js",function(){}),function(a){function c(b){a.fn.cycle.debug&&d(b)}function d(){window.console&&console.log&&console.log("[cycle] "+Array.prototype.join.call(arguments," "))}function e(b,c,d){var e=a(b).data("cycle.opts"),f=!!b.cyclePause;f&&e.paused?e.paused(b,e,c,d):!f&&e.resumed&&e.resumed(b,e,c,d)}function f(b,c,f){function j(b,c,e){if(!b&&c===!0){var f=a(e).data("cycle.opts");if(!f)return d("options not found, can not resume"),!1;e.cycleTimeout&&(clearTimeout(e.cycleTimeout),e.cycleTimeout=0),m(f.elements,f,1,!f.backwards)}}b.cycleStop==undefined&&(b.cycleStop=0);if(c===undefined||c===null)c={};if(c.constructor==String){switch(c){case"destroy":case"stop":var g=a(b).data("cycle.opts");if(!g)return!1;return b.cycleStop++,b.cycleTimeout&&clearTimeout(b.cycleTimeout),b.cycleTimeout=0,g.elements&&a(g.elements).stop(),a(b).removeData("cycle.opts"),c=="destroy"&&h(g),!1;case"toggle":return b.cyclePause=b.cyclePause===1?0:1,j(b.cyclePause,f,b),e(b),!1;case"pause":return b.cyclePause=1,e(b),!1;case"resume":return b.cyclePause=0,j(!1,f,b),e(b),!1;case"prev":case"next":var g=a(b).data("cycle.opts");if(!g)return d('options not found, "prev/next" ignored'),!1;return a.fn.cycle[c](g),!1;default:c={fx:c}}return c}if(c.constructor==Number){var i=c;return c=a(b).data("cycle.opts"),c?i<0||i>=c.elements.length?(d("invalid slide index: "+i),!1):(c.nextSlide=i,b.cycleTimeout&&(clearTimeout(b.cycleTimeout),b.cycleTimeout=0),typeof f=="string"&&(c.oneTimeFx=f),m(c.elements,c,1,i>=c.currSlide),!1):(d("options not found, can not advance slide"),!1)}return c}function g(b,c){if(!a.support.opacity&&c.cleartype&&b.style.filter)try{b.style.removeAttribute("filter")}catch(d){}}function h(b){b.next&&a(b.next).unbind(b.prevNextEvent),b.prev&&a(b.prev).unbind(b.prevNextEvent),(b.pager||b.pagerAnchorBuilder)&&a.each(b.pagerAnchors||[],function(){this.unbind().remove()}),b.pagerAnchors=null,b.destroy&&b.destroy(b)}function i(b,c,f,h,i){var n=a.extend({},a.fn.cycle.defaults,h||{},a.metadata?b.metadata():a.meta?b.data():{}),p=a.isFunction(b.data)?b.data(n.metaAttr):null;p&&(n=a.extend(n,p)),n.autostop&&(n.countdown=n.autostopCount||f.length);var s=b[0];b.data("cycle.opts",n),n.$cont=b,n.stopCount=s.cycleStop,n.elements=f,n.before=n.before?[n.before]:[],n.after=n.after?[n.after]:[],!a.support.opacity&&n.cleartype&&n.after.push(function(){g(this,n)}),n.continuous&&n.after.push(function(){m(f,n,0,!n.backwards)}),j(n),!a.support.opacity&&n.cleartype&&!n.cleartypeNoBg&&r(c),b.css("position")=="static"&&b.css("position","relative"),n.width&&b.width(n.width),n.height&&n.height!="auto"&&b.height(n.height),n.startingSlide?n.startingSlide=parseInt(n.startingSlide,10):n.backwards&&(n.startingSlide=f.length-1);if(n.random){n.randomMap=[];for(var t=0;t<f.length;t++)n.randomMap.push(t);n.randomMap.sort(function(a,b){return Math.random()-.5}),n.randomIndex=1,n.startingSlide=n.randomMap[1]}else n.startingSlide>=f.length&&(n.startingSlide=0);n.currSlide=n.startingSlide||0;var u=n.startingSlide;c.css({position:"absolute",top:0,left:0}).hide().each(function(b){var c;n.backwards?c=u?b<=u?f.length+(b-u):u-b:f.length-b:c=u?b>=u?f.length-(b-u):u-b:f.length-b,a(this).css("z-index",c)}),a(f[u]).css("opacity",1).show(),g(f[u],n),n.fit&&(n.aspect?c.each(function(){var b=a(this),c=n.aspect===!0?b.width()/b.height():n.aspect;n.width&&b.width()!=n.width&&(b.width(n.width),b.height(n.width/c)),n.height&&b.height()<n.height&&(b.height(n.height),b.width(n.height*c))}):(n.width&&c.width(n.width),n.height&&n.height!="auto"&&c.height(n.height))),n.center&&(!n.fit||n.aspect)&&c.each(function(){var b=a(this);b.css({"margin-left":n.width?(n.width-b.width())/2+"px":0,"margin-top":n.height?(n.height-b.height())/2+"px":0})}),n.center&&!n.fit&&!n.slideResize&&c.each(function(){var b=a(this);b.css({"margin-left":n.width?(n.width-b.width())/2+"px":0,"margin-top":n.height?(n.height-b.height())/2+"px":0})});var v=n.containerResize&&!b.innerHeight();if(v){var w=0,x=0;for(var y=0;y<f.length;y++){var z=a(f[y]),A=z[0],B=z.outerWidth(),C=z.outerHeight();B||(B=A.offsetWidth||A.width||z.attr("width")),C||(C=A.offsetHeight||A.height||z.attr("height")),w=B>w?B:w,x=C>x?C:x}w>0&&x>0&&b.css({width:w+"px",height:x+"px"})}var D=!1;n.pause&&b.hover(function(){D=!0,this.cyclePause++,e(s,!0)},function(){D&&this.cyclePause--,e(s,!0)});if(k(n)===!1)return!1;var E=!1;h.requeueAttempts=h.requeueAttempts||0,c.each(function(){var b=a(this);this.cycleH=n.fit&&n.height?n.height:b.height()||this.offsetHeight||this.height||b.attr("height")||0,this.cycleW=n.fit&&n.width?n.width:b.width()||this.offsetWidth||this.width||b.attr("width")||0;if(b.is("img")){var c=a.browser.msie&&this.cycleW==28&&this.cycleH==30&&!this.complete,e=a.browser.mozilla&&this.cycleW==34&&this.cycleH==19&&!this.complete,f=a.browser.opera&&(this.cycleW==42&&this.cycleH==19||this.cycleW==37&&this.cycleH==17)&&!this.complete,g=this.cycleH==0&&this.cycleW==0&&!this.complete;if(c||e||f||g){if(i.s&&n.requeueOnImageNotLoaded&&++h.requeueAttempts<100)return d(h.requeueAttempts," - img slide not loaded, requeuing slideshow: ",this.src,this.cycleW,this.cycleH),setTimeout(function(){a(i.s,i.c).cycle(h)},n.requeueTimeout),E=!0,!1;d("could not determine size of image: "+this.src,this.cycleW,this.cycleH)}}return!0});if(E)return!1;n.cssBefore=n.cssBefore||{},n.cssAfter=n.cssAfter||{},n.cssFirst=n.cssFirst||{},n.animIn=n.animIn||{},n.animOut=n.animOut||{},c.not(":eq("+u+")").css(n.cssBefore),a(c[u]).css(n.cssFirst);if(n.timeout){n.timeout=parseInt(n.timeout,10),n.speed.constructor==String&&(n.speed=a.fx.speeds[n.speed]||parseInt(n.speed,10)),n.sync||(n.speed=n.speed/2);var F=n.fx=="none"?0:n.fx=="shuffle"?500:250;while(n.timeout-n.speed<F)n.timeout+=n.speed}n.easing&&(n.easeIn=n.easeOut=n.easing),n.speedIn||(n.speedIn=n.speed),n.speedOut||(n.speedOut=n.speed),n.slideCount=f.length,n.currSlide=n.lastSlide=u,n.random?(++n.randomIndex==f.length&&(n.randomIndex=0),n.nextSlide=n.randomMap[n.randomIndex]):n.backwards?n.nextSlide=n.startingSlide==0?f.length-1:n.startingSlide-1:n.nextSlide=n.startingSlide>=f.length-1?0:n.startingSlide+1;if(!n.multiFx){var G=a.fn.cycle.transitions[n.fx];if(a.isFunction(G))G(b,c,n);else if(n.fx!="custom"&&!n.multiFx)return d("unknown transition: "+n.fx,"; slideshow terminating"),!1}var H=c[u];return n.skipInitializationCallbacks||(n.before.length&&n.before[0].apply(H,[H,H,n,!0]),n.after.length&&n.after[0].apply(H,[H,H,n,!0])),n.next&&a(n.next).bind(n.prevNextEvent,function(){return o(n,1)}),n.prev&&a(n.prev).bind(n.prevNextEvent,function(){return o(n,0)}),(n.pager||n.pagerAnchorBuilder)&&q(f,n),l(n,f),n}function j(b){b.original={before:[],after:[]},b.original.cssBefore=a.extend({},b.cssBefore),b.original.cssAfter=a.extend({},b.cssAfter),b.original.animIn=a.extend({},b.animIn),b.original.animOut=a.extend({},b.animOut),a.each(b.before,function(){b.original.before.push(this)}),a.each(b.after,function(){b.original.after.push(this)})}function k(b){var e,f,g=a.fn.cycle.transitions;if(b.fx.indexOf(",")>0){b.multiFx=!0,b.fxs=b.fx.replace(/\s*/g,"").split(",");for(e=0;e<b.fxs.length;e++){var h=b.fxs[e];f=g[h];if(!f||!g.hasOwnProperty(h)||!a.isFunction(f))d("discarding unknown transition: ",h),b.fxs.splice(e,1),e--}if(!b.fxs.length)return d("No valid transitions named; slideshow terminating."),!1}else if(b.fx=="all"){b.multiFx=!0,b.fxs=[];for(p in g)f=g[p],g.hasOwnProperty(p)&&a.isFunction(f)&&b.fxs.push(p)}if(b.multiFx&&b.randomizeEffects){var i=Math.floor(Math.random()*20)+30;for(e=0;e<i;e++){var j=Math.floor(Math.random()*b.fxs.length);b.fxs.push(b.fxs.splice(j,1)[0])}c("randomized fx sequence: ",b.fxs)}return!0}function l(b,c){b.addSlide=function(d,e){var f=a(d),g=f[0];b.autostopCount||b.countdown++,c[e?"unshift":"push"](g),b.els&&b.els[e?"unshift":"push"](g),b.slideCount=c.length,f.css("position","absolute"),f[e?"prependTo":"appendTo"](b.$cont),e&&(b.currSlide++,b.nextSlide++),!a.support.opacity&&b.cleartype&&!b.cleartypeNoBg&&r(f),b.fit&&b.width&&f.width(b.width),b.fit&&b.height&&b.height!="auto"&&f.height(b.height),g.cycleH=b.fit&&b.height?b.height:f.height(),g.cycleW=b.fit&&b.width?b.width:f.width(),f.css(b.cssBefore),(b.pager||b.pagerAnchorBuilder)&&a.fn.cycle.createPagerAnchor(c.length-1,g,a(b.pager),c,b),a.isFunction(b.onAddSlide)?b.onAddSlide(f):f.hide()}}function m(b,d,e,f){e&&d.busy&&d.manualTrump&&(c("manualTrump in go(), stopping active transition"),a(b).stop(!0,!0),d.busy=0);if(d.busy){c("transition active, ignoring new tx request");return}var g=d.$cont[0],h=b[d.currSlide],i=b[d.nextSlide];if(g.cycleStop!=d.stopCount||g.cycleTimeout===0&&!e)return;if(!e&&!g.cyclePause&&!d.bounce&&(d.autostop&&--d.countdown<=0||d.nowrap&&!d.random&&d.nextSlide<d.currSlide)){d.end&&d.end(d);return}var j=!1;if((e||!g.cyclePause)&&d.nextSlide!=d.currSlide){j=!0;var k=d.fx;h.cycleH=h.cycleH||a(h).height(),h.cycleW=h.cycleW||a(h).width(),i.cycleH=i.cycleH||a(i).height(),i.cycleW=i.cycleW||a(i).width(),d.multiFx&&(f&&(d.lastFx==undefined||++d.lastFx>=d.fxs.length)?d.lastFx=0:!f&&(d.lastFx==undefined||--d.lastFx<0)&&(d.lastFx=d.fxs.length-1),k=d.fxs[d.lastFx]),d.oneTimeFx&&(k=d.oneTimeFx,d.oneTimeFx=null),a.fn.cycle.resetState(d,k),d.before.length&&a.each(d.before,function(a,b){if(g.cycleStop!=d.stopCount)return;b.apply(i,[h,i,d,f])});var l=function(){d.busy=0,a.each(d.after,function(a,b){if(g.cycleStop!=d.stopCount)return;b.apply(i,[h,i,d,f])})};c("tx firing("+k+"); currSlide: "+d.currSlide+"; nextSlide: "+d.nextSlide),d.busy=1,d.fxFn?d.fxFn(h,i,d,l,f,e&&d.fastOnEvent):a.isFunction(a.fn.cycle[d.fx])?a.fn.cycle[d.fx](h,i,d,l,f,e&&d.fastOnEvent):a.fn.cycle.custom(h,i,d,l,f,e&&d.fastOnEvent)}if(j||d.nextSlide==d.currSlide){d.lastSlide=d.currSlide;if(d.random)d.currSlide=d.nextSlide,++d.randomIndex==b.length&&(d.randomIndex=0),d.nextSlide=d.randomMap[d.randomIndex],d.nextSlide==d.currSlide&&(d.nextSlide=d.currSlide==d.slideCount-1?0:d.currSlide+1);else if(d.backwards){var o=d.nextSlide-1<0;o&&d.bounce?(d.backwards=!d.backwards,d.nextSlide=1,d.currSlide=0):(d.nextSlide=o?b.length-1:d.nextSlide-1,d.currSlide=o?0:d.nextSlide+1)}else{var o=d.nextSlide+1==b.length;o&&d.bounce?(d.backwards=!d.backwards,d.nextSlide=b.length-2,d.currSlide=b.length-1):(d.nextSlide=o?0:d.nextSlide+1,d.currSlide=o?b.length-1:d.nextSlide-1)}}j&&d.pager&&d.updateActivePagerLink(d.pager,d.currSlide,d.activePagerClass);var p=0;d.timeout&&!d.continuous?p=n(b[d.currSlide],b[d.nextSlide],d,f):d.continuous&&g.cyclePause&&(p=10),p>0&&(g.cycleTimeout=setTimeout(function(){m(b,d,0,!d.backwards)},p))}function n(a,b,d,e){if(d.timeoutFn){var f=d.timeoutFn.call(a,a,b,d,e);while(d.fx!="none"&&f-d.speed<250)f+=d.speed;c("calculated timeout: "+f+"; speed: "+d.speed);if(f!==!1)return f}return d.timeout}function o(b,c){var d=c?1:-1,e=b.elements,f=b.$cont[0],g=f.cycleTimeout;g&&(clearTimeout(g),f.cycleTimeout=0);if(b.random&&d<0)b.randomIndex--,--b.randomIndex==-2?b.randomIndex=e.length-2:b.randomIndex==-1&&(b.randomIndex=e.length-1),b.nextSlide=b.randomMap[b.randomIndex];else if(b.random)b.nextSlide=b.randomMap[b.randomIndex];else{b.nextSlide=b.currSlide+d;if(b.nextSlide<0){if(b.nowrap)return!1;b.nextSlide=e.length-1}else if(b.nextSlide>=e.length){if(b.nowrap)return!1;b.nextSlide=0}}var h=b.onPrevNextEvent||b.prevNextClick;return a.isFunction(h)&&h(d>0,b.nextSlide,e[b.nextSlide]),m(e,b,1,c),!1}function q(b,c){var d=a(c.pager);a.each(b,function(e,f){a.fn.cycle.createPagerAnchor(e,f,d,b,c)}),c.updateActivePagerLink(c.pager,c.startingSlide,c.activePagerClass)}function r(b){function d(a){return a=parseInt(a,10).toString(16),a.length<2?"0"+a:a}function e(b){for(;b&&b.nodeName.toLowerCase()!="html";b=b.parentNode){var c=a.css(b,"background-color");if(c&&c.indexOf("rgb")>=0){var e=c.match(/\d+/g);return"#"+d(e[0])+d(e[1])+d(e[2])}if(c&&c!="transparent")return c}return"#ffffff"}c("applying clearType background-color hack"),b.each(function(){a(this).css("background-color",e(this))})}var b="2.9995";a.support==undefined&&(a.support={opacity:!a.browser.msie}),a.expr[":"].paused=function(a){return a.cyclePause},a.fn.cycle=function(b,e){var g={s:this.selector,c:this.context};return this.length===0&&b!="stop"?!a.isReady&&g.s?(d("DOM not ready, queuing slideshow"),a(function(){a(g.s,g.c).cycle(b,e)}),this):(d("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)")),this):this.each(function(){var h=f(this,b,e);if(h===!1)return;h.updateActivePagerLink=h.updateActivePagerLink||a.fn.cycle.updateActivePagerLink,this.cycleTimeout&&clearTimeout(this.cycleTimeout),this.cycleTimeout=this.cyclePause=0;var j=a(this),k=h.slideExpr?a(h.slideExpr,this):j.children(),l=k.get(),o=i(j,k,l,h,g);if(o===!1)return;if(l.length<2){d("terminating; too few slides: "+l.length);return}var p=o.continuous?10:n(l[o.currSlide],l[o.nextSlide],o,!o.backwards);p&&(p+=o.delay||0,p<10&&(p=10),c("first timeout: "+p),this.cycleTimeout=setTimeout(function(){m(l,o,0,!h.backwards)},p))})},a.fn.cycle.resetState=function(b,c){c=c||b.fx,b.before=[],b.after=[],b.cssBefore=a.extend({},b.original.cssBefore),b.cssAfter=a.extend({},b.original.cssAfter),b.animIn=a.extend({},b.original.animIn),b.animOut=a.extend({},b.original.animOut),b.fxFn=null,a.each(b.original.before,function(){b.before.push(this)}),a.each(b.original.after,function(){b.after.push(this)});var d=a.fn.cycle.transitions[c];a.isFunction(d)&&d(b.$cont,a(b.elements),b)},a.fn.cycle.updateActivePagerLink=function(b,c,d){a(b).each(function(){a(this).children().removeClass(d).eq(c).addClass(d)})},a.fn.cycle.next=function(a){o(a,1)},a.fn.cycle.prev=function(a){o(a,0)},a.fn.cycle.createPagerAnchor=function(b,d,f,g,h){var i;a.isFunction(h.pagerAnchorBuilder)?(i=h.pagerAnchorBuilder(b,d),c("pagerAnchorBuilder("+b+", el) returned: "+i)):i='<a href="#">'+(b+1)+"</a>";if(!i)return;var j=a(i);if(j.parents("body").length===0){var k=[];f.length>1?(f.each(function(){var b=j.clone(!0);a(this).append(b),k.push(b[0])}),j=a(k)):j.appendTo(f)}h.pagerAnchors=h.pagerAnchors||[],h.pagerAnchors.push(j);var l=function(c){c.preventDefault(),h.nextSlide=b;var d=h.$cont[0],e=d.cycleTimeout;e&&(clearTimeout(e),d.cycleTimeout=0);var f=h.onPagerEvent||h.pagerClick;a.isFunction(f)&&f(h.nextSlide,g[h.nextSlide]),m(g,h,1,h.currSlide<b)};/mouseenter|mouseover/i.test(h.pagerEvent)?j.hover(l,function(){}):j.bind(h.pagerEvent,l),!/^click/.test(h.pagerEvent)&&!h.allowPagerClickBubble&&j.bind("click.cycle",function(){return!1});var n=h.$cont[0],o=!1;h.pauseOnPagerHover&&j.hover(function(){o=!0,n.cyclePause++,e(n,!0,!0)},function(){o&&n.cyclePause--,e(n,!0,!0)})},a.fn.cycle.hopsFromLast=function(a,b){var c,d=a.lastSlide,e=a.currSlide;return b?c=e>d?e-d:a.slideCount-d:c=e<d?d-e:d+a.slideCount-e,c},a.fn.cycle.commonReset=function(b,c,d,e,f,g){a(d.elements).not(b).hide(),typeof d.cssBefore.opacity=="undefined"&&(d.cssBefore.opacity=1),d.cssBefore.display="block",d.slideResize&&e!==!1&&c.cycleW>0&&(d.cssBefore.width=c.cycleW),d.slideResize&&f!==!1&&c.cycleH>0&&(d.cssBefore.height=c.cycleH),d.cssAfter=d.cssAfter||{},d.cssAfter.display="none",a(b).css("zIndex",d.slideCount+(g===!0?1:0)),a(c).css("zIndex",d.slideCount+(g===!0?0:1))},a.fn.cycle.custom=function(b,c,d,e,f,g){var h=a(b),i=a(c),j=d.speedIn,k=d.speedOut,l=d.easeIn,m=d.easeOut;i.css(d.cssBefore),g&&(typeof g=="number"?j=k=g:j=k=1,l=m=null);var n=function(){i.animate(d.animIn,j,l,function(){e()})};h.animate(d.animOut,k,m,function(){h.css(d.cssAfter),d.sync||n()}),d.sync&&n()},a.fn.cycle.transitions={fade:function(b,c,d){c.not(":eq("+d.currSlide+")").css("opacity",0),d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d),d.cssBefore.opacity=0}),d.animIn={opacity:1},d.animOut={opacity:0},d.cssBefore={top:0,left:0}}},a.fn.cycle.ver=function(){return b},a.fn.cycle.defaults={activePagerClass:"activeSlide",after:null,allowPagerClickBubble:!1,animIn:null,animOut:null,aspect:!1,autostop:0,autostopCount:0,backwards:!1,before:null,center:null,cleartype:!a.support.opacity,cleartypeNoBg:!1,containerResize:1,continuous:0,cssAfter:null,cssBefore:null,delay:0,easeIn:null,easeOut:null,easing:null,end:null,fastOnEvent:0,fit:0,fx:"fade",fxFn:null,height:"auto",manualTrump:!0,metaAttr:"cycle",next:null,nowrap:0,onPagerEvent:null,onPrevNextEvent:null,pager:null,pagerAnchorBuilder:null,pagerEvent:"click.cycle",pause:0,pauseOnPagerHover:0,prev:null,prevNextEvent:"click.cycle",random:0,randomizeEffects:1,requeueOnImageNotLoaded:!0,requeueTimeout:250,rev:0,shuffle:null,skipInitializationCallbacks:!1,slideExpr:null,slideResize:1,speed:1e3,speedIn:null,speedOut:null,startingSlide:0,sync:1,timeout:4e3,timeoutFn:null,updateActivePagerLink:null,width:null}}(jQuery),function(a){a.fn.cycle.transitions.none=function(b,c,d){d.fxFn=function(b,c,d,e){a(c).show(),a(b).hide(),e()}},a.fn.cycle.transitions.fadeout=function(b,c,d){c.not(":eq("+d.currSlide+")").css({display:"block",opacity:1}),d.before.push(function(b,c,d,e,f,g){a(b).css("zIndex",d.slideCount+(!g==1?1:0)),a(c).css("zIndex",d.slideCount+(!g==1?0:1))}),d.animIn.opacity=1,d.animOut.opacity=0,d.cssBefore.opacity=1,d.cssBefore.display="block",d.cssAfter.zIndex=0},a.fn.cycle.transitions.scrollUp=function(b,c,d){b.css("overflow","hidden"),d.before.push(a.fn.cycle.commonReset);var e=b.height();d.cssBefore.top=e,d.cssBefore.left=0,d.cssFirst.top=0,d.animIn.top=0,d.animOut.top=-e},a.fn.cycle.transitions.scrollDown=function(b,c,d){b.css("overflow","hidden"),d.before.push(a.fn.cycle.commonReset);var e=b.height();d.cssFirst.top=0,d.cssBefore.top=-e,d.cssBefore.left=0,d.animIn.top=0,d.animOut.top=e},a.fn.cycle.transitions.scrollLeft=function(b,c,d){b.css("overflow","hidden"),d.before.push(a.fn.cycle.commonReset);var e=b.width();d.cssFirst.left=0,d.cssBefore.left=e,d.cssBefore.top=0,d.animIn.left=0,d.animOut.left=0-e},a.fn.cycle.transitions.scrollRight=function(b,c,d){b.css("overflow","hidden"),d.before.push(a.fn.cycle.commonReset);var e=b.width();d.cssFirst.left=0,d.cssBefore.left=-e,d.cssBefore.top=0,d.animIn.left=0,d.animOut.left=e},a.fn.cycle.transitions.scrollHorz=function(b,c,d){b.css("overflow","hidden").width(),d.before.push(function(b,c,d,e){d.rev&&(e=!e),a.fn.cycle.commonReset(b,c,d),d.cssBefore.left=e?c.cycleW-1:1-c.cycleW,d.animOut.left=e?-b.cycleW:b.cycleW}),d.cssFirst.left=0,d.cssBefore.top=0,d.animIn.left=0,d.animOut.top=0},a.fn.cycle.transitions.scrollVert=function(b,c,d){b.css("overflow","hidden"),d.before.push(function(b,c,d,e){d.rev&&(e=!e),a.fn.cycle.commonReset(b,c,d),d.cssBefore.top=e?1-c.cycleH:c.cycleH-1,d.animOut.top=e?b.cycleH:-b.cycleH}),d.cssFirst.top=0,d.cssBefore.left=0,d.animIn.top=0,d.animOut.left=0},a.fn.cycle.transitions.slideX=function(b,c,d){d.before.push(function(b,c,d){a(d.elements).not(b).hide(),a.fn.cycle.commonReset(b,c,d,!1,!0),d.animIn.width=c.cycleW}),d.cssBefore.left=0,d.cssBefore.top=0,d.cssBefore.width=0,d.animIn.width="show",d.animOut.width=0},a.fn.cycle.transitions.slideY=function(b,c,d){d.before.push(function(b,c,d){a(d.elements).not(b).hide(),a.fn.cycle.commonReset(b,c,d,!0,!1),d.animIn.height=c.cycleH}),d.cssBefore.left=0,d.cssBefore.top=0,d.cssBefore.height=0,d.animIn.height="show",d.animOut.height=0},a.fn.cycle.transitions.shuffle=function(b,c,d){var e,f=b.css("overflow","visible").width();c.css({left:0,top:0}),d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!0,!0,!0)}),d.speedAdjusted||(d.speed=d.speed/2,d.speedAdjusted=!0),d.random=0,d.shuffle=d.shuffle||{left:-f,top:15},d.els=[];for(e=0;e<c.length;e++)d.els.push(c[e]);for(e=0;e<d.currSlide;e++)d.els.push(d.els.shift());d.fxFn=function(b,c,d,e,f){d.rev&&(f=!f);var g=f?a(b):a(c);a(c).css(d.cssBefore);var h=d.slideCount;g.animate(d.shuffle,d.speedIn,d.easeIn,function(){var c=a.fn.cycle.hopsFromLast(d,f);for(var i=0;i<c;i++)f?d.els.push(d.els.shift()):d.els.unshift(d.els.pop());if(f)for(var j=0,k=d.els.length;j<k;j++)a(d.els[j]).css("z-index",k-j+h);else{var l=a(b).css("z-index");g.css("z-index",parseInt(l,10)+1+h)}g.animate({left:0,top:0},d.speedOut,d.easeOut,function(){a(f?this:b).hide(),e&&e()})})},a.extend(d.cssBefore,{display:"block",opacity:1,top:0,left:0})},a.fn.cycle.transitions.turnUp=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!0,!1),d.cssBefore.top=c.cycleH,d.animIn.height=c.cycleH,d.animOut.width=c.cycleW}),d.cssFirst.top=0,d.cssBefore.left=0,d.cssBefore.height=0,d.animIn.top=0,d.animOut.height=0},a.fn.cycle.transitions.turnDown=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!0,!1),d.animIn.height=c.cycleH,d.animOut.top=b.cycleH}),d.cssFirst.top=0,d.cssBefore.left=0,d.cssBefore.top=0,d.cssBefore.height=0,d.animOut.height=0},a.fn.cycle.transitions.turnLeft=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!1,!0),d.cssBefore.left=c.cycleW,d.animIn.width=c.cycleW}),d.cssBefore.top=0,d.cssBefore.width=0,d.animIn.left=0,d.animOut.width=0},a.fn.cycle.transitions.turnRight=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!1,!0),d.animIn.width=c.cycleW,d.animOut.left=b.cycleW}),a.extend(d.cssBefore,{top:0,left:0,width:0}),d.animIn.left=0,d.animOut.width=0},a.fn.cycle.transitions.zoom=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!1,!1,!0),d.cssBefore.top=c.cycleH/2,d.cssBefore.left=c.cycleW/2,a.extend(d.animIn,{top:0,left:0,width:c.cycleW,height:c.cycleH}),a.extend(d.animOut,{width:0,height:0,top:b.cycleH/2,left:b.cycleW/2})}),d.cssFirst.top=0,d.cssFirst.left=0,d.cssBefore.width=0,d.cssBefore.height=0},a.fn.cycle.transitions.fadeZoom=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!1,!1),d.cssBefore.left=c.cycleW/2,d.cssBefore.top=c.cycleH/2,a.extend(d.animIn,{top:0,left:0,width:c.cycleW,height:c.cycleH})}),d.cssBefore.width=0,d.cssBefore.height=0,d.animOut.opacity=0},a.fn.cycle.transitions.blindX=function(b,c,d){var e=b.css("overflow","hidden").width();d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d),d.animIn.width=c.cycleW,d.animOut.left=b.cycleW}),d.cssBefore.left=e,d.cssBefore.top=0,d.animIn.left=0,d.animOut.left=e},a.fn.cycle.transitions.blindY=function(b,c,d){var e=b.css("overflow","hidden").height();d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d),d.animIn.height=c.cycleH,d.animOut.top=b.cycleH}),d.cssBefore.top=e,d.cssBefore.left=0,d.animIn.top=0,d.animOut.top=e},a.fn.cycle.transitions.blindZ=function(b,c,d){var e=b.css("overflow","hidden").height(),f=b.width();d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d),d.animIn.height=c.cycleH,d.animOut.top=b.cycleH}),d.cssBefore.top=e,d.cssBefore.left=f,d.animIn.top=0,d.animIn.left=0,d.animOut.top=e,d.animOut.left=f},a.fn.cycle.transitions.growX=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!1,!0),d.cssBefore.left=this.cycleW/2,d.animIn.left=0,d.animIn.width=this.cycleW,d.animOut.left=0}),d.cssBefore.top=0,d.cssBefore.width=0},a.fn.cycle.transitions.growY=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!0,!1),d.cssBefore.top=this.cycleH/2,d.animIn.top=0,d.animIn.height=this.cycleH,d.animOut.top=0}),d.cssBefore.height=0,d.cssBefore.left=0},a.fn.cycle.transitions.curtainX=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!1,!0,!0),d.cssBefore.left=c.cycleW/2,d.animIn.left=0,d.animIn.width=this.cycleW,d.animOut.left=b.cycleW/2,d.animOut.width=0}),d.cssBefore.top=0,d.cssBefore.width=0},a.fn.cycle.transitions.curtainY=function(b,c,d){d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!0,!1,!0),d.cssBefore.top=c.cycleH/2,d.animIn.top=0,d.animIn.height=c.cycleH,d.animOut.top=b.cycleH/2,d.animOut.height=0}),d.cssBefore.height=0,d.cssBefore.left=0},a.fn.cycle.transitions.cover=function(b,c,d){var e=d.direction||"left",f=b.css("overflow","hidden").width(),g=b.height();d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d),e=="right"?d.cssBefore.left=-f:e=="up"?d.cssBefore.top=g:e=="down"?d.cssBefore.top=-g:d.cssBefore.left=f}),d.animIn.left=0,d.animIn.top=0,d.cssBefore.top=0,d.cssBefore.left=0},a.fn.cycle.transitions.uncover=function(b,c,d){var e=d.direction||"left",f=b.css("overflow","hidden").width(),g=b.height();d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!0,!0,!0),e=="right"?d.animOut.left=f:e=="up"?d.animOut.top=-g:e=="down"?d.animOut.top=g:d.animOut.left=-f}),d.animIn.left=0,d.animIn.top=0,d.cssBefore.top=0,d.cssBefore.left=0},a.fn.cycle.transitions.toss=function(b,c,d){var e=b.css("overflow","visible").width(),f=b.height();d.before.push(function(b,c,d){a.fn.cycle.commonReset(b,c,d,!0,!0,!0),!d.animOut.left&&!d.animOut.top?a.extend(d.animOut,{left:e*2,top:-f/2,opacity:0}):d.animOut.opacity=0}),d.cssBefore.left=0,d.cssBefore.top=0,d.animIn.left=0},a.fn.cycle.transitions.wipe=function(b,c,d){var e=b.css("overflow","hidden").width(),f=b.height();d.cssBefore=d.cssBefore||{};var g;if(d.clip)if(/l2r/.test(d.clip))g="rect(0px 0px "+f+"px 0px)";else if(/r2l/.test(d.clip))g="rect(0px "+e+"px "+f+"px "+e+"px)";else if(/t2b/.test(d.clip))g="rect(0px "+e+"px 0px 0px)";else if(/b2t/.test(d.clip))g="rect("+f+"px "+e+"px "+f+"px 0px)";else if(/zoom/.test(d.clip)){var h=parseInt(f/2,10),i=parseInt(e/2,10);g="rect("+h+"px "+i+"px "+h+"px "+i+"px)"}d.cssBefore.clip=d.cssBefore.clip||g||"rect(0px 0px 0px 0px)";var j=d.cssBefore.clip.match(/(\d+)/g),k=parseInt(j[0],10),l=parseInt(j[1],10),m=parseInt(j[2],10),n=parseInt(j[3],10);d.before.push(function(b,c,d){if(b==c)return;var g=a(b),h=a(c);a.fn.cycle.commonReset(b,c,d,!0,!0,!1),d.cssAfter.display="block";var i=1,j=parseInt(d.speedIn/13,10)-1;(function o(){var a=k?k-parseInt(i*(k/j),10):0,b=n?n-parseInt(i*(n/j),10):0,c=m<f?m+parseInt(i*((f-m)/j||1),10):f,d=l<e?l+parseInt(i*((e-l)/j||1),10):e;h.css({clip:"rect("+a+"px "+d+"px "+c+"px "+b+"px)"}),i++<=j?setTimeout(o,13):g.css("display","none")})()}),a.extend(d.cssBefore,{display:"block",opacity:1,top:0,left:0}),d.animIn={left:0},d.animOut={left:0}}}(jQuery),define("web/js/lib/jquery/plugins/jquery-cycle.js",function(){}),jQuery.fn.farbtastic=function(a){return $.farbtastic(this,a),this},jQuery.farbtastic=function(a,b){var a=$(a).get(0);return a.farbtastic||(a.farbtastic=new jQuery._farbtastic(a,b))},jQuery._farbtastic=function(a,b){var c=this;$(a).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var d=$(".farbtastic",a);c.wheel=$(".wheel",a).get(0),c.radius=84,c.square=100,c.width=194,navigator.appVersion.match(/MSIE [0-6]\./)&&$("*",d).each(function(){if(this.currentStyle.backgroundImage!="none"){var a=this.currentStyle.backgroundImage;a=this.currentStyle.backgroundImage.substring(5,a.length-2),$(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+a+"')"})}}),c.linkTo=function(a){typeof c.callback=="object"&&$(c.callback).unbind("keyup",c.updateValue),c.color=null;if(typeof a=="function")c.callback=a;else if(typeof a=="object"||typeof a=="string")c.callback=$(a),c.callback.bind("keyup",c.updateValue),c.callback.get(0).value&&c.setColor(c.callback.get(0).value);return this},c.updateValue=function(a){this.value&&this.value!=c.color&&c.setColor(this.value)},c.setColor=function(a){var b=c.unpack(a);return c.color!=a&&b&&(c.color=a,c.rgb=b,c.hsl=c.RGBToHSL(c.rgb),c.updateDisplay()),this},c.setHSL=function(a){return c.hsl=a,c.rgb=c.HSLToRGB(a),c.color=c.pack(c.rgb),c.updateDisplay(),this},c.widgetCoords=function(a){var b,d,e=a.target||a.srcElement,f=c.wheel;if(typeof a.offsetX!="undefined"){var g={x:a.offsetX,y:a.offsetY},h=e;while(h)h.mouseX=g.x,h.mouseY=g.y,g.x+=h.offsetLeft,g.y+=h.offsetTop,h=h.offsetParent;var h=f,i={x:0,y:0};while(h){if(typeof h.mouseX!="undefined"){b=h.mouseX-i.x,d=h.mouseY-i.y;break}i.x+=h.offsetLeft,i.y+=h.offsetTop,h=h.offsetParent}h=e;while(h)h.mouseX=undefined,h.mouseY=undefined,h=h.offsetParent}else{var g=c.absolutePosition(f);b=(a.pageX||0*(a.clientX+$("html").get(0).scrollLeft))-g.x,d=(a.pageY||0*(a.clientY+$("html").get(0).scrollTop))-g.y}return{x:b-c.width/2,y:d-c.width/2}},c.mousedown=function(a){document.dragging||($(document).bind("mousemove",c.mousemove).bind("mouseup",c.mouseup),document.dragging=!0);var b=c.widgetCoords(a);return c.circleDrag=Math.max(Math.abs(b.x),Math.abs(b.y))*2>c.square,c.mousemove(a),!1},c.mousemove=function(a){var b=c.widgetCoords(a);if(c.circleDrag){var d=Math.atan2(b.x,-b.y)/6.28;d<0&&(d+=1),c.setHSL([d,c.hsl[1],c.hsl[2]])}else{var e=Math.max(0,Math.min(1,-(b.x/c.square)+.5)),f=Math.max(0,Math.min(1,-(b.y/c.square)+.5));c.setHSL([c.hsl[0],e,f])}return!1},c.mouseup=function(){$(document).unbind("mousemove",c.mousemove),$(document).unbind("mouseup",c.mouseup),document.dragging=!1},c.updateDisplay=function(){var a=c.hsl[0]*6.28;$(".h-marker",d).css({left:Math.round(Math.sin(a)*c.radius+c.width/2)+"px",top:Math.round(-Math.cos(a)*c.radius+c.width/2)+"px"}),$(".sl-marker",d).css({left:Math.round(c.square*(.5-c.hsl[1])+c.width/2)+"px",top:Math.round(c.square*(.5-c.hsl[2])+c.width/2)+"px"}),$(".color",d).css("backgroundColor",c.pack(c.HSLToRGB([c.hsl[0],1,.5]))),typeof c.callback=="object"?($(c.callback).css({backgroundColor:c.color,color:c.hsl[2]>.5?"#000":"#fff"}),$(c.callback).each(function(){this.value&&this.value!=c.color&&(this.value=c.color)})):typeof c.callback=="function"&&c.callback.call(c,c.color)},c.absolutePosition=function(a){var b={x:a.offsetLeft,y:a.offsetTop};if(a.offsetParent){var d=c.absolutePosition(a.offsetParent);b.x+=d.x,b.y+=d.y}return b},c.pack=function(a){var b=Math.round(a[0]*255),c=Math.round(a[1]*255),d=Math.round(a[2]*255);return"#"+(b<16?"0":"")+b.toString(16)+(c<16?"0":"")+c.toString(16)+(d<16?"0":"")+d.toString(16)},c.unpack=function(a){if(a.length==7)return[parseInt("0x"+a.substring(1,3))/255,parseInt("0x"+a.substring(3,5))/255,parseInt("0x"+a.substring(5,7))/255];if(a.length==4)return[parseInt("0x"+a.substring(1,2))/15,parseInt("0x"+a.substring(2,3))/15,parseInt("0x"+a.substring(3,4))/15]},c.HSLToRGB=function(a){var b,c,d,e,f,g=a[0],h=a[1],i=a[2];return c=i<=.5?i*(h+1):i+h-i*h,b=i*2-c,[this.hueToRGB(b,c,g+.33333),this.hueToRGB(b,c,g),this.hueToRGB(b,c,g-.33333)]},c.hueToRGB=function(a,b,c){return c=c<0?c+1:c>1?c-1:c,c*6<1?a+(b-a)*c*6:c*2<1?b:c*3<2?a+(b-a)*(.66666-c)*6:a},c.RGBToHSL=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2];return b=Math.min(h,Math.min(i,j)),c=Math.max(h,Math.max(i,j)),d=c-b,g=(b+c)/2,f=0,g>0&&g<1&&(f=d/(g<.5?2*g:2-2*g)),e=0,d>0&&(c==h&&c!=i&&(e+=(i-j)/d),c==i&&c!=j&&(e+=2+(j-h)/d),c==j&&c!=h&&(e+=4+(h-i)/d),e/=6),[e,f,g]},$("*",d).mousedown(c.mousedown),c.setColor("#000000"),b&&c.linkTo(b)},define("web/js/lib/farbtastic/farbtastic.js",function(){}),jQuery.fn.extend({getUrlParam:function(a){a=escape(unescape(a));var b=new Array,c=null;if($(this).attr("nodeName")=="#document")window.location.search.search(a)>-1&&(c=window.location.search.substr(1,window.location.search.length).split("&"));else if($(this).attr("src")!="undefined"){var d=$(this).attr("src");if(d.indexOf("?")>-1){var e=d.substr(d.indexOf("?")+1);c=e.split("&")}}else{if($(this).attr("href")=="undefined")return null;var d=$(this).attr("href");if(d.indexOf("?")>-1){var e=d.substr(d.indexOf("?")+1);c=e.split("&")}}if(c==null)return null;for(var f=0;f<c.length;f++)escape(unescape(c[f].split("=")[0]))==a&&b.push(c[f].split("=")[1]);return b.length==0?null:b.length==1?b[0]:b}}),define("web/js/lib/jquery/plugins/jquerygetUrlParam.js",function(){}),function($){$.toJSON=function(a){if(typeof JSON=="object"&&JSON.stringify)return JSON.stringify(a);var b=typeof a;if(a===null)return"null";if(b=="undefined")return undefined;if(b=="number"||b=="boolean")return a+"";if(b=="string")return $.quoteString(a);if(b=="object"){if(typeof a.toJSON=="function")return $.toJSON(a.toJSON());if(a.constructor===Date){var c=a.getUTCMonth()+1;c<10&&(c="0"+c);var d=a.getUTCDate();d<10&&(d="0"+d);var e=a.getUTCFullYear(),f=a.getUTCHours();f<10&&(f="0"+f);var g=a.getUTCMinutes();g<10&&(g="0"+g);var h=a.getUTCSeconds();h<10&&(h="0"+h);var i=a.getUTCMilliseconds();return i<100&&(i="0"+i),i<10&&(i="0"+i),'"'+e+"-"+c+"-"+d+"T"+f+":"+g+":"+h+"."+i+'Z"'}if(a.constructor===Array){var j=[];for(var k=0;k<a.length;k++)j.push($.toJSON(a[k])||"null");return"["+j.join(",")+"]"}var l=[];for(var m in a){var n,b=typeof m;if(b=="number")n='"'+m+'"';else{if(b!="string")continue;n=$.quoteString(m)}if(typeof a[m]=="function")continue;var o=$.toJSON(a[m]);l.push(n+":"+o)}return"{"+l.join(", ")+"}"}},$.evalJSON=function(src){return typeof JSON=="object"&&JSON.parse?JSON.parse(src):eval("("+src+")")},$.secureEvalJSON=function(src){if(typeof JSON=="object"&&JSON.parse)return JSON.parse(src);var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@"),filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");throw new SyntaxError("Error parsing JSON, source is not valid.")},$.quoteString=function(a){return a.match(_escapeable)?'"'+a.replace(_escapeable,function(a){var b=_meta[a];return typeof b=="string"?b:(b=a.charCodeAt(),"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16))})+'"':'"'+a+'"'};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,_meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}}(jQuery),define("web/js/lib/jquery/plugins/jqueryjson.js",function(){}),jQuery.cookie=function(a,b,c){if(arguments.length>1&&String(b)!=="[object Object]"){c=jQuery.extend({},c);if(b===null||b===undefined)c.expires=-1;if(typeof c.expires=="number"){var d=c.expires,e=c.expires=new Date;e.setDate(e.getDate()+d)}return b=String(b),document.cookie=[encodeURIComponent(a),"=",c.raw?b:encodeURIComponent(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};var f,g=c.raw?function(a){return a}:decodeURIComponent;return(f=(new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)")).exec(document.cookie))?g(f[1]):null},define("web/js/lib/jquery/plugins/jquerycookie.js",function(){}),function(a,b){function s(a,b){return function(){if(r.plugin.debug)return a.apply(this,arguments);try{return a.apply(this,arguments)}catch(c){r.plugin.errors.push({plugin:b,thrown:c,source:a.toString()}),this.trigger("error",r.plugin.errors)}}}function v(a){var b=typeof a=="string"?a:[a.language,a.region].join("-"),c=b.split("-");return{iso6391:b,language:c[0]||"",region:c[1]||""}}function x(){var a,b=[];if(Object.keys)b=Object.keys(r.p);else for(a in r.p)h.call(r.p,a)&&b.push(a);return b.join(",").toLowerCase().split(",")}if(!b.addEventListener){a.Popcorn={isSupported:!1};var c="forEach extend effects error guid sizeOf isArray nop position disable enable destroy addTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect parser xhr getJSONP getScript".split(/\s+/);while(c.length)a.Popcorn[c.shift()]=function(){};return}var d=Array.prototype,e=Object.prototype,f=d.forEach,g=d.slice,h=e.hasOwnProperty,i=e.toString,j=a.Popcorn,k=/^(#([\w\-\_\.]+))$/,l=[],m=!1,n=!1,o={events:{hash:{},apis:{}}},p=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b,c){a.setTimeout(b,16)}}(),q=function(a){var b=a.media.currentTime,c=a.options.frameAnimation,d=a.data.disabled,e=a.data.trackEvents,f=e.animating,g=e.startIndex,h=r.registryByName,i=0,j,k,l;g=Math.min(g+1,e.byStart.length-2);while(g>0&&e.byStart[g]){j=e.byStart[g],k=j._natives,l=k&&k.type;if(!k||!!h[l]||!!a[l])j.start<=b&&j.end>b&&d.indexOf(l)===-1?j._running||(j._running=!0,k.start.call(a,null,j),c&&j&&j._running&&j.natives.frame&&k.frame.call(a,null,j,b)):j._running===!0&&(j._running=!1,k.end.call(a,null,j),c&&j._natives.frame&&(i=f.indexOf(j),i>=0&&f.splice(i,1)));g--}},r=function(a,b){return new r.p.init(a,b||null)};r.version="1.1.2",r.isSupported=!0,r.instances=[],r.p=r.prototype={init:function(c,d){var e;if(typeof c=="function"){if(b.readyState==="interactive"||b.readyState==="complete"){c(b,r);return}l.push(c);if(!m){m=!0;var f=function(){n=!0,b.removeEventListener("DOMContentLoaded",f,!1);for(var a=0,c=l.length;a<c;a++)l[a].call(b,r);l=null};b.addEventListener("DOMContentLoaded",f,!1)}return}e=k.exec(c),this.media=e&&e.length&&e[2]?b.getElementById(e[2]):c,this[this.media.nodeName&&this.media.nodeName.toLowerCase()||"video"]=this.media,r.instances.push(this),this.options=d||{},this.isDestroyed=!1,this.data={timeUpdate:r.nop,disabled:[],events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:{byStart:[{start:-1,end:-1}],byEnd:[{start:-1,end:-1}],animating:[],startIndex:0,endIndex:0,previousUpdateTime:-1}};var g=function(b){var c,d;b.media.readyState>=2?(c=b.media.duration,d=c!=c?Number.MAX_VALUE:c+1,r.addTrackEvent(b,{start:d,end:d}),b.options.frameAnimation?(b.data.timeUpdate=function(){r.timeUpdate(b,{}),b.trigger("timeupdate"),!b.isDestroyed&&p(b.data.timeUpdate)},!b.isDestroyed&&p(b.data.timeUpdate)):(b.data.timeUpdate=function(a){r.timeUpdate(b,a)},b.isDestroyed||b.media.addEventListener("timeupdate",b.data.timeUpdate,!1))):a.setTimeout(function(){g(b)},1)};return g(this),this}},r.p.init.prototype=r.p,r.forEach=function(a,b,c){if(!a||!b)return{};c=c||this;var d,e;if(f&&a.forEach===f)return a.forEach(b,c);if(i.call(a)==="[object NodeList]"){for(d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a);return a}for(d in a)h.call(a,d)&&b.call(c,a[d],d,a);return a},r.extend=function(a){var b=a,c=g.call(arguments,1);return r.forEach(c,function(a){for(var c in a)b[c]=a[c]}),b},r.extend(r,{noConflict:function(b){return b&&(a.Popcorn=j),r},error:function(a){throw new Error(a)},guid:function(a){return r.guid.counter++,(a?a:"")+(+(new Date)+r.guid.counter)},sizeOf:function(a){var b=0;for(var c in a)b++;return b},isArray:Array.isArray||function(a){return i.call(a)==="[object Array]"},nop:function(){},position:function(c){var d=c.getBoundingClientRect(),e={},f=c.ownerDocument,g=b.documentElement,h=b.body,i,j,k,l,m,n;i=g.clientTop||h.clientTop||0,j=g.clientLeft||h.clientLeft||0,k=a.pageYOffset&&g.scrollTop||h.scrollTop,l=a.pageXOffset&&g.scrollLeft||h.scrollLeft,m=Math.ceil(d.top+k-i),n=Math.ceil(d.left+l-j);for(var o in d)e[o]=Math.round(d[o]);return r.extend({},e,{top:m,left:n})},disable:function(a,b){var c=a.data.disabled;return c.indexOf(b)===-1&&c.push(b),q(a),a},enable:function(a,b){var c=a.data.disabled,d=c.indexOf(b);return d>-1&&c.splice(d,1),q(a),a},destroy:function(a){var b=a.data.events,c,d,e;for(d in b){c=b[d];for(e in c)delete c[e];b[d]=null}a.isDestroyed||(a.data.timeUpdate&&a.media.removeEventListener("timeupdate",a.data.timeUpdate,!1),a.isDestroyed=!0)}}),r.guid.counter=1,r.extend(r.p,function(){var a="load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended",b={};return r.forEach(a.split(/\s+/g),function(a){b[a]=function(b){return typeof this.media[a]=="function"?(b!=null&&/play|pause/.test(a)&&(this.media.currentTime=r.util.toSeconds(b)),this.media[a](),this):b!=null?(this.media[a]=b,this):this.media[a]}}),b}()),r.forEach("enable disable".split(" "),function(a){r.p[a]=function(b){return r[a](this,b)}}),r.extend(r.p,{roundTime:function(){return-~this.media.currentTime},exec:function(a,b){return r.addTrackEvent(this,{start:a,end:a+1,_running:!1,_natives:{start:b||r.nop,end:r.nop,type:"exec"}}),this},mute:function(a){var b=a==null||a===!0?"muted":"unmuted";return b==="unmuted"&&(this.media.muted=!1,this.media.volume=this.data.state.volume),b==="muted"&&(this.data.state.volume=this.media.volume,this.media.muted=!0),this.trigger(b),this},unmute:function(a){return this.mute(a==null?!1:!a)},position:function(){return r.position(this.media)},toggle:function(a){return r[this.data.disabled.indexOf(a)>-1?"enable":"disable"](this,a)},defaults:function(a,b){return r.isArray(a)?(r.forEach(a,function(a){for(var b in a)this.defaults(b,a[b])},this),this):(this.options.defaults||(this.options.defaults={}),this.options.defaults[a]||(this.options.defaults[a]={}),r.extend(this.options.defaults[a],b),this)}}),r.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"},r.Events.Natives=r.Events.UIEvents+" "+r.Events.MouseEvents+" "+r.Events.Events,o.events.apiTypes=["UIEvents","MouseEvents","Events"],function(a,b){var c=o.events.apiTypes,d=a.Natives.split(/\s+/g),e=0,f=d.length,g;for(;e<f;e++)b.hash[d[e]]=!0;c.forEach(function(c,d){b.apis[c]={};var e=a[c].split(/\s+/g),f=e.length,g=0;for(;g<f;g++)b.apis[c][e[g]]=!0})}(r.Events,o.events),r.events={isNative:function(a){return!!o.events.hash[a]},getInterface:function(a){if(!r.events.isNative(a))return!1;var b=o.events,c=b.apiTypes,d=b.apis,e=0,f=c.length,g,h;for(;e<f;e++){h=c[e];if(d[h][a]){g=h;break}}return g},all:r.Events.Natives.split(/\s+/g),fn:{trigger:function(c,d){var e,f;if(this.data.events[c]&&r.sizeOf(this.data.events[c])){e=r.events.getInterface(c);if(e)return f=b.createEvent(e),f.initEvent(c,!0,!0,a,1),this.media.dispatchEvent(f),this;r.forEach(this.data.events[c],function(a,b){a.call(this,d)},this)}return this},listen:function(a,b){var c=this,d=!0,e=r.events.hooks[a],f=a,g;return this.data.events[a]||(this.data.events[a]={},d=!1),e&&(e.add&&e.add.call(this,{},b),e.bind&&(a=e.bind),e.handler&&(g=b,b=function(b){e.handler.call(c,b,g)}),d=!0,this.data.events[a]||(this.data.events[a]={},d=!1)),this.data.events[a][b.name||b.toString()+r.guid()]=b,!d&&r.events.all.indexOf(a)>-1&&this.media.addEventListener(a,function(b){r.forEach(c.data.events[a],function(a,d){typeof a=="function"&&a.call(c,b)})},!1),this},unlisten:function(a,b){return this.data.events[a]&&this.data.events[a][b]?(delete this.data.events[a][b],this):(this.data.events[a]=null,this)}},hooks:{canplayall:{bind:"canplaythrough",add:function(a,b){var c=!1;this.media.readyState&&(b.call(this,a),c=!0),this.data.hooks.canplayall={fired:c}},handler:function(b,c){this.data.hooks.canplayall.fired||(c.call(this,b),this.data.hooks.canplayall.fired=!0)}}}},r.forEach(["trigger","listen","unlisten"],function(a){r.p[a]=r.events.fn[a]}),r.addTrackEvent=function(a,b){b&&b._natives&&b._natives.type&&a.options.defaults&&a.options.defaults[b._natives.type]&&(b=r.extend({},a.options.defaults[b._natives.type],b)),b._natives&&(b._id=b.id?b.id:r.guid(b._natives.type),a.data.history.push(b._id)),b.start=r.util.toSeconds(b.start,a.options.framerate),b.end=r.util.toSeconds(b.end,a.options.framerate);var c=a.data.trackEvents.byStart,d=a.data.trackEvents.byEnd,e,f,g;for(e=c.length-1;e>=0;e--)if(b.start>=c[e].start){c.splice(e+1,0,b);break}for(f=d.length-1;f>=0;f--)if(b.end>d[f].end){d.splice(f+1,0,b);break}b._natives&&(!!r.registryByName[b._natives.type]||!!a[b._natives.type])&&(g=a.media.currentTime,b.end>g&&b.start<=g&&a.data.disabled.indexOf(b._natives.type)===-1&&(b._running=!0,b._natives.start.call(a,null,b),a.options.frameAnimation&&b._natives.frame&&(a.data.trackEvents.animating.push(b),b._natives.frame.call(a,null,b,g)))),e<=a.data.trackEvents.startIndex&&b.start<=a.data.trackEvents.previousUpdateTime&&a.data.trackEvents.startIndex++,f<=a.data.trackEvents.endIndex&&b.end<a.data.trackEvents.previousUpdateTime&&a.data.trackEvents.endIndex++,this.timeUpdate(a,null,!0),b._id&&r.addTrackEvent.ref(a,b)},r.addTrackEvent.ref=function(a,b){return a.data.trackRefs[b._id]=b,a},r.removeTrackEvent=function(a,b){var c=a.data.history.length,d=0,e=[],f=[],g=[],h=[];r.forEach(a.data.trackEvents.byStart,function(c,g,h){c._id||(e.push(a.data.trackEvents.byStart[g]),f.push(a.data.trackEvents.byEnd[g])),c._id&&(c._id!==b&&(e.push(a.data.trackEvents.byStart[g]),f.push(a.data.trackEvents.byEnd[g])),c._id===b&&(d=g,c._natives._teardown&&c._natives._teardown.call(a,c)))}),a.data.trackEvents.animating.length&&r.forEach(a.data.trackEvents.animating,function(c,d,e){c._id||g.push(a.data.trackEvents.animating[d]),c._id&&c._id!==b&&g.push(a.data.trackEvents.animating[d])}),d<=a.data.trackEvents.startIndex&&a.data.trackEvents.startIndex--,d<=a.data.trackEvents.endIndex&&a.data.trackEvents.endIndex--,a.data.trackEvents.byStart=e,a.data.trackEvents.byEnd=f,a.data.trackEvents.animating=g;for(var i=0;i<c;i++)a.data.history[i]!==b&&h.push(a.data.history[i]);a.data.history=h,r.removeTrackEvent.ref(a,b)},r.removeTrackEvent.ref=function(a,b){return delete a.data.trackRefs[b],a},r.getTrackEvents=function(a){var b=[],c=a.data.trackEvents.byStart,d=c.length,e=0,f;for(;e<d;e++)f=c[e],f._id&&b.push(f);return b},r.getTrackEvents.ref=function(a){return a.data.trackRefs},r.getTrackEvent=function(a,b){return a.data.trackRefs[b]},r.getTrackEvent.ref=function(a,b){return a.data.trackRefs[b]},r.getLastTrackEventId=function(a){return a.data.history[a.data.history.length-1]},r.timeUpdate=function(a,b){var c=a.media.currentTime,d=a.data.trackEvents.previousUpdateTime,e=a.data.trackEvents,f=e.animating,g=e.endIndex,h=e.startIndex,i=0,j=e.byStart.length,k=e.byEnd.length,l=r.registryByName,m="trackstart",n="trackend",o,p,q,s,t;if(d<=c){while(e.byEnd[g]&&e.byEnd[g].end<=c){o=e.byEnd[g],s=o._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,o._id);return}o._running===!0&&(o._running=!1,s.end.call(a,b,o),a.trigger(n,r.extend({},o,{plugin:t,type:n}))),g++}while(e.byStart[h]&&e.byStart[h].start<=c){p=e.byStart[h],s=p._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,p._id);return}p.end>c&&p._running===!1&&a.data.disabled.indexOf(t)===-1&&(p._running=!0,s.start.call(a,b,p),a.trigger(m,r.extend({},p,{plugin:t,type:m})),a.options.frameAnimation&&p&&p._running&&p._natives.frame&&f.push(p)),h++}if(a.options.frameAnimation)while(i<f.length)q=f[i],q._running?(q._natives.frame.call(a,b,q,c),i++):f.splice(i,1)}else if(d>c){while(e.byStart[h]&&e.byStart[h].start>c){p=e.byStart[h],s=p._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,p._id);return}p._running===!0&&(p._running=!1,s.end.call(a,b,p),a.trigger(n,r.extend({},o,{plugin:t,type:n}))),h--}while(e.byEnd[g]&&e.byEnd[g].end>c){o=e.byEnd[g],s=o._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,o._id);return}o.start<=c&&o._running===!1&&a.data.disabled.indexOf(t)===-1&&(o._running=!0,s.start.call(a,b,o),a.trigger(m,r.extend({},p,{plugin:t,type:m})),a.options.frameAnimation&&o&&o._running&&o._natives.frame&&f.push(o)),g--}if(a.options.frameAnimation)while(i<f.length)q=f[i],q._running?(q._natives.frame.call(a,b,q,c),i++):f.splice(i,1)}e.endIndex=g,e.startIndex=h,e.previousUpdateTime=c,e.byStart.length<j&&e.startIndex--,e.byEnd.length<k&&e.endIndex--},r.extend(r.p,{getTrackEvents:function(){return r.getTrackEvents.call(null,this)},getTrackEvent:function(a){return r.getTrackEvent.call(null,this,a)},getLastTrackEventId:function(){return r.getLastTrackEventId.call(null,this)},removeTrackEvent:function(a){return r.removeTrackEvent.call(null,this,a),this},removePlugin:function(a){return r.removePlugin.call(null,this,a),this},timeUpdate:function(a){return r.timeUpdate.call(null,this,a),this},destroy:function(){return r.destroy.call(null,this),this}}),r.manifest={},r.registry=[],r.registryByName={},r.plugin=function(a,b,c){if(r.protect.natives.indexOf(a.toLowerCase())>=0){r.error("'"+a+"' is a protected function name");return}var d=["start","end"],e={},f,h=typeof b=="function",i=["_setup","_teardown","start","end","frame"],j=function(a,b){return a=a||r.nop,b=b||r.nop,function(){a.apply(this,arguments),b.apply(this,arguments)}};r.manifest[a]=c=c||b.manifest||{},i.forEach(function(c){b[c]=s(b[c]||r.nop,a)});var k=function(b,e){if(!e)return this;var f=e._natives={},h="",k,l,m,n;return r.extend(f,b),e._natives.type=a,e._running=!1,f.start=f.start||f["in"],f.end=f.end||f.out,f._teardown=j(function(){var a=g.call(arguments);a.unshift(null),a[1]._running&&f.end.apply(this,a)},f._teardown),k=this.options.defaults&&this.options.defaults[e._natives&&e._natives.type],e.compose=e.compose&&e.compose.split(" ")||[],e.effect=e.effect&&e.effect.split(" ")||[],e.compose=e.compose.concat(e.effect),e.compose.forEach(function(a){h=r.compositions[a]||{},i.forEach(function(a){f[a]=j(f[a],h[a])})}),e._natives.manifest=c,"start"in e||(e.start=e["in"]||0),"end"in e||(e.end=e.out||this.duration()||Number.MAX_VALUE),n=k?r.extend({},k,e):e,n.target||(m="options"in c&&c.options,n.target=m&&"target"in m&&m.target),e._natives._setup&&e._natives._setup.call(this,n),r.addTrackEvent(this,r.extend(n,e)),r.forEach(b,function(a,b){b!=="type"&&d.indexOf(b)===-1&&this.listen(b,a)},this),this};e[a]=function(a){return k.call(this,h?b.call(this,a):b,a)},r.extend(r.p,e);var l={fn:e[a],definition:b,base:b,parents:[],name:a};return r.registry.push(r.extend(e,l,{type:a})),r.registryByName[a]=l,e},r.plugin.errors=[],r.plugin.debug=!1,r.removePlugin=function(a,b){if(!b){b=a,a=r.p;if(r.protect.natives.indexOf(b.toLowerCase())>=0){r.error("'"+b+"' is a protected function name");return}var c=r.registry.length,d;for(d=0;d<c;d++)if(r.registry[d].name===b){r.registry.splice(d,1),delete r.registryByName[b],delete r.manifest[b],delete a[b];return}}var e=a.data.trackEvents.byStart,f=a.data.trackEvents.byEnd,g=a.data.trackEvents.animating,h,i;for(h=0,i=e.length;h<i;h++)e[h]&&e[h]._natives&&e[h]._natives.type===b&&f[h]&&f[h]._natives&&f[h]._natives.type===b&&(e[h]._natives._teardown&&e[h]._natives._teardown.call(a,e[h]),e.splice(h,1),f.splice(h,1),h--,i--,a.data.trackEvents.startIndex<=h&&(a.data.trackEvents.startIndex--,a.data.trackEvents.endIndex--));for(h=0,i=g.length;h<i;h++)g[h]&&g[h]._natives&&g[h]._natives.type===b&&(g.splice(h,1),h--,i--)},r.compositions={},r.compose=function(a,b,c){r.manifest[a]=c=c||b.manifest||{},r.compositions[a]=b},r.plugin.effect=r.effect=r.compose,r.parsers={},r.parser=function(a,b,c){if(r.protect.natives.indexOf(a.toLowerCase())>=0){r.error("'"+a+"' is a protected function name");return}typeof b=="function"&&!c&&(c=b,b="");if(typeof c!="function"||typeof b!="string")return;var d=r.events.all,e,f={};return e=function(a,d){if(!a)return this;var e=this;return r.xhr({url:a,dataType:b,success:function(a){var b=c(a),f,g,i,j=0;f=b.data||[],g=f.length,i=null;if(!g)return;for(;j<g;j++){i=f[j];for(var k in i)h.call(i,k)&&!!e[k]&&e[k](i[k])}d&&d()}}),this},f[a]=e,r.extend(r.p,f),f},r.player=function(a,c){c=c||{};var d=function(a,d,e){e=e||{};var f=new Date/1e3,g=f,h=0,i=1,j=!1,l={},m=b.getElementById(k.exec(a)&&k.exec(a)[2])||b.getElementById(a)||a,n={},o,p;for(var q in m)typeof m[q]=="object"?n[q]=m[q]:typeof m[q]=="function"?n[q]=function(a){return"length"in m[a]&&!m[a].call?m[a]:function(){return m[a].apply(m,arguments)}}(q):r.player.defineProperty(n,q,{get:function(a){return function(){return m[a]}}(q),set:r.nop,configurable:!0});var s=function(){f=new Date/1e3,n.paused||(n.currentTime=n.currentTime+(f-g),n.dispatchEvent("timeupdate"),o=setTimeout(s,10)),g=f};return n.play=function(){this.paused=!1,n.readyState>=4&&(g=new Date/1e3,n.dispatchEvent("play"),s())},n.pause=function(){this.paused=!0,n.dispatchEvent("pause")},r.player.defineProperty(n,"currentTime",{get:function(){return h},set:function(a){return h=+a,n.dispatchEvent("timeupdate"),h},configurable:!0}),r.player.defineProperty(n,"volume",{get:function(){return i},set:function(a){return i=+a,n.dispatchEvent("volumechange"),i},configurable:!0}),r.player.defineProperty(n,"muted",{get:function(){return j},set:function(a){return j=+a,n.dispatchEvent("volumechange"),j},configurable:!0}),n.addEventListener=function(a,b){return l[a]||(l[a]=[]),l[a].push(b),b},n.dispatchEvent=function(a){var c,d=this,e,f=a.type;f||(f=a,e=r.events.getInterface(f),e&&(c=b.createEvent(e),c.initEvent(f,!0,!0,window,1))),r.forEach(l[f],function(a){a.call(d,c,d)})},n.src=d||"",n.readyState=0,n.duration=0,n.paused=!0,n.ended=0,c._setup?c._setup.call(n,e):(n.readyState=4,n.dispatchEvent("load"),n.dispatchEvent("loadeddata")),n.addEventListener("load",function(){n.currentTime=h,n.volume=i,n.muted=j}),n.addEventListener("loadeddata",function(){!n.paused&&n.play()}),p=new r.p.init(n,e),p};r[a]=r[a]||d},r.player.defineProperty=Object.defineProperty||function(a,b,c){a.__defineGetter__(b,c.get||r.nop),a.__defineSetter__(b,c.set||r.nop)};var t=/\?/,u={url:"",data:"",dataType:"",success:r.nop,type:"GET",async:!0,xhr:function(){return new a.XMLHttpRequest}};r.xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;if(!(!a.dataType||a.dataType!=="jsonp"&&a.dataType!=="script")){r.xhr.getJSONP(a.url,a.success,a.dataType==="script");return}var b=r.extend({},u,a);b.ajax=b.xhr();if(b.ajax)return b.type==="GET"&&b.data&&(b.url+=(t.test(b.url)?"&":"?")+b.data,b.data=null),b.ajax.open(b.type,b.url,b.async),b.ajax.send(b.data||null),r.xhr.httpData(b)},r.xhr.httpData=function(a){var b,c=null,d,e=null;return a.ajax.onreadystatechange=function(){if(a.ajax.readyState===4){try{c=JSON.parse(a.ajax.responseText)}catch(f){}b={xml:a.ajax.responseXML,text:a.ajax.responseText,json:c};if(!b.xml||!b.xml.documentElement){b.xml=null;try{d=new DOMParser,e=d.parseFromString(a.ajax.responseText,"text/xml"),e.getElementsByTagName("parsererror").length||(b.xml=e)}catch(f){}}a.dataType&&(b=b[a.dataType]),a.success.call(a.ajax,b)}},b},r.xhr.getJSONP=function(a,c,d){var e=b.head||b.getElementsByTagName("head")[0]||b.documentElement,f=b.createElement("script"),g=a.split("?")[1],h=!1,i=[],j,k,l;g&&!d&&(i=g.split("&")),i.length&&(k=i[i.length-1].split("=")),j=i.length?k[1]?k[1]:k[0]:"jsonp",!g&&!d&&(a+="?callback="+j),j&&!d&&(!window[j]||(j=r.guid(j)),window[j]=function(a){c&&c(a),h=!0},a=a.replace(k.join("="),k[0]+"="+j)),f.onload=function(){d&&c&&c(),h&&delete window[j],e.removeChild(f)},f.src=a,e.insertBefore(f,e.firstChild);return},r.getJSONP=r.xhr.getJSONP,r.getScript=r.xhr.getScript=function(a,b){return r.xhr.getJSONP(a,b,!0)},r.util={toSeconds:function(a,b){var c=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/,d="Invalid time format",e,f,g,h,i,j;return typeof a=="number"?a:(typeof a=="string"&&!c.test(a)&&r.error(d),e=a.split(":"),f=e.length-1,g=e[f],g.indexOf(";")>-1&&(i=g.split(";"),j=0,b&&typeof b=="number"&&(j=parseFloat(i[1],10)/b),e[f]=parseInt(i[0],10)+j),h=e[0],{1:parseFloat(h,10),2:parseInt(h,10)*60+parseFloat(e[1],10),3:parseInt(h,10)*3600+parseInt(e[1],10)*60+parseFloat(e[2],10)}[e.length||1])}};var w=v(a.navigator.userLanguage||a.navigator.language);r.locale={get:function(){return w},set:function(a){return w=v(a),r.locale.broadcast(),w},broadcast:function(a){var b=r.instances,c=b.length,d=0,e;a=a||"locale:changed";for(;d<c;d++)e=b[d],a in e.data.events&&e.trigger(a)}},r.p.cue=r.p.exec,r.protect={natives:x()},a.Popcorn=r}(window,window.document),function(a,b){var c=a.document,d=a.location,e=/:\/\//,f=d.href.replace(d.href.split("/").slice(-1)[0],""),g=function(a,b,c){a=a||0,b=(b||a||0)+1,c=c||1;var d=Math.ceil((b-a)/c)||0,e=0,f=[];f.length=d;while(e<d)f[e++]=a,a+=c;return f};b.sequence=function(a,c){return new b.sequence.init(a,c)},b.sequence.init=function(a,d){this.parent=c.getElementById(a),this.seqId=b.guid("__sequenced"),this.queue=[],this.playlist=[],this.inOuts={ofVideos:[],ofClips:[]},this.dims={width:0,height:0},this.active=0,this.cycling=!1,this.playing=!1,this.times={last:0},this.events={};var g=this,h=0;return b.forEach(d,function(d,h){var i=c.createElement("video");i.preload="auto",i.controls=!0,i.style.display=h&&"none"||"",i.id=g.seqId+"-"+h,g.queue.push(i);var j=d["in"],k=d.out;g.inOuts.ofVideos.push({"in":j!==undefined&&j||1,out:k!==undefined&&k||0}),g.inOuts.ofVideos[h].out=g.inOuts.ofVideos[h].out||g.inOuts.ofVideos[h]["in"]+2,i.src=e.test(d.src)?d.src:f+d.src,i.setAttribute("data-sequence-owner",a),i.setAttribute("data-sequence-guid",g.seqId),i.setAttribute("data-sequence-id",h),i.setAttribute("data-sequence-clip",[g.inOuts.ofVideos[h]["in"],g.inOuts.ofVideos[h].out].join(":")),g.parent.appendChild(i),g.playlist.push(b("#"+i.id))}),g.inOuts.ofVideos.forEach(function(a){var b=a.out-a["in"],c={"in":h,out:h+b};g.inOuts.ofClips.push(c),h=c.out+1}),b.forEach(this.queue,function(a,c){function d(b){return c||(g.dims.width=a.videoWidth,g.dims.height=a.videoHeight),a.currentTime=g.inOuts.ofVideos[c]["in"]-.5,a.removeEventListener("canplaythrough",d,!1),!0}a.addEventListener("canplaythrough",d,!1),a.addEventListener("play",function(a){g.playing=!0},!1),a.addEventListener("pause",function(a){g.playing=!1},!1),a.addEventListener("timeupdate",function(c){var d=c.srcElement||c.target,e=+(d.dataset&&d.dataset.sequenceId||d.getAttribute("data-sequence-id")),f=Math.floor(a.currentTime);g.times.last!==f&&e===g.active&&(g.times.last=f,f===g.inOuts.ofVideos[e].out&&b.sequence.cycle.call(g,e))},!1)}),this},b.sequence.init.prototype=b.sequence.prototype,b.sequence.cycle=function(a){this.queue||b.error("Popcorn.sequence.cycle is not a public method");var c=this.queue,d=this.inOuts.ofVideos,e=c[a],f=0,g,h,i,j;return c[a+1]&&(f=a+1),c[a+1]?(g=c[f],h=d[f],b.extend(g,{width:this.dims.width,height:this.dims.height}),i=this.playlist[f],j=this.playlist[a],e.pause(),this.active=f,this.times.last=h["in"]-1,i.currentTime(h["in"]),i[f?"play":"pause"](),this.trigger("cycle",{position:{previous:a,current:f}}),f&&(e.style.display="none",g.style.display=""),this.cycling=!1):(f=0,this.playlist[a].pause()),this};var h=["timeupdate","play","pause"];b.extend(b.sequence.prototype,{eq:function(a){return this.playlist[a]},remove:function(){this.parent.innerHTML=null},clip:function(a){return this.inOuts.ofVideos[a]},duration:function(){var a=0,b=this.inOuts.ofClips,c=0;for(;c<b.length;c++)a+=b[c].out-b[c]["in"]+1;return a-1},play:function(){return this.playlist[this.active].play(),this},exec:function(a,c){var d=this.active;return this.inOuts.ofClips.forEach(function(b,c){a>=b["in"]&&a<=b.out&&(d=c)}),a+=this.inOuts.ofVideos[d]["in"]-this.inOuts.ofClips[d]["in"],b.addTrackEvent(this.playlist[d],{start:a-1,end:a,_running:!1,_natives:{start:c||b.nop,end:b.nop,type:"exec"}}),this},listen:function(a,c){var d=this,e=this.playlist,f=e.length,g=0,i;return c||(c=b.nop),b.Events.Natives.indexOf(a)>-1?b.forEach(e,function(b){b.listen(a,function(e){e.active=d,h.indexOf(a)>-1?c.call(b,e):++g===f&&c.call(b,e)})}):(this.events[a]||(this.events[a]={}),i=c.name||b.guid("__"+a),this.events[a][i]=c),this},unlisten:function(a,b){},trigger:function(a,c){var d=this;if(b.Events.Natives.indexOf(a)>-1)return;return this.events[a]&&b.forEach(this.events[a],function(b,e){b.call(d,{type:a},c)}),this}}),b.forEach(b.manifest,function(a,c){b.sequence.prototype[c]=function(a){var d={},e=[],f,h,i,j,k,l,m,n,o;for(f=0;f<this.inOuts.ofClips.length;f++)h=this.inOuts.ofClips[f],i=g(h["in"],h.out),j=i.indexOf(a.start),k=i.indexOf(a.end),j>-1&&(d[f]=b.extend({},h,{start:i[j],clipIdx:j})),k>-1&&(d[f]=b.extend({},h,{end:i[k],clipIdx:k}));l=Object.keys(d).map(function(a){return+a}),e=g(l[0],l[1]);for(f=0;f<e.length;f++){var p={},q=e[f],r=d[q];r?(m=this.inOuts.ofVideos[q],n=r.clipIdx,o=g(m["in"],m.out),r.start&&(p.start=o[n],p.end=o[o.length-1]),r.end&&(p.start=o[0],p.end=o[n])):(p.start=this.inOuts.ofVideos[q]["in"],p.end=this.inOuts.ofVideos[q].out),this.playlist[q][c](b.extend({},a,p))}return this}})}(this,Popcorn),function(a){document.addEventListener("DOMContentLoaded",function(){var b="data-timeline-sources",c=document.querySelectorAll("["+b+"]");a.forEach(c,function(d,e){var f=c[e],g=!1,h,i,j;f.id||(f.id=a.guid("__popcorn")),f.nodeType&&f.nodeType===1&&(j=a("#"+f.id),h=(f.getAttribute(b)||"").split(","),h[0]&&a.forEach(h,function(a){i=a.split("!"),i.length===1&&(i=a.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/)[2].split("."),i[0]="parse"+i[1].toUpperCase(),i[1]=a),h[0]&&j[i[0]]&&j[i[0]](i[1])}),!j.autoplay||j.play())})},!1)}(Popcorn),function(a){a.plugin("attribution",function(){var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAYAAABjyArgAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAEZ0FNQQAAsY58+1GTAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAA",c={"cc-by":b+"eeSURBVHja7JpfbNvGHce/R9JBU9Qa89QN2gD5TepLmGTJYyyte9mypiSC7aXrIj8NqDFI6lavLezISpwuE5LJwpACw7aaWJ8L0/kD7B8iyi2wRXYiGikgvUkPNbY+ybXbh5l/bg8kT6RlO7Zjq2maM0488e4o8sPv/e53vzOhlEYIIZ/hadr3RCklBAAFgNt/vwWO48BxHHieB8fx4DkOHO8dOQ6EcOAIASEEIMS/CigoqEPhUAeO42bbtt2jY8O2HTiOzeoc6rD2lFL/Zlj5SUg/fvknAAACgPpweZ53M8d3yzzv1nG8B5mAEC7I14PjgXVcmLbt5WDZDkN2HIeBDYJ+kiALAMJweQFC6Ojmm3O3UKlUUKvVsLa6FrrQYGQQp06dQup7Kbx09kewHR4cZ7kvxOZAQLx3GRg+DnVHArwxRPYH7v2FOrQPNDQajdD5RCIB+ZyM4yeP9RUyAUD/duevEASBQRUEwc28gKo+j+KVIpaXl3d0wWg0irG3xjA8fBqWbcO2LViWl20LlmUzhW+m5L2q+L//+RTXy9fRbDQBAMlkEpIkAQAMw4Cu6wCAeCKO0cwovvmt5/uiYAKA/rP6Dwi80AUrDGBAEJCfmIQ2q7EOoihClmXEYjEMDw8DAKrVKtrtNjRNw8rKCmsrKzJ+NfZLHH72MCzLgmlZsCwTlmWFTYYP2PFs+R5s8eernyMzmsXq6ipkWUapVEIsFgu1abfbyOVy0DQNkUgEl4uXDxwyA3znwzsY8MEOCBgQBkJwRVFENptFJpOBKIpbXlBVVeRyOQY6nojjT+/9Ec8cPgzLMmGaJlPyppDp3gBPvHkBzUYT6XQaMzMz3eHpmaDg9VRVxcjICOKJOC5duXjggDkA4D0bLPA8BD6sXEmSUK/Xkc/nt4ULAOl0Gq1Wiw3NZqOJq8VrIVvOMY+EdLP3txHMTm1us9GELMsYe+ONh7ZPp9OQZRnNRhP3F+oHbiY4AOB8t4znUdXnQ3ArlUrPcNsuiaKISqXCIGuzGqrVefC8sDlkznf7EIK806R94N5rqVRC4oUXNvqhm46GUqkU6nvggF0FuyouXikyUDMzMw9V7XaQ/b7F3xQ9X9qDSzyfmvM8DIIuZLI7yI1GA8lkskcEIyMjbISMjIyE6mKxGJLJZI+ncXAK9h7+5twt5i1ks1mmwr0kURSZUpaXl3Hzxi22YHEhb20idps2u09VVTctb9fnwAD7aqpUKgxOJpNhjXRdh6IoSKVSSKVSKBQKW9ZNT0+H7J2v4sqdSkC9XdNAyKOZiMc9uQsNQsARglqt5rpYsszA6LqOVCoV6qTrOnRdRyaTgaIoPXVLS0tsNpdlGaqqolaruSvAAFigC7frle/+IQzD2HQy85WbTqd31OcAFew+qL9CO3r0KGuQy+WY3Wq1WmzSO3/+PFOyJElotVqYnZ0N+cgAWHltda1rDtjR57p3E5FIJKDrOtrtduh80F0Lln2fWNd1JBKJ/ih44+QStE/+m06n04jFYgy0P5H4KvXrZFnumVC67hf72LcHkM/JaEw1kMvlMDs7u6M+vmjkc3J/FPxVTsdPHkM8EYemaT3ewlZwNU1DPBHvS1yC84MtQX8xaJ98NauqipWVFRiGgaGhIRQKha6v6y2Tg3XB4dj1S9nHvj7Er98eQyQSgaqqUBSF/WbQD26321AUBdPT04hEIhjNjPZvkvNvZDAyiLXVNSwtLbEG+Xye3fSRI0dC4Pw6wzB66vzkX2swMghKA8thUPjv1Pu254d4LvIcyten8dt3itA0DZqmQZIkSJIEURSh6zoTTT+DPWzevnvvLg4dOoTChQK0WQ2iKKLT6YQ8g3K5zGIMyWQS+XyeqbdcLrO2wToAGBoaQrvdxovffxHXSlfxv/V1mOY6TMuEaVqw/biEY8OxHRaE32vo8nEKV7Jgz78X/4WBgUP4aP4jZH6RYcvJbDb7SD/gB1YAYOqdKfzwzA+wbq5j3TRhmSZMawPgRwj4PK4Bdw4A29JJpoYRjUYBAIVCocf12U1aWVlhs3U0GvUC8X5o0oHj2WLfXDypiQMAhzqwbXcf7dLliwyQoiihGO9u4KZSKdZ37M0xL8BudyEHQpRskqVP1pYRm9wB0PH8OF24X6PGgzp99Wev+lM9lSSJ1ut1utPUarWoJEmsv6zI1HhQpwv3a/Ti5Yvs/Ncod79kX8/QxfoCNT42qKzI7LwoinRycpJ2Op0twXY6HTo5OUlFUWT9Tp46SZc+NuiisUDH8+NfR7i0Z/U/kR/Hy4oMQRBwrXgN7//l/T1vGRUuTcKyLNy9W8NrP3/t4IdiwLwEdzOCq9SN3/tmIoJ5Ij/uKvlBnb6n/plGo9Edv7FoNErLvy9T40GdLhoL9N0/vNs3tVBKty0Hz31pCvZT9vUMXvnpK2wXQq9UcWPuxrbb9mfls0gmh9le29zcDUwVpvqnlE0U/GUq96EBwuMnjmEifwHf/k40sBsRDDci5Lf6/3iy/Mkn+N3VEuar8/0digGIj4Np2HEE9vTwaZx56QxOfPcEvhGJhGO4nmv12eoq7i3ew+2bt/sO9iur4KdpHwBTSp8lhHzxFMWBjCjy/wEATHqgDqiBjQoAAAAASUVORK5CYII=","cc-by-sa":b+"j2SURBVHja7FpLbBvHGf72IaMyInZ9SgKqiHQTdfH6eUossmlTuI7tZS27dtzUpA8NGqMgldpy2kiiKFupo9qh2MIx2iYS4/QaaP0CGqcwV2qAWpRtUnAA6kYGkFDnJIVKAVvc3elhd4e7FPWgHkHj+BeGOzuPf3e/+eaff/4RQwhxMQzzFZ7ImgshhGEAEAC4cfM6WJYFy7LgOA4sy4FjWbCceWVZMAwLlmHAMAzAMJYWEBAQnUAnOnTdSJqmGVddg6bp0HWN1ulEp+0JIdbL0PzjIAf3HwIAMACIBS7HcUZiuVKe44w6ljNBZsAwrB1fExwTWN0AU9PMZM9rTpB1XafA2oF+nEDmATjB5XjwjquRrl25jmQyiVQqhdnCrENRnasOO3fuhO+HPuzd9zI0nQPLqsaAaCwYMOZY2qaPToyZAHMOMYuDe28sDfljGdls1lHu8XggHZCwdceWVYGxXvoZAOSTW/8Az/MUVJ7njcTxGFZG0HeuD1NTU8tS6Ha70f67drS07IKqadA0FapqJk2FqmqU4ZWYXM7iB//5EhfjFzGRnQAAeL1eiKIIAMhkMlAUBQDQ5GnCidAJPPPs01UBsJ76D+4/ZAD8z+FPwXN8CVi+BjU8j0hnN+QhmXYQBAGSJKGhoQEtLS0AgOHhYeTzeciyjJmZGdpW8ks42f5b1G6shaqqKKoqVLUIVVWdJsMCWDdtuQ3orwtfI3QijEKhAEmSEIvF0NDQ4PiIfD6PtrY2yLIMl8uF3r7eZYOw3vopwLf+dQs1FrA1PGr4Gge4giAgHA4jFApBEIQFFSYSCbS1tVGgmzxNeH/gb/hebS1UtYhisUiZXBHkMnvc+WYXJrITCAQCGBwcLE0707TYmZ5IJBAMBtHkacKZcz3LAqCS/snJSUxNThqzsb4e9fX1K9Z/cP8hsADAmTaY5zjwnJO5oiginU4jEoksCi4ABAIB5HI5OsUmshM433fBYctZ6pEwpWT+2QG8N5bGRHYCkiSh/dSpJT8mEAhAkiRMZCdwbyy9LJtbrv/vly/D+/wLOHr4CI4ePgLv8y/g05s3V6TfEhYAWMst4zgMKyMOcJPJ5Lxps5gIgoBkMklBlodkDA+PgOP4yiCzltsHB8jyx8Y7xGIxeJqby/3LigtiLBZz9F1MyvWP3r6N7q4I6p95Fl6vDwdaWwEAv/7Va/hTf3/V+h0AGww2WNx3ro8CNTg4uCRrFwPZ6tv3hz7TlzbBZUyfmjU9DAYlkM3pn81m4fV65w1uMBikzA8Gg466hoYGeL3eeZ5AJbHrLxQKyKbvAwD2Sz/D+4kBvHP+j3irq9MwDwODVet3Mtj8+GtXrlNvIRwOUxauRARBoCM+NTWFa1ev0w2LAfLCJsKSSs9PJBIV84v1WUjsbXvfNYj11w8/oGU/fuklAEChUMCXDx5UrZ8CbLEpmUxScEKhEG2kKAr8fj98Ph98Ph+i0eiCdf3mdLLslsXi5K2kjb0l08AwlU3ENykulwvxeBwbXXW4dOlSxTYPHz5akW5jo8EwYBkGqVTKcLEkiQKjKAp8Pp+jk6IoUBQFoVAIfr9/Xt34+DhdlSVJQiKRQCqVMnaANmCBErglr7ykK5PJVFzMLOYGAoF59ZX6LCT2tjU8j/aTJ7GxtpaWjd6+TfPPNTxXtX4bg40PtXZomzdvpg3a2tqo/cnlcnTRO3bsGGWyKIrI5XIYGhpy+MgAaH62MFsyB/Rq4TrfRHg8HiiKgnw+7yi3u2v2vOWzKooCj8ez5IeX65+cnER3VwSv/PwwenvOoLfnDLo6OgAAp06frlq/A2D74lJuZ6wRCwQC1MjncjkEAgFaZ20+JEmidfaFp+R+0Z8lX0w6IDkGeDlitbX6VqM/ePw4gsePGwM3MIDBgQE8evgIe/a+jCNHX6lav8NE/D/K1h1b0ORpgizLCAaD89haCVxZltHkaVpW3KCS/re6OvGT3bvxxRcGq5ubm6mLWK1+J4OJc1dktzMWmxOJBGZmZpDJZNDY2IhoNFrydc1tsr3OPm1L/iv9WdbLnf59O1wuFxKJBPx+P9Vl94Pz+Tz8fj/6+/vhcrlwInRi2R9fSf/2HdtxoLUVB1pb4WluXpV+ymDrhetcdZgtzGJ8fJw2iEQi9OGbNm1yAGfVZTKZeXWWWLrqXHUgxLYdBoE1pubdvJd7yvUU4hf78c7bfZBlGbIsQxRFiKIIQRCgKAolw0qCMeutn67bo3dHsWHDBkS7opCHZAiCgOnpaYdnEI/HaYzB6/UiEolQ9sbjcdrWXgcAjY2NyOfzePFHL+JC7Dwezc2hWJxDUS2iWFShWXEJXYOu6TQIX75T+zaGK2mw5/adf6OmZgM+G/kMod+E6LYwHA6v6qWtAAkAnH37LH66ZzfminOYKxahFosoqmUAVwj4fNsD7iwAeqTj9bXA7XYDAKLR6DwXqRqZmZmhq67b7TYD8VZoUodu2mLLXDyuwgKATnRomnGOdqa3hwLk9/sdMd5qwPX5fLRv+5vtZoBdK4FsC1HSRZY8XkdGdHEHQDoiHWTsXopk7qfJq7981VrqiSiKJJ1Ok+VKLpcjoijS/pJfIpn7aTJ2L0V6ento+XcolW7Cb4TInfQYyXyeIZJfouWCIJDu7m4yPT29ILDT09Oku7ubCIJA++3YuYOMf54hdzJjpCPS8V0ElzDlTmlnpAP7/RJ4nseFvgv46PJHKz4yip7phqqqGB1N4fXXXl/5FLOZDftphn33WX6/Vs+w36/KRNhTZ6TDYPL9NBlIfEDcbveyR8ztdpP4n+Mkcz9N7mTGyHt/eW/VLCCELJq3l61W/1LPXDWDLQm/EcLRXxylpxBKchhXr1xd9Nh+n7QPXm8LPWu7cuUqzkbPrn6RqMCutWJu+TMqnfethsXMYvvWrdu2oDPShfofuG2nEfZwIxx+q/WPJ1OTk3j3fAwjwyNrswrbQFxr07DQsxZ75poBbMmull3Ys3cPtm3fhu+7XM4YrulafVUo4O6du7hx7caaAftNMXgpG7/uAD+RlQtDCNnIMMx/n0CxDhsMQpj/DQDwRbusfJXB0QAAAABJRU5ErkJggg==","cc-by-nd":b+"grSURBVHja7FpNbBvHFf72R0YdROz6lBZsAQrogczFtB37aFF1AqR1bC1h2Jc0NXUqEKEgmTZqWkimaMupS9ilicJJA7fRojkHWvkH6B/MpRqgNSWLKzgAeSjAPURoe5IipYeKuzs97O5wl1xSFCWljeNnjHa5M/Ptzjdv3nvzxgwhJMAwzKd4KnsuhBCGAUAA4P4f74FlWbAsC47jwLIcOJYFy9lXlgXDsGAZBgzDAAzjoICAgJgEJjFhmlYxDMO6mgYMw4RpGrTOJCZtTwhxPobePwlyfvQCAIABQBxyOY6zCss17znOqmM5m2QGDMO6+bXJsYk1LTINwy7ue8NLsmmalFg30U8SyTwAL7kcD95ztcrd+XsoFosol8vY3Nj0AA0GBnHixAmMfHsEZ86+AsPkwLK6NSEGCwaMPZeu5WMSayXAXkNMd3KXFyuQP5RRrVY9zyORCMRzIo4eP7IrMvYLnwFA/vDg9+B5npLK87xVOB4lZQG5azmsrq72BBgMBjHx0wkMD5+EbhgwDB26bhdDh64bVMP9NLlVi//5j3/hVuEWatUaACAWiyEajQIAVFWFoigAgHAkjPHkOL729ed2RMB+4p8fvWAR/OfSn8BzfJNYfgADPI/M1DTkOZl2EAQBoigiFApheHgYAFAqlaBpGmRZxvr6Om0rxkX8eOJHOPjMQei6joauQ9cb0HXdazIcgk3blruI/mzjMyTHU9jY2IAoisjn8wiFQp5BaJqGdDoNWZYRCARwNXe1ZxL2G58S/OAvDzDgEDvAY4Af8JArCAJSqRSSySQEQegIKEkS0uk0JTocCeM379/GVw4ehK430Gg0qCb7ktxij6feuoRatYZEIoHZ2dnmsrNNi1vTJUnC2NgYwpEwrly73BMBnfA7jW2n+OdHL4AFAM62wTzHgee8mhuNRlGpVJDJZLqSCwCJRAL1ep0usVq1huu5Gx5bztKIhGkW+5+bwOXFCmrVGkRRxMSbb247mEQiAVEUUavWsLxY6cnm7ie+IywAsE5YxnEoKQsecovFYtuy6SaCIKBYLFKS5TkZpdICOI73J5l1wj54SJY/tL4hn88j8vzzrfGlr0PM5/Oevt2kG34n2Qm+h2BLgy0tzl3LUaJmZ2e31dpuJDt9cz/P2bG0TS5jx9SsHWEwaJJsL/9qtYpYLNY2uWNjY1Tzx8bGPHWhUAixWKwtEvATP/xvhYZ8Sz/4Xg22B393/h6NFlKpFNXCfkQQBDrjq6uruHvnHt2wWCR3NhGO+L1fkiTf+259Oklr25deftm39IsPwIqDHW0qFouUnGQySRspioJCoUCdVywWQyaT8a0bHR1FKpWidstxesUHRbxy5rStvbZpMJskOyaC4H+30Xj31+/uOaa10WAYsAyDcrlshViiSJe3oigYGRnxdFIUBYqiIJlMIh6Pt9WtrKxQryyKIiRJQrlctnaArItUNMltRuVNLFVVfZ2No7mJRKKt3q9PJ2lt6zYHbvm7Vu8Ln5oIZ8DODu3w4cO0QTqdpvanXq9Tp3fx4kVks1m6bOr1Oubm5jwxMgB6v7mx2TQH9Orw2m4iIpEIFEWBpmme5+5wqjW00jQNiqIgEolsO3A//FMvvehb+sH3aLDbubTaGWfGEokEQqEQJdpxOI6WOnWiKLY5nmb4Rf9s+2HiORHVmSrS6TTm5uZ6GoyjDOI5sS/8927f3jN8jwb/P8rR40cQjoQhy3JbtNBp8LIsIxwJ95Q32G98L8HEuyty2xlHmyVJwvr6OlRVxdDQELLZbDPWtbfJ7jr3smrGr/RPTx/3k59NIBAIQJIkxONxiuWOgzVNQzwex82bNxEIBDCeHO958J3wW81Ov/jURDgfPBgYxObGJlZWVmiDTCZDX37o0CHPi506VVXb6hxxsAYDgyDEtR0GgTOn9q+2j3s28CwKt27iF2/nIMsyZFlGNBpFNBqFIAhQFIUqQz/JmP3Gp3774aOHOHDgALKXspDnZAiCgLW1tZ7CNFmWUSgUaFt3HQAMDQ1B0zScevEUbuSv4z9bW2g0ttDQG2g0dBhOXsI0YBomTcK37tS+iOlKmuz529JfMTBwAB8tfITkD5N0W+jEs/2KkyABgJm3Z/Dd09/BVmMLW40G9EYDDb2FYJ+Ezxc94c4CoEc6sZFhBINBAEA2m/W1Sb3K+vo69brBYNBOxDupSROmbYsdc/GkCgsAJjFhGNY52pWrlylB8Xjck+PdCbkjIyO078RbE3aC3WiS7EpRUidLnqwjI+rcAZDJzCRZXC4T9XGFvPb91xxXT6LRKKlUKqRXqdfrJBqN0v5iXCTq4wpZXC6Ty1cv0+dfotL8kXojSZYqi0T9WCViXKTPBUEg09PTZG1trSOxa2trZHp6mgiCQPsdP3GcrHyskiV1kUxmJr+M5BKmNSidykxiNC6C53ncyN3AB7/7oO8jo+yVaei6jocPy3j9B6/3v8RcZsN9muHefbb+3im+H5bfe/s2Ee4ylZm0NPlxhbwv/ZYEg8GeZywYDJLCrwpEfVwhS+oieee9d3atBYSQrvfuZ/3ib4fb7zuYTtuq1BtJvPq9V+kphFIs4c78na7H9mfFs4jFhulZ2/z8HcxkZ3bvJLpo0m40109j/a67eQ/Tbd969NgRTGUu4RvfDLpOI9zpRnjiVuc/nqx+8gl+eT2PhdLC3njhLgPdS4Ldk/m5EOzIyeGTOH3mNI69cAxfDQS8OVw7tPp0YwOPlh7h/t37e0bs563B+2GDeyL4qfQvDCHkGYZh/v2Uin3YYBDC/HcArOiX8zGX6zMAAAAASUVORK5CYII=","cc-by-nc":b+"k0SURBVHja7FpdbNvWFf5IysFS1BrztA1yMBt7sQqskZMmy4Ytlta9LJ4TCnaCFkkWuQ812mCTlB+3S+3Iyk8TK/Zkb0iBYVstrCjahwZm/oDNGSLaKzBbTiIZaSM9rJCK2FiHDbArpwVmkbx7EHlF2pIty3axpjnGFX/uvR/J75577jnnmiGEWBmG+RSPZc2FEMIwAAgA3Bi+DpZlwbIsOI4Dy3LgWBYspx1ZFgzDgmUYMAwDMIyOAgICohKoRIWq5ouiKPmjqkBRVKiqQutUotL2hBD9Zej5oyD79u4HADAAiE4ux3H5wnKFc47L17GcRjIDhmGN/GrkaMSqeTIVRSvGc8VMsqqqlFgj0Y8SyRYAZnI5CyymY75cu3Id0WgUsVgMc9k5E1C1tRo7duyA68cuNO/5GRSVA8vK+QFRWDBgtLE0TB+V5GcCtDnELE3u3Yk4xMsiksmk6b7dbofQImDr9oZVkbFe+AwA8pdbf4bFYqGkWiyWfOEsGJFGEboQwvT0dFmANpsNHb/qQGPjLsiKAkWRIctaUWTIskI1vJgmL9TiT/75L1wauIRUMgUAcDqdcDgcAIBEIgFJkgAA9fZ6HPEewTe/9Y0VEbCe+Pv27s8T/NeRm7BwlgKxlipUWSwIdHVDHBJpB57nIQgCamtr0djYCAAYGRlBJpOBKIqYnZ2lbQW3gOMdx7DxiY2QZRk5WYYs5yDLstlk6ASrmi03EP0w+xDeIz5ks1kIgoBwOIza2lrTR2QyGfj9foiiCKvVinOhc2WTsN74lOBbf7uFKp3YKguqLFUmcnmeh8/ng9frBc/zJQEjkQj8fj8lut5ejz+8+Xt8beNGyHIOuVyOanJRkhfY465XTyGVTMHj8WBwcLAw7TTTYtT0SCSCtrY21NvrcebC6bIIKIX/m/5+jI+N4+1331kV/r69+8ECAKfZYAvHwcKZNdfhcCAejyMQCCxJLgB4PB6k02k6xVLJFHpDfSZbzlKPhCkU7c9I4N2JOFLJFARBQMeJE8t+jMfjgSAISCVTuDsRL8vmppIpbG1owA92ft9E7oVQCNdu3MArx09gamqqInxdWABgdbeM4zAijZrIjUaji6bNUsLzPKLRKCVZHBIxMjIKjrMUJ5nV3T6YSBYv598hHA7D/tRTC/3LogtiOBw29V1K9DafP/wMPefPw/nDH+GlF9vh9fvR3t6OkydPItTXi/GxsYrwTQTnNTivxaELIUrU4ODgslq7FMl639D5kOZLa+Qymk/Nah4GgwLJ2vRPJpNwOp2LBretrY1qfltbm6mutrYWTqdzkSdQTHT85uZm7Nu/H1NTU7g5PIzvfLsWn889xMFDB3H/ww/R0tpaEb5Zg7WPv3blOvUWfD4f1cJKhOd5OuLT09O4dvU6DVjyJJc2EboUe34kEil6vlSfUuJwOBDq68X5UA/efvcdtLS24qOPMwj19WLz5s2IvDmI5P37FeNTgnVtikajlByv10sbSZIEt9sNl8sFl8uFYDBYsq6/v99kF3Utjt6KGrS3YBoYpriJ+KLlezt3oqf3Ih48eICOY8fR8N2ncfm999C8uwkHnnseN4eHK8LNBxoMA5ZhEIvF8i6WIFBiJEmCy+UydZIkCZIkwev1wu12L6qbnJykq7IgCIhEIojFYvkI0EAsUCC34JUXsBKJRNHFTNdcj8ezqL5Yn1KysG02m8XN4WH09F6E534bmnc3AQDGx8YwPjaGmpoaMFWWSjQ4/6F6hLZlyxbawO/3U/uTTqfponf48GGqyQ6HA+l0GkNDQyYfGQA9n8vOFcwBPeq8LjYRdrsdkiQhk8mY7hvdKeO57rNKkgS73b7shxfDf+nFdpw7fQZbn96CA889j48+zqCltRU9vRdx4ODBFeGbCDYuLgvtjD7KHo+HGvl0Og2Px0Pr9OBDEARaZ1wYCu4X/Vn2xYQWwTTA5YjeVu+7Uvye3otoe+EFfPKff+Mf6TQGwmG8dqoLLa2tCJ49g4btz5SNbyb4/1C2bm9Avb0eoigu8hZKkSuKIurt9WXlDYrh19TU4LVTXTjmP4rmpib80ueD1WqtCN9MMDFHRUbbpGtzJBLB7OwsEokE6urqEAwGC76uFiYb64zTtuC/0p+yXu6Vkx2wWq2IRCJwu90Uy+gHZzIZuN1u9Pf3w2q14oj3SNkfXwr/2InjNIpbDT5d5PQXrrZWYy47h8nJSdogEAjQh2/atMlEnF6XSCQW1emiY1Vbq0GIIRwGgT6m2tWil3vS+iQGLvWj5/UQRFGEKIpwOBxwOBzgeR6SJFFlqCQZs974dN0evzOODRs2IHgqCHFIBM/zmJmZMXkGAwMDNMfgdDoRCASo9g4MDNC2xjoAqKurQyaTwbM/eRZ94V78d34eudw8cnIOuZwMRc9LqApURaVJ+IWR2pcxXUmTPWO3/46qqg14f/R9eH/hpWGhz+db1UvrCRIAOPv6Wexu+inmc/OYz+Ug53LIyQsILpLw+bIn3FkAdEvH6WqEzWYDAASDwUUu0kpkdnaWrtA2m01LxOupSRWqZot1c/GoCgsAKlGhKPl9tDPnTlOC3G63Kce7EnJdLhft2/Fqh5ZgVwokG1KUdJElj9aWEV3cAZDOQCeZuBsjiXtxcujnh/SlnjgcDhKPx0m5kk6nicPhoP0Ft0AS9+Jk4m6MnD53mt7/CpXChe+ol9yOT5DEBwkiuAV6n+d50t3dTWZmZkoSOzMzQ7q7uwnP87Tf9h3byeQHCXI7MUE6A51fRXIJs9Ap7Qp0Yq9bgMViQV+oD2/96a2Kt4yCZ7ohyzLGx2N4uf3lyqeYwWwYdzOM0efC65Xil8LSn10pNoqx3hXozGvyvTh5M/JHYrPZyh4xm81GBn47QBL34uR2YoK88bs3Vq0FhJAlz433KsVfDrfSZzClwirfUS8OHDxAdyGk6AiuXrm65Lb9HmEPnM5Gutd25cpVnA2eXf0iUUSD10JzF2KUOq5GmKXi1q3bGtAVOIWazTbDboQx3QiT36r/48n01BR+3RvG6Mjo2qzCC6bsWpmG5UzCUs9dE4J12dW4C03NTdj2zDZ83Wo153A11+rTbBZ3bt/BjWs31ozYL1qD18MGl0XwY1mFiSCEPMEwzGePqViHAIMQ5n8DAFb/49reYmyHAAAAAElFTkSuQmCC","cc-by-nc-sa":b+"pvSURBVHja7FptbFPXGX7utYlGJzz/2yYHYYQ2xZFWHAq0dLSx161TS9NcLylfocNmWtuVdUlKCNvIl4FAY0Id91Ob1sRrV7VaqTBfaxc6fEPQ4sRJbEaL82OVjZKoVJvm4KCpxB/vflzfE9/EThxo1Y72lY7v8T3nPPfc57znPe95z+WISMNx3FV8JZ+6EBHHASAAON19CjzPg+d5qFQq8LwKKp4Hr0pfeR4cx4PnOHAcB3CcjAICgVKEFKWQSkkpmUxK11QSyWQKqVSSlaUoxeoTkdwZlr8V5JHyjQAADgDJ5KpUKinxqum8SiWV8ao0yRw4js/kN01OmtiURGYymU6Z+aSS5FQqxYjNJPpWIlkNQEmuSg214iqlk8dPwev1YmBgAJOxSQXQEs0SrF27FuYfmFH28ENIplTg+YQ0IEkeHLj0WGZMnxRJMwHpOcRJ5A77A/C87UEoFFLUNxgMECoErFpTktfLfVFwOAD017PvQq1WM1LVarWUVGr0iOfgeMaB8fHxvDqk0+lQ/5t6lJbei0QyiWQygUQinZIJJBJJpuGZmvzR+Ed4vuMFjIRGAAAmkwlGoxEAEAwGIYoiAKDIUISd1TvxrW9/M+vzr3z0MV50vfiFwHmkfKNE8Hs9Z6BWqaeJVS/CIrUazY0t8BzzsAZarRaCIECv16O0tBQA0NPTg0gkAo/Hg4mJCVZXsAioq9+FxbctRiKRQDyRQCIRRyKRUJoMSuFq9Cp++cRTiMViEAQBTqcTer1e0dlIJILa2lp4PB5oNBq0OlpnvdS12DVU76z5wuDIdpjO9p6l3r5z1Ofvo8Ggny68HyTBIlB68pJWq6WWlhaKRqM0l3R1dZFWq2XtigxFdL6vlwaDg+Qb7KPevnPk7T1LZ8Ruevdv79Dp7lN04p3jZDAYCABZrVYFnowz8xky9lvH/6xIRYairDgup5O2btp8Uzijo6Pk6+sjX18fjY6O5oUDgHgAUKVtsFqlglql1Fyj0YhAIIDm5mZotdo5zYPVakU4HGZTaSQ0gnbHEYUt55lHInkjfp8foVAIgiCgfvfueU2Q1WqFIAgYCY1g2B9Q2MqR0AhWlZTg7rvWsfvPdXTgGYcDJ0+fxp663RgbG8sLJ7M/f3r1VZjW34OqzVtQtXkLTOvvwZnu7jlxFOtNr6+XfIM+Gr4wRK7nXUxzjEbjvFqbTaLRKBmNRobjesFFw/8Ypv4hH5339ZL3vKTF77z3FzIUS9obDofzxg+HwwSADAYD0xZ5FhR957u0YpmeSr+/np74+WMEgFpaWujQwUMEgI6+9VZeOHJ/fH19Et6d6+hn221Uv6uOVizT04plenI5nTlxsmiwpMWOZxzM3nZ1dc2rtdlEq9XC6/Wyto5DjrQvndZgLu1T8zxCl0IwmUyzbJzNZmNabrPZFGV6vR4mk0mxsodCEk5ZWRke2bgRY2NjONPdjRXL9Pjv5DVse3QbLn3wASoqK/PC0ev1iMViCAUuAgDKhZ/gD+5OtLUfxt6mRgCAu7MrJ44svOym8bzkisneQk1NDZvqNyJarRZOpxMAMD4+jpMnTrENi0Qyx9y0bM9xu91Z87Jka2M0GuE40o5Djja8/uYbqKisxIeXI3AcacfSpUvh7uxC6NKlvHBkaX1WUrjf//EVdu9H998PAIjFYvj4ypWcOIxgWZu8Xi8jp7q6mlUSRREWiwVmsxlmsxl2uz1nWUdHh8JeylrsPevN0F4OHD9N8Gchd951F9raD2N0dBT1u+pQ8r3b8fbRoyh7cAOqNm9hNnQu0Wg0cLlcuE2zBC+//HLWOp98cn1ODGmjwXHgOQ4DAwOSiyUIjBhRFGE2mxWNRFGEKIqorq6GxWKZVXbhwgV0dXUxLLfbjYGBAWkHmCZWIpdjfmW2xUzWXKvVOqs8W5uZ92KxGM50d6Ot/TCsl2woe3ADAKDf50O/z4fCwkJwi9Rz4ixSq1FfV4fbFi9m9/p9PpZfpl+Wsz8ZGiy9sLxDW7lyJatQW1vL7Ew4HIbX64Ver8f27duZJhuNRoTDYRw7dkzhIwNg+cnYpPQccBlXoLi4GKIoIhKJKDomD9DMvOyDiqIIg8Gg2FnNxPnFY4+jdd9+rLp9Jao2b8GHlyOoqKxEW/thVG3blhfO2NgYWpqasXXTZrTu24/WffvR1NAAANi9Z0/O/igIBgfFdM20J/LIWK1WZszD4TCsVisrkzcfgiCwssyFhG0bOfYz7YxvqlQMZD4i1xUqhOmNTTqfidPWfhi2HTtw5d//wj/DYbicTuxtakRFZSXsB/ajZM3qeXFsO3bAtmOHNNCdnejq7MT1T65jQ9lD2FK1NWd/FCbi85R169fBUGyAx+OBzWabpa3ZyPV4PCgyFCniAKvWlKDIUKTAKSwsxN6mRnxt8WIMDw3hVzU1N4Szt6kRP37gAVy+LGl1cXExDMXFc+IoNZiUUaxMeyJrs9vtxsTEBILBIJYvXw673c7K5G1yZlnmdJ6Oj7IfRScaWxqh0WjgdrthsVhYm8woWyQSgcViQUdHBzQaDXZW75z1Mnt+W58VZ9fuOrz+5hs3hbN6zWpUVFaiorIShuLivHBYsMc/PICCggKsv/seTMYmYbVamSZ5PJ5ZC5lsMsrLy3OWye1ra2vR0dGBJZolOP/3XkxNTWEqPoV4Io54PCEFg5IJRP8zgYP2g8yXNBqNMBqN0Gq1EEWRDfp8QZprsWtoO+hgQZrPE4cFe/qH+lFQUAB7kx2eYx5otVpEo1GFZ+ByuVgwx2Qyobm5mQ2Ay+VidTPLAGD58uWIRCK474f34YizHdenphCfQbAcN04lU/D3+3Hs6K0RrmQE+wb7sGhRAc6fO4/qpyT/1+l0oibDZt2IuN1utgs7cPAAHtzwAKbiU5iKx5GIxxFPzCA4SwD+/z3gzgNgRzomcyl0Oh0AwG63z3KdFiITExNsddXpdOlAfPoUI5VCKm2LKX3kdKsKDwApSiGZlM7R9rfuYwRZLBZFjHch5JrNZta2/tf16QB7cprkjCMjtsjSrXVkxBZ3ANTQ3ED+4QEKXgzQoz99VBFRCwQCC4p0ZUbSBItAwYsB8g8P0L7Wfez+lyhN/6l5upoGA34K3kDAPRqNUktLiyLgvmbtGrrwfpAGg35qaG74MpJL3EyntLG5AeUWAWq1GkccR/Daq6/d8JGRfX8LEokE+vsH8OTjT+bzHUHGro9j9zJ3mTP/58LJ1UZ+Rr6Bplx9WhDGzNTY3CBp8sUAdbpfIZ1Ol/eI6XQ6cj3vouDFAA0G/fTS717Ku+3MY6KZ+cx78+HM1z4frGx1FooxS4NlqXm6GlXbqthRj+jtwYnjJ+Y8tn9YeBgmUyk70Dx+/AQO2A8s5EuYWdqyEM2dWTfXdYFf52TV3lz9zLqTy1W46o4SNDY3oXCpLuM0IjPcCIXfKn94Mj42hmfbnTjXc27BL3MzpmE+kzAX/kIHLV+MOQmW5d7Se7GhbAPuWH0HvqHRpD+dmjYwRISrsRiGBodw+uTpBRP7WWnwzdrg+daET43gr+QmNhpE9PWvaPiMNhhE3P8GAG3CFDKJWtqSAAAAAElFTkSuQmCC","cc-by-nc-nd":b+"m8SURBVHja7FpdcBvVFf52pXgGplH11mbkDPbQdqy8oIQmMZRiufwMxRivJiHtFChyZwqUlMoiiWlaO5JCfkBNKqvhp30oUsswMCVMlL9CHRqt4xTLkmKtE7D8UMZisIf2pZLltDO1Vnv6sNprrS1bsgNDGjgz17vW3fvt3W/PPfe75y5HRCaO46bxhX3iRkQcB4AA4HT/KfA8D57nYTAYwPMGGHgevKF05HlwHA+e48BxHMBxGgoIBFIICilQFLUUi0X1qBRRLCpQlCKrU0hh1xOR1hl2fi3YAx3bAAAcANLINRgMauENc+cGg1rHG0okc+A4vpzfEjklYhWVzGKxVMrPi3qSFUVhxJYTfS2RbASgJ9dghFF3VMvJ46cQjUYRj8cxk5/RAa02rcamTZvQ+p1WtN9/H4qKATwvqy+kyIMDV3qXZcNHIXUkoDSGOJXckUQKkTcjSKfTuuutViuELQI2bFxf08NdLTgcAPrL2bdhNBoZqUajUS0GIwbEc/A/68fU1FRNHbJYLOje3Y2WltshF4soFmXIcqkUZchykXl4uSd/PPUxjvQ9j/H0OADAbrfDZrMBACRJgiiKAIAmaxO2u7bjq2u+UvH+//j4n3gh+MJVgfNAxzaV4HcGzsBoMM4Ra1yFVUYjPL1eRI5FWAOz2QxBENDQ0ICWlhYAwMDAADKZDCKRCHK5HLtWcAjY2b0D111/HWRZRkGWIcsFyLKsDxmkYDo7jZ8+/iTy+TwEQUAgEEBDQ4Ous5lMBm63G5FIBCaTCfv9+xc81OX8Zbi2d101OFocprODZ2lw6BwNJYYoKSVo9D2JBIdApcFLZrOZvF4vZbNZWspCoRCZzWbWrsnaROeHBikpJSmWHKLBoXMUHTxLZ8R+evuvb9Hp/lN04q3jZLVaCQA5nU4dnoYz/x4a9hvH/6QrTdamijjBQIB+8L3vXzHOYs+8GA4A4gHAUIrBRoMBRoPec202G1KpFDweD8xm85Lhwel0YmJigg2l8fQ4DvkP62I5zxSJqkYSsQTS6TQEQUD3rl1VQ5DT6YQgCBhPj2MkkdLFyvH0ODasX49bm29hv/+mrw/P+v04efo0nt65C5OTkzXhXGl/dPPNYGyQYskYjYxeoOCRIPMcm81W1WsrWTabJZvNxnCCzwdp5OIIDV+I0fnYIEXPq1781jt/Jus61XsnJiZqxp+YmCAAZLVambdoo6Dp69+gG29ooJZv3UaP//hRAkBer5cOHjhIAOjoG2/UhHOl/angwaoX+5/1s3gbCoWqem0lM5vNiEajrK3/oL+kpUsezJU0Nc8jPZaG3W5fEOM6OzuZl3d2durqGhoaYLfbdTN7Oq3itLe344Ft2zA5OYkz/f248YYG/GfmMh56+CGMvf8+tmzdWhNOeX++1tBYsSyFoxmvyTSeV6WYpha6urrYUF+Jmc1mBAIBAMDU1BROnjjFFiwqyRyTaZXuEw6HK55rVqmNzWaD//AhHPQ/h1dffw1btm7FBx9m4D98CGvXrkX45RDSY2M14ZTbXffcU7FUwwGg6mDNm6LRKCPH5XKxi0RRRDAYZCrBbrfD4/FUrOvo6EBXVxeLT263G7lcDtGzUdzX3lbyXg4cz4FTuE9N5G9ubsbm5mY82eXCkb4gzvT3482jR/Hm0aPY3NwM5486cdfdd9eE9dJvX1pxP9SFBseB5zjE43FVYgkCG96iKKK1tVXXSBRFiKIIl8sFh8OxoG50dBShUIhhhcNhxONxdQXIc2zoa4sPSZIqTh6a5zqdzgX1ldrM/y2fz+NMfz+eO/QrOMc60X5vGwBgOBbDcCyG+vp6cKuMVXHKw0G5/T0zsWR/yjxYfWBthXbTTTexC9xuN4sz0WgUmUwGnZ2deOSRR+Dz+djwOHbsGCRJgtvtZhoZAFpaWhAOhzGTn1HvA67sCKxbtw6iKCKTyejiXigUYgRrL6tcg4qiCKvVqltZzcf5yaOPYTgWw5G+IADggw8z6N6xE5uaN+OiNIo/hMP4cGqyKs4dd925pJdW6o9ORSSlBF0au8hm/Wg0ukCLer3eBbPnUnWaRaNRdt2lsYuUlJL0bvxdGvibSO8MnCGPbw8BIEEQFsWfb4KgavTdPbvZjL27Z/cCnI8++oj2+fbSmjVraPWXVlMwEKDp6ell41SzSjg6FfFZ2i233QLrOisikcgCtVDJtNVTk7VJlwfYsHE9mqxNOpz6+nr8ck8vdrifQntbG37W1QWTybRsnJX0R6ciQPosVnk80WbHcDiMXC4HSZLQ2NgIn8/H6rRlcnld+fCZy4+yP7pO9Hp7YTKZEA6H4XA4WJvyLFsmk4HD4UBfXx9MJhO2u7YveJinf9FdEWfHrp149fXXrhhnfliohsOSPYmROOrq6nDbrd/GTH4GTqeTxb1IJLJgItMmno6OjkXrtPZutxt9fX1YbVqN8+8OYnZ2FrOFWRTkAgoFWU0GFWVk/5XDAd8BpiVtNhtsNhvMZjNEUWQvvVqS5nL+Mp474GdJms8ShyV7hi8Mo66uDr49PkSORWA2m5HNZmuSaZFIBMFgkF1bXgcAjY2NyGQyuOPOO3A4cAj/nZ1FYR7BWt5YKSpIDCdw7Oi1ka5kBMeSQ1i1qg7nz52H60lV/wYCAaZnV2rhcJjFsX0H9uHetu9itjCL2UIBcqGAgjyP4AoJ+P/3hDsPgG3p2FtbYLFYAAA+n69i7KnVcrkck3gWi6WUiC/tYigKlFIsptKW07VqPAAopKBYVPfRntm/lxHkcDh0Od7lkNva2sradv+8u5RgL86RXLZlxCZZura2jNjkDoB6PD2UGImTdClFD//wYV1GLZVKLSuzVJ5JExwCSZdSlBiJ0979e9nvn6My90/XUy5KphIkrSDhns1myev16hLuGzdtpNH3JEpKCerx9HweySVuvijt9fSgwyHAaDTisP8wXvnjKyveMvI944UsyxgejuOJx56o5TuCOf1YyrQRlW2OVvh/MZzF2mj3qIaxFE6lflYNEeWl19OjevKlFL0c/j1ZLJaa35jFYqHgkSBJl1KUlBL04u9erLnt/OXx/PPy36rhVGtfC9YngbPAgzXresqFBx96kG31iNEBnDh+Yslt+/uF+2G3t7ANzePHT2Cfb99yvoRZ1DNq8dxKnlbpuJz+VMOphrkowQCw4eb16PXsQf1aS9luRHm6ETrdqn14MjU5iV8fCuDcwLnlfmp0RaGhWkhYDjGfFM6SBGt2e8vtaGtvw83fvBlfNplKn07NBRgiwnQ+jwvJCzh98vSyif20PPhqiME1EfyFrdw4Irqe47h/f0HFp7DAIOL+NwDFrtvhh4x87AAAAABJRU5ErkJggg=="},d;return{_setup:function(b){var e="",f=b.license&&c[b.license.toLowerCase()],g="target=_blank";b._container=document.createElement("div"),b._container.style.display="none",d=document.getElementById(b.target),b.nameofworkurl&&(e+="<a href='"+b.nameofworkurl+"' "+g+">"),b.nameofwork&&(e+=b.nameofwork),b.nameofworkurl&&(e+="</a>"),b.copyrightholderurl&&(e+="<a href='"+b.copyrightholderurl+"' "+g+">"),b.copyrightholder&&(e+=", "+b.copyrightholder),b.copyrightholderurl&&(e+="</a>"),e===""&&(e=b.text),b.license?f?b.licenseurl?e="<a href='"+b.licenseurl+"' "+g+"><img src='"+f+"' border='0'/></a> "+e:e="<img src='"+f+"' />"+e:(e+=", license: ",b.licenseurl?e+="<a href='"+b.licenseurl+"' "+g+">"+b.license+"</a> ":e+=b.license):b.licenseurl&&(e+=", <a href='"+b.licenseurl+"' "+g+">license</a> "),b._container.innerHTML=e;if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(b._container)},start:function(a,b){b._container.style.display="inline"},end:function(a,b){b._container.style.display="none"},_teardown:function(a){d=document.getElementById(a.target),d&&d.removeChild(a._container)}}}(),{about:{name:"Popcorn Attribution Plugin",version:"0.2",author:"@rwaldron",website:"github.com/rwldrn"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},nameofwork:{elem:"input",type:"text",label:"Name of Work"},nameofworkurl:{elem:"input",type:"url",label:"Url of Work"},copyrightholder:{elem:"input",type:"text",label:"Copyright Holder"},copyrightholderurl:{elem:"input",type:"url",label:"Copyright Holder Url"},license:{elem:"input",type:"text",label:"License type"},licenseurl:{elem:"input",type:"url",label:"License URL"},target:"attribution-container"}})}(Popcorn),function(a){a.plugin("code",function(b){var c=!1,d=function(){var a=function(a){return function(b,d){var e=function(){c&&b(),c&&a(e)};e()}};return window.webkitRequestAnimationFrame?a(window.webkitRequestAnimationFrame):window.mozRequestAnimationFrame?a(window.mozRequestAnimationFrame):a(function(a){window.setTimeout(a,16)})}();if(!b.onStart||typeof b.onStart!="function"){if(a.plugin.debug)throw new Error("Popcorn Code Plugin Error: onStart must be a function.");b.onStart=a.nop}if(b.onEnd&&typeof b.onEnd!="function"){if(a.plugin.debug)throw new Error("Popcorn Code Plugin Error: onEnd  must be a function.");b.onEnd=undefined}if(b.onFrame&&typeof b.onFrame!="function"){if(a.plugin.debug)throw new Error("Popcorn Code Plugin Error: onFrame  must be a function.");b.onFrame=undefined}return{start:function(a,b){b.onStart(b),b.onFrame&&(c=!0,d(b.onFrame,b))},end:function(a,b){b.onFrame&&(c=!1),b.onEnd&&b.onEnd(b)}}},{about:{name:"Popcorn Code Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},onStart:{elem:"input",type:"function",label:"onStart"},onFrame:{elem:"input",type:"function",label:"onFrame"},onEnd:{elem:"input",type:"function",label:"onEnd"}}})}(Popcorn),function(a){var b=0;a.plugin("flickr",function(c){var d,e=document.getElementById(c.target),f,g,h,i,j=c.numberofimages||4,k=c.height||"50px",l=c.width||"50px",m=c.padding||"5px",n=c.border||"0px";d=document.createElement("div"),d.id="flickr"+b,d.style.width="100%",d.style.height="100%",d.style.display="none",b++;if(!e&&a.plugin.debug)throw new Error("flickr target container doesn't exist");e&&e.appendChild(d);var o=function(){f?setTimeout(function(){o()},5):(g="http://api.flickr.com/services/rest/?method=flickr.people.findByUsername&",g+="username="+c.username+"&api_key="+c.apikey+"&format=json&jsoncallback=flickr",a.getJSONP(g,function(a){f=a.user.nsid,p()}))},p=function(){g="http://api.flickr.com/services/feeds/photos_public.gne?",f&&(g+="id="+f+"&"),c.tags&&(g+="tags="+c.tags+"&"),g+="lang=en-us&format=json&jsoncallback=flickr",a.xhr.getJSONP(g,function(b){var c=document.createElement("p");c.innerHTML="<p style='padding:"+m+";'>"+b.title+"<p/>",a.forEach(b.items,function(a,b){if(!(b<j))return!1;h=document.createElement("a"),h.setAttribute("href",a.link),h.setAttribute("target","_blank"),i=document.createElement("img"),i.setAttribute("src",a.media.m),i.setAttribute("height",k),i.setAttribute("width",l),i.setAttribute("style","border:"+n+";padding:"+m),h.appendChild(i),c.appendChild(h)}),d.appendChild(c)})};return c.username&&c.apikey?o():(f=c.userid,p()),{start:function(a,b){d.style.display="inline"},end:function(a,b){d.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(d)}}},{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},userid:{elem:"input",type:"text",label:"UserID"},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username"},apikey:{elem:"input",type:"text",label:"Api_key"},target:"flickr-container",height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"},padding:{elem:"input",type:"text",label:"Padding"},border:{elem:"input",type:"text",label:"Border"},numberofimages:{elem:"input",type:"text",label:"Number of Images"}}})}(Popcorn),function(a){a.forEach(["footnote","text"],function(b){a.plugin(b,{manifest:{about:{name:"Popcorn "+b+" Plugin",version:"0.2",author:"@annasob, @rwaldron",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},text:{elem:"input",type:"text",label:"Text"},target:b+"-container"}},_setup:function(b){var c=document.getElementById(b.target);b._container=document.createElement("div"),b._container.style.display="none",b._container.innerHTML=b.text;if(!c&&a.plugin.debug)throw new Error("target container doesn't exist");c&&c.appendChild(b._container)},start:function(a,b){b._container.style.display="inline"},end:function(a,b){b._container.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}})})}(Popcorn),function(a,b){var c=!1;a.plugin("facebook",{manifest:{about:{name:"Popcorn Facebook Plugin",version:"0.1",author:"Dan Ventura, Matthew Schranz: @mjschranz",website:"dsventura.blogspot.com, mschranz.wordpress.com"},options:{type:{elem:"select",options:["LIKE","LIKE-BOX","ACTIVITY","FACEPILE","LIVE-STREAM","SEND","COMMENTS"],label:"Type"},target:"facebook-container",start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},font:{elem:"input",type:"text",label:"font"},xid:{elem:"input",type:"text",label:"Xid"},href:{elem:"input",type:"url",label:"Href"},site:{elem:"input",type:"url",label:"Site"},height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"},action:{elem:"select",options:["like","recommend"],label:"Action"},stream:{elem:"select",options:["false","true"],label:"Stream"},header:{elem:"select",options:["false","true"],label:"Header"},layout:{elem:"select",options:["standard","button_count","box_count"],label:"Layout"},max_rows:{elem:"input",type:"text",label:"Max_rows"},border_color:{elem:"input",type:"text",label:"Border_color"},event_app_id:{elem:"input",type:"text",label:"Event_app_id"},colorscheme:{elem:"select",options:["light","dark"],label:"Colorscheme"},show_faces:{elem:"select",options:["false","true"],label:"Showfaces"},recommendations:{elem:"select",options:["false","true"],label:"Recommendations"},always_post_to_friends:{elem:"input",options:["false","true"],label:"Always_post_to_friends"},num_posts:{elem:"input",type:"text",label:"Number_of_Comments"}}},_setup:function(d){var e=document.getElementById(d.target),f=d.type;if(!document.getElementById("fb-root")){var g=document.createElement("div");g.setAttribute("id","fb-root"),document.body.appendChild(g)}if(!c||d.event_app_id)c=!0,a.getScript("//connect.facebook.net/en_US/all.js"),b.fbAsyncInit=function(){FB.init({appId:d.event_app_id||"",status:!0,cookie:!0,xfbml:!0})};f=f.toLowerCase();var h=function(a){return["like","like-box","activity","facepile","live-stream","send","comments"].indexOf(a)>-1};if(!h(f))throw new Error("Facebook plugin type was invalid.");d._container=document.createElement("div"),d._container.id="facebookdiv-"+a.guid(),d._facebookdiv=document.createElement("fb:"+f),d._container.appendChild(d._facebookdiv);var i=f==="activity"?"site":"href";d._facebookdiv.setAttribute(i,d[i]||document.URL);var j="width height layout show_faces stream header colorscheme maxrows border_color recommendations font always_post_to_friends xid num_posts".split(" ");a.forEach(j,function(a){d[a]!=null&&d._facebookdiv.setAttribute(a,d[a])});if(!e&&a.plugin.debug)throw new Error("Facebook target container doesn't exist");e&&e.appendChild(d._container)},start:function(a,b){b._container.style.display=""},end:function(a,b){b._container.style.display="none"},_teardown:function(a){var b=document.getElementById(a.target);b&&b.removeChild(a._container)}})}(Popcorn,this);var googleCallback;(function(a){var b=1,c=!1,d=!1,e,f;googleCallback=function(a){typeof google!="undefined"&&google.maps&&google.maps.Geocoder&&google.maps.LatLng?(e=new google.maps.Geocoder,d=!0):setTimeout(function(){googleCallback(a)},1)},f=function(){document.body?(c=!0,a.getScript("//maps.google.com/maps/api/js?sensor=false&callback=googleCallback")):setTimeout(function(){f()},1)},a.plugin("googlemap",function(g){var h,j,k,l=document.getElementById(g.target);c||f(),h=document.createElement("div"),h.id="actualmap"+b,h.style.width="100%",h.style.height="100%",b++;if(!l&&a.plugin.debug)throw new Error("target container doesn't exist");l&&l.appendChild(h);var m=function(){d?g.location?e.geocode({address:g.location},function(a,b){b===google.maps.GeocoderStatus.OK&&(g.lat=a[0].geometry.location.lat(),g.lng=a[0].geometry.location.lng(),k=new google.maps.LatLng(g.lat,g.lng),j=new google.maps.Map(h,{mapTypeId:google.maps.MapTypeId[g.type]||google.maps.MapTypeId.HYBRID}),j.getDiv().style.display="none")}):(k=new google.maps.LatLng(g.lat,g.lng),j=new google.maps.Map(h,{mapTypeId:google.maps.MapTypeId[g.type]||google.maps.MapTypeId.HYBRID}),j.getDiv().style.display="none"):setTimeout(function(){m()},5)};return m(),{start:function(a,b){var c=this,d,e=function(){if(j){j.getDiv().style.display="block",google.maps.event.trigger(j,"resize"),j.setCenter(k),b.zoom&&typeof b.zoom!="number"&&(b.zoom=+b.zoom),b.zoom=b.zoom||8,j.setZoom(b.zoom),b.heading&&typeof b.heading!="number"&&(b.heading=+b.heading),b.pitch&&typeof b.pitch!="number"&&(b.pitch=+b.pitch);if(b.type==="STREETVIEW"){j.setStreetView(d=new google.maps.StreetViewPanorama(h,{position:k,pov:{heading:b.heading=b.heading||0,pitch:b.pitch=b.pitch||0,zoom:b.zoom}}));var a=function(d,e){var h=google.maps.geometry.spherical.computeHeading;setTimeout(function(){var e=c.media.currentTime;if(typeof b.tween=="object"){for(var i=0,j=d.length;i<j;i++){var k=d[i];e>=k.interval*(i+1)/1e3&&(e<=k.interval*(i+2)/1e3||e>=k.interval*j/1e3)&&(o.setPosition(new google.maps.LatLng(k.position.lat,k.position.lng)),o.setPov({heading:k.pov.heading||h(k,d[i+1])||0,zoom:k.pov.zoom||0,pitch:k.pov.pitch||0}))}a(d,d[0].interval)}else{for(var l=0,m=d.length;l<m;l++){var n=b.interval;e>=n*(l+1)/1e3&&(e<=n*(l+2)/1e3||e>=n*m/1e3)&&(f.setPov({heading:h(d[l],d[l+1])||0,zoom:b.zoom,pitch:b.pitch||0}),f.setPosition(g[l]))}a(g,b.interval)}},e)};if(b.location&&typeof b.tween=="string"){var f=d,g=[],i=new google.maps.DirectionsService,l=new google.maps.DirectionsRenderer(f),m={origin:b.location,destination:b.tween,travelMode:google.maps.TravelMode.DRIVING};i.route(m,function(a,b){b==google.maps.DirectionsStatus.OK&&(l.setDirections(a),n(a,c))});var n=function(c,d){var e=c.routes[0].overview_path;for(var f=0,h=e.length;f<h;f++)g.push(new google.maps.LatLng(e[f].lat(),e[f].lng()));b.interval=b.interval||1e3,a(g,10)}}else if(typeof b.tween=="object"){var o=d;for(var p=0,q=b.tween.length;p<q;p++)b.tween[p].interval=b.tween[p].interval||1e3,a(b.tween,10)}}}else setTimeout(function(){e()},13)};e()},end:function(a,b){j&&(j.getDiv().style.display="none")},_teardown:function(a){var b=document.getElementById(a.target);b&&b.removeChild(h),h=j=k=null}}},{about:{name:"Popcorn Google Map Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","STREETVIEW","HYBRID","TERRAIN"],label:"Type"},zoom:{elem:"input",type:"text",label:"Zoom"},lat:{elem:"input",type:"text",label:"Lat"},lng:{elem:"input",type:"text",label:"Lng"},location:{elem:"input",type:"text",label:"Location"},heading:{elem:"input",type:"text",label:"Heading"},pitch:{elem:"input",type:"text",label:"Pitch"}}})})(Popcorn),function(a){a.plugin("image",{manifest:{about:{name:"Popcorn image Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},href:{elem:"input",type:"url",label:"Link URL"},target:"image-container",src:{elem:"input",type:"url",label:"Source URL"},text:{elem:"input",type:"text",label:"TEXT"}}},_setup:function(b){var c=document.createElement("img"),d=document.getElementById(b.target);b.link=document.createElement("a"),b.link.style.position="relative",b.link.style.textDecoration="none";if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(b.link),c.addEventListener("load",function(){c.style.borderStyle="none",b.href&&(b.link.href=b.href),b.link.target="_blank";var d=c.height/12+"px",e=document.createElement("div");a.extend(e.style,{color:"black",fontSize:d,fontWeight:"bold",position:"relative",textAlign:"center",width:c.width+"px",zIndex:"10"}),e.innerHTML=b.text||"",b.link.appendChild(e),b.link.appendChild(c),e.style.top=c.height/2-e.offsetHeight/2+"px",b.link.style.display="none"},!1),c.src=b.src},start:function(a,b){b.link.style.display="block"},end:function(a,b){b.link.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a.link)}})}(Popcorn),function(a){var b=function(a){var b=0,c=0,d=0,e=null,f=null,g=!1,h=0,i=function(){},j=function(){a.background(0),c=d=0,e=f=null},k=function(b,c,d,e){var f,h,i,j;g?(f=c*a.height,h=a.width-b*a.width,i=e*a.height,j=a.width-d*a.width):(f=b*a.width,h=c*a.height,i=d*a.width,j=e*a.height),a.stroke(0),a.strokeWeight(13),a.strokeCap(a.SQUARE),a.line(f,h,i,j),a.stroke(255),a.strokeWeight(12),a.strokeCap(a.ROUND),a.line(f,h,i,j)},l=function(a){a<c&&j();while(c<=a){if(!h)return;b=h[d]||h;var g=b.pt[c],i=c;e!=null&&k(e,f,g.x,g.y),e=g.x,f=g.y,c===i&&c++}};a.draw=function(){i()},a.setup=function(){},a.construct=function(b,c,d){var e=function(){if(c){h=c.gml.tag.drawing.stroke;var a=(d.end-d.start)/(h.pt||function(a){var b=[];for(var c=0,d=a.length;c<d;c++)b=b.concat(a[c].pt);return b}(h)).length,f=c.gml.tag,j=f.header&&f.header.client&&f.header.client.name;g=j==="Graffiti Analysis 2.0: DustTag"||j==="DustTag: Graffiti Analysis 2.0"||j==="Fat Tag - Katsu Edition",i=function(){b.currentTime<d.endDrawing&&l((b.currentTime-d.start)/a)};return}setTimeout(e,5)};a.size(640,640),a.frameRate(60),a.smooth(),j(),a.noLoop(),e()}};a.plugin("gml",{_setup:function(c){var d=this,e=document.getElementById(c.target);c.endDrawing=c.endDrawing||c.end,c.container=document.createElement("canvas"),c.container.style.display="none",c.container.setAttribute("id","canvas"+c.gmltag);if(!e&&a.plugin.debug)throw new Error("target container doesn't exist");e&&e.appendChild(c.container);var f=function(){a.getJSONP("//000000book.com/data/"+c.gmltag+".json?callback=",function(a){c.pjsInstance=new Processing(c.container,b),c.pjsInstance.construct(d.media,a,c),c._running&&c.pjsInstance.loop()},!1)};window.Processing?f():a.getScript("//processingjs.org/content/download/processing-js-1.3.0/processing-1.3.0.min.js",f)},start:function(a,b){b.pjsInstance&&b.pjsInstance.loop(),b.container.style.display="block"},end:function(a,b){b.pjsInstance&&b.pjsInstance.noLoop(),b.container.style.display="none"},_teardown:function(a){a.pjsInstance&&a.pjsInstance.exit(),document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a.container)}})}(Popcorn),function(a){var b={},c=function(c){if(c.artist){var d="";d="<h3>"+c.artist.name+"</h3>",d+="<a href='"+c.artist.url+"' target='_blank' style='float:left;margin:0 10px 0 0;'><img src='"+c.artist.image[2]["#text"]+"' alt=''></a>",d+="<p>"+c.artist.bio.summary+"</p>",d+="<hr /><p><h4>Tags</h4><ul>",a.forEach(c.artist.tags.tag,function(a,b){d+="<li><a href='"+a.url+"'>"+a.name+"</a></li>"}),d+="</ul></p>",d+="<hr /><p><h4>Similar</h4><ul>",a.forEach(c.artist.similar.artist,function(a,b){d+="<li><a href='"+a.url+"'>"+a.name+"</a></li>"}),d+="</ul></p>",b[c.artist.name.toLowerCase()].htmlString=d}};a.plugin("lastfm",function(){return{_setup:function(d){d._container=document.createElement("div"),d._container.style.display="none",d._container.innerHTML="",d.artist=d.artist&&d.artist.toLowerCase()||"";var e=document.getElementById(d.target);if(!e&&a.plugin.debug)throw new Error("target container doesn't exist");e&&e.appendChild(d._container),b[d.artist]||(b[d.artist]={count:0,htmlString:"Unknown Artist"},a.getJSONP("//ws.audioscrobbler.com/2.0/?method=artist.getinfo&artist="+d.artist+"&api_key="+d.apikey+"&format=json&callback=lastFMcallback",c,!1)),b[d.artist].count++},start:function(a,c){c._container.innerHTML=b[c.artist].htmlString,c._container.style.display="inline"},end:function(a,b){b._container.style.display="none",b._container.innerHTML=""},_teardown:function(a){--b[a.artist].count||delete b[a.artist],document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}}}(),{about:{name:"Popcorn LastFM Plugin",version:"0.1",author:"Steven Weerdenburg",website:"http://sweerdenburg.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"lastfm-container",artist:{elem:"input",type:"text",label:"Artist"}}})}(Popcorn),function(a){a.plugin("lowerthird",{manifest:{about:{name:"Popcorn lowerthird Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"lowerthird-container",salutation:{elem:"input",type:"text",label:"Text"},name:{elem:"input",type:"text",label:"Text"},role:{elem:"input",type:"text",label:"Text"}}},_setup:function(b){var c=document.getElementById(b.target);this.container||(this.container=document.createElement("div"),this.container.style.position="absolute",this.container.style.color="white",this.container.style.textShadow="black 2px 2px 6px",this.container.style.fontSize="24px",this.container.style.fontWeight="bold",this.container.style.paddingLeft="40px",this.container.style.width=this.video.offsetWidth+"px",this.container.style.left=this.position().left+"px",this.video.parentNode.appendChild(this.container));if(b.target&&b.target!=="lowerthird-container"){b.container=document.createElement("div");if(!c&&a.plugin.debug)throw new Error("target container doesn't exist");c&&c.appendChild(b.container)}else b.container=this.container},start:function(a,b){b.container.innerHTML=(b.salutation?b.salutation+" ":"")+b.name+(b.role?"<br />"+b.role:""),this.container.style.top=this.position().top+this.video.offsetHeight-(40+this.container.offsetHeight)+"px"},end:function(a,b){b.container.innerHTML=""}})}(Popcorn),function(a){var b=1,c=!1;a.plugin("googlefeed",function(d){var e=function(){var b=!1,d=0,e=document.getElementsByTagName("link"),f=e.length,g=document.head||document.getElementsByTagName("head")[0],h=document.createElement("link"),i="//www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.";window.GFdynamicFeedControl?c=!0:a.getScript(i+"js",function(){c=!0});for(;d<f;d++)e[d].href===i+"css"&&(b=!0);b||(h.type="text/css",h.rel="stylesheet",h.href=i+"css",g.insertBefore(h,g.firstChild))};window.google?e():a.getScript("//www.google.com/jsapi",function(){google.load("feeds","1",{callback:function(){e()}})});var f=document.createElement("div"),g=document.getElementById(d.target),h=function(){c?d.feed=new GFdynamicFeedControl(d.url,f,{vertical:d.orientation.toLowerCase()==="vertical"?!0:!1,horizontal:d.orientation.toLowerCase()==="horizontal"?!0:!1,title:d.title=d.title||"Blog"}):setTimeout(function(){h()},5)};if(!d.orientation||d.orientation.toLowerCase()!=="vertical"&&d.orientation.toLowerCase()!=="horizontal")d.orientation="vertical";f.style.display="none",f.id="_feed"+b,f.style.width="100%",f.style.height="100%",b++;if(!g&&a.plugin.debug)throw new Error("target container doesn't exist");return g&&g.appendChild(f),h(),{start:function(a,b){f.setAttribute("style","display:inline")},end:function(a,b){f.setAttribute("style","display:none")},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(f),delete a.feed}}},{about:{name:"Popcorn Google Feed Plugin",version:"0.1",author:"David Seifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"feed-container",url:{elem:"input",type:"url",label:"url"},title:{elem:"input",type:"text",label:"title"},orientation:{elem:"select",options:["Vertical","Horizontal"],label:"orientation"}}})}(Popcorn),function(a){var b=0,c=function(b,c){var d=b.container=document.createElement("div"),e=d.style,f=b.media,g=function(){var a=b.position();e.fontSize="18px",e.width=f.offsetWidth+"px",e.top=a.top+f.offsetHeight-d.offsetHeight-40+"px",e.left=a.left+"px",setTimeout(g,10)};return d.id=c||a.guid(),e.position="absolute",e.color="white",e.textShadow="black 2px 2px 6px",e.fontWeight="bold",e.textAlign="center",g(),b.media.parentNode.appendChild(d),d};a.plugin("subtitle",{manifest:{about:{name:"Popcorn Subtitle Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"subtitle-container",text:{elem:"input",type:"text",label:"Text"}}},_setup:function(a){var d=document.createElement("div");d.id="subtitle-"+b++,d.style.display="none",!this.container&&(!a.target||a.target==="subtitle-container")&&c(this),a.target&&a.target!=="subtitle-container"?a.container=document.getElementById(a.target)||c(this,a.target):a.container=this.container,document.getElementById(a.container.id)&&document.getElementById(a.container.id).appendChild(d),a.innerContainer=d,a.showSubtitle=function(){a.innerContainer.innerHTML=a.text||""}},start:function(a,b){b.innerContainer.style.display="inline",b.showSubtitle(b,b.text)},end:function(a,b){b.innerContainer.style.display="none",b.innerContainer.innerHTML=""},_teardown:function(a){a.container.removeChild(a.innerContainer)}})}(Popcorn),function(a){var b=[],c=function(){this.name="",this.contains={},this.toString=function(){var a=[];for(var b in this.contains)this.contains.hasOwnProperty(b)&&a.push(" "+this.contains[b]);return a.toString()}};a.plugin("tagthisperson",function(){return{_setup:function(d){var e=!1,f=document.getElementById(d.target);if(!f&&a.plugin.debug)throw new Error("target container doesn't exist");for(var g=0;g<b.length;g++)if(b[g].name===d.target){d._p=b[g],e=!0;break}e||(d._p=new c,d._p.name=d.target,b.push(d._p))},start:function(a,b){b._p.contains[b.person]=b.image?"<img src='"+b.image+"'/> ":"",b._p.contains[b.person]+=b.href?"<a href='"+b.href+"' target='_blank'> "+b.person+"</a>":b.person,document.getElementById(b.target).innerHTML=b._p.toString()},end:function(a,b){delete b._p.contains[b.person],document.getElementById(b.target).innerHTML=b._p.toString()}}}(),{about:{name:"Popcorn tagthisperson Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"tagthisperson-container",person:{elem:"input",type:"text",label:"Name"},image:{elem:"input",type:"url",label:"Image Src"},href:{elem:"input",type:"url",label:"URL"}}})}(Popcorn),function(a){var b=!1;a.plugin("twitter",{manifest:{about:{name:"Popcorn Twitter Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},src:{elem:"input",type:"text",label:"Source"},target:"twitter-container",height:{elem:"input",type:"number",label:"Height"},width:{elem:"input",type:"number",label:"Width"}}},_setup:function(c){!window.TWTR&&!b&&(b=!0,a.getScript("//widgets.twimg.com/j/2/widget.js"));var d=document.getElementById(c.target);c.container=document.createElement("div"),c.container.setAttribute("id",a.guid()),c.container.style.display="none";if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(c.container);var e=c.src||"",f=c.width||250,g=c.height||200,h=/^@/.test(e),i={version:2,id:c.container.getAttribute("id"),rpp:30,width:f,height:g,interval:6e3,theme:{shell:{background:"#ffffff",color:"#000000"},tweets:{background:"#ffffff",color:"#444444",links:"#1985b5"}},features:{loop:!0,timestamp:!0,avatars:!0,hashtags:!0,toptweets:!0,live:!0,scrollbar:!1,behavior:"default"}},j=function(a){window.TWTR?h?(i.type="profile",(new TWTR.Widget(i)).render().setUser(e).start()):(i.type="search",i.search=e,i.subject=e,(new TWTR.Widget(i)).render().start()):setTimeout(function(){j(a)},1)};j(this)},start:function(a,b){b.container.style.display="inline"},end:function(a,b){b.container.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a.container)}})}(Popcorn),function(a){a.plugin("webpage",{manifest:{about:{name:"Popcorn Webpage Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{id:{elem:"input",type:"text",label:"Id"},start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},src:{elem:"input",type:"url",label:"Src"},target:"iframe-container"}},_setup:function(b){var c=document.getElementById(b.target);b.src=b.src.replace(/^(https?:)?(\/\/)?/,"//"),b._iframe=document.createElement("iframe"),b._iframe.setAttribute("width","100%"),b._iframe.setAttribute("height","100%"),b._iframe.id=b.id,b._iframe.src=b.src,b._iframe.style.display="none";if(!c&&a.plugin.debug)throw new Error("target container doesn't exist");c&&c.appendChild(b._iframe)},start:function(a,b){b._iframe.src=b.src,b._iframe.style.display="inline"},end:function(a,b){b._iframe.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._iframe)}})}(Popcorn);var wikiCallback;(function(a){a.plugin("wikipedia",{manifest:{about:{name:"Popcorn Wikipedia Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},lang:{elem:"input",type:"text",label:"Language"},src:{elem:"input",type:"url",label:"Src"},title:{elem:"input",type:"text",label:"Title"},numberofwords:{elem:"input",type:"text",label:"Num Of Words"},target:"wikipedia-container"}},_setup:function(b){var c,d=a.guid();b.lang||(b.lang="en"),b.numberofwords=b.numberofwords||200,window["wikiCallback"+d]=function(a){b._link=document.createElement("a"),b._link.setAttribute("href",b.src),b._link.setAttribute("target","_blank"),b._link.innerHTML=b.title||a.parse.displaytitle,b._desc=document.createElement("p"),c=a.parse.text["*"].substr(a.parse.text["*"].indexOf("<p>")),c=c.replace(/((<(.|\n)+?>)|(\((.*?)\) )|(\[(.*?)\]))/g,""),c=c.split(" "),b._desc.innerHTML=c.slice(0,c.length>=b.numberofwords?b.numberofwords:c.length).join(" ")+" ...",b._fired=!0};if(b.src)a.getScript("//"+b.lang+".wikipedia.org/w/api.php?action=parse&props=text&page="+b.src.slice(b.src.lastIndexOf("/")+1)+"&format=json&callback=wikiCallback"+d);else if(a.plugin.debug)throw new Error("Wikipedia plugin needs a 'src'")},start:function(a,b){var c=function(){b._fired?b._link&&b._desc&&document.getElementById(b.target)&&(document.getElementById(b.target).appendChild(b._link),document.getElementById(b.target).appendChild(b._desc),b._added=!0):setTimeout(function(){c()},13)};c()},end:function(a,b){b._added&&(document.getElementById(b.target).removeChild(b._link),document.getElementById(b.target).removeChild(b._desc))},_teardown:function(a){a._added&&(a._link.parentNode&&document.getElementById(a.target).removeChild(a._link),a._desc.parentNode&&document.getElementById(a.target).removeChild(a._desc),delete a.target)}})})(Popcorn),function(a,b){var c={text:function(a){var b=a.post,c=document.createElement("a"),d=document.createTextNode(b.title),e=document.createElement("div");c.setAttribute("href",b.post_url),c.appendChild(d),e.appendChild(c),e.innerHTML+=b.body,a._container.appendChild(e)},photo:function(b){var c=b.width||250,d=-1,e=[b.post.photos.length],f=[b.post.photos.length],g=document.createElement("div"),h=document.createElement("img"),i=b.post;for(var j=0,k=i.photos.length;j<k;j++){var l=i.photos[j],m=l.alt_sizes;for(var n=0,o=m.length;n<o;n++){var p=m[n];if(p.width===c){f[j]=p.url,e[j]=l.caption,d=0;break}p.width===250&&(d=n)}d===-1&&a.error("Clearly your blog has a picture that is so tiny it isn't even 250px wide. Consider  using a bigger picture or try a smaller size."),n===m.length&&(f[j]=m[d].url)}for(var q=0,r=f.length;q<r;q++)g.innerHTML+=e[q]+"<br/>",h.setAttribute("src",f[q]),h.setAttribute("alt","Pic"+q),g.appendChild(h),g.innerHTML+="<br/>";g.innerHTML+="<br/>"+i.caption,b._container.appendChild(g)},audio:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post;if(!d.artist){var e=document.createTextNode(d.source_title);c.setAttribute("href",d.source_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/>"}else{var f=document.createElement("img");b.innerHTML+="Artist: "+d.artist+"<br/>",c.setAttribute("href",d.source_url),f.setAttribute("src",d.album_art),f.setAttribute("alt",d.album),c.appendChild(f),b.appendChild(c),b.innerHTML+="<hr/>"+d.track_number+" - "+d.track_name+"<br/>"}b.innerHTML+=d.player+"   "+d.plays+"plays<br/>"+d.caption,a._container.appendChild(b)},video:function(b){var c=b.width||400,d=-1,e=b.post,f=document.createElement("div"),g;for(var h=0,i=e.player.length;h<i;h++){var j=e.player[h];if(j.width===c){g=j.embed_code,d=0;break}j.width===400&&(d=h)}h===b.post.player.length&&(g=e.player[d].embed_code),d===-1&&a.error("Specified video size was not found and default was never found. Please try another width."),f.innerHTML+=g+"<br/>"+e.caption,b._container.appendChild(f)},chat:function(a){var b=a.post,c,d=document.createElement("div");d.innerHTML+="<strong><u>"+b.title+"</u></strong><br/><br/>";for(var e=0,f=b.dialogue.length;e<f;e++)c=b.dialogue[e],d.innerHTML+=c.label+" "+c.phrase+"<br/>";a._container.appendChild(d)},quote:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post,e=document.createTextNode(d.text);c.setAttribute("href",d.post_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/><br/>Source: <b>"+d.source+"</b>",a._container.appendChild(b)},link:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post,e=document.createTextNode(d.title);c.setAttribute("href",d.post_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/>"+d.description,a._container.appendChild(b)},answer:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post,e=document.createTextNode(d.asking_name);b.innerHTML="Inquirer: ",c.setAttribute("href",d.asking_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/><br/>Question: "+d.question+"<br/>Answer: "+d.answer,a._container.appendChild(b)}};a.plugin("tumblr",{manifest:{about:{name:"Popcorn Tumblr Plugin",version:"0.1",author:"Matthew Schranz, @mjschranz",website:"mschranz.wordpress.com"},options:{requestType:{elem:"select",options:["INFO","AVATAR","BLOGPOST"],label:"Type_Of_Plugin"},target:"tumblr-container",start:{elem:"input",type:"number",label:"Start_Time"},end:{elem:"input",type:"number",label:"End_Time"},base_hostname:{elem:"input",type:"text",label:"User_Name"},api_key:{elem:"input",type:"text",label:"Application_Key"},size:{elem:"select",options:[16,24,30,40,48,64,96,128,512],label:"avatarSize"},blogId:{elem:"input",type:"number",label:"Blog_ID"},width:{elem:"input",type:"number",label:"Photo_Width"}}},_setup:function(b){var d=document.getElementById(b.target),e,f,g,h,i,j,k=function(a){return["info","avatar","blogpost"].indexOf(a)>-1};b.requestType=b.requestType.toLowerCase(),(!b.base_hostname||!b.api_key&&(b.requestType==="info"||b.requestType==="blogpost"))&&a.error("Must provide a blog URL to the plugin and an api_key for Blog Info and Blog Post requests."),!k(b.requestType)&&a.error("Invalid tumblr plugin type."),b.requestType==="blogpost"&&b.blogId===undefined&&a.error("Error. BlogId required for blogpost requests"),!d&&a.plugin.debug&&a.error("Target Tumblr container doesn't exist."),f=b.base_hostname.slice(b.base_hostname.indexOf("/")+2,b.base_hostname.length),g=b.base_hostname.slice(0,b.base_hostname.indexOf("/")+2),h=g==="http://"||g==="https://"?f:b.base_hostname,h.indexOf("/")>-1&&(h=h.slice(0,h.indexOf("/"))),b.base_hostname=h,b._container=document.createElement("div"),b._container.id="tumblrdiv-"+a.guid(),b.requestType==="avatar"?b._container.innerHTML="<img src=http://api.tumblr.com/v2/blog/"+b.base_hostname+"/avatar/"+b.size+" alt='BlogAvatar' />":(b.requestType==="blogpost"?j="posts":j="info",e="http://api.tumblr.com/v2/blog/"+b.base_hostname+"/"+j+"?api_key="+b.api_key+"&id="+b.blogId+"&jsonp=tumblrCallBack",a.getJSONP(e,function(d){if(d.meta.msg==="OK"){var e=document.createElement("div");if(b.requestType==="blogpost"){b.post=d.response.posts[0];var f=b.post.type,g=b.post,h=g.tags;e.innerHTML="Date Published: "+b.post.date.slice(0,b.post.date.indexOf(" "))+"<br/>";if(h.length!==0){e.innerHTML+="Tags: "+h[0];for(var i=1,j=h.length;i<j;i++)e.innerHTML+=", "+h[i]}else e.innerHTML+="Tags: No Tags Used";b._container.appendChild(e),c[f](b)}else{var k=document.createElement("a"),l=d.response.blog,m=document.createTextNode(l.title);k.setAttribute("href",l.url),k.appendChild(m),e.appendChild(k),e.innerHTML+=l.description,b._container.appendChild(e)}}else a.error("Error. Request failed. Status code: "+d.meta.status+" - Message: "+d.meta.msg)},!1)),b._container.style.display="none",d&&d.appendChild(b._container)},start:function(a,b){b._container&&(b._container.style.display="")},end:function(a,b){b._container&&(b._container.style.display="none")},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}})}(Popcorn,this),function(a){a.plugin("linkedin",{manifest:{about:{name:"Popcorn LinkedIn Plugin",version:"0.1",author:"Dan Ventura",website:"dsventura.blogspot.com"},options:{type:{elem:"input",type:"text",label:"Type"},url:{elem:"input",type:"text",label:"URL"},apikey:{elem:"input",type:"text",label:"API Key"},counter:{elem:"input",type:"text",label:"Counter"},memberid:{elem:"input",type:"text",label:"Member ID"},format:{elem:"input",type:"text",label:"Format"},companyid:{elem:"input",type:"text",label:"Company ID"},modules:{elem:"input",type:"text",label:"Modules"},productid:{elem:"input",type:"text",label:"productid"},related:{elem:"input",type:"text",label:"related"},start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"linkedin-container"}},_setup:function(b){var c=b.apikey,d=document.getElementById(b.target),e=document.createElement("script");a.getScript("//platform.linkedin.com/in.js"),b._container=document.createElement("div"),b._container.appendChild(e),c&&(e.innerHTML="api_key: "+c),b.type=b.type&&b.type.toLowerCase()||"";var f=function(){b._container=document.createElement("p"),b._container.innerHTML="Plugin requires a valid <a href='https://www.linkedin.com/secure/developer'>apikey</a>";if(!d&&a.plugin.debug)throw"target container doesn't exist";d&&d.appendChild(b._container)},g=function(a){return{share:function(){e.setAttribute("type","IN/Share"),a.counter&&e.setAttribute("data-counter",a.counter),a.url&&e.setAttribute("data-url",a.url)},memberprofile:function(){e.setAttribute("type","IN/MemberProfile"),e.setAttribute("data-id",a.memberid),e.setAttribute("data-format",a.format||"inline"),a.text&&a.format.toLowerCase()!=="inline"&&e.setAttribute("data-text",a.text)},companyinsider:function(){e.setAttribute("type","IN/CompanyInsider"),e.setAttribute("data-id",a.companyid),a.modules&&a._container.setAttribute("data-modules",a.modules)},companyprofile:function(){e.setAttribute("type","IN/CompanyProfile"),e.setAttribute("data-id",a.companyid),e.setAttribute("data-format",a.format||"inline"),a.text&&a.format.toLowerCase()!=="inline"&&e.setAttribute("data-text",a.text),a.related!==undefined&&e.setAttribute("data-related",a.related)},recommendproduct:function(){e.setAttribute("type","IN/RecommendProduct"),e.setAttribute("data-company",a.companyid||"LinkedIn"),e.setAttribute("data-product",a.productid||"201714"),a.counter&&e.setAttribute("data-counter",a.counter)}}}(b);c?g[b.type]&&g[b.type]():f();if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(b._container),b._container.style.display="none"},start:function(a,b){b._container.style.display="block"},end:function(a,b){b._container.style.display="none"},_teardown:function(a){var b=document.getElementById(a.target);b&&b.removeChild(a._container)}})}(Popcorn),function(a){a.plugin("mustache",function(b){var c,d,e,f;a.getScript("https://github.com/janl/mustache.js/raw/master/mustache.js");var g=!!b.dynamic,h=typeof b.template,i=typeof b.data,j=document.getElementById(b.target);if(!j&&a.plugin.debug)throw new Error("target container doesn't exist");b.container=j||document.createElement("div");if(h==="function")g?e=b.template:f=b.template(b);else if(h==="string")f=b.template;else{if(a.plugin.debug)throw new Error("Mustache Plugin Error: options.template must be a String or a Function.");f=""}if(i==="function")g?c=b.data:d=b.data(b);else if(i==="string")d=JSON.parse(b.data);else if(i==="object")d=b.data;else{if(a.plugin.debug)throw new Error("Mustache Plugin Error: options.data must be a String, Object, or Function.");d=""}return{start:function(a,b){var g=function(){if(!window.Mustache)setTimeout(function(){g()},10);else{c&&(d=c(b)),e&&(f=e(b));var a=Mustache.to_html(f,d).replace(/^\s*/mg,"");b.container.innerHTML=a}};g()},end:function(a,b){b.container.innerHTML=""},_teardown:function(a){c=d=e=f=null}}},{about:{name:"Popcorn Mustache Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"mustache-container",template:{elem:"input",type:"text",label:"Template"},data:{elem:"input",type:"text",label:"Data"},dynamic:{elem:"input",type:"text",label:"Dynamic"}}})}(Popcorn),function(a){function d(a,b){if(a.map){a.map.div.style.display=b;return}setTimeout(function(){d(a,b)},10)}var b,c=1;a.plugin("openmap",function(b){var e,f,g,h,j,k,l,m,n=document.getElementById(b.target);e=document.createElement("div"),e.id="openmapdiv"+c,e.style.width="100%",e.style.height="100%",c++;if(!n&&a.plugin.debug)throw new Error("target container doesn't exist");return n&&n.appendChild(e),m=function(){if(!window.OpenLayers)setTimeout(function(){m()},50);else{b.location?(location=new OpenLayers.LonLat(0,0),a.getJSONP("//tinygeocoder.com/create-api.php?q="+b.location+"&callback=jsonp",function(a){f=new OpenLayers.LonLat(a[1],a[0]),b.map.setCenter(f)})):f=new OpenLayers.LonLat(b.lng,b.lat),b.type=b.type||"ROADMAP";if(b.type==="SATELLITE"){b.map=new OpenLayers.Map({div:e,maxResolution:.28125,tileSize:new OpenLayers.Size(512,512)});var c=new OpenLayers.Layer.WorldWind("LANDSAT","//worldwind25.arc.nasa.gov/tile/tile.aspx",2.25,4,{T:"105"});b.map.addLayer(c),h=new OpenLayers.Projection("EPSG:4326"),g=new OpenLayers.Projection("EPSG:4326")}else if(b.type==="TERRAIN"){h=new OpenLayers.Projection("EPSG:4326"),g=new OpenLayers.Projection("EPSG:4326"),b.map=new OpenLayers.Map({div:e,projection:g});var d=new OpenLayers.Layer.WMS("USGS Terraserver","//terraserver-usa.org/ogcmap.ashx?",{layers:"DRG"});b.map.addLayer(d)}else{g=new OpenLayers.Projection("EPSG:900913"),h=new OpenLayers.Projection("EPSG:4326"),f=f.transform(h,g),b.map=new OpenLayers.Map({div:e,projection:g,displayProjection:h});var i=new OpenLayers.Layer.OSM;b.map.addLayer(i)}b.map&&(b.map.div.style.display="none")}},m(),{_setup:function(b){window.OpenLayers||a.getScript("//openlayers.org/api/OpenLayers.js");var c=function(){if(!b.map)setTimeout(function(){c()},13);else{b.zoom=b.zoom||2,b.zoom&&typeof b.zoom!="number"&&(b.zoom=+b.zoom),b.map.setCenter(f,b.zoom);if(b.markers){var d=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style["default"]),e=function(a){clickedFeature=a.feature;if(!clickedFeature.attributes.text)return;l=new OpenLayers.Popup.FramedCloud("featurePopup",clickedFeature.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(120,250),clickedFeature.attributes.text,null,!0,function(a){k.unselect(this.feature)}),clickedFeature.popup=l,l.feature=clickedFeature,b.map.addPopup(l)},i=function(a){feature=a.feature,feature.popup&&(l.feature=null,b.map.removePopup(feature.popup),feature.popup.destroy(),feature.popup=null)},m=function(b){a.getJSONP("//tinygeocoder.com/create-api.php?q="+b.location+"&callback=jsonp",function(a){var c=(new OpenLayers.Geometry.Point(a[1],a[0])).transform(h,g),e=OpenLayers.Util.extend({},d);if(!b.size||isNaN(b.size))b.size=14;e.pointRadius=b.size,e.graphicOpacity=1,e.externalGraphic=b.icon;var f=new OpenLayers.Feature.Vector(c,null,e);b.text&&(f.attributes={text:b.text}),j.addFeatures([f])})};j=new OpenLayers.Layer.Vector("Point Layer",{style:d}),b.map.addLayer(j);for(var n=0,o=b.markers.length;n<o;n++){var p=b.markers[n];p.text&&(k||(k=new OpenLayers.Control.SelectFeature(j),b.map.addControl(k),k.activate(),j.events.on({featureselected:e,featureunselected:i})));if(p.location){var q=m;q(p)}else{var r=(new OpenLayers.Geometry.Point(p.lng,p.lat)).transform(h,g),s=OpenLayers.Util.extend({},d);if(!p.size||isNaN(p.size))p.size=14;s.pointRadius=p.size,s.graphicOpacity=1,s.externalGraphic=p.icon;var t=new OpenLayers.Feature.Vector(r,null,s);p.text&&(t.attributes={text:p.text}),j.addFeatures([t])}}}}};c()},start:function(a,b){d(b,"block")},end:function(a,b){d(b,"none")},_teardown:function(a){n&&n.removeChild(e),e=map=f=g=h=j=k=l=null}}},{about:{name:"Popcorn OpenMap Plugin",version:"0.3",author:"@mapmeld",website:"mapadelsur.blogspot.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","TERRAIN"],label:"Type"},zoom:{elem:"input",type:"text",label:"Zoom"},lat:{elem:"input",type:"text",label:"Lat"},lng:{elem:"input",type:"text",label:"Lng"},location:{elem:"input",type:"text",label:"Location"},markers:{elem:"input",type:"text",label:"List Markers"}}})}(Popcorn),document.addEventListener("click",function(a){var b=a.target;(b.nodeName==="A"||b.parentNode&&b.parentNode.nodeName==="A")&&Popcorn.instances.forEach(function(a){a.options.pauseOnLinkClicked&&a.pause()})},!1),function(a){var b={},c=0,d=function(a){b[a]=document.createElement("div");var c=document.getElementById(a);return c&&c.appendChild(b[a]),b[a].style.height="100%",b[a].style.position="relative",b[a]},e=document.createElement("span"),f=["webkit","Moz","ms","O",""],g=["Transform","TransitionDuration","TransitionTimingFunction"],h={},i;document.getElementsByTagName("head")[0].appendChild(e);for(var j=0,k=g.length;j<k;j++)for(var l=0,m=f.length;l<m;l++){i=f[l]+g[j];if(i in e.style){h[g[j].toLowerCase()]=i;break}}document.getElementsByTagName("head")[0].appendChild(e),a.plugin("wordriver",{manifest:{about:{name:"Popcorn WordRiver Plugin"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"wordriver-container",text:{elem:"input",type:"text",label:"Text"},color:{elem:"input",type:"text",label:"Color"}}},_setup:function(c){if(!document.getElementById(c.target)&&a.plugin.debug)throw new Error("target container doesn't exist");c._duration=c.end-c.start,c._container=b[c.target]||d(c.target),c.word=document.createElement("span"),c.word.style.position="absolute",c.word.style.whiteSpace="nowrap",c.word.style.opacity=0,c.word.style.MozTransitionProperty="opacity, -moz-transform",c.word.style.webkitTransitionProperty="opacity, -webkit-transform",c.word.style.OTransitionProperty="opacity, -o-transform",c.word.style.transitionProperty="opacity, transform",c.word.style[h.transitionduration]="1s, "+c._duration+"s",c.word.style[h.transitiontimingfunction]="linear",c.word.innerHTML=c.text,c.word.style.color=c.color||"black"},start:function(a,b){b._container.appendChild(b.word),b.word.style[h.transform]="",b.word.style.fontSize=~~(30+20*Math.random())+"px",c%=b._container.offsetWidth-b.word.offsetWidth,b.word.style.left=c+"px",c+=b.word.offsetWidth+10,b.word.style[h.transform]="translateY("+(b._container.offsetHeight-b.word.offsetHeight)+"px)",b.word.style.opacity=1,setTimeout(function(){b.word.style.opacity=0},(b.end-b.start-1||1)*1e3)},end:function(a,b){b.word.style.opacity=0},_teardown:function(a){var c=document.getElementById(a.target);a.word.parentNode&&a._container.removeChild(a.word),b[a.target]&&!b[a.target].childElementCount&&c&&c.removeChild(b[a.target])&&delete b[a.target]}})}(Popcorn),function(a){a.plugin("processing",function(b){var c=function(c){function d(b){var d=function(){c.listen("pause",function(){b.canvas.style.display==="inline"&&b.pjsInstance.noLoop()}),c.listen("play",function(){b.canvas.style.display==="inline"&&b.pjsInstance.loop()})};if(b.sketch)a.xhr({url:b.sketch,dataType:"text",success:function(a){b.codeReady=!1;var e=Processing.compile(a);b.pjsInstance=new Processing(b.canvas,e),b.seeking=!1,b._running&&!c.media.paused&&b.pjsInstance.loop()||b.pjsInstance.noLoop(),c.listen("seeking",function(){b._running&&b.canvas.style.display==="inline"&&b.noPause&&b.pjsInstance.loop()}),b.noPause=b.noPause||!1,!b.noPause&&d(),b.codeReady=!0}});else if(a.plugin.debug)throw new Error("Popcorn.Processing: options.sketch is undefined")}window.Processing?d(b):a.getScript("//wac.1237.edgecastcdn.net/801237/cdn.processingjs.org/content/download/processing-js-1.3.6/processing-1.3.6.min.js",function(){d(b)})};return{_setup:function(b){b.codeReady=!1,b.parentTarget=document.getElementById(b.target);if(!b.parentTarget&&a.plugin.debug)throw new Error("target container doesn't exist");var d=document.createElement("canvas");d.id=a.guid(b.target+"-sketch"),d.style.display="none",b.canvas=d,b.parentTarget&&b.parentTarget.appendChild(b.canvas),c(this)},start:function(a,b){b.codeReady&&!this.media.paused&&b.pjsInstance.loop(),b.canvas.style.display="inline"},end:function(a,b){b.pjsInstance&&b.pjsInstance.noLoop(),b.canvas.style.display="none"},_teardown:function(a){a.pjsInstance&&a.pjsInstance.exit(),a.parentTarget&&a.parentTarget.removeChild(a.canvas)}}},{about:{name:"Popcorn Processing Plugin",version:"0.1",author:"Christopher De Cairos, Benjamin Chalovich",website:"cadecairos.blogspot.com, ben1amin.wordpress.org"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:{elem:"input",type:"text",label:"Target"},sketch:{elem:"input",type:"url",label:"Sketch"},noPause:{elem:"select",options:["TRUE","FALSE"],label:"No Loop"}}})}(Popcorn),function(a){var b=1;a.plugin("timeline",function(c){var d=document.getElementById(c.target),e=document.createElement("div"),f,g=!0;d&&!d.firstChild?(d.appendChild(f=document.createElement("div")),f.style.width="inherit",f.style.height="inherit",f.style.overflow="auto"):f=d.firstChild,e.style.display="none",e.id="timelineDiv"+b,c.direction=c.direction||"up",c.direction.toLowerCase()==="down"&&(g=!1);if(d&&f)g?f.insertBefore(e,f.firstChild):f.appendChild(e);else if(a.plugin.debug)throw new Error("target container doesn't exist");return b++,e.innerHTML="<p><span id='big' style='font-size:24px; line-height: 130%;' >"+c.title+"</span><br />"+"<span id='mid' style='font-size: 16px;'>"+c.text+"</span><br />"+c.innerHTML,{start:function(a,b){e.style.display="block",b.direction==="down"&&(f.scrollTop=f.scrollHeight)},end:function(a,b){e.style.display="none"},_teardown:function(a){f&&e&&f.removeChild(e)&&!f.firstChild&&d.removeChild(f)}}},{about:{name:"Popcorn Timeline Plugin",version:"0.1",author:"David Seifried @dcseifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"feed-container",title:{elem:"input",type:"text",label:"title"},text:{elem:"input",type:"text",label:"text"},innerHTML:{elem:"input",type:"text",label:"innerHTML"},direction:{elem:"input",type:"text",label:"direction"}}})}(Popcorn),function(a,b){var c={};a.plugin("documentcloud",{manifest:{about:{name:"Popcorn Document Cloud Plugin",version:"0.1",author:"@humphd, @ChrisDeCairos",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"documentcloud-container",width:{elem:"input",type:"text",label:"Width"},height:{elem:"input",type:"text",label:"Height"},src:{elem:"input",type:"text",label:"PDF URL"},preload:{elem:"input",type:"boolean",label:"Preload"},page:{elem:"input",type:"number",label:"Page Number"},aid:{elem:"input",type:"number",label:"Annotation Id"}}},_setup:function(d){function g(){function v(a){d._key=a.api.getId(),d._changeView=function(a){d.aid?a.pageSet.showAnnotation(a.api.getAnnotation(d.aid)):a.api.setCurrentPage(d.page)}}function w(b){var f=!1;return a.forEach(e.viewers,function(a,g){if(a.api.getSchema().canonicalURL===b){var h;v(a),h=c[d._key],d._containerId=h.id,h.num+=1,f=!0,e.loaded=!0}}),f}function x(){var a={num:1,id:d._containerId};c[d._key]=a,e.loaded=!0}e.loaded=!1;var g=d.url.replace(/\.html$/,".js"),h=d.target,i=b.getElementById(h),j=b.createElement("div"),k=a.position(i),l=d.width||k.width,m=d.height||k.height,n=d.sidebar||!0,o=d.text||!0,p=d.pdf||!0,q=d.showAnnotations||!0,r=d.zoom||700,s=d.search||!0,t=d.page,u;if(!w(d.url)){j.id=d._containerId=a.guid(h),u="#"+j.id,i.appendChild(j),f.trigger("documentready");var y=d.page||d.aid?function(a){v(a),d._changeView(a),j.style.visibility="hidden",a.elements.pages.hide(),x()}:function(a){v(a),x(),j.style.visibility="hidden",a.elements.pages.hide()};e.load(g,{width:l,height:m,sidebar:n,text:o,pdf:p,showAnnotations:q,zoom:r,search:s,container:u,afterLoad:y})}}function h(){window.DV.loaded?g():setTimeout(h,25)}var e=window.DV=window.DV||{},f=this;if(!e.loading){e.loading=!0,e.recordHit="//www.documentcloud.org/pixel.gif";var i=b.createElement("link"),j=b.getElementsByTagName("head")[0];i.rel="stylesheet",i.type="text/css",i.media="screen",i.href="//s3.documentcloud.org/viewer/viewer-datauri.css",j.appendChild(i),e.loaded=!1,a.getScript("http://s3.documentcloud.org/viewer/viewer.js",function(){e.loading=!1,g()})}else h()},start:function(a,c){var d=b.getElementById(c._containerId),e=DV.viewers[c._key];(c.page||c.aid)&&e&&c._changeView(e),d&&e&&(d.style.visibility="visible",e.elements.pages.show())},end:function(a,c){var d=b.getElementById(c._containerId);d&&DV.viewers[c._key]&&(d.style.visibility="hidden",DV.viewers[c._key].elements.pages.hide())},_teardown:function(a){var d=b.getElementById(a._containerId),e=a._key;if(e&&DV.viewers[e]&&--c[e].num===0){DV.viewers[e].api.unload();while(d.hasChildNodes())d.removeChild(d.lastChild);d.parentNode.removeChild(d)}}})}(Popcorn,window.document),function(a){a.parser("parseJSON","JSON",function(b){var c={title:"",remote:"",data:[]},d={},e=b;return a.forEach(e.data,function(a,b){c.data.push(a)}),c})}(Popcorn),function(a){a.parser("parseSBV",function(a){var b={title:"",remote:"",data:[]},c=[],d,e=0,f=0,g=0,h=function(a){var b=a.split(":"),c=b.length-1,d;try{d=parseInt(b[c-1],10)*60+parseFloat(b[c],10),c===2&&(d+=parseInt(b[0],10)*3600)}catch(e){throw"Bad cue"}return d},i=function(a,b){var c={};return c[a]=b,c};d=a.text.split(/(?:\r\n|\r|\n)/gm),f=d.length;while(e<f){var j={},k=[],l=d[e++].split(",");try{j.start=h(l[0]),j.end=h(l[1]);while(e<f&&d[e])k.push(d[e++]);j.text=k.join("<br />"),c.push(i("subtitle",j))}catch(m){while(e<f&&d[e])e++}while(e<f&&!d[e])e++}return b.data=c,b})}(Popcorn),function(a){a.parser("parseSRT",function(a){var b={title:"",remote:"",data:[]},c=[],d=0,e=0,f=0,g,h,i,j,k=function(a){var b=a.split(":");try{var c=b[2].split(",");return c.length===1&&(c=b[2].split(".")),parseFloat(b[0],10)*3600+parseFloat(b[1],10)*60+parseFloat(c[0],10)+parseFloat(c[1],10)/1e3}catch(d){return 0}},l=function(a,b){var c={};return c[a]=b,c};g=a.text.split(/(?:\r\n|\r|\n)/gm),e=g.length;for(d=0;d<e;d++){j={},i=[],j.id=parseInt(g[d++],10),h=g[d++].split(/[\t ]*-->[\t ]*/),j.start=k(h[0]),f=h[1].indexOf(" "),f!==-1&&(h[1]=h[1].substr(0,f)),j.end=k(h[1]);while(d<e&&g[d])i.push(g[d++]);j.text=i.join("\\N").replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,""),j.text=j.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"),j.text=j.text.replace(/&lt;(\/?(font|b|u|i|s))((\s+(\w|\w[\w\-]*\w)(\s*=\s*(?:\".*?\"|'.*?'|[^'\">\s]+))?)+\s*|\s*)(\/?)&gt;/gi,"<$1$3$7>"),j.text=j.text.replace(/\\N/gi,"<br />"),c.push(l("subtitle",j))}return b.data=c,b})}(Popcorn),function(a){function b(a,b){var e=a.substr(10).split(","),f=/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,g=/\\N/gi,h;h={start:c(e[b.start]),end:c(e[b.end])};if(h.start===-1||h.end===-1)throw"Invalid time";return h.text=d(e,b.text).replace(f,"").replace(g,"<br />"),h}function c(a){var b=a.split(":");return a.length!==10||b.length<3?-1:parseInt(b[0],10)*3600+parseInt(b[1],10)*60+parseFloat(b[2],10)}function d(a,b){var c=a.length,d=[],e=b;for(;e<c;e++)d.push(a[e]);return d.join(",")}function e(a,b){var c={};return c[a]=b,c}function f(a){var b=a.substr(8).split(", "),c={},d,e;for(e=0,d=b.length;e<d;e++)b[e]==="Start"?c.start=e:b[e]==="End"?c.end=e:b[e]==="Text"&&(c.text=e);return c}a.parser("parseSSA",function(a){var c={title:"",remote:"",data:[]},d=/(?:\r\n|\r|\n)/gm,g=[],h,i,j=0,k;h=a.text.split(d),k=h.length;while(j<k&&h[j]!=="[Events]")j++;i=f(h[++j]);while(++j<k&&h[j]&&h[j][0]!=="[")try{g.push(e("subtitle",b(h[j],i)))}catch(l){}return c.data=g,c})}(Popcorn),function(a){a.parser("parseTTML",function(a){var b={title:"",remote:"",data:[]},c,d=0,e,f=function(a,b){if(!a)return-1;var c=a.split(":"),d=c.length-1,e,f,g;if(d>=2)return parseInt(c[0],10)*3600+parseInt(c[d-1],10)*60+parseFloat(c[d],10);for(g=a.length-1;g>=0;g--)if(a[g]<="9"&&a[g]>="0")break;g++,e=a.substr(g),b=b||0;if(e==="h")f=3600;else if(e==="m")f=60;else if(e==="s")f=1;else{if(e!=="ms")return-1;f=.001}return parseFloat(a.substr(0,g))*f+b},g=function(a,b){var c={};return c[a]=b,c},h=function(a,b){var c={};return c.text=a.textContent.replace(/^[\s]+|[\s]+$/gm,"").replace(/(?:\r\n|\r|\n)/gm,"<br />"),c.id=a.getAttribute("xml:id")||a.getAttribute("id"),c.start=f(a.getAttribute("begin"),b),c.end=f(a.getAttribute("end"),b),c.target=e,c.end<0&&(c.end=f(a.getAttribute("duration"),0),c.end>=0?c.end+=c.start:c.end=Number.MAX_VALUE),c},i=function(a,c){var e=a.firstChild,j,k;while(e)e.nodeType===1&&(e.nodeName==="p"?(j=h(e,c),b.data.push(g("subtitle",j)),d++):e.nodeName==="div"&&(k=f(e.getAttribute("begin")),k<0&&(k=c),i(e,k))),e=e.nextSibling};if(!a.xml||!a.xml.documentElement||!(c=a.xml.documentElement.firstChild))return b;while(c.nodeName!=="body")c=c.nextSibling;return e="",i(c,0),b})}(Popcorn),function(a){a.parser("parseTTXT",function(a){var b={title:"",remote:"",data:[]},c=function(a){var b=a.split(":"),c=0;try{return parseFloat(b[0],10)*60*60+parseFloat(b[1],10)*60+parseFloat(b[2],10)}catch(d){c=0}return c},d=function(a,b){var c={};return c[a]=b,c},e=a.xml.lastChild.lastChild,f=Number.MAX_VALUE,g=[];while(e){if(e.nodeType===1&&e.nodeName==="TextSample"){var h={};h.start=c(e.getAttribute("sampleTime")),h.text=e.getAttribute("text"),h.text&&(h.end=f-.001,g.push(d("subtitle",h))),f=h.start}e=e.previousSibling}return b.data=g.reverse(),b})}(Popcorn),function(a){function b(a){var b=a.split(":"),c=a.length,d;if(c!==12&&c!==9)throw"Bad cue";c=b.length-1;try{d=parseInt(b[c-1],10)*60+parseFloat(b[c],10),c===2&&(d+=parseInt(b[0],10)*3600)}catch(e){throw"Bad cue"}return d}function c(a,b){var c={};return c[a]=b,c}function d(a){var c,d,e={},f=/-->/,g=/[\t ]+/;if(!a||a.indexOf("-->")===-1)throw"Bad cue";c=a.replace(f," --> ").split(g);if(c.length<2)throw"Bad cue";return e.id=a,e.start=b(c[0]),e.end=b(c[2]),e}function e(a,b,c){while(c<b&&!a[c])c++;return c}function f(a,b,c){while(c<b&&a[c])c++;return c}a.parser("parseVTT",function(a){var b={title:"",remote:"",data:[]},g=[],h=0,i=0,j,k,l,m=/(?:\r\n|\r|\n)/gm;j=a.text.split(m),i=j.length;if(i===0||j[0]!=="WEBVTT")return b;h++;while(h<i){k=[];try{h=e(j,i,h),l=d(j[h++]);while(h<i&&j[h])k.push(j[h++]);l.text=k.join("<br />"),g.push(c("subtitle",l))}catch(n){h=f(j,i,h)}}return b.data=g,b})}(Popcorn),function(a){a.parser("parseXML","XML",function(b){var c={title:"",remote:"",data:[]},d={},e=function(a){var b=a.split(":");if(b.length===1)return parseFloat(b[0],10);if(b.length===2)return parseFloat(b[0],10)+parseFloat(b[1]/12,10);if(b.length===3)return parseInt(b[0]*60,10)+parseFloat(b[1],10)+parseFloat(b[2]/12,10);if(b.length===4)return parseInt(b[0]*3600,10)+parseInt(b[1]*60,10)+parseFloat(b[2],10)+parseFloat(b[3]/12,10)},f=function(b){var c={};for(var f=0,g=b.length;f<g;f++){var h=b.item(f).nodeName,i=b.item(f).nodeValue;h==="in"?c.start=e(i):h==="out"?c.end=e(i):h==="resourceid"?a.extend(c,d[i]):c[h]=i}return c},g=function(a,b){var c={};return c[a]=b,c},h=function(b,e,i){var j={};a.extend(j,e,f(b.attributes),{text:b.textContent});var k=b.childNodes;if(k.length<1||k.length===1&&k[0].nodeType===3)i?d[j.id]=j:c.data.push(g(b.nodeName,j));else for(var l=0;l<k.length;l++)k[l].nodeType===1&&h(k[l],j,i)},i=b.documentElement.childNodes;for(var j=0,k=i.length;j<k;j++)i[j].nodeType===1&&(i[j].nodeName==="manifest"?h(i[j],{},!0):h(i[j],{},!1));return c})}(Popcorn),function(a,b){function i(){return b.swfobject&&b.soundcloud}function j(a,c){if(a.currentStyle)return a.currentStyle[c];if(b.getComputedStyle)return document.defaultView.getComputedStyle(a,null).getPropertyValue(c)}function k(a){function b(a){function c(a,b){return a+" "+b+(a>1?"s":"")+" ago"}var b=((new Date).getTime()-a.getTime())/1e3;return b<60?c(g(b),"second"):(b/=60,b<60?c(g(b),"minute"):(b/=60,b<24?c(g(b),"hour"):(b/=24,b<30?c(g(b),"day"):b<365?c(g(b/30),"month"):c(g(b/365),"year"))))}function c(a){var b=f(a/60),c=g(a%60);return b+"."+(c<10?"0":"")+c}return'<div><a href="'+a.user.profile+'">'+'<img width="16px height="16px" src="'+a.user.avatar+'"></img>'+a.user.name+"</a> at "+c(a.start)+" "+b(a.date)+"<br />"+a.text+"</span>"}function l(a){if(!i()){setTimeout(function(){l(a)},15);return}var b={enable_api:!0,object_id:a._playerId,url:a.src,show_comments:!a._options.api.key&&!a._options.api.commentdiv},c={allowscriptaccess:"always",wmode:"transparent"},d={id:a._playerId,name:a._playerId},e=document.createElement("div");e.setAttribute("id",a._playerId),a._container.appendChild(e),swfobject.embedSWF("http://player.soundcloud.com/player.swf",a._playerId,a.offsetWidth,a.height,"9.0.0","expressInstall.swf",b,c,d)}var c=33,d=.25,e=Math.abs,f=Math.floor,g=Math.round,h={};a.soundcloud=function(b,c,d){return a.getScript("http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"),a.getScript("http://popcornjs.org/code/players/soundcloud/lib/soundcloud.player.api.js",function(){var a=1;soundcloud.addEventListener("onPlayerReady",function(a,b){var c=h[a.api_getFlashId()];c.swfObj=a,c.duration=a.api_getTrackDuration(),c.currentTime=a.api_getTrackPosition(),c.volume=c.previousVolume=a.api_getVolume()/100,c._mediaId=b.mediaId,c.dispatchEvent("load"),c.dispatchEvent("canplay"),c.dispatchEvent("durationchange"),c.timeupdate()}),soundcloud.addEventListener("onMediaStart",function(a,b){var c=h[a.api_getFlashId()];c.played=1,c.dispatchEvent("playing")}),soundcloud.addEventListener("onMediaPlay",function(b,c){if(a){a=0;return}var d=h[b.api_getFlashId()];d.dispatchEvent("play")}),soundcloud.addEventListener("onMediaPause",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("pause")}),soundcloud.addEventListener("onMediaBuffering",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("progress"),c.readyState===0&&(c.readyState=3,c.dispatchEvent("readystatechange"))}),soundcloud.addEventListener("onMediaDoneBuffering",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("canplaythrough")}),soundcloud.addEventListener("onMediaEnd",function(a,b){var c=h[a.api_getFlashId()];c.paused=1,c.dispatchEvent("ended")}),soundcloud.addEventListener("onMediaSeek",function(a,b){var c=h[a.api_getFlashId()];c.setCurrentTime(a.api_getTrackPosition()),c.paused&&c.dispatchEvent("timeupdate")}),soundcloud.addEventListener("onPlayerError",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("error")})}),new a.soundcloud.init(b,c,d)},a.soundcloud.init=function(){function b(a){var b=a._options,c=a._container,d=c.getBoundingClientRect(),e,f;a.width=b.width||j(c,"width")||"100%",a.height=b.height||j(c,"height")||"81px",a.src=b.src,a.autoplay=b.autoplay,parseFloat(a.height,10)!==81&&(a.height="81px"),a.offsetLeft=d.left,a.offsetTop=d.top,a.offsetHeight=parseFloat(a.height,10),a.offsetWidth=parseFloat(a.width,10),/[\d]+%/.test(a.width)&&(e=j(c,"width"),a._container.style.width=a.width,a.offsetWidth=a._container.offsetWidth,a._container.style.width=e),/[\d]+%/.test(a.height)&&(e=j(c,"height"),a._container.style.height=a.height,a.offsetHeight=a._container.offsetHeight,a._container.style.height=e)}var c=function(c,d,e){if(!c)throw"Must supply an id!";if(!d)throw"Must supply a source!";if(/file/.test(location.protocol))throw"Must run from a web server!";var f=this._container=document.getElementById(c);if(!f)throw"Could not find that container in the DOM!";e=e||{},e.api=e.api||{},e.target=c,e.src=d,e.api.commentformat=e.api.commentformat||k,this._mediaId=0,this._listeners={},this._playerId=a.guid(e.target),this._containerId=e.target,this._options=e,this._comments=[],this._popcorn=null,b(this),this.duration=0,this.volume=1,this.currentTime=0,this.ended=0,this.paused=1,this.readyState=0,this.playbackRate=1,this.top=0,this.left=0,this.autoplay=null,this.played=0,this.addEventListener("load",function(){var a=this.getBoundingClientRect();this.top=a.top,this.left=a.left,this.offsetWidth=this.swfObj.offsetWidth,this.offsetHeight=this.swfObj.offsetHeight,this.offsetLeft=this.swfObj.offsetLeft,this.offsetTop=this.swfObj.offsetTop}),h[this._playerId]=this,l(this)};return c}(),a.soundcloud.init.prototype=a.soundcloud.prototype,a.extend(a.soundcloud.prototype,{setVolume:function(a){if(!a&&a!==0)return;a<0&&(a=-a),a>1&&(a%=1),this.volume=this.previousVolume=a,this.swfObj.api_setVolume(a*100),this.dispatchEvent("volumechange")},setCurrentTime:function(a){if(!a&&a!==0)return;this.currentTime=this.previousCurrentTime=a,this.ended=a>=this.duration,this.dispatchEvent("seeked")},play:function(){if(!this.swfObj){this.addEventListener("load",this.play);return}if(!this.paused)return;this.paused=0,this.swfObj.api_play()},pause:function(){if(!this.swfObj){this.addEventListener("load",this.pause);return}if(this.paused)return;this.paused=1,this.swfObj.api_pause()},mute:function(){if(!this.swfObj){this.addEventListener("load",this.mute);return}this.muted()?this.paused?this.setVolume(this.oldVol):this.volume=this.oldVol:(this.oldVol=this.volume,this.paused?this.setVolume(0):this.volume=0)},muted:function(){return this.volume===0},load:function(){if(!this.swfObj){this.addEventListener("load",this.load);return}this.play(),this.pause()},addEventListener:function(a,b){return this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(b),b},dispatchEvent:function(b){var c=this,d=b.type||b;if(d==="play"&&this.paused||d==="pause"&&!this.paused){this[d]();return}a.forEach(this._listeners[d],function(a){a.call(c)})},timeupdate:function(){var a=this,b=this.swfObj.api_getVolume()/100,f=0;e(this.currentTime-this.previousCurrentTime)>d?(this.swfObj.api_seekTo(this.currentTime),f=1):this.previousCurrentTime=this.currentTime=this.swfObj.api_getTrackPosition(),b!==this.previousVolume?this.setVolume(b):this.volume!==this.previousVolume&&this.setVolume(this.volume),this.paused||this.dispatchEvent("timeupdate"),a.ended||setTimeout(function(){a.timeupdate.call(a)},c)},getBoundingClientRect:function(){var a,b=this;return this.swfObj?(a=this.swfObj.getBoundingClientRect(),{bottom:a.bottom,left:a.left,right:a.right,top:a.top,width:a.width||a.right-a.left,height:a.height||a.bottom-a.top}):(tmp=this._container.getBoundingClientRect(),{left:tmp.left,top:tmp.top,width:b.offsetWidth,height:b.offsetHeight,bottom:tmp.top+this.width,right:tmp.top+this.height})},registerPopcornWithPlayer:function(b){if(!this.swfObj){this.addEventListener("load",function(){this.registerPopcornWithPlayer(b)});return}this._popcorn=b;var c=this._options.api;if(c.key&&c.commentdiv){var d=this;a.xhr({url:"http://api.soundcloud.com/tracks/"+d._mediaId+"/comments.js?consumer_key="+c.key,success:function(b){a.forEach(b.json,function(a){d.addComment({start:a.timestamp/1e3,date:new Date(a.created_at),text:a.body,user:{name:a.user.username,profile:a.user.permalink_url,avatar:a.user.avatar_url}})})}})}}}),a.extend(a.soundcloud.prototype,{addComment:function(a,b){var c=this,d={start:a.start||0,date:a.date||new Date,text:a.text||"",user:{name:a.user.name||"",profile:a.user.profile||"",avatar:a.user.avatar||""},display:function(){return(b||c._options.api.commentformat)(d)}};this._comments.push(d);if(!this._popcorn)return;this._popcorn.subtitle({start:d.start,target:this._options.api.commentdiv,display:"inline",language:"en",text:d.display()})}})}(Popcorn,window),function(){vimeo_player_loaded=function(a){vimeo_player_loaded[a]&&vimeo_player_loaded[a]()},vimeo_player_loaded.seek={},vimeo_player_loaded.loadProgress={},vimeo_player_loaded.play={},vimeo_player_loaded.pause={},Popcorn.player("vimeo",{_setup:function(a){var b=this,c,d=document.createElement("div"),e=0,f=0,g=!1,h=!1,i=!1,j=0,k,l;d.id=b.id+Popcorn.guid(),b.appendChild(d),l=b.style.width?""+b.offsetWidth:"100%",k=b.style.height?""+b.offsetHeight:"100%";var m=function(){function r(a){if(!a)return;var b=/^http:\/\/player\.vimeo\.com\/video\/[\d]+/i,c=/vimeo\.com\/[\d]+/,d=a.match(b)?a.match(b)[0].substr(30):"";return d?d:a.match(c)?a.match(c)[0].substr(10):""}var h,m,n={},o=b.src,p=0,q=!1;vimeo_player_loaded[d.id]=function(){c=document.getElementById(d.id),vimeo_player_loaded.seek[d.id]=function(a){a!==e&&(e=a,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"))},vimeo_player_loaded.play[d.id]=function(){b.paused&&(b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),a())},vimeo_player_loaded.pause[d.id]=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"))},vimeo_player_loaded.loadProgress[d.id]=function(a){q||(q=!0,b.dispatchEvent("loadstart")),a.percent===100&&b.dispatchEvent("canplaythrough")},c.api_addEventListener("seek","vimeo_player_loaded.seek."+d.id),c.api_addEventListener("loadProgress","vimeo_player_loaded.loadProgress."+d.id),c.api_addEventListener("play","vimeo_player_loaded.play."+d.id),c.api_addEventListener("pause","vimeo_player_loaded.pause."+d.id);var a=function(){b.paused||(e=c.api_getCurrentTime(),b.dispatchEvent("timeupdate"),setTimeout(a,10))},h=function(){return c.api_getVolume()===0},k=function(){var a=h(),d=c.api_getVolume();i!==a&&(i=a,b.dispatchEvent("volumechange")),j!==d&&(j=d,b.dispatchEvent("volumechange")),setTimeout(k,250)};b.play=function(){b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),a(),c.api_play()},b.pause=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"),c.api_pause())},Popcorn.player.defineProperty(b,"currentTime",{set:function(a){return a?(e=f=+a,g=!0,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"),c.api_seekTo(e),e):e},get:function(){return e}}),Popcorn.player.defineProperty(b,"muted",{set:function(a){h()!==a&&(a?(p=c.api_getVolume(),c.api_setVolume(0)):c.api_setVolume(p))},get:function(){return h()}}),Popcorn.player.defineProperty(b,"volume",{set:function(a){return!a||typeof a!="number"||a<0||a>1?c.api_getVolume()/100:(c.api_getVolume()!==a&&(c.api_setVolume(a*100),j=c.api_getVolume(),b.dispatchEvent("volumechange")),c.api_getVolume()/100)},get:function(){return c.api_getVolume()/100}}),b.readyState=4,b.dispatchEvent("canplaythrough"),b.dispatchEvent("load"),b.duration=c.api_getDuration(),b.dispatchEvent("durationchange"),k(),b.dispatchEvent("loadeddata")};if(!(o=r(o)))throw"Invalid Video Id";h={clip_id:o,js_api:1,js_swf_id:d.id},Popcorn.extend(h,a),m={allowscriptaccess:"always",allowfullscreen:"true",wmode:"transparent"},swfobject.embedSWF("//vimeo.com/moogaloop.swf",d.id,l,k,"9.0.0","expressInstall.swf",h,m,n)};window.swfobject?m():Popcorn.getScript("//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",m)}})}(),onYouTubePlayerReady=function(a){console.log(a),onYouTubePlayerReady[a]&&onYouTubePlayerReady[a]()},stateChangeEventHandler=new Array,onErrorEventHandler=new Array,Popcorn.player("youtube",{_setup:function(a){var b=this,c,d=document.createElement("div"),e=0,f=0,g=!1,h=!1,i=!1,j=!1,k=0;d.id=b.id+Popcorn.guid(),youtubeId=Popcorn.guid(),b.youtubeId=Popcorn.guid(),b.appendChild(d),b.canPlay=0;var l=function(){var c,i,l,m,n,o,p;canPlay=0,onYouTubePlayerReady[d.id]=function(){b.youtubeObject=document.getElementById(d.id),stateChangeEventHandler[b.youtubeId]=function(c){if(c===1&&b.canPlay==0)b.canPlay=1,b.pause(),b.readyState=4,b.duration=b.youtubeObject.getDuration(),b.dispatchEvent("canplaythrough"),b.dispatchEvent("load"),b.dispatchEvent("durationchange"),b.dispatchEvent("loadeddata");else if(c===1)b.paused&&b.play();else if(c===2){if(g&&f===e&&Math.abs(parseFloat(f)-parseFloat(b.youtubeObject.getCurrentTime()))>2){b.youtubeObject.seekTo(e);return}if(g&&f===e&&Math.abs(parseFloat(f)-parseFloat(b.youtubeObject.getCurrentTime()))<2){g=!1,h=!0,e=b.youtubeObject.getCurrentTime(),b.dispatchEvent("timeupdate"),!b.paused&&b.pause();return}if(h){h=!1;return}e=b.youtubeObject.getCurrentTime(),b.dispatchEvent("timeupdate"),!b.paused&&b.pause(),console.log("setting the volume"),console.log(a.volume),b.youtubeObject.setVolume(a.volume)}},stateChangeEventHandler[Popcorn.guid()]=function(a){[2,100,101,150].indexOf(a)!==-1&&b.dispatchEvent("error")},b.youtubeObject.addEventListener("onStateChange","stateChangeEventHandler["+b.youtubeId+"]"),b.youtubeObject.addEventListener("onError","onErrorEventHandler["+b.youtubeId+"]");var c=function(){b.paused||(e=b.youtubeObject.getCurrentTime(),b.dispatchEvent("timeupdate"),setTimeout(c,10))},i=function(){b&&b.youtubeObject&&b.youtubeObject.isMuted()&&(j!==b.youtubeObject.isMuted()&&(j=b.youtubeObject.isMuted(),b.dispatchEvent("volumechange")),k!==b.youtubeObject.getVolume()&&(k=b.youtubeObject.getVolume(),b.dispatchEvent("volumechange")),setTimeout(i,250))};b.play=function(){b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),c(),b.youtubeObject.playVideo()},b.pause=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"),b.youtubeObject.pauseVideo())},Popcorn.player.defineProperty(b,"currentTime",{set:function(c){return c!=0||a.cue_in==0?(e=f=+c,g=!0,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"),b.youtubeObject.seekTo(e)):c==0&&a.cue_in==0&&b.dispatchEvent("timeupdate"),e},get:function(){return e}}),Popcorn.player.defineProperty(b,"muted",{set:function(a){return b.youtubeObject.isMuted()!==a&&(a?b.youtubeObject.mute():b.youtubeObject.unMute(),j=b.youtubeObject.isMuted(),b.dispatchEvent("volumechange")),b.youtubeObject.isMuted()},get:function(){return b.youtubeObject.isMuted()}}),Popcorn.player.defineProperty(b,"volume",{set:function(a){return console.log(b.youtubeObject.getVolume()),console.log(a),b.youtubeObject.getVolume()/100!==a&&(b.youtubeObject.setVolume(a*100),console.log(a*100),k=b.youtubeObject.getVolume(),b.dispatchEvent("volumechange")),b.youtubeObject.getVolume()/100},get:function(){return b.youtubeObject.getVolume()/100}}),b.youtubeObject.loadVideoById(m,a.cue_in)},a.controls=+a.controls===0||+a.controls===1?a.controls:1,a.annotations=+a.annotations===1||+a.annotations===3?a.annotations:1,a.cue_in=a.cue_in||0,a.volume=a.volume||1,c={playerapiid:d.id},i={wmode:"opaque",disablekb:"1",allowScriptAccess:"always"},l={id:d.id},m=/^.*(?:\/|v=)(.{11})/.exec(b.src)[1],p=(b.src.split("?")[1]||"").replace(/v=.{11}/,""),n=b.style.width?""+b.offsetWidth:"560",o=b.style.height?""+b.offsetHeight:"315",console.log(youtubeId),swfobject.embedSWF("http://www.youtube.com/apiplayer?enablejsapi=1&version=3&key=AI39si7oX_eCGjrxs2lil28MMQdXn-ZWhzku8fGsRVhju-pziYgmI3EOt0o4GmEl00vGXsA_OGGEKwX-xAM0a5Gbsr8zgrGpyg&playerapiid="+d.id,d.id,"100%","100%","8",null,c,i,l),console.log(d.id)};window.swfobject?l():Popcorn.getScript("//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",l)}});var onPlayerLoaded=function(a){onPlayerLoaded[a]&&onPlayerLoaded[a]()},onLoading=function(a,b){onLoading[a]&&onLoading[a](b)},onStateChange=function(a,b,c){onStateChange[a]&&onStateChange[a](b,c)},onError=function(a,b){onError[a]&&onError[a](b)};Popcorn.player("flashvideo",{_setup:function(a){var b=this,c,d=document.createElement("div"),e=0,f=0,g=!1,h=!1,i=!1,j=100;d.id=b.id+Popcorn.guid(),b.appendChild(d);var k=function(){var a,h,i,j,k,l,m;onPlayerLoaded[d.id]=function(){console.log("player "+d.id+" has loaded"),c=document.getElementById(d.id),onLoading[d.id]=function(a){if(a==2)b.duration=c.sendToFlash("getEndTime","");else if(a==3){var d=function(){b.paused||(e=c.sendToFlash("getCurrentTime",""),b.dispatchEvent("timeupdate"),setTimeout(d,10))};d(),b.play=function(){b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),d(),c.sendToFlash("play","")},b.pause=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"),c.sendToFlash("pause",""))},Popcorn.player.defineProperty(b,"currentTime",{set:function(a){return e=f=+a,g=!0,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"),c.sendToFlash("seek",e),e},get:function(){return e}}),b.readyState=4,b.dispatchEvent("canplaythrough"),b.dispatchEvent("load"),b.duration=c.sendToFlash("getEndTime",""),b.dispatchEvent("durationchange"),b.dispatchEvent("loadeddata")}},onError[d.id]=function(a,b){switch(b){case 1:console.log("onError - failed to load file");break;case 2:console.log("onError - wrong url or invalid file")}};var a="onLoading."+d.id;console.log("player "+d.id+" has loaded"),c.sendToFlash("load",j+",0")},a={vidId:d.id},h={wmode:"transparent",allowScriptAccess:"always",allownetworking:"all",bgcolor:"#000000"},i={id:d.id},j=/(http.*)/.exec(b.src)[1],swfobject.embedSWF("MediaPlayer.swf",d.id,"100%","100%","9.0.0",!1,a,h,i)};window.swfobject?k():Popcorn.getScript("//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",k)}}),function(a){var b=function(b,c){var d=0,e=0,f;a.forEach(c.classes,function(a,b){f=[],a==="parent"?f[0]=document.querySelectorAll("#"+c.target)[0].parentNode:f=document.querySelectorAll("#"+c.target+" "+a);for(d=0,e=f.length;d<e;d++)f[d].classList.toggle(b)})};a.compose("applyclass",{manifest:{about:{name:"Popcorn applyclass Effect",version:"0.1",author:"@scottdowne",website:"scottdowne.wordpress.com"},options:{}},_setup:function(a){a.classes={},a.applyclass=a.applyclass||"";var b=a.applyclass.replace(/\s/g,"").split(","),c=[],d=0,e=b.length;for(;d<e;d++)c=b[d].split(":"),c[0]&&(a.classes[c[0]]=c[1]||"")},start:b,end:b})}(Popcorn),define("web/js/lib/popcorn_flash.js",function(){}),!function(a){a(function(){a.support.transition=function(){var a=function(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},c;for(c in b)if(a.style[c]!==undefined)return b[c]}();return a&&{end:a}}()})}(window.jQuery),!function(a){var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function f(){e.trigger("closed").remove()}var c=a(this),d=c.attr("data-target"),e;d||(d=c.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),e=a(d),b&&b.preventDefault(),e.length||(e=c.hasClass("alert")?c:c.parent()),e.trigger(b=a.Event("close"));if(b.isDefaultPrevented())return;e.removeClass("in"),a.support.transition&&e.hasClass("fade")?e.on(a.support.transition.end,f):f()},a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("alert");e||d.data("alert",e=new c(this)),typeof b=="string"&&e[b].call(d)})},a.fn.alert.Constructor=c,a(function(){a("body").on("click.alert.data-api",b,c.prototype.close)})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.button.defaults,c)};b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.data(),e=c.is("input")?"val":"html";a+="Text",d.resetText||c.data("resetText",c[e]()),c[e](d[a]||this.options[a]),setTimeout(function(){a=="loadingText"?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.parent('[data-toggle="buttons-radio"]');a&&a.find(".active").removeClass("active"),this.$element.toggleClass("active")},a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("button"),f=typeof c=="object"&&c;e||d.data("button",e=new b(this,f)),c=="toggle"?e.toggle():c&&e.setState(c)})},a.fn.button.defaults={loadingText:"loading..."},a.fn.button.Constructor=b,a(function(){a("body").on("click.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle")})})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=c,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.prototype={cycle:function(b){return b||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},to:function(b){var c=this.$element.find(".active"),d=c.parent().children(),e=d.index(c),f=this;if(b>d.length-1||b<0)return;return this.sliding?this.$element.one("slid",function(){f.to(b)}):e==b?this.pause().cycle():this.slide(b>e?"next":"prev",a(d[b]))},pause:function(a){return a||(this.paused=!0),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(b,c){var d=this.$element.find(".active"),e=c||d[b](),f=this.interval,g=b=="next"?"left":"right",h=b=="next"?"first":"last",i=this,j=a.Event("slide");this.sliding=!0,f&&this.pause(),e=e.length?e:this.$element.find(".item")[h]();if(e.hasClass("active"))return;if(a.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(j);if(j.isDefaultPrevented())return;e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),this.$element.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid")},0)})}else{this.$element.trigger(j);if(j.isDefaultPrevented())return;d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return f&&this.cycle(),this}},a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("carousel"),f=a.extend({},a.fn.carousel.defaults,typeof c=="object"&&c);e||d.data("carousel",e=new b(this,f)),typeof c=="number"?e.to(c):typeof c=="string"||(c=f.slide)?e[c]():f.interval&&e.cycle()})},a.fn.carousel.defaults={interval:5e3,pause:"hover"},a.fn.carousel.Constructor=b,a(function(){a("body").on("click.carousel.data-api","[data-slide]",function(b){var c=a(this),d,e=a(c.attr("data-target")||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=!e.data("modal")&&a.extend({},e.data(),c.data());e.carousel(f),b.preventDefault()})})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.collapse.defaults,c),this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var a=this.$element.hasClass("width");return a?"width":"height"},show:function(){var b,c,d,e;if(this.transitioning)return;b=this.dimension(),c=a.camelCase(["scroll",b].join("-")),d=this.$parent&&this.$parent.find("> .accordion-group > .in");if(d&&d.length){e=d.data("collapse");if(e&&e.transitioning)return;d.collapse("hide"),e||d.data("collapse",null)}this.$element[b](0),this.transition("addClass",a.Event("show"),"shown"),this.$element[b](this.$element[0][c])},hide:function(){var b;if(this.transitioning)return;b=this.dimension(),this.reset(this.$element[b]()),this.transition("removeClass",a.Event("hide"),"hidden"),this.$element[b](0)},reset:function(a){var b=this.dimension();return this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth,this.$element[a!==null?"addClass":"removeClass"]("collapse"),this},transition:function(b,c,d){var e=this,f=function(){c=="show"&&e.reset(),e.transitioning=0,e.$element.trigger(d)};this.$element.trigger(c);if(c.isDefaultPrevented())return;this.transitioning=1,this.$element[b]("in"),a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,f):f()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("collapse"),f=typeof c=="object"&&c;e||d.data("collapse",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.collapse.defaults={toggle:!0},a.fn.collapse.Constructor=b,a(function(){a("body").on("click.collapse.data-api","[data-toggle=collapse]",function(b){var c=a(this),d,e=c.attr("data-target")||b.preventDefault()||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),f=a(e).data("collapse")?"toggle":c.data();a(e).collapse(f)})})}(window.jQuery),!function(a){function d(){a(b).parent().removeClass("open")}var b='[data-toggle="dropdown"]',c=function(b){var c=a(b).on("click.dropdown.data-api",this.toggle);a("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};c.prototype={constructor:c,toggle:function(b){var c=a(this),e,f,g;if(c.is(".disabled, :disabled"))return;return f=c.attr("data-target"),f||(f=c.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),e=a(f),e.length||(e=c.parent()),g=e.hasClass("open"),d(),g||e.toggleClass("open"),!1}},a.fn.dropdown=function(b){return this.each(function(){var d=a(this),e=d.data("dropdown");e||d.data("dropdown",e=new c(this)),typeof b=="string"&&e[b].call(d)})},a.fn.dropdown.Constructor=c,a(function(){a("html").on("click.dropdown.data-api",d),a("body").on("click.dropdown",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown.data-api",b,c.prototype.toggle)})}(window.jQuery),!function(a){function c(){var b=this,c=setTimeout(function(){b.$element.off(a.support.transition.end),d.call(b)},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c),d.call(b)})}function d(a){this.$element.hide().trigger("hidden"),e.call(this)}function e(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(a.proxy(this.hide,this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),e?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,a.proxy(f,this)):f.call(this)):b&&b()}function f(){this.$backdrop.remove(),this.$backdrop=null}function g(){var b=this;this.isShown&&this.options.keyboard?a(document).on("keyup.dismiss.modal",function(a){a.which==27&&b.hide()}):this.isShown||a(document).off("keyup.dismiss.modal")}var b=function(b,c){this.options=c,this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this))};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this,c=a.Event("show");this.$element.trigger(c);if(this.isShown||c.isDefaultPrevented())return;a("body").addClass("modal-open"),this.isShown=!0,g.call(this),e.call(this,function(){var c=a.support.transition&&b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in"),c?b.$element.one(a.support.transition.end,function(){b.$element.trigger("shown")}):b.$element.trigger("shown")})},hide:function(b){b&&b.preventDefault();var e=this;b=a.Event("hide"),this.$element.trigger(b);if(!this.isShown||b.isDefaultPrevented())return;this.isShown=!1,a("body").removeClass("modal-open"),g.call(this),this.$element.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?c.call(this):d.call(this)}},a.fn.modal=function(c){return this.each(function(){var d=a(this),e=d.data("modal"),f=a.extend({},a.fn.modal.defaults,d.data(),typeof c=="object"&&c);e||d.data("modal",e=new b(this,f)),typeof c=="string"?e[c]():f.show&&e.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},a.fn.modal.Constructor=b,a(function(){a("body").on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d,e=a(c.attr("data-target")||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({},e.data(),c.data());b.preventDefault(),e.modal(f)})})}(window.jQuery),!function(a){var b=function(a,b){this.init("tooltip",a,b)};b.prototype={constructor:b,init:function(b,c,d){var e,f;this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,this.options.trigger!="manual"&&(e=this.options.trigger=="hover"?"mouseenter":"focus",f=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(e,this.options.selector,a.proxy(this.enter,this)),this.$element.on(f,this.options.selector,a.proxy(this.leave,this))),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b.delay&&typeof b.delay=="number"&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show)return c.show();clearTimeout(this.timeout),c.hoverState="in",this.timeout=setTimeout(function(){c.hoverState=="in"&&c.show()},c.options.delay.show)},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.hide)return c.hide();clearTimeout(this.timeout),c.hoverState="out",this.timeout=setTimeout(function(){c.hoverState=="out"&&c.hide()},c.options.delay.hide)},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){a=this.tip(),this.setContent(),this.options.animation&&a.addClass("fade"),f=typeof this.options.placement=="function"?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/in/.test(f),a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight;switch(b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g).addClass(f).addClass("in")}},isHTML:function(a){return typeof a!="string"||a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(a)},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.isHTML(b)?"html":"text"](b),a.removeClass("fade in top bottom left right")},hide:function(){function d(){var b=setTimeout(function(){c.off(a.support.transition.end).remove()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.remove()})}var b=this,c=this.tip();c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d():c.remove()},fixTitle:function(){var a=this.$element;(a.attr("title")||typeof a.attr("data-original-title")!="string")&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||(typeof c.title=="function"?c.title.call(b[0]):c.title),a},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("tooltip"),f=typeof c=="object"&&c;e||d.data("tooltip",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery),!function(a){var b=function(a,b){this.init("popover",a,b)};b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.isHTML(b)?"html":"text"](b),a.find(".popover-content > *")[this.isHTML(c)?"html":"text"](c),a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-content")||(typeof c.content=="function"?c.content.call(b[0]):c.content),a},tip:function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip}}),a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("popover"),f=typeof c=="object"&&c;e||d.data("popover",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.defaults=a.extend({},a.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(a){function b(b,c){var d=a.proxy(this.process,this),e=a(b).is("body")?a(window):a(b),f;this.options=a.extend({},a.fn.scrollspy.defaults,c),this.$scrollElement=e.on("scroll.scroll.data-api",d),this.selector=(this.options.target||(f=a(b).attr("href"))&&f.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=a("body").on("click.scroll.data-api",this.selector,d),this.refresh(),this.process()}b.prototype={constructor:b,refresh:function(){var b=this,c;this.offsets=a([]),this.targets=a([]),c=this.$body.find(this.selector).map(function(){var b=a(this),c=b.data("target")||b.attr("href"),d=/^#\w/.test(c)&&a(c);return d&&c.length&&[[d.position().top,c]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},process:function(){var a=this.$scrollElement.scrollTop()+this.options.offset,b=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,c=b-this.$scrollElement.height(),d=this.offsets,e=this.targets,f=this.activeTarget,g;if(a>=c)return f!=(g=e.last()[0])&&this.activate(g);for(g=d.length;g--;)f!=e[g]&&a>=d[g]&&(!d[g+1]||a<=d[g+1])&&this.activate(e[g])},activate:function(b){var c,d;this.activeTarget=b,a(this.selector).parent(".active").removeClass("active"),d=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',c=a(d).parent("li").addClass("active"),c.parent(".dropdown-menu")&&(c=c.closest("li.dropdown").addClass("active")),c.trigger("activate")}},a.fn.scrollspy=function(c){return this.each(function(){var d=a(this),e=d.data("scrollspy"),f=typeof c=="object"&&c;e||d.data("scrollspy",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.scrollspy.Constructor=b,a.fn.scrollspy.defaults={offset:10},a(function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})})}(window.jQuery),!function(a){var b=function(b){this.element=a(b)};b.prototype={constructor:b,show:function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.attr("data-target"),e,f,g;d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,""));if(b.parent("li").hasClass("active"))return;e=c.find(".active a").last()[0],g=a.Event("show",{relatedTarget:e}),b.trigger(g);if(g.isDefaultPrevented())return;f=a(d),this.activate(b.parent("li"),c),this.activate(f,f.parent(),function(){b.trigger({type:"shown",relatedTarget:e})})},activate:function(b,c,d){function g(){e.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),f?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var e=c.find("> .active"),f=d&&a.support.transition&&e.hasClass("fade");f?e.one(a.support.transition.end,g):g(),e.removeClass("in")}},a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("tab");e||d.data("tab",e=new b(this)),typeof c=="string"&&e[c]()})},a.fn.tab.Constructor=b,a(function(){a("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")})})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.typeahead.defaults,c),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=a(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};b.prototype={constructor:b,select:function(){var a=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(a)).change(),this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:b.top+b.height,left:b.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(b){var c=this,d,e;return this.query=this.$element.val(),this.query?(d=a.grep(this.source,function(a){return c.matcher(a)}),d=this.sorter(d),d.length?this.render(d.slice(0,this.options.items)).show():this.shown?this.hide():this):this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){var b=[],c=[],d=[],e;while(e=a.shift())e.toLowerCase().indexOf(this.query.toLowerCase())?~e.indexOf(this.query)?c.push(e):d.push(e):b.push(e);return b.concat(c,d)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c=this;return b=a(b).map(function(b,d){return b=a(c.options.item).attr("data-value",d),b.find("a").html(c.highlighter(d)),b[0]}),b.first().addClass("active"),this.$menu.html(b),this},next:function(b){var c=this.$menu.find(".active").removeClass("active"),d=c.next();d.length||(d=a(this.$menu.find("li")[0])),d.addClass("active")},prev:function(a){var b=this.$menu.find(".active").removeClass("active"),c=b.prev();c.length||(c=this.$menu.find("li").last()),c.addClass("active")},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),(a.browser.webkit||a.browser.msie)&&this.$element.on("keydown",a.proxy(this.keypress,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this))},keyup:function(a){switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation(),a.preventDefault()},keypress:function(a){if(!this.shown)return;switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:if(a.type!="keydown")break;a.preventDefault(),this.prev();break;case 40:if(a.type!="keydown")break;a.preventDefault(),this.next()}a.stopPropagation()},blur:function(a){var b=this;setTimeout(function(){b.hide()},150)},click:function(a){a.stopPropagation(),a.preventDefault(),this.select()},mouseenter:function(b){this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")}},a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f=typeof c=="object"&&c;e||d.data("typeahead",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'},a.fn.typeahead.Constructor=b,a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var c=a(this);if(c.data("typeahead"))return;b.preventDefault(),c.typeahead(c.data())})})}(window.jQuery),define("web/js/lib/bootstrap.js",function(){}),function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function g(){!a&&this.init&&this.init.apply(this,arguments)}var d=this.prototype;a=!0;var e=new this;a=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);return this._super=c,e}}(f,c[f]):c[f];return g.prototype=e,g.prototype.constructor=g,g.extend=arguments.callee,g}}();var Plyr2=Backbone.Model.extend({defaults:{id:0,uri:"http://www.youtube.com/watch?v=dQw4w9WgXcQ&ob=av3e",control_mode:"standard",autoplay:!0,cue_in:0,cue_out:150,volume:.5,video_target:null,controls_target:null},initialize:function(a){this.set(a),console.log(this),this.set("format",this.getFormat(this.get("url")))},getFormat:function(a){var b="";return a.match(/^http:\/\/(?:www\.)?youtube.com\/watch\?(?=.*v=\w+)(?:\S+)?$/)?b="youtube":a.match(/^http:\/\/(?:www\.)?vimeo.com\/(.*)/)?b="vimeo":b="html5",navigator.userAgent.split(" ")[navigator.userAgent.split(" ").length-1].split("/")[0]=="Firefox"&&b=="html5"&&(b="flashvideo"),b},placeVideo:function(a){if(!this.isVideoLoaded){var b=this;a.empty().prepend(this.getVideoView().el);switch(this.get("format")){case"html5":this.pop=Popcorn("#zvideo-"+this.id),this.pop.listen("canplay",function(){b.get("cue_in")!=0?(b.pop.listen("seeked",function(){b.trigger("video_canPlay")}),b.pop.currentTime(b.get("cue_in")),console.log("seeking to: "+b.get("cue_in"))):b.trigger("video_canPlay"),b.pop.volume(b.get("volume"))});break;case"flashvideo":this.pop=Popcorn.flashvideo("#zvideo-"+this.id,this.get("uri")),this.pop.listen("loadeddata",function(){b.pop.volume(b.get("volume")),b.trigger("video_canPlay"),b.pop.currentTime(b.get("cue_in"))});break;case"youtube":console.log(b.get("volume")),this.pop=Popcorn.youtube("#zvideo-"+this.id,this.get("url"),{volume:this.get("volume"),cue_in:this.get("cue_in")}),this.pop.listen("canplaythrough",function(){console.log(b.get("volume")),b.pop.play(),b.pop.pause(),b.pop.volume(b.get("volume")),console.log(b.get("control_mode")),b.trigger("video_canPlay")});break;case"vimeo":this.pop=Popcorn.vimeo("#zvideo-"+this.id,this.get("url")),this.pop.listen("loadeddata",function(){b.trigger("video_canPlay"),b.pop.currentTime(b.get("cue_in"))});break;default:console.log("none set")}this.pop.listen("timeupdate",function(){b.trigger("timeupdate"),b.trigger("timeupdate_controls")}),this.isVideoLoaded=!0}},getVideoView:function(){var a=Backbone.View.extend({className:"plyr-video",initialize:function(){this.render()},render:function(){return this.model.get("format")=="html5"&&(this.el=$('<video class="'+this.className+'">')),this.model.get("format")=="html5"?$(this.el).attr({id:"zvideo-"+this.model.id,src:this.model.get("uri")}):$(this.el).attr("id","zvideo-"+this.model.id),$(this.el).css("position","absolute"),this}});return new a({model:this})},destroy:function(){this.isVideoLoaded=!1,this.pop.pause(),Popcorn.destroy(this.pop)},currentTime:function(){return this.pop.currentTime()},play:function(){this.pop&&this.pop.paused()&&this.pop.play()},pause:function(){this.pop&&!this.pop.paused()&&this.pop.pause()}}),Plyr=Class.extend({init:function(a,b){this.id=a,this.url=b.url,this.format=b.format,this.wrapper=$("#"+this.id),this.seeking=!1,"controls"in b?this.controls=b.controls:this.controls=1,"controlsType"in b?this.controlsType=b.controlsType:this.controlsType="standard","controlsId"in b?this.controlsWrapper=$("#"+b.controlsId):this.controlsWrapper=this.wrapper,"cueIn"in b?this.cueIn=b.cueIn:this.cueIn=50,"cueOut"in b?this.cueOut=b.cueOut:this.cueOut=150,"volume"in b?this.volume=b.volume:this.volume=1,this.controls==1&&(this.controlsType=="standard"?this.controlsWrapper.append($("<div>").attr("id","plyr-standard").append($("<div>").addClass("plyr-controls-wrapper").addClass("plyr-controls-wrapper").append($("<div>").addClass("plyr-controls").append($("<div>").addClass("plyr-button-wrapper").append($("<div>").addClass("plyr-button").addClass("plyr-play"))).append($("<div>").addClass("plyr-time")).append($("<div>").addClass("plyr-timeline").append($("<div>").addClass("plyr-scrubber")))))):this.controlsType=="editor"&&this.controlsWrapper.append($("<div>").attr({id:"plyr-editor"}).append($("<div>").addClass("plyr-controls-wrapper").append($("<div>").addClass("plyr-time-wrapper").append($("<div>").addClass("plyr-cuein-time")).append($("<div>").addClass("plyr-cueout-time"))).append($("<div>").addClass("plyr-timeline-wrapper").append($("<div>").addClass("plyr-button-wrapper").append($("<div>").addClass("plyr-button").addClass("plyr-play"))).append($("<div>").addClass("plyr-timeline").append($("<div>").addClass("plyr-cuein-bar").addClass("plyr-bar")).append($("<div>").addClass("plyr-time-bar").addClass("plyr-bar")).append($("<div>").addClass("plyr-cueout-bar").addClass("plyr-bar")).append($("<div>").addClass("plyr-cuein-scrubber").addClass("plyr-edit-scrubber").append($("<div>").addClass("plyr-scrubber-select")).append($("<div>").addClass("plyr-arrow-down-green"))).append($("<div>").addClass("plyr-scrubber").addClass("plyr-edit-scrubber").append($("<div>").addClass("plyr-hanging-box"))).append($("<div>").addClass("plyr-cueout-scrubber").addClass("plyr-edit-scrubber").append($("<div>").addClass("plyr-scrubber-select")).append($("<div>").addClass("plyr-arrow-down"))))).append($("<div>").addClass("plyr-time-wrapper").append($("<span>").addClass("plyr-time"))).append($("<div>").attr({id:"plyr-volume"})))));var c=this;this.url.match(/^http:\/\/(?:www\.)?youtube.com\/watch\?(?=.*v=\w+)(?:\S+)?$/)?this.format="youtube":this.url.match(/^http:\/\/(?:www\.)?vimeo.com\/(.*)/)?this.format="vimeo":this.format="html5",navigator.userAgent.split(" ")[navigator.userAgent.split(" ").length-1].split("/")[0]=="Firefox"&&this.format=="html5"&&(this.format="flashvideo");var c=this;this.displayControls=function(){this.cueOut==0&&(c.cueOut=c.pop.duration()),c.controlsWrapper.find(".plyr-cuein-scrubber").css({left:parseFloat(this.cueIn)*c.controlsWrapper.find(".plyr-timeline").width()/c.pop.duration()}),c.controlsWrapper.find(".plyr-cuein-bar").css({width:c.controlsWrapper.find(".plyr-cuein-scrubber").css("left")}),c.controlsWrapper.find(".plyr-cueout-scrubber").css({left:parseFloat(this.cueOut)*c.controlsWrapper.find(".plyr-timeline").width()/c.pop.duration()}),c.controlsWrapper.find(".plyr-cueout-bar").css({width:parseInt(c.controlsWrapper.find(".plyr-timeline").width())-parseInt(c.controlsWrapper.find(".plyr-cueout-scrubber").css("left"))}),c.controlsWrapper.find(".plyr-cuein-time").html(convertTime(c.cueIn,!0)),c.controlsWrapper.find(".plyr-cueout-time").html(convertTime(c.cueOut,!0)),c.controlsWrapper.find(".plyr-controls-wrapper").fadeIn()};switch(this.format){case"html5":this.wrapper.prepend($("<video>").addClass("plyr-video").attr({src:this.url,id:"z-"+this.id})),this.pop=Popcorn("#z-"+this.id),this.pop.listen("canplay",function(){c.controls==1&&c.displayControls()});break;case"flashvideo":this.wrapper.prepend($("<div>").addClass("plyr-video").attr({id:"z-"+this.id})),this.pop=Popcorn.flashvideo("#z-"+this.id,this.url),this.pop.listen("loadeddata",function(){c.controls==1&&c.displayControls()});break;case"youtube":this.wrapper.prepend($("<div>").addClass("plyr-video").attr({id:"z-"+this.id})),this.pop=Popcorn.youtube("#z-"+this.id,this.url),this.pop.listen("canplaythrough",function(){c.pop.play(),c.pop.pause(),c.controls==1&&c.displayControls()});break;case"vimeo":this.wrapper.prepend($("<div>").addClass("plyr-video").attr({id:"z-"+this.id})),this.pop=Popcorn.vimeo("#z-"+this.id,this.url),this.pop.listen("loadeddata",function(){c.controls==1&&c.displayControls()});break;default:console.log("none set")}this.controlsWrapper.find(".plyr-button").click(function(){c.pop.volume(parseInt(c.volume)),c.pop.paused()?c.pop.play():c.pop.pause()}),this.controlsType=="standard"?this.controlsWrapper.find(".plyr-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){var d=Math.floor(parseFloat(c.controlsWrapper.find(".plyr-scrubber").css("left"))*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));c.pop.trigger("timeupdate"),c.pop.currentTime(d)},start:function(){c.pop.pause()},drag:function(a,b){var d=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));c.controlsWrapper.find(".plyr-time").html(convertTime(d)+" / "+convertTime(c.pop.duration()))}}):this.controlsType=="editor"&&(this.controlsWrapper.find(".plyr-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){var d=Math.floor(parseFloat(c.controlsWrapper.find(".plyr-scrubber").css("left"))*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));d<c.cueIn?d=c.cueIn:d>c.cueOut&&(d=Math.max(parseFloat(c.cueIn),parseFloat(c.cueOut)-5)),c.pop.trigger("timeupdate"),c.pop.currentTime(d)},start:function(){c.pop.pause()},drag:function(a,b){var d=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));c.controlsWrapper.find(".plyr-time").html(convertTime(d)+" / "+convertTime(c.pop.duration()))}}),this.controlsWrapper.find(".plyr-cuein-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){c.controlsWrapper.find(".plyr-cuein-bar").css({width:c.controlsWrapper.find(".plyr-cuein-scrubber").css("left")}),c.pop.currentTime(Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width())));var d=parseFloat(c.pop.currentTime())/parseFloat(c.pop.duration())*100;c.controlsWrapper.find(".plyr-scrubber").css({left:d+"%"}),c.controlsWrapper.find(".plyr-time").html(convertTime(c.pop.currentTime())+" / "+convertTime(c.pop.duration())),c.controlsWrapper.find(".plyr-time-bar").css({width:d+"%"})},drag:function(a,b){c.cueIn=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width())),c.controlsWrapper.find(".plyr-cuein-time").html(convertTime(c.cueIn,!0))}}),this.controlsWrapper.find(".plyr-cueout-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){c.controlsWrapper.find(".plyr-cueout-bar").css({width:parseInt(c.controlsWrapper.find(".plyr-timeline").width())-parseInt(c.controlsWrapper.find(".plyr-cueout-scrubber").css("left"))}),c.pop.currentTime(Math.max(parseFloat(c.cueIn),parseFloat(c.cueOut)-5))},start:function(){c.pop.pause()},drag:function(a,b){c.cueOut=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width())),c.controlsWrapper.find(".plyr-cueout-time").html(convertTime(c.cueOut,!0))}})),this.controlsWrapper.find("#plyr-volume").slider({min:0,max:1,value:c.volume,step:.1,slide:function(a,b){c.volume=b.value,c.pop.volume(c.volume)},stop:function(a,b){}}),this.pop.listen("loadedmetadata",function(){c.controlsWrapper.find(".plyr-time").html(convertTime(c.pop.currentTime())+" / "+convertTime(c.pop.duration()))}),this.pop.listen("timeupdate",function(){c.pop.currentTime()>c.cueOut&&(c.pop.pause(),c.pop.currentTime(c.cueIn));var a=parseFloat(c.pop.currentTime())/parseFloat(c.pop.duration())*100;c.controlsWrapper.find(".plyr-scrubber").css({left:a+"%"}),c.controlsWrapper.find(".plyr-time").html(convertTime(c.pop.currentTime())+" / "+convertTime(c.pop.duration())),c.controlsWrapper.find(".plyr-time-bar").css({width:a+"%"})}),this.pop.listen("pause",function(){c.controlsWrapper.find(".plyr-button").removeClass("plyr-pause").addClass("plyr-play")}),this.pop.listen("play",function(){c.controlsWrapper.find(".plyr-button").removeClass("plyr-play").addClass("plyr-pause")}),this.pop.listen("seeking",function(){}),this.pop.listen("seeked",function(){}),this.pop.listen("ended",function(){this.currentTime(0)}),this.pop.listen("loadeddata",function(){})},destroy:function(){Popcorn.destroy(this.pop)}});define("web/js/plugins/players/plyr.js",function(){}),function(a){a.Model=Backbone.Model.extend({defaults:{cover_image:"images/default_cover.png",estimated_time:"the time it takes to eat a sandwhich",author:""},url:function(){return zeega.app.url_prefix+"api/projects/"+this.id},initialize:function(a){_.defaults(this.get("attr"),this.default_attr),this.unset("sequences",["silent"]),this.unset("frames",["silent"]),this.unset("layers",["silent"]),this.createLayerCollection(a.layers),this.createFrameCollection(a.frames),this.createSequenceCollection(a.sequences),this.layers.on("add",this.onAddLayer,this),this.frames.on("add",this.onAddFrame,this),console.log("init PROJECT"),console.log(this)},createLayerCollection:function(a){var b=this,c=zeega.module("layer"),d=[];_.each(a,function(a){var e=new c[a.type](a);b.initLayerListeners(e),d.push(e)}),this.layers=new c.MasterCollection(d)},createFrameCollection:function(a){var b=zeega.module("frame");this.frames=new b.Collection(a)},createSequenceCollection:function(a){var b=zeega.module("sequence");this.sequences=new b.Collection(a),this.sequences.render(),zeega.app.currentSequence=this.sequences.at(0)},initLayerListeners:function(a){a.on("editor_removeLayerFromFrame",this.removeLayerFromFrame,this)},onAddLayer:function(a){this.initLayerListeners(a)},onAddFrame:function(a){console.log("added frame"),console.log(a)},duplicateFrame:function(a){console.log("	DUPLICATE FRAME");var b=this,c=a.clone();c.set("duplicate_id",parseInt(a.id)),c.oldLayerIDs=a.get("layers"),c.frameIndex=_.indexOf(this.get("framesOrder"),a.id),c.dupe=!0,c.set("id",null),c.save({},{success:function(a){console.log("frame saved and is a duplicate"),console.log(a),b.insertFrameView(a,c.frameIndex),_.each(a.oldLayerIDs,function(c,d){var e=b.get("attr").persistLayers;if(_.include(e,parseInt(c))){var f=a.get("layers");f[d]=String(c),a.set({layers:f})}else b.layers.duplicateLayer(c,a.get("layers")[d])})}}),this.frames.add(c)},removeLayerFromFrame:function(a){if(_.include(this.get("persistLayers"),parseInt(a.id))){console.log("remove persistant layer"),_.each(_.toArray(this.frames.collection),function(b){var c=_.without(b.get("layers"),parseInt(a.id));c.length==0&&(c=[!1]),b.set("layers",c),b.save()});var b=_.without(this.get("persistLayers"),parseInt(a.id));b.length==0&&(b=[!1]),this.set("persistLayers",b),this.save(),a.destroy()}else{console.log("remove single layer");var c=_.without(zeega.app.currentFrame.get("layers"),parseInt(a.id));c.length==0&&(c=[!1]),console.log(c),zeega.app.currentFrame.set("layers",c),zeega.app.currentFrame.save(),console.log(zeega.app.currentFrame.get("layers")),console.log(zeega.app.currentFrame),this.destroyOrphanLayers()}},destroyOrphanLayers:function(){var a=this,b=_.map(this.layers.pluck("id"),function(a){return parseInt(a)}),c=_.flatten(this.frames.pluck("layers")),d=_.difference(b,c);_.each(d,function(b){a.layers.get(b).destroy()})},loadProject:function(){this.view=new a.Views.Editor({model:this}),this.view.render(),this.trigger("ready")},loadPublishProject:function(){var a=zeega.module("modal");this.view=new a.Views.ShareProject({model:this}),this.view.render()},update:function(a,b){var c=this;b||this.save({},{success:function(){c.trigger("update")}})}})}(zeega.module("project")),define("web/js/app/models/editor.model.project.js",function(){}),function(a){a.Model=Backbone.Model.extend({defaults:{attr:{}},url:function(){return this.isNew()?zeega.app.url_prefix+"projects/"+zeega.app.project.id+"/sequences":zeega.app.url_prefix+"sequences/"+this.id},defaultAttr:{persistLayers:[]},initialize:function(a){this.checkAttr(),this.set({attr:_.defaults(this.get("attr"),this.defaultAttr)}),this.on("updateFrameOrder",this.updateFrameOrder,this),this.on("sync",this.checkAttr,this),this.attachTabView(),this.trigger("ready")},checkAttr:function(){_.isUndefined(this.get("attr").persistlayers)&&(this.get("attr").persistLayers=[])},attachTabView:function(){this.view=new a.Views.SequenceTabs({model:this}),this.on("sync",this.refreshView,this)},refreshView:function(){console.log("refresh view!!!"),this.view.render()},updateFrameOrder:function(a){var b=_.map($("#frame-list").sortable("toArray"),function(a){return Math.floor(a.match(/([0-9])*$/g)[0])});console.log(b),this.set({frames:b}),a!=0&&this.save()},insertFrameView:function(a,b){_.isUndefined(b)?$("#frame-list").append(a.render()):$("#frame-list").children("li:eq("+b+")").after(a.render()),this.updateFrameOrder()},destroyFrame:function(a){console.log("destroy frame:"),zeega.app.currentFrame==a&&zeega.app.loadLeftFrame(),this.updateFrameOrder()},updatePersistLayer:function(a){console.log("persist this layer"),this.set("attr",{persistLayers:[parseInt(a)]}),this.save();var b=this.get("attr");_.include(b.persistLayers,parseInt(a))?b=_.extend(b,{persistLayers:_.without(b.persistLayers,parseInt(a))}):(b.persistLayers?b=_.extend(b,{persistLayers:_.compact(b.persistLayers.push(parseInt(a)))}):b.persistLayers=[parseInt(a)],console.log(b))}})}(zeega.module("sequence")),define("web/js/app/models/editor.model.sequence.js",function(){}),function(a){a.Model=Backbone.Model.extend({defaults:{title:"Untitled"},url:function(){return sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"api/items/"+this.id},initialize:function(){},loadTags:function(a,b){this.tags.reset({silent:!0}),this.tags.item_id=this.id,this.tags.fetch({success:a,error:b})}})}(zeega.module("items")),define("web/js/app/models/editor.model.item.js",function(){}),function(a){a.Model=Backbone.Model.extend({frameTarget:$("#frame-list"),defaults:{name:"Untitled",layers:[],thumbnail_url:"../../../images/thumb.png",attr:{advance:0}},url:function(){return this.isNew()?(console.log("FRAME URL "+zeega.app.url_prefix+"api/projects/"+zeega.app.project.id+"/sequences/"+zeega.app.currentSequence.id+"/frames"),zeega.app.url_prefix+"api/projects/"+zeega.app.project.id+"/sequences/"+zeega.app.currentSequence.id+"/frames"):(console.log("FRAME URL "+zeega.app.url_prefix+"api/frames/"+this.id),zeega.app.url_prefix+"api/frames/"+this.id)},initialize:function(){this.updating=!1,this.get("layers")&&this.set({layers:_.map(this.get("layers"),function(a){return parseInt(a)})}),this.get("thumbnail_url")==""&&this.set("thumbnail_url",this.defaults.thumbnail_url),console.log("frame model",this),this.view=new a.Views.FrameSequence({model:this}),this.on("update_thumb",this.updateThumb,this),this.updateFrameThumb=_.debounce(this.updateThumb,2e3)},render:function(){this.frameTarget.append(this.view.render().el)},unrender:function(){this.frameTarget.append(this.view.remove())},updateThumb:function(){console.log("SAVE FRAME"),console.log(this);var a=this;if(this.updating!=1&&zeega.app.thumbnailUpdates){this.updating=!0,$("#frame-thumb-"+this.id).find(".frame-update-overlay").fadeIn("fast");var b=new Worker(sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"/js/helpers/thumbworker.js");b.addEventListener("message",function(b){console.log(b),b.data?(a.set({thumbnail_url:b.data}),console.log("thumbnail returned!!",b.data)):a.trigger("thumbUpdateFail"),a.updating=!1,this.terminate()},!1),b.postMessage({cmd:"capture",msg:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"api/frames/"+this.get("id")+"/thumbnail"})}},validate:function(a){console.log("VALIDATE LAYER ARRAY",a.layers+"");if(!_.isNull(a.layers)&&a.layers.length>1&&_.include(a.layers,!1))return alert("There was an error with your project :(/nplease email bugs@zeega.org and describe what you were doing that led to this error.\nPlease refresh your browser. Your last edit may not have saved. We apologize for the inconvenience."),"layer array update error!"}})}(zeega.module("frame")),define("web/js/app/models/editor.model.frame.js",function(){}),function(a){a.Model=Backbone.Model.extend({showControls:!0,player:!1,displayCitation:!0,visualLoaded:!1,defaultControls:!0,editorWindow:$("#visual-editor-workspace"),layerPanel:$("#layers-list-visual"),layerColor:["red","blue","yellow","green"],defaults:{attr:{},linkable:!0,thumbUpdate:!0},defaultAttributes:{},url:function(){return this.isNew()?zeega.app.url_prefix+"api/projects/"+zeega.app.project.id+"/layers":zeega.app.url_prefix+"layers/"+this.id},initialize:function(b,c){this.on("ready",function(){this.visualLoaded=!0}),this.on("refresh_view",this.refreshView,this),this.on("editor_layerRender",this.renderLayerInEditor,this),this.on("editor_destroyLayer editor_layerUnrender",this.unrenderLayerFromEditor,this),this.on("editor_controlsOpen",this.onControlsOpen,this),this.on("editor_controlsClosed",this.onControlsClosed,this),this.on("editor_destroyLayer",this.unrenderLayerFromEditor,this),c&&_.extend(this,c),_.isNull(this.layerType)?console.log("MISSING LAYER TYPE"):(this.set("type",this.layerType),this.set("attr",_.defaults(this.get("attr"),this.defaultAttributes)),this.visual=new a.Views.Visual[this.layerType]({model:this}),this.player||(this.controls=new a.Views.Controls[this.layerType]({model:this})),this.init())},generateNewViews:function(){_.isNull(this.layerType)||(this.visual=new a.Views.Visual[this.layerType]({model:this}),this.player||(this.controls=new a.Views.Controls[this.layerType]({model:this})))},init:function(){},onControlsOpen:function(){},onControlsClosed:function(){},renderLayerInEditor:function(a){this.visual.render().$el.css("zIndex",a+1),this.isNew()?(this.visual.render().$el.css("zIndex",1e3),this.editorWindow.append(this.visual.el)):this.editorWindow.append(this.visual.render().el),this.controls&&this.layerPanel.prepend(this.controls.render().el),this.trigger("editor_rendered editor_layerEnter")},unrenderLayerFromEditor:function(){this.hasChanged()&&this.save(),this.trigger("editor_layerExit")},refreshView:function(){console.log("	refresh view"),this.visual.$el.attr("id","layer-visual-"+this.id),this.controls&&this.controls.$el.attr("id","layer-"+this.id)},update:function(a,b){var c=this;_.extend(this.get("attr"),a),b||this.save({},{success:function(){c.trigger("update")}})},thumb:function(){var a=$("<img>").attr("src",this.attr.thumbnail_url).css({width:"100%"});this.thumbnail.append(a)},preload:function(){$("#zeega-player").trigger("ready",{id:this.id})},stash:function(){},playUnsupported:function(){},onExit:function(){},setIcon:function(){this.icon=!0},setZIndex:function(a){this.visualEditorElement.css("z-index",a)},onStateChange:function(){},onError:function(){},validate:function(a){a.title&&(a.title=a.title.replace(/(<([^>]+)>)/ig,""))}})}(zeega.module("layer")),define("web/js/app/models/editor.model.layer.js",function(){}),function(a){a.Collection=Backbone.Collection.extend({model:a.Model,initialize:function(){$("#sequence-tabs").empty(),this.on("add",this.drawSequenceTab,this)},render:function(){_.each(_.toArray(this),function(a,b){$("#sequence-tabs").append(a.view.render().el)}),this.at(0).trigger("focus")},drawSequenceTab:function(a){_.each(_.toArray(this),function(a){a.trigger("blur")}),$("#sequence-tabs").append(a.view.render().el),a.trigger("focus")}})}(zeega.module("sequence")),define("web/js/app/collections/editor.collections.sequence.js",function(){}),function(a){a.ViewCollection=Backbone.View.extend({el:$("#database-item-list"),initialize:function(){this.collection=new a.Collection,this.collection.on("reset",this.reset,this),this._childViews=[],$(this.el).spin("small"),this.render()},render:function(){var b=this;return this._isRendered=!0,this.collection.length?_.each(_.toArray(this.collection),function(c){var d=new a.Views.List({model:c});b._childViews.push(d),$(b.el).append(d.render().el)}):$(this.el).html('<li class="alert alert-error">No results :(</li>'),$(this.el).fadeTo(100,1),$(this.el).spin(!1),this},reset:function(){this._isRendered&&($(this.el).empty(),this._childViews=[],this.render())},getNextPage:function(){if(this.collectionFull!=1){console.log("add more!!!");var a=this;this.collection.page++,this.collection.fetch({add:!0,success:function(b){a._childViews=[],$(a.el).empty(),a.render(),a.collection.totalItemsCount==a.collection.length&&(a.collectionFull=!0)}})}},append:function(a){a.each(this.add),a.bind("add",this.add),insertPager(_.size(this._itemViews),Database.page)},search:function(a,b){var c=this;$(this.el).fadeTo(1e3,.5),$(this.el).spin("small"),this.collection.setSearch(a,b),this.collection.fetch()},refresh:function(){$(this.el).fadeTo(1e3,.5),$(this.el).spin("small"),this.collection.fetch()},getSearch:function(){return this.collection.search}}),a.Collection=Backbone.Collection.extend({page:0,totalItemsCount:0,base:function(){return zeega.app.url_prefix+"api/search?r_items=1&r_itemswithcollections=0&user=-1&site="+sessionStorage.getItem("siteid")+"&page="+this.page},search:{},initialize:function(){if(itemsJSON){var a=jQuery.parseJSON(itemsJSON);this.totalItemsCount=a.items_count,this.reset(a.items)}else console.log("items NOT bootstrapped. Do search. "),this.fetch()},url:function(){var a=this.base();return _.isUndefined(this.search.query)||(a+="&q="+this.search.query),_.isUndefined(this.search.contentType)||(a+="&content="+this.search.contentType),!_.isUndefined(this.search.collectionID)&&this.search.collectionID!="all"&&(a+="&collection="+this.search.collectionID,a=a.replace("&user=-1",""),a=a.replace("&site="+sessionStorage.getItem("siteid"),"")),a},setSearch:function(a,b){b?this.search=a:_.extend(this.search,a)},parse:function(a){return this.totalItemsCount=a.items_count,a.items}})}(zeega.module("items")),define("web/js/app/collections/editor.collections.item.js",function(){}),function(a){a.Collection=Backbone.Collection.extend({model:a.Model,url:function(){return zeega.app.url_prefix+"sequences/"+zeega.app.sequence.id+"/frames"},initialize:function(){}})}(zeega.module("frame")),define("web/js/app/collections/editor.collections.frame.js",function(){}),function(a){a.MasterCollection=Backbone.Collection.extend({initialize:function(){this.visible=[]},addNewLayer:function(b){var c=this;console.log("ADD NEW LAYER");if(_.isUndefined(b.item)){console.log("add non item layer type: "+b.type);var d=new a[b.type]({attr:b.options});return console.log(new a[b.type]),console.log(d),this.add(d),b.show()&&d.trigger("editor_layerRender"),this.saveLayer(d,b.frame),d}console.log(b.item.get("layer_type"));var d=new(a[b.item.get("layer_type")])({type:b.item.get("layer_type"),attr:b.item.attributes});return this.add(d),b.show()&&d.trigger("editor_layerRender"),this.saveLayer(d,b.frame),d},saveLayer:function(a,b){console.log("SAVE NEW LAYER"),console.log("save to: "+a.url());var c=this;a.save({},{success:function(a){console.log("SAVED NEW LAYER"),console.log(a),a.trigger("refresh_view"),a.trigger("layer_saved"),c.addLayerToFrame(b,a),b.trigger("update_thumb")}})},duplicateLayer:function(a,b){var c=this.get(a),d=c.clone();d.generateNewViews(),d.set("id",b),this.add(d),c.save()},addLayerToFrame:function(a,b){console.log("	ADD LAYER TO FRAME"),a.id!=zeega.app.currentFrame&&(a.get("layers")?a.get("layers").push(b.id):a.set("layers",[b.id]),a.save(),console.log(a)),b.trigger("update"),zeega.app.updateLayerOrder(a)},removeLayer:function(a){this.removeLayerFromFrame(a)},removeLayerFromFrame:function(a,b){_.isUndefined(b)&&(b=zeega.app.currentFrame);if(b.get("layers")){var c=_.without(b.get("layers"),parseInt(a.id));c.length==0&&c.push(!1),b.set({layers:c}),b.save()}}})}(zeega.module("layer")),define("web/js/app/collections/editor.collections.layer.js",function(){}),function(a){a.Views.Editor=Backbone.View.extend({el:$("#sequence-title"),render:function(){var a=this;return this.$el.html(this.model.get("title")),this.$el.attr("contenteditable","true").keypress(function(a){a.which==13&&(a.preventDefault(),$(this).blur())}).blur(function(){a.saveTitle()}),$("#sequence-cover-image").css({"background-image":'url("'+zeega.app.url_prefix+this.model.get("cover_image")+'")'}),console.log("cover image: "+this.model.get("cover_image")),this},saveTitle:function(){if(this.$el.text()!=this.model.get("title")){var a=this.$el.text()==""?"untitled":this.$el.text();this.$el.effect("highlight",{},2e3),this.model.save({title:a})}}})}(zeega.module("project")),define("web/js/app/views/editor.project/editor.view.project.editor.js",function(){}),function(a){a.Views.SequenceTabs=Backbone.View.extend({tagName:"li",inFocus:!1,initialize:function(){this.model.on("focus",this.onFocus,this),this.model.on("blur",this.onBlur,this),this.model.on("change:title",this.render,this)},render:function(){return $(this.el).html(_.template(this.getTemplate(),{title:this.model.get("title")||"..."})),this},onFocus:function(){this.inFocus=!0,this.$el.addClass("active")},onBlur:function(){this.inFocus=!1,this.$el.removeClass("active")},events:{"click .menu-toggler":"toggleDropdown","click .sequence-tab-link":"goToSequence","click .rename-sequence":"renameSequence","click .delete-sequence":"deleteSequence"},goToSequence:function(a){return this.inFocus||zeega.app.goToSequence(this.model.id),this.closeDropdown(),!1},toggleDropdown:function(a){return this.$el.find(".menu").toggleClass("hide"),!1},closeDropdown:function(){this.$el.find(".menu").addClass("hide")},renameSequence:function(){var a=this;return this.loadedModal||($("body").append(_.template(this.getModalTemplate(),this.model.attributes)),$("#sequence-modal-"+a.model.id+" input").focus(),$("#sequence-modal-"+this.model.id+" .save").click(function(){a.model.save({title:$("#sequence-modal-"+a.model.id+" input").val()})}),$("#sequence-modal-"+a.model.id+" input").keypress(function(b){b.which==13&&(a.model.save({title:$("#sequence-modal-"+a.model.id+" input").val()}),$("#sequence-modal-"+a.model.id).modal("hide"))})),$("#sequence-modal-"+this.model.id).modal("show"),this.closeDropdown(),this.loadedModal=!0,!1},deleteSequence:function(){return confirm('Delete sequence: "'+this.model.get("title")+'"\n\nThis will also delete all incoming and outgoing connections to this sequence!')?(this.remove(),zeega.app.deleteSequence(this.model.id),this.closeDropdown()):this.closeDropdown(),!1},getTemplate:function(){var a="<a href=\"#\" class=\"sequence-tab-link\"><%= title %></a> <a href='#' class='menu-toggler'><b class='caret'></b></a><div class='well menu hide'><ul class='nav nav-list'><li><a href='#' class='rename-sequence'>rename</a></li><li><a href='#' class='delete-sequence'>delete</a></li></ul></div>";return a},getModalTemplate:function(){var a='<div class="modal" id="sequence-modal-<%= id %>"><div class="modal-header"><button class="close" data-dismiss="modal">×</button><h3>Rename Sequence</h3></div><div class="modal-body"><input type="text" class="input-xlarge sequence-title" value="<%= title %>"></div><div class="modal-footer"><a href="#" class="btn" data-dismiss="modal">Close</a><a href="#" class="btn btn-primary save" data-dismiss="modal">Save changes</a></div></div>';return a}})}(zeega.module("sequence")),define("web/js/app/views/editor.sequence/editor.view.sequence.sequence-tab",function(){}),function(a){a.Views.List=Backbone.View.extend({tagName:"li",className:"database-asset-list",render:function(){var a=this,b={type:this.model.get("layer_type").toLowerCase(),title:this.model.get("title"),creator:this.model.get("media_creator_username"),thumbUrl:this.model.get("thumbnail_url")},c=_.template(this.getTemplate());$(this.el).append(c(b)),$(this.el).attr({id:"item-"+this.model.id,"data-original-title":this.model.get("title"),"data-content":"created by: "+this.model.get("media_creator_username")}),$(this.el).draggable({distance:10,cursor:"crosshair",appendTo:"body",cursorAt:{top:-5,left:-5},opacity:.75,helper:function(){var a=$(this).find(".item-thumbnail").clone().css({height:"75px",width:"75px",overflow:"hidden",background:"white"});return a},start:function(){$(this).draggable("option","revert",!0),$("#visual-editor-workspace").addClass("target-focus"),$("#frame-drawer").addClass("target-focus"),zeega.app.draggedItem=a.model},stop:function(){$("#visual-editor-workspace").removeClass("target-focus"),$("#frame-drawer").removeClass("target-focus"),zeega.app.draggedItem=null}});var d={delayIn:1500};return this},events:{},previewItem:function(){},getTemplate:function(){var a='<i class="zicon-<%= type %> item-icon show-in-list-view"></i><img class="item-thumbnail" src="<%= thumbUrl %>"/><div class="item-title show-in-list-view"><%= title %></div>';return a}})}(zeega.module("items")),define("web/js/app/views/editor.item/editor.view.item.database-tray.js",function(){}),function(a){a.Views.FrameSequence=Backbone.View.extend({initialize:function(){this.model.on("change:thumbnail_url",this.onNewThumb,this),this.model.on("focus",this.focus,this),this.model.on("blur",this.blur,this),this.model.on("refresh_view",this.refreshView,this)},focus:function(){$(this.el).addClass("active-frame"),this.model.inFocus=!0},blur:function(){$(this.el).removeClass("active-frame"),this.model.inFocus=!1},render:function(){var a=this;this.model.on("thumbUpdateFail",function(){console.log("thumb fail"),$(a.el).find(".frame-update-overlay").hide()});var b={frameID:this.model.id,thumbURL:this.model.get("thumbnail_url")},c=_.template(this.getTemplate());return this.el=$(c(b)),$(this.el).droppable({accept:".database-asset-list",hoverClass:"frame-item-hover",tolerance:"pointer",over:function(a,b){$("#frame-drawer").addClass("hover")},out:function(a,b){$("#frame-drawer").removeClass("hover")},drop:function(b,c){$("#frame-drawer").removeClass("hover"),c.draggable.draggable("option","revert",!1),zeega.app.addLayer({item:zeega.app.draggedItem,frame:a.model}),console.log("add layer:",zeega.app.draggedItem,a.model)}}),$(this.el).hover(function(){$(a.el).find(".frame-menu").show()},function(){$(a.el).find(".menu-items").removeClass("open"),$(a.el).find(".frame-menu").hide()}),$(this.el).click(function(){return a.goToFrame(),!1}),$(this.el).find(".menu-toggle").click(function(){return a.openDropdown(),!1}),$(this.el).find(".nav-list a").click(function(){switch($(this).data("action")){case"delete":confirm("Delete Frame?")&&($(a.el).remove(),a.model.destroy());break;case"duplicate":zeega.app.duplicateFrame(a.model);break;default:console.log("not recognized")}return event.stopPropagation(),!1}),$(this.el).hover(function(){zeega.app.draggedItem==null&&$(this).find(".menu-toggle").show()},function(){$(this).find(".menu-toggle").hide(),$(this).find(".menu").hide()}),this},events:{mouseover:"showGear","click .menu-toggle":"openDropdown"},refreshView:function(){$(this.el).attr("id","frame-thumb-"+this.model.id)},showGear:function(){console.log("hover")},openDropdown:function(){$(this.el).find(".menu").show(),event.stopPropagation()},goToFrame:function(){return console.log("go to frame: "+this.model.id),zeega.app.loadFrame(this.model),!1},onNewThumb:function(){var a=this;$(this.el).is(":visible ")?$(this.el).fadeOut("fast",function(){$(this).css("background-image",'url("'+a.model.get("thumbnail_url")+'")').fadeIn("fast"),$(this).find(".frame-update-overlay").hide()}):($(this.el).css("background-image",'url("'+this.model.get("thumbnail_url")+'")'),$(this.el).find(".frame-update-overlay").hide())},getTemplate:function(){var a="<li id='frame-thumb-<%= frameID %>' class='frame-thumb' style='background-image:url(\"<%= thumbURL %>\")'><div class='frame-update-overlay'></div><a href='#' class='menu-toggle'><span class='zicon zicon-gear orange'></span></a><div class='well menu'><ul class='nav nav-list'><li><a href='#' data-action='duplicate'>Duplicate Frame</a></li><li><a href='#' data-action='delete'>Delete Frame</a></li></ul></div></li>";return a}})}(zeega.module("frame")),define("web/js/app/views/editor.frame/editor.view.frame.frame-sequence.js",function(){}),function(a){a.Views.Lib=Backbone.View.extend({defaults:{},initialize:function(a){this.settings=_.defaults(a,this.defaults),$(this.el).addClass("control"),this.init(),this.model.on("editor_controlsOpen",this.private_onControlsOpen,this),this.model.on("editor_controlsClosed",this.private_onControlsClosed,this),this.model.on("editor_layerEnter",this.private_onLayerEnter,this),this.model.on("editor_layerExit",this.private_onLayerExit,this)},init:function(){},getControl:function(){return this.render(),this.el},onControlsOpen:function(){},onControlsClosed:function(){},onLayerEnter:function(){},onLayerExit:function(){},private_onControlsOpen:function(){this.onControlsOpen(),this.delegateEvents()},private_onControlsClosed:function(){this.onControlsClosed(),this.undelegateEvents()},private_onLayerEnter:function(){this.onLayerEnter(),this.delegateEvents()},private_onLayerExit:function(){this.onLayerExit(),this.undelegateEvents()}}),a.Views.Lib.ContinueLayer=a.Views.Lib.extend({className:"control continue-layer",render:function(){var a='<button class="btn" style="width:100%">Continue Layer</button>';$(this.el).append(a)},events:{click:"continueLayer"},continueLayer:function(){this.$el.find("button").effect("highlight",{},2e3),zeega.app.continueLayer(this.model.id)}}),a.Views.Lib.ContinueToNextFrame=a.Views.Lib.extend({className:"control continue-to-next",render:function(){var a='<button class="btn" style="width:100%">Continue on next frame</button>';$(this.el).append(a)},events:{click:"continueLayerToNextFrame"},continueLayerToNextFrame:function(){this.$el.find("button").effect("highlight",{},2e3),zeega.app.continueLayerToNextFrame(this.model.id)}}),a.Views.Lib.ContinueOnAllFrames=a.Views.Lib.extend({className:"control continue-to-all",defaults:{active:!1},render:function(){var a='<button class="btn" style="width:100%">Continue on all frames</button>';$(this.el).append(a),this.settings.active&&$(this.el).find("button").addClass("active btn-warning")},events:{click:"continueOnAllFrames"},continueOnAllFrames:function(){this.$el.find("button").hasClass("active")?this.$el.find("button").removeClass("active btn-warning"):this.$el.find("button").addClass("active btn-warning"),this.$el.find("button").effect("highlight",{},2e3),console.log("continue layer on all frames!: "+this.model.id),zeega.app.continueOnAllFrames(this.model)}}),a.Views.Lib.Link=a.Views.Lib.extend({className:"control link-controls",render:function(){var a=this.model.get("attr").link||"";$(this.el).append(_.template(this.getTemplate(),{link:a}))},events:{"click .remove-link":"clearLink","focus input":"focusInput","blur input":"updateLink"},clearLink:function(){return this.$el.find("input").val(""),this.updateLink(),!1},focusInput:function(){var a=this;this.$el.find("input").keypress(function(b){if(b.which==13)return a.updateLink(),this.blur(),!1})},updateLink:function(){this.$el.find("input").unbind("keypress");var a=this.$el.find("input").val();a!=this.model.get("attr").link&&(this.$el.find("input, .add-on").effect("highlight",{},2e3),this.model.update({link:a}))},getTemplate:function(){return html='<div class="input-prepend"><span class="add-on">http://</span><input class="span2" type="text" placeholder="www.example.com" value="<%= link %>"><a href="#" class="remove-link">&times;</span>',"</div>",html}}),a.Views.Lib.Target=a.Views.Lib.extend({defaults:{className:"",idName:""},init:function(a){this.className=this.settings.className},render:function(){$(this.el).attr("id",this.settings.idName)}}),a.Views.Lib.Slider=a.Views.Lib.extend({className:"control control-slider",defaults:{label:"control",min:0,max:100,step:1,value:100,silent:!1,suffix:"",css:!0,scaleWith:!1,scaleValue:!1,callback:!1,save:!0,slide:null},render:function(){var a=this;return this.$el.append(_.template(this.getTemplate(),this.settings)),this.$el.find(".control-slider").slider({min:this.settings.min,max:this.settings.max,value:_.isUndefined(this.model.get("attr")[this.settings.property])?this.settings.value:this.model.get("attr")[this.settings.property],step:this.settings.step,slide:function(b,c){a.settings.css&&a.model.visual.$el.css(a.settings.property,c.value+a.settings.suffix),_.isNull(a.settings.slide)||a.settings.slide()},stop:function(b,c){if(a.settings.save){var d={};d[a.settings.property]=c.value,a.model.update(d)}}}),this},getValue:function(){return this.$el.find(".control-slider").slider("option","value")},getTemplate:function(){var a="<div class='control-name'><%= label %></div><div class='control-slider'></div>";return a}}),a.Views.Lib.ClearStyles=a.Views.Lib.extend({className:"clear-styles",render:function(){var a='<button class="btn" style="width:100%">Clear Styles</button>';$(this.el).append(a)},events:{click:"clearStyles"},clearStyles:function(){var a=this.model.get("attr").content.replace(/(<([^>]+)>)/ig,"");this.model.update({content:a}),console.log("clear styles!: "+a),this.model.updateContentInPlace()}}),a.Views.Lib.TextStyles=a.Views.Lib.extend({className:"text-styles",render:function(){var a=this.getTemplate();$(this.el).append(a)},events:{"click .bold":"addBold","click .italic":"addItalic","click .underline":"addUnderline","click .clear-styles":"clearStyles"},addBold:function(){this.model.visual.$el.find(".style-bold").length?this.model.visual.$el.find(".style-bold").contents().unwrap():this.model.visual.$el.find(".inner").wrapInner('<span class="style-bold" style="font-weight:bold"/>'),this.$el.find(".bold").effect("highlight",{},2e3),this.saveContent()},addItalic:function(){this.model.visual.$el.find(".style-italic").length?this.model.visual.$el.find(".style-italic").contents().unwrap():this.model.visual.$el.find(".inner").wrapInner('<span class="style-italic" style="font-style:italic"/>'),this.$el.find(".italic").effect("highlight",{},2e3),this.saveContent()},addUnderline:function(){this.model.visual.$el.find(".style-underline").length?this.model.visual.$el.find(".style-underline").contents().unwrap():this.model.visual.$el.find(".inner").wrapInner('<span class="style-underline" style="text-decoration:underline"/>'),this.$el.find(".underline").effect("highlight",{},2e3),this.saveContent()},saveContent:function(){var a=this.model.visual.$el.find("#zedit-target").html();this.model.update({content:a})},clearStyles:function(){var a=this.model.get("attr").content.replace(/(<([^>]+)>)/ig,"");this.model.update({content:a}),this.model.updateContentInPlace()},getTemplate:function(){var a='<div class="btn-group"><button class="btn bold"><i class="zicon-bold"></i></button><button class="btn italic"><i class="zicon-italic"></i></button><button class="btn underline"><i class="zicon-underline"></i></button><button class="btn clear-styles"><i class="zicon-cancel"></i></button></div>';return a}}),a.Views.Lib.FontChooser=a.Views.Lib.extend({className:"font-chooser",render:function(){var a=this.getTemplate();$(this.el).append(a)},events:{"click .font-list a":"changeFont"},changeFont:function(a){return this.$el.find(".open").removeClass("open"),this.model.visual.$el.find(".style-font-family").contents().unwrap(),this.model.visual.$el.find(".inner").wrapInner('<span class="style-font-family" style="font-family:'+$(a.target).data("font-family")+'"/>'),this.saveContent(),!1},saveContent:function(){var a=this.model.visual.$el.find("#zedit-target").html();this.model.update({content:a})},getTemplate:function(){var a='<div class="btn-group"><a class="btn dropdown-toggle" data-toggle="dropdown" href="#">Fonts<span class="caret"></span></a><ul class="dropdown-menu font-list"><li style="font-family:\'Arial\'"><a href="#" data-font-family="Arial">Arial</a></li><li style="font-family:\'Georgia\'"><a href="#" data-font-family="Georgia">Georgia</a></li><li style="font-family:\'Verdana\'"><a href="#" data-font-family="Verdana">Verdana</a></li><li style="font-family:\'Sorts Mill Goudy\'"><a href="#" data-font-family="Sorts Mill Goudy">Sorts Mill Goudy</a></li><li style="font-family:\'Poiret One\'"><a href="#" data-font-family="Poiret One">Poiret One</a></li><li style="font-family:\'Trocchi\'"><a href="#" data-font-family="Trocchi">Trocchi</a></li><li style="font-family:\'Pontano Sans\'"><a href="#" data-font-family="Pontano Sans">Pontano Sans</a></li></ul></div>';return a}}),a.Views.Lib.ColorPicker=a.Views.Lib.extend({className:"control-colorpicker",defaults:{property:"backgroundColor",color:"#ffffff",save:!0,opacity:!1,opacityValue:1},save:function(){console.log("save rect");var a={};console.log(this),a[this.settings.property]=this.settings.color,this.model.update(a)},render:function(){var b=this;return this.settings.opacity&&(this.opacitySlider=new a.Views.Lib.Slider({css:!1,property:this.settings.property+"Opacity",value:this.settings[this.settings.property+"Opacity"]||this.settings.opacityValue,model:this.model,label:this.settings.label+" Opacity",step:.01,min:.05,max:1,slide:function(){b.refreshColor(b.settings.color,b.opacitySlider.getValue())}})),this.$el.append(_.template(this.getTemplate(),this.settings)),this.settings.opacity&&this.$el.append(this.opacitySlider.getControl()),this.initHexField(),this},events:{"click .color-box, input":"initWheel","click .close":"closeWheel"},initHexField:function(){var a=this;this.$el.find("input").keypress(function(b){if(b.which==13){console.log($(this).val());var c=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test($(this).val());c?$(this).effect("highlight",{},2e3):($(this).val("#FF00FF"),$(this).effect("highlight",{color:"#ff0000"},2e3)),$.farbtastic(a.$el.find(".control-colorpicker")).setColor($(this).val()),this.lazySave()}})},initWheel:function(){var a=this;console.log("pull up color wheel!"),this.$el.find(".close").show(),this.wheelLoaded!=1?($.farbtastic(this.$el.find(".control-colorpicker")).setColor(a.settings.color).linkTo(function(b){a.refreshColor(b,a.opacitySlider?a.opacitySlider.getValue():1),a.settings.color=b}),this.wheelLoaded=!0):this.$el.find(".control-colorpicker").show()},closeWheel:function(){this.$el.find(".close").hide(),this.$el.find(".control-colorpicker").hide()},refreshColor:function(a,b){this.model.visual.$el.css(this.settings.property,"rgba("+a.toRGB()+","+b+")"),this.$el.find(".color-box").css("background-color",a),this.$el.find("input").val(a),this.settings.save&&this.lazySave()},lazySave:_.debounce(function(){var a={};a[this.settings.property]=this.settings.color,this.model.update(a)},1e3),getTemplate:function(){var a="<div class='input-prepend input-append'><span class='add-on'><%= label %></span><input id='prependedInput' class='span1' type='text' size='16' value='<%= color %>'/><span class='add-on color-box' style='background-color:<%= color %>'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><a class=\"close\" style=\"display:none\">&times;</a><div class='control-colorpicker'></div>";return a}}),a.Views.Lib.Playback=a.Views.Lib.extend({className:"control control-playback plyr-controls-wrapper",defaults:{},init:function(){this.model.on("video_ready",this.onVideoReady,this)},render:function(){var a=this;return this.$el.append(this.getTemplate()).attr("id","plyr-editor"),this},onVideoReady:function(){this.delegateEvents(),this.initPopcornEvents(),this.initScrubbers()},initPopcornEvents:function(){var a=this;this.model.video.pop.listen("pause",function(){a.$el.find(".plyr-button").removeClass("plyr-pause").addClass("plyr-play")}),this.model.video.pop.listen("play",function(){a.$el.find(".plyr-button").removeClass("plyr-play").addClass("plyr-pause")}),this.model.video.on("timeupdate_controls",function(){Math.abs(a.model.video.pop.volume()-a.model.get("attr").volume)>.01&&a.model.video.pop.volume(a.model.get("attr").volume),a.model.get("attr").cue_out!=0&&a.model.video.pop.currentTime()>a.model.get("attr").cue_out?(a.model.video.pop.currentTime(a.model.get("attr").cue_in),a.model.video.pop.pause()):a.model.video.pop.currentTime()<a.model.get("attr").cue_in&&(a.model.video.pop.currentTime(a.model.get("attr").cue_in),a.model.video.pop.pause());var b=parseFloat(a.model.video.pop.currentTime())/parseFloat(a.model.video.pop.duration())*100;a.$el.find(".plyr-scrubber").css({left:b+"%"}),a.$el.find(".plyr-time").html(convertTime(a.model.video.pop.currentTime())+" / "+convertTime(a.model.video.pop.duration())),a.$el.find(".plyr-time-bar").css({width:b+"%"})}),this.model.video.pop.listen("seeking",function(){}),this.model.video.pop.listen("seeked",function(){}),this.model.video.pop.listen("ended",function(){}),this.model.video.pop.listen("loadeddata",function(){})},initScrubbers:function(){var a=this;this.$el.find(".plyr-scrubber").draggable({axis:"x",containment:"parent",start:function(){a.model.video.pop.pause()},drag:function(b,c){var d=Math.floor(parseFloat(c.position.left)*a.model.video.pop.duration()/parseFloat(a.$el.find(".plyr-timeline").width()));a.$el.find(".plyr-time").html(convertTime(d)+" / "+convertTime(a.model.video.pop.duration()))},stop:function(b,c){var d=Math.floor(parseFloat(a.$el.find(".plyr-scrubber").css("left"))*a.model.video.pop.duration()/parseFloat(a.$el.find(".plyr-timeline").width()));d<a.model.get("attr").cue_in?d=a.model.get("attr").cue_in:d>a.model.get("attr").cue_out&&parseFloat(a.model.get("attr").cue_out)>0&&(d=Math.max(parseFloat(a.model.get("attr").cue_in),parseFloat(a.model.get("attr").cue_out)-5)),a.model.video.pop.trigger("timeupdate"),a.model.video.pop.currentTime(d)}}),this.$el.find(".plyr-cuein-scrubber").draggable({axis:"x",containment:"parent",drag:function(b,c){a.model.get("attr").cue_in=Math.floor(parseFloat(c.position.left)*a.model.video.pop.duration()/parseFloat(a.$el.find(".plyr-timeline").width())),a.$el.find(".plyr-cuein-time").html(convertTime(a.model.get("attr").cue_in,!0))},stop:function(b,c){a.$el.find(".plyr-cuein-bar").css({width:a.$el.find(".plyr-cuein-scrubber").css("left")}),console.log(Math.floor(parseFloat(c.position.left)*a.model.video.pop.duration()/parseFloat(a.$el.find(".plyr-timeline").width()))),a.model.video.pop.currentTime(Math.floor(parseFloat(c.position.left)*a.model.video.pop.duration()/parseFloat(a.$el.find(".plyr-timeline").width())));var d=parseFloat(a.model.video.pop.currentTime())/parseFloat(a.model.video.pop.duration())*100;a.$el.find(".plyr-scrubber").css({left:d+"%"}),a.$el.find(".plyr-time").html(convertTime(a.model.video.pop.currentTime())+" / "+convertTime(a.model.video.pop.duration())),a.$el.find(".plyr-time-bar").css({width:d+"%"}),a.model.update({cue_in:a.model.get("attr").cue_in})}}),this.$el.find(".plyr-scrubber").css({left:Math.floor(parseFloat(this.model.get("attr").cue_in)*parseFloat(this.$el.find(".plyr-timeline").width())/parseFloat(this.model.video.pop.duration()))}),this.$el.find(".plyr-cuein-scrubber").css({left:Math.floor(parseFloat(this.model.get("attr").cue_in)*parseFloat(this.$el.find(".plyr-timeline").width())/parseFloat(this.model.video.pop.duration()))}),parseFloat(this.model.get("attr").cue_out)>0&&this.$el.find(".plyr-cueout-scrubber").css({left:Math.floor(parseFloat(this.model.get("attr").cue_out)*parseFloat(this.$el.find(".plyr-timeline").width())/parseFloat(this.model.video.pop.duration()))}),this.$el.find(".plyr-cueout-scrubber").draggable({axis:"x",containment:"parent",start:function(){a.model.video.pop.pause()},drag:function(b,c){a.model.get("attr").cue_out=Math.floor(parseFloat(c.position.left)*a.model.video.pop.duration()/parseFloat(a.$el.find(".plyr-timeline").width())),a.$el.find(".plyr-cueout-time").html(convertTime(a.model.get("attr").cue_out,!0))},stop:function(b,c){a.$el.find(".plyr-cueout-bar").css({width:parseInt(a.$el.find(".plyr-timeline").width())-parseInt(a.$el.find(".plyr-cueout-scrubber").css("left"))}),a.model.video.pop.currentTime(Math.max(parseFloat(a.model.get("attr").cue_in),parseFloat(a.model.get("attr").cue_out)-5)),a.model.update({cue_out:a.model.get("attr").cue_out})}})},events:{"click .plyr-button":"playPause"},playPause:function(){console.log("volume: "+this.model.get("attr").volume),this.model.video.pop.volume(this.model.get("attr").volume),this.model.video.pop.paused()?this.model.video.pop.play():this.model.video.pop.pause()},getTemplate:function(){var a='<div class="plyr-time-wrapper"><div class="plyr-cuein-time"></div><div class="plyr-cueout-time"></div></div><div class="plyr-timeline-wrapper"><div class="plyr-button-wrapper"><div class="plyr-button plyr-play"></div></div><div class="plyr-timeline"><div class="plyr-cuein-bar plyr-bar"></div><div class="plyr-time-bar plyr-bar"></div><div class="plyr-cueout-bar plyr-bar"></div><div class="plyr-cuein-scrubber plyr-edit-scrubber"><div class="plyr-scrubber-select"></div><div class="plyr-arrow-down-green"></div></div><div class="plyr-scrubber plyr-edit-scrubber"><div class="plyr-hanging-box"></div></div><div class="plyr-cueout-scrubber plyr-edit-scrubber"><div class="plyr-scrubber-select"></div><div class="plyr-arrow-down"></div></div></div></div><div class="plyr-time-wrapper"><span class="plyr-time"></span></div>';return a}}),a.Views.Lib.GoogleMaps=a.Views.Lib.extend({className:"control control-google-map",defaults:{mapWidth:268,mapHeight:268,type:"map",streetView:!0,searchBar:!0,disableDoubleClickZoom:!0,panControl:!1,zoomControl:!0,mapTypeControl:!0,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1},init:function(){},onControlsOpen:function(){this.initMap()},initMap:function(){console.log("geo layer open"),console.log(this);if(this.loaded!=1){var a=new google.maps.LatLng(this.model.get("attr").lat,this.model.get("attr").lng),b=google.maps.MapTypeId[this.model.get("attr").mapType.toUpperCase()],c={zoom:this.model.get("attr").zoom,center:a,mapTypeId:b,disableDoubleClickZoom:this.settings.disableDoubleClickZoom,panControl:this.settings.panControl,zoomControl:this.settings.zoomControl,mapTypeControl:this.settings.mapTypeControl,scaleControl:this.settings.scaleControl,streetViewControl:!1,overviewMapControl:this.settings.overviewMapControl};this.map=new google.maps.Map($(this.el).find(".google-map")[0],c),this.marker=new google.maps.Marker({position:a,map:this.map}),this.marker.setDraggable(!0),this.initMapListeners(),this.initGeoCoder(),this.loaded=!0}},initGeoCoder:function(){var a=this;this.geocoder=new google.maps.Geocoder,$(this.el).find(".geocoder").keypress(function(b){if(b.which==13)return a.lookup($(this).val()),$(this).blur(),!1}).blur(function(){a.lookup($(this).val())})},lookup:function(a){console.log("lookup: "+a);var b=this;this.geocoder.geocode({address:a},function(c,d){if(d==google.maps.GeocoderStatus.OK){b.map.getStreetView().getVisible()&&b.map.getStreetView().setVisible(!1);var e=c[0].geometry.location;b.map.setCenter(e),b.marker.setPosition(e),b.model.update({title:a,lat:e.lat(),lng:e.lng()}),b.model.trigger("update"),console.log("new geocoded location")}else alert("Geocoder failed at address look for "+input.val()+": "+d)})},initMapListeners:function(){var a=this;google.maps.event.addListener(this.map,"idle",function(){}),google.maps.event.addListener(this.marker,"dragend",function(){var b=a.marker.getPosition();console.log("map is idle now"),a.model.update({lat:b.lat(),lng:b.lng()}),a.model.trigger("update")}),google.maps.event.addListener(this.map,"maptypeid_changed",function(){console.log("the maps type has changed"),a.model.update({mapType:a.map.getMapTypeId()})}),google.maps.event.addListener(this.map,"zoom_changed",function(){console.log("map zoom level changed"),a.model.update({zoom:a.map.getZoom()})}),google.maps.event.addListener(this.map.getStreetView(),"visible_changed",function(){console.log("streetview changed");if(a.map.getStreetView().getVisible()){var b=a.map.getStreetView().getPosition();console.log(b.lat()+":"+b.lng()),a.model.update({type:"streetview",lat:b.lat(),lng:b.lng(),heading:a.map.getStreetView().getPov().heading,pitch:a.map.getStreetView().getPov().pitch,streetZoom:Math.floor(a.map.getStreetView().getPov().zoom)})}else a.model.update({type:"map"})}),google.maps.event.addListener(a.map.getStreetView(),"pov_changed",function(){b()});var b=_.debounce(function(){var b=a.map.getStreetView().getPosition(),c=a.map.getStreetView().getPov();console.log("streetview moved"),a.model.update({heading:c.heading,lat:b.lat(),lng:b.lng(),pitch:c.pitch,streetZoom:Math.floor(c.zoom)})},1e3)},onControlsClosed:function(){console.log("geo layer closed")},save:function(){console.log("save rect");var a={};console.log(this)},onLayerEnter:function(){$(this.el).find(".google-map").is(":visible")&&this.onControlsOpen()},onLayerExit:function(){this.map={},$(this.el).find(".google-map").empty(),this.loaded=!1},render:function(){var a=this;return this.$el.append(_.template(this.getTemplate(),this.settings)),this},lazySave:_.debounce(function(){var a={};a[this.settings.property]=this.settings.color,this.model.update(a)},3e3),getTemplate:function(){var a="<div class='google-map' style='width:<%= mapWidth %>px; height:<%= mapHeight %>px'></div><input class='geocoder' type='text' placeholder='type a place name'>";return a}})}(zeega.module("layer")),define("web/js/app/views/editor.layer/editor.view.layer.control-library.js",function(){}),function(a){a.Views.Controls=Backbone.View.extend({tagName:"li",className:"editor-layer",initialize:function(){this.initListeners(),this.attr=this.model.get("attr"),_.extend(this.events,this.eventTriggers),this.setBaseTemplate(),this.controls=this.$el.find("#controls"),this.$el.attr("id","layer-"+this.model.id),this.$el.attr("data-id",this.model.id),this.init()},drawDefaultControls:function(){$(this.el).find(".default-layer-controls").empty();var b=zeega.app.currentSequence.get("attr")?zeega.app.currentSequence.get("attr").persistLayers:{},c=_.include(b,parseInt(this.model.id)),d=new a.Views.Lib.ContinueLayer({model:this.model});$(this.el).find(".default-layer-controls").append(d.getControl());if(this.model.get("attr").linkable){var e=new a.Views.Lib.Link({model:this.model});$(this.el).find(".default-layer-controls").append(e.getControl())}},initListeners:function(){this.model.on("update",this.updateViewInPlace,this),this.model.player?(this.model.on("player_preload",this.private_onPreload,this),this.model.on("player_play",this.private_onPlay,this),this.model.on("player_exit",this.private_onExit,this),this.model.on("player_unrender",this.private_onUnrender,this)):(this.model.on("editor_layerEnter",this.private_onLayerEnter,this),this.model.on("editor_layerExit",this.private_onLayerExit,this),this.model.on("editor_controlsOpen",this.private_onControlsOpen,this),this.model.on("editor_controlsClosed",this.private_onControlsClosed,this),this.model.on("editor_removeLayerFromFrame",this.private_onRemoveLayerFromFrame,this))},init:function(){},onLayerEnter:function(){},onLayerExit:function(){},onControlsOpen:function(){},onControlsClosed:function(){},onPreload:function(){},onPlay:function(){},onExit:function(){},onUnrender:function(){},private_onLayerEnter:function(){console.log("	LAYER LIST enter"),this.model.defaultControls&&this.drawDefaultControls(),this.delegateEvents(),this.onLayerEnter()},private_onLayerExit:function(){console.log("	LAYER LIST EXIT"),this.undelegateEvents(),this.$el.find("#controls").empty(),this.onLayerExit()},private_onRemoveLayerFromFrame:function(){this.remove()},private_onControlsOpen:function(){this.onControlsOpen()},private_onControlsClosed:function(){this.onControlsClosed()},private_onPreload:function(){this.onPreload(),this.moveOffStage()},private_onPlay:function(){this.moveOnStage(),this.onPlay()},private_onExit:function(){this.moveOffStage(),this.onExit()},private_onUnrender:function(){this.remove(),this.onUnrender()},moveOnStage:function(){$(this.el).css({top:this.attr.top+"%",left:this.attr.left+"%"})},moveOffStage:function(){$(this.el).css({top:"-1000%",left:"-1000%"})},updateViewInPlace:function(){console.log("re render"),$(this.el).attr("data-id",this.model.id),$(this.el).find(".layer-title").html(this.model.get("attr").title)},events:{"click .delete-layer":"delete","click .layer-title":"expand","click .layer-icon":"hideShow","mouseenter .layer-icon":"onLayerIconEnter","mouseleave .layer-icon":"onLayerIconLeave","mouseenter .delete-layer":"onLayerTrashEnter","mouseleave .delete-layer":"onLayerTrashLeave"},eventTriggers:{},"delete":function(){confirm("Delete Layer?")&&(this.model.trigger("editor_removeLayerFromFrame",this.model),this.remove())},expand:function(){var a=this;return $(this.el).find(".layer-content").is(":hidden")?($(this.el).find(".layer-content").show("blind",{direction:"vertical"},function(){a.model.trigger("editor_controlsOpen"),$(this).removeClass("closed")}),this.visible=!0):($(this.el).find(".layer-content").hide("blind",{direction:"vertical"},function(){$(this).addClass("closed"),a.model.trigger("editor_controlsClosed")}),this.visible=!1),!1},hideShow:function(){var a=!this.model.get("visibleineditor");this.model.set({visibleineditor:a}),a?$(this.el).find(".asset-type-icon").addClass("orange"):$(this.el).find(".asset-type-icon").removeClass("orange")},onLayerIconEnter:function(){$(this.el).find(".asset-type-icon").addClass("zicon-visible")},onLayerIconLeave:function(){$(this.el).find(".asset-type-icon").removeClass("zicon-visible")},onLayerTrashEnter:function(){$(this.el).find(".delete-layer").addClass("orange zicon-trash-open")},onLayerTrashLeave:function(){$(this.el).find(".delete-layer").removeClass("orange zicon-trash-open")},setBaseTemplate:function(){var a=this.model.get("attr").title,b="",c="";if(_.isUndefined(this.model.get("attr").link_to)||this.model.get("attr").link_to=="")c="hidden";var d=c==""?this.model.get("attr").link_to:"",e={id:"layer-edit-"+this.model.id,type:this.model.get("type").toLowerCase(),layerName:a,persist:b,show_link:c,link_to:d};$(this.el).append(_.template(this.getBaseTemplate(),e))},getBaseTemplate:function(){var a='<div class="layer-uber-bar clearfix"><div class="layer-icon"><i class="zicon-<%= type %> orange"></i></div><div class="layer-title"><%= layerName %></div><div class="layer-uber-controls"><i class="zicon-trash-closed delete-layer"></i></div><div class="layer-drag-handle"><span class="zicon zicon-vert-drag"></span></div></div><div class="layer-content inset-tray dark tray closed"><div id="controls" class="clearfix"></div><div class="default-layer-controls clearfix"></div></div>';return a}})}(zeega.module("layer")),define("web/js/app/views/editor.layer/editor.view.layer.layer-list.js",function(){}),function(a){a.Views.Visual=Backbone.View.extend({className:"visual-element",layerClassName:"",draggable:!0,linkable:!0,initialize:function(){var a=this;_.extend(this.events,this.eventTriggers),this.initListeners(),this.attr=this.model.get("attr"),$(this.el).css({position:"absolute",overflow:"hidden",width:a.model.get("attr").width+"%",opacity:a.model.get("attr").opacity,top:this.model.player?"-1000%":a.model.get("attr").top+"%",left:this.model.player?"-1000%":a.model.get("attr").left+"%"}).addClass("layer-"+this.model.layerType.toLowerCase()).attr("id","layer-visual-"+this.model.id),$(this.el).addClass(this.layerClassName),this.init()},initListeners:function(){this.model.player?(this.model.on("player_preload",this.private_onPreload,this),this.model.on("player_play",this.private_onPlay,this),this.model.on("player_exit",this.private_onExit,this),this.model.on("player_unrender",this.private_onUnrender,this)):(this.model.on("editor_layerEnter",this.private_onLayerEnter,this),this.model.on("editor_layerExit editor_removeLayerFromFrame",this.private_onLayerExit,this),this.model.on("editor_controlsOpen",this.private_onControlsOpen,this),this.model.on("editor_controlsClosed",this.private_onControlsClosed,this))},events:{},eventTriggers:{},init:function(){},onLayerEnter:function(){},onLayerExit:function(){this.model.trigger("editor_readyToRemove")},onControlsOpen:function(){},onControlsClosed:function(){},onPreload:function(){var a=this;this.render(),this.attr.link&&$(this.el).click(function(){window.location="http://"+a.attr.link}).addClass("linked-layer"),this.model.trigger("ready",this.model.id)},onPlay:function(){},onExit:function(){},onUnrender:function(){},private_onLayerEnter:function(){this.draggable&&this.makeDraggable(),this.onLayerEnter()},private_onLayerExit:function(){this.model.on("editor_readyToRemove",this.remove,this),this.onLayerExit()},private_onControlsOpen:function(){this.onControlsOpen()},private_onControlsClosed:function(){this.onControlsClosed()},makeDraggable:function(){var a=this;$(this.el).draggable({start:function(a,b){},stop:function(b,c){var d=c.position.top/$(this).parent().height()*100,e=c.position.left/$(this).parent().width()*100;a.model.update({top:d,left:e})}})},private_onPreload:function(){this.render(),this.onPreload(),this.model.rendered=!0},private_onPlay:function(a){this.moveOnStage(),a&&this.updateZIndex(a),this.onPlay(),this.model.inFocus=!0;if(this.attr.link||this.model.get("type")=="Link"){var b=this;setTimeout(function(){$(b.el).addClass("link-blink")},250),setTimeout(function(){$(b.el).removeClass("link-blink")},2e3)}},private_onExit:function(){this.moveOffStage(),this.onExit(),this.model.inFocus=!1},private_onUnrender:function(){this.onUnrender(),this.model.inFocus=!1,this.model.rendered=!1,this.remove()},moveOnStage:function(){$(this.el).css({top:this.attr.top+"%",left:this.attr.left+"%"})},updateZIndex:function(a){$(this.el).css("z-index",a)},moveOffStage:function(){$(this.el).css({top:"-1000%",left:"-1000%"})}})}(zeega.module("layer")),define("web/js/app/views/editor.layer/editor.view.layer.visual-editor.js",function(){}),function(a){a.Views.LinkExisting=Backbone.View.extend({className:"modal",el:$("#publish-project-modal"),initialize:function(){},render:function(){var a=this;return console.log("modal render!!!"),$(this.el).html(this.getTemplate()),_.each(_.toArray(zeega.app.project.sequences),function(b){$(a.el).find(".sequence-choose-select").append('<option value="'+b.id+'">'+b.get("title")+"</option>")}),_.each(zeega.app.project.sequences.at(0).get("frames"),function(b){zeega.app.currentFrame.id==b?$(a.el).find(".frame-choose-list").append('<li class="frame-thumb-no-choose-icon" data-id="'+b+'"><img src="'+zeega.app.project.frames.get(b).get("thumbnail_url")+'"/></li>'):$(a.el).find(".frame-choose-list").append('<li class="frame-thumb-choose-icon" data-id="'+b+'"><img src="'+zeega.app.project.frames.get(b).get("thumbnail_url")+'"/></li>')}),this.targetSequence=zeega.app.project.sequences.at(0).id,this},show:function(){this.$el.modal("show")},hide:function(){return this.$el.modal("hide"),zeega.app.busy=!1,this.remove(),!1},events:{"change .sequence-choose-select":"selectSequence","click li.frame-thumb-choose-icon":"selectFrame","click .close":"hide","click .save":"makeConnection"},selectSequence:function(){var a=this,b=$(a.el).find(".sequence-choose-select").val();$(this.el).find(".btn-primary").addClass("disabled").removeClass("save btn-primary"),$(this.el).find(".frame-choose-list").empty(),_.each(zeega.app.project.sequences.get(b).get("frames"),function(b){$(a.el).find(".frame-choose-list").append('<li class="frame-thumb-choose-icon" data-id="'+b+'"><img src="'+zeega.app.project.frames.get(b).get("thumbnail_url")+'"/></li>')}),this.targetSequence=b},selectFrame:function(a){var b=$(a.target).closest("li");$(this.el).find(".selected").removeClass("selected"),$(b).addClass("selected"),$(this.el).find(".disabled").removeClass("disabled").addClass("save btn-primary"),this.targetFrame=$(b).data("id")},makeConnection:function(){return this.hide(),zeega.app.connectToSequenceFrame(this.targetSequence,this.targetFrame),!1},getTemplate:function(){var a='<div class="modal" id="sequence-modal"><div class="modal-header"><button class="close">×</button></div><div class="modal-body"><h3>1. Choose Sequence:</h3><select class="sequence-choose-select"></select><h3>2. Choose Frame:</h3><ul class="frame-choose-list unstyled"></ul></div><div class="modal-footer"><a href="#" class="btn close" >Close</a><a href="#" class="btn disabled">Save changes</a></div></div>';return a}})}(zeega.module("modal")),define("web/js/app/views/editor.modals/editor.view.modal.link-existing",function(){}),function(a){a.Views.LinkAdvanced=Backbone.View.extend({className:"modal",initialize:function(){},render:function(){var a=this;return console.log("modal render!!!"),$(this.el).html(this.getTemplate()),zeega.app.currentFrame.get("layers").length<1&&$(a.el).find(".layer-checkbox-list").append('there are no layers on this frame to continue. Press the "Make New Sequence" button to continue with a blank sequence.'),_.each(zeega.app.currentFrame.get("layers"),function(b){var c=zeega.app.project.layers.get(b);if(c.get("type")!="Link"){var d="<li><label class='checkbox'><input type='checkbox' value='"+c.id+"'> <i class='zicon-"+c.get("type").toLowerCase()+"'></i> "+c.get("attr").title+"</label></li>";$(a.el).find(".layer-checkbox-list").append(d)}}),this},show:function(){this.$el.modal("show")},hide:function(){return this.$el.modal("hide"),zeega.app.busy=!1,this.remove(),!1},events:{"click .close":"hide","click .save":"makeConnection"},makeConnection:function(){this.hide();var a=$(this.el).find(".layer-checkbox-list input:checked"),b=_.map(a,function(a){return parseInt($(a).val())});return zeega.app.connectToAdvanced(_.union([],b)),!1},getTemplate:function(){var a='<div class="modal" id="sequence-modal"><div class="modal-header"><button class="close">×</button></div><div class="modal-body"><h3>Select layers to persist to your new sequence:</h3><ul class="layer-checkbox-list unstyled"></ul></div><div class="modal-footer"><a href="#" class="btn close" >Cancel</a><a href="#" class="btn btn-success pull-right save">Make New Sequence</a></div></div>';return a}})}(zeega.module("modal")),define("web/js/app/views/editor.modals/editor.view.modal.link-advanced",function(){}),function(a){a.Views.ShareProject=Backbone.View.extend({el:$("#publish-project-modal"),render:function(){var a=this;this.elemId=Math.floor(Math.random()*1e4);var b="";console.log(this.model);var c=this.model.frames.models,d=_.isUndefined(this.model.get("attr"))?{}:this.model.get("attr");for(var e=0;e<c.length;e++){var f=c[e];b+='<a href="#"><img class="publish-cover-image'+(d.project_thumbnail==f.get("thumbnail_url")?" publish-image-select":"")+'" id="'+f.id+'" src="'+f.get("thumbnail_url")+'"></a>'}var g=zeega.app.url_prefix+"project/"+this.model.id+"/view";this.iframeHTML='<iframe src="'+g+'" width="100%" height="100%" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';var h=this.convertHTML(this.iframeHTML),i={imageHTML:b,projectlink:g,uriEncodedProjectlink:encodeURIComponent(g),uriEncodedTitle:encodeURIComponent(this.model.get("title")),iframeEmbed:h,iframeHTML:this.iframeHTML,randId:this.elemId};return console.log(this),console.log(_.extend(this.model.attributes,i)),$(this.el).html(_.template(this.getTemplate(),_.extend(this.model.attributes,i))),$(this.el).find(".tagsedit").empty().tagsInput({interactive:!0,defaultText:"add a tag",onAddTag:function(){a.updateTags("",a)},onRemoveTag:function(){a.updateTags("",a)},removeWithBackspace:!1,minChars:1,maxChars:0,placeholderColor:"#C0C0C0"}),$(this.el).find("#preview-images img").mouseup(function(){$("#preview-images img").removeClass("publish-image-select"),$(this).addClass("publish-image-select")}),$(this.el).find("#close-modal").mouseup(function(){return $(a.el).html(" "),$(a.el).modal("hide"),!1}),$(this.el).find("#publish-open-customize-size").mouseup(function(){return $("#publish-customize-size").fadeToggle(),!1}),$(this.el).find("#looks-good").mouseup(function(){return d.project_thumbnail=$("#preview-images .publish-image-select").attr("src"),a.model.save({title:$("#publish-project-title").val(),published:!0,author:$("#publish-project-author").val(),estimated_time:$("#publish-project-estimated-time").val()},{success:function(b,c){console.log(a.model),$(a.el).find("#publish-project-modal-step1").hide(),$(a.el).find("#publish-project-modal-step2").show()},error:function(a,b){console.log("error publishing project"),console.log(a)}}),!1}),$(this.el).find("#publish-back").mouseup(function(){return $(a.el).find("#publish-project-modal-step2").hide(),$(a.el).find("#publish-project-modal-step1").show(),!1}),$(this.el).find("#publish-width, #publish-height").blur(function(b){var c=null;return $(this).attr("id")=="publish-width"?c=$(a.iframeHTML).attr("width",$(this).val()):c=$(a.iframeHTML).attr("height",$(this).val()),a.iframeHTML=c[0].outerHTML,$(a.el).find("#publish-embed").html(a.convertHTML(a.iframeHTML)),b.stopPropagation(),b.preventDefault(),!1}),$(this.el).modal("show"),this},convertHTML:function(a){return a.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;")},updateTags:function(a,b){model=b.model;var c=$("#"+b.elemId+"_tagsinput").children(".tag"),d=[];for(var e=c.length;e--;)d.push($(c[e]).text().substring(0,$(c[e]).text().length-1).trim());b.model.save({tags:d})},getTemplate:function(){var a='<div id="publish-project-modal-step1"><div class="modal-header"><button data-dismiss="modal" class="close">&times;</button><h3>Before you share your project, make sure everything looks good!</h3></div><div class="modal-body clearfix"><label for="publish-project-title">Title</label><input type="text" id="publish-project-title" value="<%= title %>"/><label for="publish-project-author">Author(s)</label><input type="text" id="publish-project-author" value="<%= author %>"/><label for="publish-project-estimated-time">Estimated Time</label><input type="text" id="publish-project-estimated-time" value="<%= estimated_time %>"/><label for="tags">Tags</label><div class="tags"><input name="tags" class="tagsedit" id="<%=randId%>" value="<%=tags%>" /></div><div class="publish-footer"><button id="looks-good" class="btn btn-success secondary">looks good <i class="icon-circle-arrow-right icon-white"></i></button></div></div></div><div id="publish-project-modal-step2" style="display:none"><div class="modal-header"><button data-dismiss="modal" class="close">&times;</button><h3>You\'re ready to publish <span style="color:#F15A29"><%= title %></span>!</h3><p>As you edit in the future this project will be automatically updated.</p></div><div class="modal-body clearfix"><div class="publish-left-column"><label for="project-title">Share your project</label><div id="publish-social-media"><span class="publish-social-media"><a href="https://twitter.com/share" class="twitter-share-button" data-url="<%=projectlink %>" data-text="Zeega Project: <%=title %>">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></span></div><label for="project-link">Or copy this link</label><input type="text" id="project-link" value="<%= projectlink %>"/></div><div class="publish-right-column"><label for="publish-embed">Embed your project</label><textarea id="publish-embed"><%= iframeEmbed %></textarea><a href="#" class="customize" id="publish-open-customize-size">Customize size</a><div id="publish-customize-size"><label for="publish-width">Width</label><input type="text" id="publish-width" value=""/><label for="publish-height">Height</label><input type="text" id="publish-height" value=""/></div><label for="publish-preview">Preview</label><div class="publish-preview"><%= iframeHTML %></div></div><div class="publish-footer"><button id="publish-back" class="btn secondary"><i class="icon-circle-arrow-left"></i> Back</button><button class="btn secondary pull-right" data-dismiss="modal" ><i class="icon-ok-circle"></i> Done</button></div></div></div>';return a}})}(zeega.module("modal")),define("web/js/app/views/editor.modals/editor.view.modal.share-project",function(){}),function(a){a.Views.ContinueLayer=Backbone.View.extend({initialize:function(){},render:function(){var a=this;console.log("modal render!!!"),$(this.el).html(this.getTemplate()),console.log(zeega.app.currentFrame.get("layers"));var b=0;return _.each(zeega.app.currentFrame.get("layers"),function(c){var d=zeega.app.project.layers.get(c);console.log(d);if(d.get("type")=="Link"&&d.get("attr").from_frame==zeega.app.currentFrame.id){console.log("this frame has links!!");var e=zeega.app.project.frames.get(d.get("attr").to_frame);console.log(e);var f="<li data-id='"+e.id+"'><a href='#'><img src='"+e.get("thumbnail_url")+"' height:'50px' width='50px'/></a></li>";$(a.el).find(".layer-list-checkboxes").append(f),b++}}),b==0&&$(a.el).find("#linked-frames-selector").remove(),this},show:function(){this.$el.modal("show")},hide:function(){return this.$el.modal("hide"),this.remove(),zeega.app.busy=!1,!1},events:{"click .close":"hide","click .save":"makeConnection","click .layer-list-checkboxes li":"selectFrame"},makeConnection:function(){this.hide();var a=this;return _.each($(this.el).find(".layer-list-checkboxes li.selected"),function(b){var b=zeega.app.project.frames.get($(b).data("id")),c=b.get("layers");c.push(a.model.id),b.save({layers:c})}),$(this.el).find("#continue-sequence").is(":checked")?(zeega.app.continueOnAllFrames(this.model.id),!1):($(this.el).find("#continue-next-frame").is(":checked")&&zeega.app.continueLayerToNextFrame(this.model.id),!1)},selectFrame:function(a){return $(a.target).closest("li").toggleClass("selected"),!1},getTemplate:function(){var a='<div class="modal" id="sequence-modal"><div class="modal-header"><button class="close">×</button></div><div class="modal-body"><h3>Continue this layer to</h3><label class="checkbox"><input id="continue-next-frame" type="checkbox" value="next_frame"> next frame</label><label class="checkbox"><input id="continue-sequence" type="checkbox" value="sequence"> this sequence</label><div id="linked-frames-selector">linked frames</br><ul class="layer-list-checkboxes unstyled"></ul></div></div><div class="modal-footer"><a href="#" class="btn close" >Cancel</a><a href="#" class="btn btn-success pull-right save">OK</a></div></div>';return a}})}(zeega.module("modal")),define("web/js/app/views/editor.modals/editor.view.modal.continue-layer",function(){}),function(a){a.Video=a.Model.extend({layerType:"Video",defaultAttributes:{title:"Video Layer",url:"none",left:0,top:0,height:100,width:100,volume:.5,cue_in:0,cue_out:0,opacity:1,dimension:1.5,citation:!0},init:function(){console.log(this.get("attr")),console.log(this),this.video=new Plyr2({url:this.get("attr").attribution_uri,uri:this.get("attr").uri,id:this.id,cue_in:this.get("attr").cue_in,cue_out:this.get("attr").cue_out,volume:this.get("attr").volume})}}),a.Views.Controls.Video=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Playback({model:this.model}),c=new a.Views.Lib.Slider({property:"volume",model:this.model,label:"Volume",min:0,max:1,step:.01,css:!1}),d=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),e=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),f=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1});return this.controls.append(b.getControl()).append(c.getControl()).append(d.getControl()).append(e.getControl()).append(f.getControl()),this}}),a.Views.Visual.Video=a.Views.Visual.extend({draggable:!0,linkable:!0,render:function(){var a=$("<img>").attr("id","video-player-"+this.model.id).attr("src",this.attr.thumbnail_url).css({width:"100%"});return $(this.el).html(a).css("height",this.attr.height+"%"),this},onLayerEnter:function(){this.model.controls.visible==1&&(this.$el.find("img").remove(),this.model.video.placeVideo(this.$el),this.model.loaded=!0)},onLayerExit:function(){this.model.video.isVideoLoaded&&this.model.video.destroy(),this.model.loaded=!1,this.model.trigger("editor_readyToRemove")},onControlsOpen:function(){console.log("video controls open : visual");var a=this;this.model.loaded?this.model.video.pop.pause():(this.model.video.on("video_canPlay",function(){a.model.trigger("video_ready",a.model.id)},this),this.model.video.placeVideo(this.$el),this.model.loaded=!0)},onControlsClosed:function(){this.model.video.pop.pause()},onPreload:function(){this.model.video.on("timeupdate",function(){Math.abs(a.model.video.pop.volume()-a.model.get("attr").volume)>.01&&a.model.video.pop.volume(a.model.get("attr").volume),a.model.get("attr").cue_out!=0&&a.model.video.pop.currentTime()>a.model.get("attr").cue_out&&(a.model.video.pop.currentTime(a.model.get("attr").cue_in),a.model.video.pop.pause(),a.model.trigger("playback_ended"),console.log("playback ended"))},this);var a=this;this.model.loaded?this.model.video.pop.pause():(this.model.video.placeVideo(this.$el),this.model.video.on("video_canPlay",function(){console.log("video ready player"),a.model.trigger("ready",a.model.id)},this),this.model.loaded=!0)},onPlay:function(){this.model.video.play()},onExit:function(){this.model.video.pause()},onUnrender:function(){this.model.video.pause()}}),a.Youtube=a.Video.extend(),a.Views.Controls.Youtube=a.Views.Controls.Video.extend(),a.Views.Visual.Youtube=a.Views.Visual.Video.extend(),a.Vimeo=a.Video.extend(),a.Views.Controls.Vimeo=a.Views.Controls.Video.extend(),a.Views.Visual.Vimeo=a.Views.Visual.Video.extend()}(zeega.module("layer")),define("web/js/plugins/layers/video/video.js",function(){}),function(a){a.Audio=a.Video.extend({layerType:"Audio",defaultAttributes:{title:"Audio Layer",url:"none",left:0,top:0,height:100,width:100,volume:.5,cue_in:0,cue_out:0,opacity:1,dimension:1.5,citation:!0}}),a.Views.Controls.Audio=a.Views.Controls.Video.extend({render:function(){var b=new a.Views.Lib.Playback({model:this.model}),c=new a.Views.Lib.Slider({property:"volume",model:this.model,label:"Volume",min:0,max:1,step:.01,css:!1});return this.controls.append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.Audio=a.Views.Visual.Video.extend({draggable:!1,linkable:!1,render:function(){return this}})}(zeega.module("layer")),define("web/js/plugins/layers/audio/audio.js",function(){}),function(a){a.Geo=a.Model.extend({layerType:"Geo",defaultAttributes:{title:"Streetview Layer",height:100,width:100,lat:42.3735626,lng:-71.1189639,zoom:10,streetZoom:1,heading:0,pitch:0,mapType:"satellite",url:"",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0,linkable:!0}}),a.Views.Controls.Geo=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),d=new a.Views.Lib.Slider({property:"left",model:this.model,label:"Horizontal Position",suffix:"%",min:0,max:100}),e=new a.Views.Lib.Slider({property:"top",model:this.model,label:"Vertical Position",suffix:"%",min:0,max:100}),f=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1}),g=new a.Views.Lib.GoogleMaps({model:this.model});return $(this.controls).append(g.getControl()).append(b.getControl()).append(c.getControl()).append(d.getControl()).append(e.getControl()).append(f.getControl()),this}}),a.Views.Visual.Geo=a.Views.Visual.extend({draggable:!1,linkable:!0,init:function(){console.log("	GEO INIT");var a=this;this.model.on("update",this.updateVisual,this)},render:function(){var a=$('<div class="gmap-container">').css({width:"100%",height:"100%"});return $(this.el).html(a).css({height:this.attr.height+"%"}),this},updateVisual:function(){console.log("	update visual"),console.log(this);var a=new google.maps.LatLng(this.model.get("attr").lat,this.model.get("attr").lng),b={heading:this.model.get("attr").heading,pitch:this.model.get("attr").pitch,zoom:this.model.get("attr").streetZoom};this.streetview.setPosition(a),this.streetview.setPov(b)},onLayerEnter:function(){if(!this.isLoaded){console.log("geo layer enter");var a=new google.maps.LatLng(this.model.get("attr").lat,this.model.get("attr").lng),b={addressControl:!1,addressControlOptions:!1,clickToGo:!0,disableDoubleClickZoom:!1,enableCloseButton:!1,imageDateControl:!1,linksControl:!1,panControl:!0,panControlOptions:!0,position:a,visible:!0,zoomControl:!0,zoomControlOptions:!0,pov:{heading:this.model.get("attr").heading,pitch:this.model.get("attr").pitch,zoom:this.model.get("attr").streetZoom}};this.streetview=new google.maps.StreetViewPanorama($(this.el).find(".gmap-container")[0],b),this.initMapListeners(),this.isLoaded=!0}},initMapListeners:function(){var a=this;google.maps.event.addListener(this.streetview,"position_changed",function(){b()}),google.maps.event.addListener(this.streetview,"pov_changed",function(){b()});var b=_.debounce(function(){var b=a.model.get("attr");(b.heading!=a.streetview.getPov().heading||b.pitch!=a.streetview.getPov().pitch||b.streetZoom!=a.streetview.getPov().zoom||Math.floor(b.lat*1e3)!=Math.floor(a.streetview.getPosition().lat()*1e3)||Math.floor(b.lng*1e3)!=Math.floor(a.streetview.getPosition().lng()*1e3))&&a.model.update({heading:a.streetview.getPov().heading,pitch:a.streetview.getPov().pitch,streetZoom:Math.floor(a.streetview.getPov().zoom),lat:a.streetview.getPosition().lat(),lng:a.streetview.getPosition().lng()})},1e3)},onLayerExit:function(){this.map={},$(this.el).find(".gmap-container").hide(),this.isLoaded=!1},onPreload:function(){if(!this.isLoaded){var a=new google.maps.LatLng(this.model.get("attr").lat,this.model.get("attr").lng),b={addressControl:!1,addressControlOptions:!1,clickToGo:!0,disableDoubleClickZoom:!1,enableCloseButton:!1,imageDateControl:!1,linksControl:!1,panControl:!0,panControlOptions:!0,position:a,visible:!0,zoomControl:!0,zoomControlOptions:!0,pov:{heading:this.model.get("attr").heading,pitch:this.model.get("attr").pitch,zoom:this.model.get("attr").streetZoom}};this.streetview={},this.streetview=new google.maps.StreetViewPanorama($(this.el).find(".gmap-container")[0],b),this.isLoaded=!0}this.model.trigger("ready",this.model.id)}})}(zeega.module("layer")),define("web/js/plugins/layers/geo/geo.js",function(){}),function(a){a.Image=a.Model.extend({layerType:"Image",defaultAttributes:{title:"Image Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0,linkable:!0}}),a.Views.Controls.Image=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Scale",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1});return $(this.controls).append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.Image=a.Views.Visual.extend({draggable:!0,render:function(){var a=$("<img>").attr("src",this.attr.uri).css({width:"100%"});return $(this.el).html(a),this}})}(zeega.module("layer")),define("web/js/plugins/layers/image/image.js",function(){}),function(a){a.Mapbox=a.Model.extend({layerType:"Mapbox",defaultAttributes:{title:"Mapbox Layer",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0,media_geo_latitude:40.7774,media_geo_longitude:-73.9606,attributes:{zoom:12,maxzoom:18,minzoom:0},zoomControl:12,interaction:!1}}),a.Views.Controls.Mapbox=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),d=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1}),e=new a.Views.Lib.Slider({property:"left",model:this.model,label:"Left",suffix:"%",step:1,min:0,max:100}),f=new a.Views.Lib.Slider({property:"top",model:this.model,label:"Top",step:1,suffix:"%",min:0,max:100});return this.controls.append(b.render().el).append(c.render().el).append(f.render().el).append(e.render().el).append(d.render().el),this}}),a.Views.Visual.Mapbox=a.Views.Visual.extend({draggable:!1,linkable:!0,render:function(){return this.tileUrl="http://{s}.tiles.mapbox.com/v3/"+this.attr.uri+"/{z}/{x}/{y}.png",this.tileLayer=new L.TileLayer(this.tileUrl,{minZoom:this.attr.attributes.minzoom,maxZoom:this.attr.attributes.maxzoom,attribution:""}),this.latlng=new L.LatLng(parseFloat(this.attr.media_geo_latitude),parseFloat(this.attr.media_geo_longitude)),$(this.el).css({width:this.attr.width+"%",height:this.attr.height+"%"}),$(this.el).html($("<div>").css({width:"100%",height:"100%"}).addClass("cloud-map")),this},onLayerEnter:function(){var a=$(this.el).find(".cloud-map").get(0),b={minZoom:this.attr.attributes.minzoom,maxZoom:this.attr.attributes.maxzoom,scrollWheelZoom:!1,zoomControl:!1,doubleClickZoom:!1};console.log(b),console.log(this.attr),this.map=new L.Map(a,b),console.log(this.attr),this.map.setView(this.latlng,this.attr.attributes.zoom).addLayer(this.tileLayer);var c=this;this.map.on("zoomend",function(a){c.model.update({attributes:{zoom:a.target.getZoom()}}),c.attr.attributes.zoom=a.target.getZoom()}),this.map.on("dragend",function(a){c.model.update({media_geo_latitude:a.target.getCenter().lat,media_geo_longitude:a.target.getCenter().lng}),c.latlng=a.target.getCenter()}),this.zoomControl=new L.Control.Zoom,this.map.addControl(this.zoomControl)},onPreload:function(){console.log("oh yeah"),console.log(this.el),console.log("oh yeah");var a=$(this.el).find(".cloud-map").get(0);console.log(this.el),this.map=new L.Map(a,{minZoom:this.attr.attributes.minzoom,maxZoom:this.attr.attributes.maxzoom,scrollWheelZoom:!1,zoomControl:!1,doubleClickZoom:!1}),this.map.setView(this.latlng,this.attr.attributes.zoom).addLayer(this.tileLayer);var b=this;this.map.on("zoomend",function(a){b.model.update({zoom:a.target.getZoom()})}),this.map.on("dragend",function(a){b.model.update({media_geo_latitude:a.target.getCenter().lat,media_geo_longitude:a.target.getCenter().lng})}),this.zoomControl=new L.Control.Zoom,this.map.addControl(this.zoomControl),this.model.trigger("ready",this.model.id)}})}(zeega.module("layer")),define("web/js/plugins/layers/mapbox/mapbox.js",function(){}),function(a){a.Text=a.Model.extend({layerType:"Text",displayCitation:!1,linkable:!0,defaultAttributes:{title:"Text Layer",content:"Text",left:0,top:0,color:"#ffffff",opacity:.9,fontSize:200,overflow:"visible",width:25,linkable:!0},updateContentInPlace:function(){this.visual.updateContentInPlace()},preload:function(a){},play:function(a){},stash:function(){this.display.css({top:"-1000%",left:"-1000%"})}}),a.Views.Controls.Text=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.ColorPicker({property:"color",color:this.model.get("attr").color,model:this.model,label:"Text Color",opacity:!0}),c=new a.Views.Lib.Slider({property:"fontSize",model:this.model,label:"Font Size",suffix:"%",min:100,max:1e3}),d=new a.Views.Lib.TextStyles({model:this.model}),e=new a.Views.Lib.FontChooser({model:this.model});return this.controls.append(d.getControl()).append(e.getControl()).append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.Text=a.Views.Visual.extend({draggable:!0,render:function(){var a="",b="";if(_.isObject(this.model.get("attr").color)){var c=this.model.get("attr").color;a=rgbToHex(c.r,c.g,c.b)}else a=this.model.get("attr").color;if(_.isObject(this.model.get("attr").backgroundColor)){var c=this.model.get("attr").backgroundColor;b=rgbToHex(c.r,c.g,c.b)}else b=this.model.get("attr").backgroundColor;var d={color:"rgba("+a.toRGB()+","+(this.model.get("attr").colorOpacity||1)+")",opacity:this.model.get("attr").opacity,fontSize:this.model.get("attr").fontSize<100?"200%":this.model.get("attr").fontSize+"%",width:this.model.get("attr").width+"%",overflow:"visible","line-height":"100%"};return $(this.el).html(_.template(this.getTemplate(),_.extend(this.model.get("attr"),{contentEditable:!this.model.player}))).css(d),this.model.player||$(this.el).addClass("text-non-editing"),this.model.trigger("ready",this.model.id),this},onLayerEnter:function(){var a=this;this.$el.find("#zedit-target").keyup(function(b){b.which==27&&$(this).blur(),a.lazySave()}).bind("paste",function(b){console.log("content pasted in!"),a.lazySave()}),this.$el.click(function(){a.$el.find("#zedit-target").focus(),a.$el.draggable("option","disabled",!0),a.$el.addClass("text-editing").removeClass("text-non-editing")}).focusout(function(){a.$el.draggable("option","disabled",!1),a.$el.removeClass("text-editing").addClass("text-non-editing"),a.lazySave()}),$(this.el).resizable({stop:function(b,c){$(this).css("height",""),a.model.update({width:$(this).width()/$(this).parent().width()*100})}})},lazySave:_.debounce(function(){var a=this.$el.find("#zedit-target").html(),b=this.cleanString(a);this.model.update({content:a,title:b})},1e3),cleanString:function(a){return a.replace(/(<([^>]+)>)/ig,"")},updateContentInPlace:function(){$(this.el).find("#zedit-target").html(this.model.get("attr").content)},getTemplate:function(){var a='<div id="zedit-target" class="inner" contenteditable="<%= contentEditable %>" ><%= content %></div>';return a}})}(zeega.module("layer")),define("web/js/plugins/layers/text/text.js",function(){}),function(a){a.GoogleBook=a.Model.extend({layerType:"GoogleBook",defaultAttributes:{title:"GoogleBook Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0}}),a.Views.Controls.GoogleBook=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Scale",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1});return this.controls.append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.GoogleBook=a.Views.Visual.extend({draggable:!0,linkable:!0,render:function(){console.log(this);var a=$("<img>").attr("src",this.attr.thumbnail_url).css({width:"100%"});return $(this.el).html(a),this}})}(zeega.module("layer")),define("web/js/plugins/layers/googlebook/googlebook.js",function(){}),function(a){a.Link=a.Model.extend({layerType:"Link",layerPanel:$("#links-list"),defaultControls:!1,defaultAttributes:{title:"Link Layer",to_sequence:null,from_sequence:null,to_frame:null,from_frame:null,left:25,top:25,height:50,width:50},init:function(a){},setToFrame:function(a,b){this.get("attr").to_sequence=a,this.get("attr").to_frame=b,this.get("attr").title="Link to sequence "+a,this.save()}}),a.Views.Controls.Link=a.Views.Controls.extend({onLayerEnter:function(){var a=this.model.layerIndex||this.model.layerColor.length;$(this.el).find(".zicon-link").css({"background-color":this.model.layerColor[a%this.model.layerColor.length]}),this.model.get("attr").to_frame==zeega.app.currentFrame.id&&this.remove()},render:function(){return this}}),a.Views.Visual.Link=a.Views.Visual.extend({preview:!1,init:function(){this.preview=zeega.app.previewMode},render:function(){var a=this,b={height:this.model.get("attr").height+"%",cursor:"pointer","z-index":100};if(!zeega.app.previewMode){var c=this.model.layerIndex||this.model.layerColor.length;_.extend(b,{border:"2px dashed "+this.model.layerColor[c%this.model.layerColor.length],"border-radius":"6px"}),this.model.get("attr").to_frame==zeega.app.currentFrame.id&&!zeega.app.previewMode&&this.remove()}else this.delegateEvents({click:"goClick"});return $(this.el).html(this.getTemplate()).css(b).addClass("linked-layer"),this},events:{"click .go-to-sequence":"goToSequenceFrame","click .delete-link":"deleteLink","mousedown .show-controls":"showControls"},goClick:function(){zeega.app.player.goToSequenceFrame(this.model.get("attr").to_sequence,this.model.get("attr").to_frame)},goToSequenceFrame:function(){zeega.app.previewMode?zeega.app.player.goToSequenceFrame(this.model.get("attr").to_sequence,this.model.get("attr").to_frame):zeega.app.router.navigate("editor/sequence/"+this.model.get("attr").to_sequence+"/frame/"+this.model.get("attr").to_frame,{trigger:!0})},deleteLink:function(a){confirm("delete link?")&&(this.model.trigger("editor_removeLayerFromFrame",this.model),this.remove())},showControls:function(a){},onLayerEnter:function(){this.render(),this.delegateEvents();if(this.model.get("attr").from_frame==zeega.app.currentFrame.id){var a=this;this.delegateEvents(),this.$el.resizable({stop:function(b,c){a.model.update({width:$(this).width()/$(this).parent().width()*100,height:$(this).height()/$(this).parent().height()*100})}})}},onPlay:function(){this.render(),this.model.get("attr").to_frame==zeega.app.player.currentFrame.id&&this.moveOffStage(),this.delegateEvents({click:"goClick"})},getTemplate:function(){var a="";return this.preview||(a+='<i class="icon-remove delete-link"></i>'),!this.preview&&!_.isNull(this.model.get("attr").to_sequence)&&(a+='<i class="icon-share go-to-sequence"></i>'),a}})}(zeega.module("layer")),define("web/js/plugins/layers/link/link",function(){}),function(a){a.Rectangle=a.Model.extend({layerType:"Rectangle",defaultAttributes:{title:"Color Layer",url:null,backgroundColor:"#ff00ff",left:0,top:0,height:100,width:100,opacity:.75,linkable:!0}}),a.Views.Controls.Rectangle=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.ColorPicker({property:"backgroundColor",color:this.attr.backgroundColor,model:this.model,label:"Color"}),c=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),d=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),e=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:0,max:1});return this.controls.append(b.getControl()).append(e.getControl()).append(c.getControl()).append(d.getControl()),this}}),a.Views.Visual.Rectangle=a.Views.Visual.extend({render:function(){var a={backgroundColor:this.attr.backgroundColor,height:this.model.get("attr").height+"%"};return $(this.el).css(a),this.model.trigger("ready",this.model.id),this}})}(zeega.module("layer")),define("web/js/plugins/layers/rectangle/rectangle",function(){}),jQuery(function(a){function d(b){switch(b){case 0:a("#visual-editor-workspace").css("width","704px");break;case 1:a("#visual-editor-workspace").css("width","625px");break;default:console.log("goDefault")}}function e(){return a("#project-settings-modal").modal("show"),a("#project-settings-modal").find("#close-modal").click(function(){a("#project-settings-modal").modal("hide")}),!1}function f(){var c=b.exportProject(!0);return a("#export").modal("show"),a("#export-json").val(c),a("#export-json").focus(function(){a("#export-json").select()}),a("#export").find("#close-modal").mouseup(function(){a("#export").modal("hide")}),!1}function g(){a(".menu-items").removeClass("open")}var b=zeega.app;b.init(),initHeaderUX(),a(".info").popover({delayIn:0}),a("body").click(function(){a(".menu").addClass("hide")}),a("#sequence-cover-image").droppable({accept:".database-asset-list",hoverClass:"workspace-item-hover",tolerance:"pointer",drop:function(a,b){b.draggable.draggable("option","revert",!1),zeega.app.editCoverImage({item:zeega.app.draggedItem})}});var c=VS.init({container:a(".visual_search"),query:"",callbacks:{search:function(a,b){console.log("	search");var d={},e=!1;_.each(_.toArray(b),function(a){console.log(a),a.get("category")=="filter"&&(e?a.destroy():d.contentType=a.get("value"),e=!0),a.get("category")=="text"&&(d.query=a.get("value"))}),c.searchBox.renderFacets(),zeega.app.searchDatabase(d,!0)},facetMatches:function(a){a(["filter",{label:"all",category:"Media Type"},{label:"audio",category:"Media Type"},{label:"image",category:"Media Type"},{label:"video",category:"Media Type"}])},valueMatches:function(a,b,c){switch(a){case"filter":c(["all","audio","image","video"])}}}});a(".VS-icon.VS-icon-search").click(function(){console.log("open filter dialog"),a(".filter-list").show("fast")}),a(".filter-list a").click(function(b){var d=new VS.model.SearchFacet({category:"filter",value:a(this).data("searchFilter"),app:c.searchBox.app});return c.searchQuery.add(d,{at:0}),c.options.callbacks.search(null,c.searchQuery),a(".filter-list").hide(),b.stopPropagation(),!1}),a("#make-connection .action").click(function(b){return a(this).hasClass("disabled")||(a(this).closest("div").removeClass("open"),zeega.app.makeConnection(a(this).data("action"))),!1}),a("#connection-confirm button").click(function(){a("#make-connection button").removeClass("disabled"),a("#connection-confirm").hide(),zeega.app.confirmConnection(a(this).data("action"))}),a("#database-collection-filter").change(function(){a("#database-search-filter").val("all"),console.log("search collection: "+a(this).val()),zeega.app.searchDatabase({collectionID:a(this).val()},!1)}),a("#add-node-button").click(function(){return zeega.app.addFrame(),!1}),a("#preview").click(function(){return zeega.app.previewSequence(),!1}),a("#list-view").click(function(){return console.log("goto list view"),a("#grid-view .zicon").removeClass("orange"),a(this).find(".zicon").addClass("orange"),a("#database-item-list").addClass("list-view").removeClass("grid-view"),!1}),a("#grid-view").click(function(){return console.log("goto grid view"),a("#list-view .zicon").removeClass("orange"),a(this).find(".zicon").addClass("orange"),a("#database-item-list").removeClass("list-view").addClass("grid-view"),!1}),a("#project-settings").click(function(){e()}),a("#ratio-list a").click(function(){return d(a(this).data("ratio-id")),!1}),a("#new-layer-list a").click(function(){return zeega.app.addLayer({type:a(this).data("type")}),!1}),a("#add-frame").draggable({axis:"x",revert:!0,start:function(a,b){this.num=Math.floor(b.position.left/55)},containment:"parent",helper:function(){return a("<div>")},drag:function(b,c){var d=Math.floor(c.position.left/55);if(this.num!=d){var e=this;a(".ghost-frame").remove(),_.times(d-this.num,function(){a("#frame-drawer ul").append(a('<li class="frame-thumb ghost-frame">'))})}},stop:function(b,c){a(".ghost-frame").remove(),_.times(Math.floor(c.position.left/55-this.num),function(){zeega.app.addFrame()})}}),a("#publish-project").click(function(){return zeega.app.shareProject(),!1}),a("#get-help").click(function(){localStorage.help=!0,zeega.app.initStartHelp()}),a(".menu-toggle").click(function(){var b=a(this).next();return b.hasClass("open")?b.removeClass("open"):b.addClass("open"),!1}),a("html").bind("click",g),a(".visual_search").click(function(a){a.stopPropagation()}),a("#refresh-database").click(function(){zeega.app.refreshDatabase()}),window.addEventListener("focus",function(){zeega.app.refreshDatabase(),console.log("refreshing database from zeega.ux.editor line 260")}),a("#database-search-text").keypress(function(b){var c=b.which;if(c!=13)return!0;zeega.app.searchDatabase({query:a("#database-search-text").val()},!1),a("#database-panel .panel-content").is(":hidden")&&a("#database-panel .panel-content").show("blind",{direction:"vertical"})}),a(".layer-list a:first").click(function(){return console.log("sortable layers"),a("#sortable-layers li").children("div").hide("fast"),a(this).closest("li").children("div").is(":visible")?(a(this).closest("li").children("div").hide("fast"),!1):(a(this).closest("li").children("div").show("fast"),!1)}),a("#frame-list").sortable({containment:"#frame-drawer",forceHelperSize:!0,placeholder:"frame-thumb ui-state-highlight",forcePlaceholderSize:!0,forceHelperSize:!0,tolerance:"pointer",distance:10,stop:function(){zeega.app.updateFrameOrder()}}),a("#layers-list-visual").sortable({handle:".layer-drag-handle",cursor:"move",axis:"y",containment:"#sidebar",cursorAt:{top:1,left:1},placeholder:"ui-state-highlight",update:function(){zeega.app.updateLayerOrder()}}),a("#sortable-layers").disableSelection(),a("#links-list").sortable({handle:".layer-drag-handle",cursor:"move",axis:"y",containment:"#sidebar",cursorAt:{top:1,left:1},placeholder:"ui-state-highlight",update:function(){console.log("link sort update"),zeega.app.updateLayerOrder()}}),a("#advance-controls input").change(function(){var b=zeega.app.currentFrame.get("attr");b?b.advance=a(this).val()!=-1?parseInt(a(this).val()*1e3):-1:b={advance:a(this).val()!=-1?parseInt(a(this).val()*1e3):-1},zeega.app.currentFrame.set({attr:b}),zeega.app.currentFrame.save()}),a("#frame-advance-random input").change(function(){var c=b.currentFrame.get("attr");a(this).is(":checked")?c.advanceRandom=!0:c.advanceRandom=!1,b.currentFrame.set({attr:c}),b.currentFrame.save()}),a(".expandable .panel-head").click(function(){var b=a(this).next("div");b.is(":visible")?b.hide("blind",{direction:"vertical"}):b.show("blind",{direction:"vertical"})}),a("#database-item-list").scroll(function(){a("#database-item-list").scrollTop()==a("#database-item-list")[0].scrollHeight-a("#database-item-list").innerHeight()&&zeega.app.itemCollection.getNextPage()}),a("#visual-editor-workspace").droppable({accept:".database-asset-list",hoverClass:"workspace-item-hover",tolerance:"pointer",drop:function(a,b){b.draggable.draggable("option","revert",!1),zeega.app.addLayer({item:zeega.app.draggedItem})}}),a("#css-change").toggle(function(){a("body").css("background","#fff"),a("#sequence-header").css("color","#444"),a("#frame-drawer").css("background","#fff"),a(".database-asset").css("background","#fff")},function(){a("body").css("background",""),a("#sequence-header").css("color",""),a("#frame-drawer").css("background",""),a(".database-asset").css("background","")})}),define("web/js/app/index",function(){}),require.config({baseUrl:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"js/.js",paths:{order:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"js/lib/order.js",text:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"js/lib/text"}}),require(["web/js/lib/underscore.js","web/js/lib/backbone.js","web/js/lib/jquery/ui/js/jquery-ui.min.js","web/js/lib/spin.js","web/js/lib/swfobject.js","web/js/lib/visualsearch.js","web/js/lib/leaflet/leaflet.js","web/js/ux/zeega.ux.header.js","web/js/ux/layer-controls.js","web/js/helpers/zeega.extends.js","web/js/helpers/zeega.helpers.js","web/js/app/zeega.js","web/js/app/zeega.player.js","web/js/lib/jquery/plugins/spin.js","web/js/lib/jquery/plugins/jeditable.min.js","web/js/lib/jquery/plugins/jquery-cycle.js","web/js/lib/farbtastic/farbtastic.js","web/js/lib/jquery/plugins/jquerygetUrlParam.js","web/js/lib/jquery/plugins/jqueryjson.js","web/js/lib/jquery/plugins/jquerycookie.js","web/js/lib/popcorn_flash.js","web/js/lib/bootstrap.js","web/js/plugins/players/plyr.js","web/js/app/models/editor.model.project.js","web/js/app/models/editor.model.sequence.js","web/js/app/models/editor.model.item.js","web/js/app/models/editor.model.frame.js","web/js/app/models/editor.model.layer.js","web/js/app/collections/editor.collections.sequence.js","web/js/app/collections/editor.collections.item.js","web/js/app/collections/editor.collections.frame.js","web/js/app/collections/editor.collections.layer.js","web/js/app/views/editor.project/editor.view.project.editor.js","web/js/app/views/editor.sequence/editor.view.sequence.sequence-tab","web/js/app/views/editor.item/editor.view.item.database-tray.js","web/js/app/views/editor.frame/editor.view.frame.frame-sequence.js","web/js/app/views/editor.layer/editor.view.layer.control-library.js","web/js/app/views/editor.layer/editor.view.layer.layer-list.js","web/js/app/views/editor.layer/editor.view.layer.visual-editor.js","web/js/app/views/editor.modals/editor.view.modal.link-existing","web/js/app/views/editor.modals/editor.view.modal.link-advanced","web/js/app/views/editor.modals/editor.view.modal.share-project","web/js/app/views/editor.modals/editor.view.modal.continue-layer","web/js/plugins/layers/video/video.js","web/js/plugins/layers/audio/audio.js","web/js/plugins/layers/geo/geo.js","web/js/plugins/layers/image/image.js","web/js/plugins/layers/mapbox/mapbox.js","web/js/plugins/layers/text/text.js","web/js/plugins/layers/googlebook/googlebook.js","web/js/plugins/layers/link/link","web/js/plugins/layers/rectangle/rectangle","web/js/app/index"],function(a){console.log("ALL JS LOADED");var b=$("#sequence-id").val()}),define("web/js/loaders/editor_min.js",function(){})